/******************************************************************************/
/***          Generated by IBExpert 2022.3.4.1 22.01.2023 20:08:31          ***/
/******************************************************************************/

SET SQL DIALECT 3;

SET NAMES UTF8;

CREATE DATABASE 'D:\A1-docs\c_net\Klons\KlonsFM\DB\klonsfm_p.fdb'
USER 'AIVARS' PASSWORD 'parole'
PAGE_SIZE 16384
DEFAULT CHARACTER SET UTF8 COLLATION UNICODE_CI;



/******************************************************************************/
/***                                Domains                                 ***/
/******************************************************************************/

CREATE DOMAIN DAMOUNT AS
NUMERIC(12,4);

CREATE DOMAIN DMAC1 AS
VARCHAR(8);

CREATE DOMAIN DMAC3 AS
VARCHAR(5);

CREATE DOMAIN DMAC4 AS
VARCHAR(8);

CREATE DOMAIN DMAC5 AS
VARCHAR(5);

CREATE DOMAIN DMCLID AS
VARCHAR(15);

CREATE DOMAIN DMDOCTYP AS
VARCHAR(10);

CREATE DOMAIN DMV2 AS
VARCHAR(2);

CREATE DOMAIN DPRICEX AS
NUMERIC(15,4);

CREATE DOMAIN MONEY AS
NUMERIC(15,2)
DEFAULT 0;

CREATE DOMAIN NEW_DOMAIN AS
VARCHAR(100);

CREATE DOMAIN T_YESNO AS
CHAR(1)
DEFAULT 'N'
CHECK((VALUE IS NULL) OR (VALUE IN ('N','Y')));



/******************************************************************************/
/***                               Generators                               ***/
/******************************************************************************/

CREATE GENERATOR GEN_BAL0_ID;
SET GENERATOR GEN_BAL0_ID TO 0;

CREATE GENERATOR GEN_BALA21_ID;
SET GENERATOR GEN_BALA21_ID TO 0;

CREATE GENERATOR GEN_BALA2_ID;
SET GENERATOR GEN_BALA2_ID TO 427;

CREATE GENERATOR GEN_BALA3_ID;
SET GENERATOR GEN_BALA3_ID TO 143;

CREATE GENERATOR GEN_DOCS0_ID;
SET GENERATOR GEN_DOCS0_ID TO 0;

CREATE GENERATOR GEN_LOGX_ID;
SET GENERATOR GEN_LOGX_ID TO 0;

CREATE GENERATOR GEN_LOPSD_IDL;
SET GENERATOR GEN_LOPSD_IDL TO 35;

CREATE GENERATOR GEN_LOPS_IDL;
SET GENERATOR GEN_LOPS_IDL TO 26;

CREATE GENERATOR GEN_LXOP_ID;
SET GENERATOR GEN_LXOP_ID TO 0;

CREATE GENERATOR GEN_M_ADDRESSSES_ID;
SET GENERATOR GEN_M_ADDRESSSES_ID TO 4;

CREATE GENERATOR GEN_M_AUX_ID;
SET GENERATOR GEN_M_AUX_ID TO 5;

CREATE GENERATOR GEN_M_BANKS_ID;
SET GENERATOR GEN_M_BANKS_ID TO 5;

CREATE GENERATOR GEN_M_CONTACTS_ID;
SET GENERATOR GEN_M_CONTACTS_ID TO 2;

CREATE GENERATOR GEN_M_COUNTRIES_ID;
SET GENERATOR GEN_M_COUNTRIES_ID TO 249;

CREATE GENERATOR GEN_M_DOCSEQ;
SET GENERATOR GEN_M_DOCSEQ TO 22;

CREATE GENERATOR GEN_M_DOCS_ID;
SET GENERATOR GEN_M_DOCS_ID TO 7;

CREATE GENERATOR GEN_M_DOCTYPES_ID;
SET GENERATOR GEN_M_DOCTYPES_ID TO 9;

CREATE GENERATOR GEN_M_ITEMS_CAT_ID;
SET GENERATOR GEN_M_ITEMS_CAT_ID TO 16;

CREATE GENERATOR GEN_M_ITEMS_ID;
SET GENERATOR GEN_M_ITEMS_ID TO 5;

CREATE GENERATOR GEN_M_PAYMENTTYPE_ID;
SET GENERATOR GEN_M_PAYMENTTYPE_ID TO 3;

CREATE GENERATOR GEN_M_PVNRATES2_ID;
SET GENERATOR GEN_M_PVNRATES2_ID TO 143;

CREATE GENERATOR GEN_M_PVNRATES_ID;
SET GENERATOR GEN_M_PVNRATES_ID TO 0;

CREATE GENERATOR GEN_M_PVNTEXTS_ID;
SET GENERATOR GEN_M_PVNTEXTS_ID TO 11;

CREATE GENERATOR GEN_M_ROWS_ID;
SET GENERATOR GEN_M_ROWS_ID TO 8;

CREATE GENERATOR GEN_M_STORES_ID;
SET GENERATOR GEN_M_STORES_ID TO 9;

CREATE GENERATOR GEN_M_STORETYPE_ID;
SET GENERATOR GEN_M_STORETYPE_ID TO 6;

CREATE GENERATOR GEN_M_TRANSACTIONTYPE_ID;
SET GENERATOR GEN_M_TRANSACTIONTYPE_ID TO 0;

CREATE GENERATOR GEN_M_UNITS_ID;
SET GENERATOR GEN_M_UNITS_ID TO 7;

CREATE GENERATOR GEN_M_VEHICLES_ID;
SET GENERATOR GEN_M_VEHICLES_ID TO 2;

CREATE GENERATOR GEN_OPSD_ID;
SET GENERATOR GEN_OPSD_ID TO 42;

CREATE GENERATOR GEN_OPS_ID;
SET GENERATOR GEN_OPS_ID TO 99;

CREATE GENERATOR GEN_PARAMS_ID;
SET GENERATOR GEN_PARAMS_ID TO 10340;

CREATE GENERATOR GEN_PERSONTYP_ID;
SET GENERATOR GEN_PERSONTYP_ID TO 2;

CREATE GENERATOR GEN_ROPS1A_ID;
SET GENERATOR GEN_ROPS1A_ID TO 156;

CREATE GENERATOR GEN_ROPS2A_ID;
SET GENERATOR GEN_ROPS2A_ID TO 119;

CREATE GENERATOR GEN_ROPS2B_ID;
SET GENERATOR GEN_ROPS2B_ID TO 0;

CREATE GENERATOR GEN_ROPS3A_ID;
SET GENERATOR GEN_ROPS3A_ID TO 5;

CREATE GENERATOR GEN_TABLE1_ID;
SET GENERATOR GEN_TABLE1_ID TO 0;

CREATE GENERATOR GEN_TREM_ID;
SET GENERATOR GEN_TREM_ID TO 0;

CREATE GENERATOR GEN_TREPA1_ID;
SET GENERATOR GEN_TREPA1_ID TO 0;

CREATE GENERATOR GEN_TREPAPAN_ID;
SET GENERATOR GEN_TREPAPAN_ID TO 0;

CREATE GENERATOR GEN_TREPDARZ1_ID;
SET GENERATOR GEN_TREPDARZ1_ID TO 135;

CREATE GENERATOR GEN_TREPDARZ2_ID;
SET GENERATOR GEN_TREPDARZ2_ID TO 23;

CREATE GENERATOR GEN_TREPDOCS1_ID;
SET GENERATOR GEN_TREPDOCS1_ID TO 0;

CREATE GENERATOR GEN_TREPDOCS2_ID;
SET GENERATOR GEN_TREPDOCS2_ID TO 0;

CREATE GENERATOR GEN_TREPDOCSS_ID;
SET GENERATOR GEN_TREPDOCSS_ID TO 0;

CREATE GENERATOR GEN_TREPMT_ID;
SET GENERATOR GEN_TREPMT_ID TO 0;

CREATE GENERATOR GEN_TREPPVNZ1_AD;
SET GENERATOR GEN_TREPPVNZ1_AD TO 0;

CREATE GENERATOR GEN_TREPPVNZ1_ID;
SET GENERATOR GEN_TREPPVNZ1_ID TO 0;

CREATE GENERATOR GEN_TREPUDOCS_ID;
SET GENERATOR GEN_TREPUDOCS_ID TO 0;

CREATE GENERATOR GEN_TTEMP_BALA21_ID;
SET GENERATOR GEN_TTEMP_BALA21_ID TO 0;

CREATE GENERATOR GEN_TTEMP_BALAC_ID;
SET GENERATOR GEN_TTEMP_BALAC_ID TO 0;

CREATE GENERATOR GEN_TTEMP_BALMT1_ID;
SET GENERATOR GEN_TTEMP_BALMT1_ID TO 38;

CREATE GENERATOR GEN_TTEMP_CHANGES_ID;
SET GENERATOR GEN_TTEMP_CHANGES_ID TO 0;

CREATE GENERATOR GEN_TTEMP_PVN1_ID;
SET GENERATOR GEN_TTEMP_PVN1_ID TO 94;

CREATE GENERATOR GEN_TUDOCLISTS_ID;
SET GENERATOR GEN_TUDOCLISTS_ID TO 0;

CREATE GENERATOR GEN_TUDOCS_ID;
SET GENERATOR GEN_TUDOCS_ID TO 0;

CREATE GENERATOR GEN_TUPVN1_ID;
SET GENERATOR GEN_TUPVN1_ID TO 0;

CREATE GENERATOR YEAR00;
SET GENERATOR YEAR00 TO 0;

CREATE GENERATOR YEAR01;
SET GENERATOR YEAR01 TO 0;

CREATE GENERATOR YEAR02;
SET GENERATOR YEAR02 TO 0;

CREATE GENERATOR YEAR03;
SET GENERATOR YEAR03 TO 0;

CREATE GENERATOR YEAR04;
SET GENERATOR YEAR04 TO 32;

CREATE GENERATOR YEAR05;
SET GENERATOR YEAR05 TO 0;

CREATE GENERATOR YEAR06;
SET GENERATOR YEAR06 TO 2;

CREATE GENERATOR YEAR07;
SET GENERATOR YEAR07 TO 0;

CREATE GENERATOR YEAR08;
SET GENERATOR YEAR08 TO 0;

CREATE GENERATOR YEAR09;
SET GENERATOR YEAR09 TO 0;

CREATE GENERATOR YEAR10;
SET GENERATOR YEAR10 TO 0;

CREATE GENERATOR YEAR11;
SET GENERATOR YEAR11 TO 0;

CREATE GENERATOR YEAR12;
SET GENERATOR YEAR12 TO 7;

CREATE GENERATOR YEAR13;
SET GENERATOR YEAR13 TO 2;

CREATE GENERATOR YEAR14;
SET GENERATOR YEAR14 TO 0;

CREATE GENERATOR YEAR15;
SET GENERATOR YEAR15 TO 0;

CREATE GENERATOR YEAR16;
SET GENERATOR YEAR16 TO 0;

CREATE GENERATOR YEAR17;
SET GENERATOR YEAR17 TO 0;

CREATE GENERATOR YEAR18;
SET GENERATOR YEAR18 TO 0;

CREATE GENERATOR YEAR19;
SET GENERATOR YEAR19 TO 0;

CREATE GENERATOR YEAR20;
SET GENERATOR YEAR20 TO 0;

CREATE GENERATOR YEAR21;
SET GENERATOR YEAR21 TO 0;

CREATE GENERATOR YEAR22;
SET GENERATOR YEAR22 TO 0;

CREATE GENERATOR YEAR23;
SET GENERATOR YEAR23 TO 0;

CREATE GENERATOR YEAR24;
SET GENERATOR YEAR24 TO 0;

CREATE GENERATOR YEAR25;
SET GENERATOR YEAR25 TO 0;

CREATE GENERATOR YEAR26;
SET GENERATOR YEAR26 TO 0;

CREATE GENERATOR YEAR27;
SET GENERATOR YEAR27 TO 0;

CREATE GENERATOR YEAR28;
SET GENERATOR YEAR28 TO 0;

CREATE GENERATOR YEAR29;
SET GENERATOR YEAR29 TO 0;

CREATE GENERATOR YEAR30;
SET GENERATOR YEAR30 TO 0;

CREATE GENERATOR YEAR31;
SET GENERATOR YEAR31 TO 0;

CREATE GENERATOR YEAR32;
SET GENERATOR YEAR32 TO 0;



/******************************************************************************/
/***                               Exceptions                               ***/
/******************************************************************************/

CREATE EXCEPTION EX_FAILURE 'Procedura netika izpildita';

CREATE EXCEPTION MY_EXCEPTION_BADYEARVALUE 'Nekorekts gads datumƒÅ';



/******************************************************************************/
/***                           Stored procedures                            ***/
/******************************************************************************/



SET TERM ^ ;

CREATE PROCEDURE SP_BAL0_ID
RETURNS (
    NEXTID INTEGER)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_BAL0_IDA
RETURNS (
    NEXTID INTEGER)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_BALA2_ID
RETURNS (
    NEXTID INTEGER)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_BALA3_ID
RETURNS (
    NEXTID INTEGER)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_CURRCHECK_01 (
    SDT DATE,
    EDT DATE,
    PAC VARCHAR(8),
    PCLID VARCHAR(15),
    PCUR VARCHAR(3))
RETURNS (
    ID INTEGER /* TYPE OF COLUMN ROPS1A.ID */,
    SPID INTEGER /* TYPE OF COLUMN ROPS1A.SPID */,
    DID INTEGER /* TYPE OF COLUMN ROPS1A.DID */,
    DETE DATE /* TYPE OF COLUMN ROPS1A.DETE */,
    NRX VARCHAR(5) /* TYPE OF COLUMN ROPS1A.NRX */,
    DOCTYP VARCHAR(10) /* TYPE OF COLUMN ROPS1A.DOCTYP */,
    DOCTYP1 VARCHAR(10) /* TYPE OF COLUMN ROPS1A.DOCTYP1 */,
    DOCTYP2 VARCHAR(10) /* TYPE OF COLUMN ROPS1A.DOCTYP2 */,
    DOCST VARCHAR(6) /* TYPE OF COLUMN ROPS1A.DOCST */,
    DOCNR VARCHAR(15) /* TYPE OF COLUMN ROPS1A.DOCNR */,
    CLID VARCHAR(15) /* TYPE OF COLUMN ROPS1A.CLID */,
    CLID2 VARCHAR(15) /* TYPE OF COLUMN ROPS1A.CLID2 */,
    NAME VARCHAR(50) /* TYPE OF COLUMN ROPS1A.NAME */,
    NAME2 VARCHAR(50) /* TYPE OF COLUMN ROPS1A.NAME2 */,
    REGNR VARCHAR(15) /* TYPE OF COLUMN ROPS1A.REGNR */,
    REGNR2 VARCHAR(15) /* TYPE OF COLUMN ROPS1A.REGNR2 */,
    B0 NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.B0 */,
    DESCR VARCHAR(80) /* TYPE OF COLUMN ROPS1A.DESCR */,
    DESCR2 VARCHAR(80) /* TYPE OF COLUMN ROPS1A.DESCR2 */,
    AC1 VARCHAR(8) /* TYPE OF COLUMN ROPS1A.AC1 */,
    AC2 VARCHAR(8) /* TYPE OF COLUMN ROPS1A.AC2 */,
    SAC1 VARCHAR(50) /* TYPE OF COLUMN ROPS1A.SAC1 */,
    SAC2 VARCHAR(50) /* TYPE OF COLUMN ROPS1A.SAC2 */,
    SUMMC NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.SUMMC */,
    CUR VARCHAR(3) /* TYPE OF COLUMN ROPS1A.CUR */,
    SUMM NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.SUMM */,
    PVN NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.PVN */,
    RAC VARCHAR(8) /* TYPE OF COLUMN ROPS1A.RAC */,
    SDB NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.SDB */,
    SCR NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.SCR */,
    RAC2 VARCHAR(8) /* TYPE OF COLUMN ROPS1A.RAC2 */,
    RAC3 VARCHAR(5) /* TYPE OF COLUMN ROPS1A.RAC3 */,
    RAC4 VARCHAR(8) /* TYPE OF COLUMN ROPS1A.RAC4 */,
    RAC5 VARCHAR(5) /* TYPE OF COLUMN ROPS1A.RAC5 */,
    QV FLOAT /* TYPE OF COLUMN ROPS1A.QV */,
    ZNR INTEGER /* TYPE OF COLUMN ROPS1A.ZNR */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_DIFF_01 (
    PDOCID INTEGER)
RETURNS (
    IDL INTEGER /* TYPE OF COLUMN LOPSD.IDL */,
    ID INTEGER /* TYPE OF COLUMN LOPSD.ID */,
    ZDT TIMESTAMP /* TYPE OF COLUMN LOPSD.ZDT */,
    DTLD TIMESTAMP /* TYPE OF COLUMN LOPSD.DTLD */,
    ODT TIMESTAMP /* TYPE OF COLUMN LOPSD.ODT */,
    USL VARCHAR(15) /* TYPE OF COLUMN LOPSD.USL */,
    DETE DATE /* TYPE OF COLUMN LOPSD.DETE */,
    NRX VARCHAR(5) /* TYPE OF COLUMN LOPSD.NRX */,
    ZNR INTEGER /* TYPE OF COLUMN LOPSD.ZNR */,
    DOCTYP VARCHAR(10) /* TYPE OF COLUMN LOPSD.DOCTYP */,
    DOCST VARCHAR(6) /* TYPE OF COLUMN LOPSD.DOCST */,
    DOCNR VARCHAR(15) /* TYPE OF COLUMN LOPSD.DOCNR */,
    CLID VARCHAR(15) /* TYPE OF COLUMN LOPSD.CLID */,
    CLID2 VARCHAR(15) /* TYPE OF COLUMN LOPSD.CLID2 */,
    DESCR VARCHAR(80) /* TYPE OF COLUMN LOPSD.DESCR */,
    SUMM NUMERIC(15,2) /* TYPE OF COLUMN LOPSD.SUMM */,
    PVN NUMERIC(15,2) /* TYPE OF COLUMN LOPSD.PVN */,
    ZU VARCHAR(20) /* TYPE OF COLUMN LOPSD.ZU */,
    TPL INTEGER)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_DIFF_02 (
    PDOCID INTEGER)
RETURNS (
    IDL INTEGER /* TYPE OF COLUMN LOPS.IDL */,
    DOCID INTEGER /* TYPE OF COLUMN LOPS.DOCID */,
    ID INTEGER /* TYPE OF COLUMN LOPS.ID */,
    DTL TIMESTAMP /* TYPE OF COLUMN LOPS.DTL */,
    DTLD TIMESTAMP /* TYPE OF COLUMN LOPS.DTLD */,
    ODT TIMESTAMP /* TYPE OF COLUMN LOPS.ODT */,
    USL VARCHAR(15) /* TYPE OF COLUMN LOPS.USL */,
    AC11 VARCHAR(8) /* TYPE OF COLUMN LOPS.AC11 */,
    AC12 VARCHAR(8) /* TYPE OF COLUMN LOPS.AC12 */,
    AC13 VARCHAR(5) /* TYPE OF COLUMN LOPS.AC13 */,
    AC14 VARCHAR(8) /* TYPE OF COLUMN LOPS.AC14 */,
    AC15 VARCHAR(5) /* TYPE OF COLUMN LOPS.AC15 */,
    AC21 VARCHAR(8) /* TYPE OF COLUMN LOPS.AC21 */,
    AC22 VARCHAR(8) /* TYPE OF COLUMN LOPS.AC22 */,
    AC23 VARCHAR(5) /* TYPE OF COLUMN LOPS.AC23 */,
    AC24 VARCHAR(8) /* TYPE OF COLUMN LOPS.AC24 */,
    AC25 VARCHAR(5) /* TYPE OF COLUMN LOPS.AC25 */,
    SUMMC NUMERIC(15,2) /* TYPE OF COLUMN LOPS.SUMMC */,
    CUR VARCHAR(3) /* TYPE OF COLUMN LOPS.CUR */,
    SUMM NUMERIC(15,2) /* TYPE OF COLUMN LOPS.SUMM */,
    QV FLOAT /* TYPE OF COLUMN LOPS.QV */,
    TPL INTEGER)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_DIFF_11 (
    PDATE1 DATE,
    PDATE2 DATE,
    PDATE3 DATE)
RETURNS (
    IDL1 INTEGER /* TYPE OF COLUMN LOPSD.IDL */,
    IDL2 INTEGER /* TYPE OF COLUMN LOPS.IDL */,
    DOCID INTEGER /* TYPE OF COLUMN LOPSD.ID */,
    ROWID INTEGER /* TYPE OF COLUMN LOPS.ID */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_DIFF_12 (
    PDATE1 DATE,
    PDATE2 DATE,
    PDATE3 DATE,
    PCLID VARCHAR(15),
    PAC1 VARCHAR(8),
    PAC2 VARCHAR(8),
    PAC3 VARCHAR(5),
    PAC4 VARCHAR(8),
    PAC5 VARCHAR(5))
RETURNS (
    TP INTEGER,
    DOCID INTEGER /* TYPE OF COLUMN OPS.DOCID */,
    ROWID INTEGER /* TYPE OF COLUMN OPS.ID */,
    DOCDTL TIMESTAMP,
    DOCDTLD TIMESTAMP,
    DOCODT TIMESTAMP,
    ROWDTL TIMESTAMP,
    ROWDTLD TIMESTAMP,
    ROWODT TIMESTAMP,
    DETE DATE /* TYPE OF COLUMN OPSD.DETE */,
    ZNR INTEGER /* TYPE OF COLUMN OPSD.ZNR */,
    NRX VARCHAR(5) /* TYPE OF COLUMN OPSD.NRX */,
    DOCTYP VARCHAR(10) /* TYPE OF COLUMN OPSD.DOCTYP */,
    DOCST VARCHAR(6) /* TYPE OF COLUMN OPSD.DOCST */,
    DOCNR VARCHAR(15) /* TYPE OF COLUMN OPSD.DOCNR */,
    DOCTYP2 VARCHAR(10) /* TYPE OF COLUMN DOCTYP.ID1 */,
    CLID VARCHAR(15) /* TYPE OF COLUMN OPSD.CLID */,
    CLID2 VARCHAR(15) /* TYPE OF COLUMN OPSD.CLID2 */,
    DESCR VARCHAR(80) /* TYPE OF COLUMN OPSD.DESCR */,
    DOCSUMM NUMERIC(15,2) /* TYPE OF COLUMN OPSD.SUMM */,
    DOCPVN NUMERIC(15,2) /* TYPE OF COLUMN OPSD.PVN */,
    AC11 VARCHAR(8) /* TYPE OF COLUMN OPS.AC11 */,
    AC12 VARCHAR(8) /* TYPE OF COLUMN OPS.AC12 */,
    AC13 VARCHAR(5) /* TYPE OF COLUMN OPS.AC13 */,
    AC14 VARCHAR(8) /* TYPE OF COLUMN OPS.AC14 */,
    AC15 VARCHAR(5) /* TYPE OF COLUMN OPS.AC15 */,
    AC21 VARCHAR(8) /* TYPE OF COLUMN OPS.AC21 */,
    AC22 VARCHAR(8) /* TYPE OF COLUMN OPS.AC22 */,
    AC23 VARCHAR(5) /* TYPE OF COLUMN OPS.AC23 */,
    AC24 VARCHAR(8) /* TYPE OF COLUMN OPS.AC24 */,
    AC25 VARCHAR(5) /* TYPE OF COLUMN OPS.AC25 */,
    SUMMC NUMERIC(15,2) /* TYPE OF COLUMN OPS.SUMMC */,
    CUR VARCHAR(3) /* TYPE OF COLUMN OPS.CUR */,
    SUMM NUMERIC(15,2) /* TYPE OF COLUMN OPS.SUMM */,
    QV FLOAT /* TYPE OF COLUMN OPS.QV */,
    DESCR2 VARCHAR(50) /* TYPE OF COLUMN OPS.DESCR */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_DOCS0_ID
RETURNS (
    NEXTID INTEGER)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_FIXLOPSODT
AS
BEGIN
  EXIT;
END^





CREATE PROCEDURE SP_FIXOPSDATES
AS
BEGIN
  EXIT;
END^





CREATE PROCEDURE SP_GEN_M_ADDRESSSES_ID
RETURNS (
    ID INTEGER)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_GEN_M_AUX_ID
RETURNS (
    ID INTEGER)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_GEN_M_BANKACCOUNTS_ID
RETURNS (
    ID INTEGER)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_GEN_M_BANKS_ID
RETURNS (
    ID INTEGER)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_GEN_M_CONTACTS_ID
RETURNS (
    ID INTEGER)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_GEN_M_COUNTRIES_ID
RETURNS (
    ID INTEGER)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_GEN_M_DOCS_ID
RETURNS (
    ID INTEGER)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_GEN_M_DOCSEQ
RETURNS (
    ID INTEGER)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_GEN_M_DOCTYPES_ID
RETURNS (
    ID INTEGER)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_GEN_M_ITEMS_CAT_ID
RETURNS (
    ID INTEGER)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_GEN_M_ITEMS_ID
RETURNS (
    ID INTEGER)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_GEN_M_PAYMENTTYPE_ID
RETURNS (
    ID INTEGER)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_GEN_M_PVNRATES_ID
RETURNS (
    ID INTEGER)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_GEN_M_PVNRATES2_ID
RETURNS (
    ID INTEGER)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_GEN_M_PVNTEXTS_ID
RETURNS (
    ID INTEGER)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_GEN_M_ROWS_ID
RETURNS (
    ID INTEGER)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_GEN_M_STORES_ID
RETURNS (
    ID INTEGER)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_GEN_M_STORETYPE_ID
RETURNS (
    ID INTEGER)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_GEN_M_TRANSACTIONTYPE_ID
RETURNS (
    ID INTEGER)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_GEN_M_UNITS_ID
RETURNS (
    ID INTEGER)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_GEN_M_VEHICLES_ID
RETURNS (
    ID INTEGER)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_LINKEDDOCS_1 (
    PSD DATE,
    PED DATE,
    PCLID VARCHAR(15),
    PDOCNR VARCHAR(15))
RETURNS (
    ID INTEGER,
    DETE DATE,
    CLID VARCHAR(15),
    DOCTYP VARCHAR(10),
    DOCST VARCHAR(6),
    DOCNR VARCHAR(15),
    DESCR VARCHAR(80),
    SUMM NUMERIC(15,4),
    PVN NUMERIC(15,4))
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_LINKEDDOCS_2 (
    PSD DATE,
    PED DATE,
    PCLID VARCHAR(15),
    PDOCNR VARCHAR(15))
RETURNS (
    ID INTEGER /* TYPE OF COLUMN OPS.ID */,
    DOCID INTEGER /* TYPE OF COLUMN OPS.DOCID */,
    DESCR VARCHAR(50) /* TYPE OF COLUMN OPS.DESCR */,
    AC11 VARCHAR(8) /* TYPE OF COLUMN OPS.AC11 */,
    AC12 VARCHAR(8) /* TYPE OF COLUMN OPS.AC12 */,
    AC13 VARCHAR(5) /* TYPE OF COLUMN OPS.AC13 */,
    AC14 VARCHAR(8) /* TYPE OF COLUMN OPS.AC14 */,
    AC15 VARCHAR(5) /* TYPE OF COLUMN OPS.AC15 */,
    AC21 VARCHAR(8) /* TYPE OF COLUMN OPS.AC21 */,
    AC22 VARCHAR(8) /* TYPE OF COLUMN OPS.AC22 */,
    AC23 VARCHAR(5) /* TYPE OF COLUMN OPS.AC23 */,
    AC24 VARCHAR(8) /* TYPE OF COLUMN OPS.AC24 */,
    AC25 VARCHAR(5) /* TYPE OF COLUMN OPS.AC25 */,
    SUMMC NUMERIC(15,2) /* TYPE OF COLUMN OPS.SUMMC */,
    CUR VARCHAR(3) /* TYPE OF COLUMN OPS.CUR */,
    SUMM NUMERIC(15,2) /* TYPE OF COLUMN OPS.SUMM */,
    QV FLOAT /* TYPE OF COLUMN OPS.QV */,
    NL SMALLINT /* TYPE OF COLUMN OPS.NL */,
    ZDT TIMESTAMP /* TYPE OF COLUMN OPS.ZDT */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_M_CALC_DOC_AMOUNTS (
    PIDDOC INTEGER,
    PISREVERSED INTEGER)
AS
BEGIN
  EXIT;
END^





CREATE PROCEDURE SP_M_CLEARDATA
AS
BEGIN
  EXIT;
END^





CREATE PROCEDURE SP_M_CURRENTSTOCK_01 (
    PIDITEM INTEGER)
RETURNS (
    IDITEM INTEGER,
    IDSTORE INTEGER,
    AMOUNT DAMOUNT)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_M_CURRENTSTOCK_02 (
    PIDSTORE INTEGER)
RETURNS (
    IDITEM INTEGER,
    IDSTORE INTEGER,
    AMOUNT DAMOUNT)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_M_DEL_FINDOC (
    PIDDOCM INTEGER)
AS
BEGIN
  EXIT;
END^





CREATE PROCEDURE SP_M_FILTER_DOCS_01 (
    PDT1 DATE,
    PDT2 DATE,
    PTP INTEGER,
    PSTATE INTEGER,
    PIDSTOREOUT INTEGER,
    PIDSTOREIN INTEGER,
    PIDSTOREOUTORIN INTEGER)
RETURNS (
    ID INTEGER /* TYPE OF COLUMN M_DOCS.ID */,
    DT DATE /* TYPE OF COLUMN M_DOCS.DT */,
    SR VARCHAR(10) /* TYPE OF COLUMN M_DOCS.SR */,
    NR VARCHAR(20) /* TYPE OF COLUMN M_DOCS.NR */,
    TP INTEGER /* TYPE OF COLUMN M_DOCS.TP */,
    PVNTYPE INTEGER /* TYPE OF COLUMN M_DOCS.PVNTYPE */,
    STATE INTEGER /* TYPE OF COLUMN M_DOCS.STATE */,
    IDSTOREIN INTEGER /* TYPE OF COLUMN M_DOCS.IDSTOREIN */,
    IDSTOREOUT INTEGER /* TYPE OF COLUMN M_DOCS.IDSTOREOUT */,
    IDCREDDOC INTEGER /* TYPE OF COLUMN M_DOCS.IDCREDDOC */,
    CREDDOCDT DATE /* TYPE OF COLUMN M_DOCS.CREDDOCDT */,
    SUMM NUMERIC(15,2) /* TYPE OF COLUMN M_DOCS.SUMM */,
    IDSEQ BIGINT /* TYPE OF COLUMN M_DOCS.IDSEQ */,
    ACCIN VARCHAR(8) /* TYPE OF COLUMN M_DOCS.ACCIN */,
    ACCOUT VARCHAR(8) /* TYPE OF COLUMN M_DOCS.ACCOUT */,
    CREDDOCSR VARCHAR(10) /* TYPE OF COLUMN M_DOCS.CREDDOCSR */,
    CREDDOCNR VARCHAR(20) /* TYPE OF COLUMN M_DOCS.CREDDOCNR */,
    IDCARRIER INTEGER /* TYPE OF COLUMN M_DOCS.IDCARRIER */,
    IDADDRESSOUT INTEGER /* TYPE OF COLUMN M_DOCS.IDADDRESSOUT */,
    IDADDRESSIN INTEGER /* TYPE OF COLUMN M_DOCS.IDADDRESSIN */,
    IDVEHICLE INTEGER /* TYPE OF COLUMN M_DOCS.IDVEHICLE */,
    IDTRANSACTIONTYPE INTEGER /* TYPE OF COLUMN M_DOCS.IDTRANSACTIONTYPE */,
    IDPAYMENTTYPE INTEGER /* TYPE OF COLUMN M_DOCS.IDPAYMENTTYPE */,
    IDDRIVER INTEGER /* TYPE OF COLUMN M_DOCS.IDDRIVER */,
    ACCOUNTINGTP SMALLINT /* TYPE OF COLUMN M_DOCS.ACCOUNTINGTP */,
    ACCTP1 SMALLINT /* TYPE OF COLUMN M_DOCS.ACCTP1 */,
    ACCTP2 SMALLINT /* TYPE OF COLUMN M_DOCS.ACCTP2 */,
    DUEDATE DATE /* TYPE OF COLUMN M_DOCS.DUEDATE */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_M_FILTER_DOCS_02 (
    PIDDOC INTEGER)
RETURNS (
    ID INTEGER /* TYPE OF COLUMN M_DOCS.ID */,
    DT DATE /* TYPE OF COLUMN M_DOCS.DT */,
    SR VARCHAR(10) /* TYPE OF COLUMN M_DOCS.SR */,
    NR VARCHAR(20) /* TYPE OF COLUMN M_DOCS.NR */,
    TP INTEGER /* TYPE OF COLUMN M_DOCS.TP */,
    PVNTYPE INTEGER /* TYPE OF COLUMN M_DOCS.PVNTYPE */,
    STATE INTEGER /* TYPE OF COLUMN M_DOCS.STATE */,
    IDSTOREIN INTEGER /* TYPE OF COLUMN M_DOCS.IDSTOREIN */,
    IDSTOREOUT INTEGER /* TYPE OF COLUMN M_DOCS.IDSTOREOUT */,
    IDCREDDOC INTEGER /* TYPE OF COLUMN M_DOCS.IDCREDDOC */,
    CREDDOCDT DATE /* TYPE OF COLUMN M_DOCS.CREDDOCDT */,
    SUMM NUMERIC(15,2) /* TYPE OF COLUMN M_DOCS.SUMM */,
    IDSEQ BIGINT /* TYPE OF COLUMN M_DOCS.IDSEQ */,
    ACCIN VARCHAR(8) /* TYPE OF COLUMN M_DOCS.ACCIN */,
    ACCOUT VARCHAR(8) /* TYPE OF COLUMN M_DOCS.ACCOUT */,
    CREDDOCSR VARCHAR(10) /* TYPE OF COLUMN M_DOCS.CREDDOCSR */,
    CREDDOCNR VARCHAR(20) /* TYPE OF COLUMN M_DOCS.CREDDOCNR */,
    IDCARRIER INTEGER /* TYPE OF COLUMN M_DOCS.IDCARRIER */,
    IDADDRESSOUT INTEGER /* TYPE OF COLUMN M_DOCS.IDADDRESSOUT */,
    IDADDRESSIN INTEGER /* TYPE OF COLUMN M_DOCS.IDADDRESSIN */,
    IDVEHICLE INTEGER /* TYPE OF COLUMN M_DOCS.IDVEHICLE */,
    IDTRANSACTIONTYPE INTEGER /* TYPE OF COLUMN M_DOCS.IDTRANSACTIONTYPE */,
    IDPAYMENTTYPE INTEGER /* TYPE OF COLUMN M_DOCS.IDPAYMENTTYPE */,
    IDDRIVER INTEGER /* TYPE OF COLUMN M_DOCS.IDDRIVER */,
    ACCOUNTINGTP SMALLINT /* TYPE OF COLUMN M_DOCS.ACCOUNTINGTP */,
    ACCTP1 SMALLINT /* TYPE OF COLUMN M_DOCS.ACCTP1 */,
    ACCTP2 SMALLINT /* TYPE OF COLUMN M_DOCS.ACCTP2 */,
    DUEDATE DATE /* TYPE OF COLUMN M_DOCS.DUEDATE */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_M_FILTER_ITEMS_01 (
    PIDDOC INTEGER)
RETURNS (
    ID INTEGER /* TYPE OF COLUMN M_ITEMS.ID */,
    BARCODE VARCHAR(30) /* TYPE OF COLUMN M_ITEMS.BARCODE */,
    NAME VARCHAR(300) /* TYPE OF COLUMN M_ITEMS.NAME */,
    CAT INTEGER /* TYPE OF COLUMN M_ITEMS.CAT */,
    UNITS INTEGER /* TYPE OF COLUMN M_ITEMS.UNITS */,
    STORE1 INTEGER /* TYPE OF COLUMN M_ITEMS.STORE1 */,
    PVNRATE INTEGER /* TYPE OF COLUMN M_ITEMS.PVNRATE */,
    ISSERVICE INTEGER /* TYPE OF COLUMN M_ITEMS.ISSERVICE */,
    SELLPRICE NUMERIC(15,4) /* TYPE OF COLUMN M_ITEMS.SELLPRICE */,
    BUYPRICE NUMERIC(15,4) /* TYPE OF COLUMN M_ITEMS.BUYPRICE */,
    LASTBUYPRICE NUMERIC(15,4) /* TYPE OF COLUMN M_ITEMS.LASTBUYPRICE */,
    AMOUNTINSTORE NUMERIC(12,4) /* TYPE OF COLUMN M_ITEMS.AMOUNTINSTORE */,
    LASTSALEDATE DATE /* TYPE OF COLUMN M_ITEMS.LASTSALEDATE */,
    LASTBUYDATE DATE /* TYPE OF COLUMN M_ITEMS.LASTBUYDATE */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_M_FILTER_ITEMS_PER_STORE_01 (
    PIDDOC INTEGER)
RETURNS (
    IDITEM INTEGER /* TYPE OF COLUMN M_ITEMS_PER_STORE.IDITEM */,
    IDSTORE INTEGER /* TYPE OF COLUMN M_ITEMS_PER_STORE.IDSTORE */,
    AMOUNT NUMERIC(12,4) /* TYPE OF COLUMN M_ITEMS_PER_STORE.AMOUNT */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_M_FILTER_ROWS_01 (
    PIDDOC INTEGER)
RETURNS (
    ID INTEGER /* TYPE OF COLUMN M_ROWS.ID */,
    IDDOC INTEGER /* TYPE OF COLUMN M_ROWS.IDDOC */,
    IDITEM INTEGER /* TYPE OF COLUMN M_ROWS.IDITEM */,
    IDPVNRATE INTEGER /* TYPE OF COLUMN M_ROWS.IDPVNRATE */,
    UNITS INTEGER /* TYPE OF COLUMN M_ROWS.UNITS */,
    IDCREDROW INTEGER /* TYPE OF COLUMN M_ROWS.IDCREDROW */,
    AMOUNT NUMERIC(12,4) /* TYPE OF COLUMN M_ROWS.AMOUNT */,
    DISCOUNT FLOAT /* TYPE OF COLUMN M_ROWS.DISCOUNT */,
    PRICE0 NUMERIC(15,4) /* TYPE OF COLUMN M_ROWS.PRICE0 */,
    PRICE NUMERIC(15,4) /* TYPE OF COLUMN M_ROWS.PRICE */,
    BUYPRICE NUMERIC(15,4) /* TYPE OF COLUMN M_ROWS.BUYPRICE */,
    OLDPRICE NUMERIC(15,4) /* TYPE OF COLUMN M_ROWS.OLDPRICE */,
    TOLDPRICE NUMERIC(15,2) /* TYPE OF COLUMN M_ROWS.TOLDPRICE */,
    TPRICE NUMERIC(15,2) /* TYPE OF COLUMN M_ROWS.TPRICE */,
    TBUYPRICE NUMERIC(15,2) /* TYPE OF COLUMN M_ROWS.TBUYPRICE */,
    IDSEQ BIGINT /* TYPE OF COLUMN M_ROWS.IDSEQ */,
    ACC6 VARCHAR(8) /* TYPE OF COLUMN M_ROWS.ACC6 */,
    ACC7 VARCHAR(8) /* TYPE OF COLUMN M_ROWS.ACC7 */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_M_GETCOUNTSFOREVENTS (
    PTP INTEGER,
    PID INTEGER)
RETURNS (
    RCOUNT INTEGER)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_M_ITEMMOVEMENT_01 (
    PIDITEM INTEGER,
    PDATE1 DATE,
    PDATE2 DATE)
RETURNS (
    GTP INTEGER,
    DT DATE,
    SR VARCHAR(10) /* TYPE OF COLUMN M_DOCS.SR */,
    NR VARCHAR(20) /* TYPE OF COLUMN M_DOCS.NR */,
    TP INTEGER /* TYPE OF COLUMN M_DOCS.TP */,
    IDSTOREOUT INTEGER,
    IDSTOREIN INTEGER,
    AMOUNT DAMOUNT)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_M_MAKELINKS_01A (
    PIDROW INTEGER,
    PSTARTDATE DATE)
RETURNS (
    RESULT VARCHAR(300))
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_M_MAKELINKS_01B (
    PIDDOC INTEGER,
    PNEWDOCSTATE INTEGER)
RETURNS (
    RESULT VARCHAR(300))
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_M_MAKELINKS_02A (
    PIDROW INTEGER)
RETURNS (
    BUYPRICE DPRICEX,
    TBUYPRICE DPRICEX,
    RESULT VARCHAR(300))
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_M_MAKELINKS_02B (
    PIDDOC INTEGER)
RETURNS (
    IDROW INTEGER,
    BUYPRICE DPRICEX,
    TBUYPRICE DPRICEX,
    RESULT VARCHAR(300))
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_M_MAKELINKS_11 (
    PIDDOC INTEGER,
    PNEWDOCSTATE INTEGER)
RETURNS (
    RESULT VARCHAR(300))
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_M_MAKELINKS_21A (
    PIDROW INTEGER)
RETURNS (
    RESULT VARCHAR(300))
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_M_MAKELINKS_21B (
    PIDDOC INTEGER,
    PNEWDOCSTATE INTEGER)
RETURNS (
    RESULT VARCHAR(300))
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_M_MAKELINKS_22A (
    PIDROW INTEGER)
RETURNS (
    BUYPRICE DPRICEX,
    TBUYPRICE MONEY,
    RESULT VARCHAR(300))
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_M_MAKELINKS_22B (
    PIDDOC INTEGER)
RETURNS (
    IDROW INTEGER,
    BUYPRICE DPRICEX,
    TBUYPRICE MONEY,
    RESULT VARCHAR(300))
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_M_MAKELINKS_23A (
    PIDROW INTEGER)
RETURNS (
    CREDDOCID INTEGER,
    CREDROWID INTEGER,
    IDITEM INTEGER,
    AMOUNT DAMOUNT,
    BUYPRICE DPRICEX,
    TBUYPRICE MONEY)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_M_MAKELINKS_23B (
    PIDDOC INTEGER)
RETURNS (
    IDROW INTEGER,
    CREDDOCID INTEGER,
    CREDROWID INTEGER,
    IDITEM INTEGER,
    AMOUNT DAMOUNT,
    BUYPRICE DPRICEX,
    TBUYPRICE MONEY,
    CREDDOCDT DATE,
    CREDDOCSR VARCHAR(10) /* TYPE OF COLUMN M_DOCS.SR */,
    CREDDOCNR VARCHAR(20) /* TYPE OF COLUMN M_DOCS.NR */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_M_MAKELINKS_31A (
    PIDROW INTEGER)
RETURNS (
    RESULT VARCHAR(300))
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_M_MAKELINKS_31B (
    PIDDOC INTEGER,
    PNEWDOCSTATE INTEGER)
RETURNS (
    RESULT VARCHAR(300))
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_M_MAKELINKS_32A (
    PIDROW INTEGER)
RETURNS (
    CREDDOCID INTEGER,
    CREDROWID INTEGER,
    IDITEM INTEGER,
    AMOUNT DAMOUNT,
    PRICE DPRICEX,
    TPRICE MONEY)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_M_MAKELINKS_32B (
    PIDDOC INTEGER)
RETURNS (
    IDROW INTEGER,
    CREDDOCID INTEGER,
    CREDROWID INTEGER,
    IDITEM INTEGER,
    AMOUNT DAMOUNT,
    PRICE DPRICEX,
    TPRICE MONEY,
    CREDDOCDT DATE,
    CREDDOCSR VARCHAR(10) /* TYPE OF COLUMN M_DOCS.SR */,
    CREDDOCNR VARCHAR(20) /* TYPE OF COLUMN M_DOCS.NR */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_M_MAKELINKS_33A (
    PIDROW INTEGER)
RETURNS (
    SELLPRICE DPRICEX,
    SELLTOTALPRICE DPRICEX,
    BUYPRICE DPRICEX,
    BUYTOTALPRICE DPRICEX,
    RESULT VARCHAR(300))
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_M_MAKELINKS_33B (
    PIDDOC INTEGER)
RETURNS (
    IDROW INTEGER,
    SELLPRICE DPRICEX,
    SELLTOTALPRICE DPRICEX,
    BUYPRICE DPRICEX,
    BUYTOTALPRICE DPRICEX,
    RESULT VARCHAR(300))
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_M_MAKELINKS_41 (
    PIDDOC INTEGER,
    PNEWDOCSTATE INTEGER)
RETURNS (
    RESULT VARCHAR(300))
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_M_MAKELINKS_51A (
    PIDROW INTEGER)
RETURNS (
    RESULT VARCHAR(300))
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_M_MAKELINKS_51B (
    PIDDOC INTEGER,
    PNEWDOCSTATE INTEGER)
RETURNS (
    RESULT VARCHAR(300))
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_M_MAKELINKS_52 (
    PIDDOC INTEGER)
RETURNS (
    RIDROW INTEGER,
    RESULT VARCHAR(300))
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_M_MAKELINKS_61A (
    PIDROW INTEGER)
RETURNS (
    RESULT VARCHAR(300))
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_M_MAKELINKS_61B (
    PIDDOC INTEGER,
    PNEWDOCSTATE INTEGER)
RETURNS (
    RESULT VARCHAR(300))
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_M_MAKELINKS_62 (
    PIDDOC INTEGER)
RETURNS (
    RIDROW INTEGER,
    RESULT VARCHAR(300))
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_M_RECALC_ROWSISGONE_1
RETURNS (
    RET INTEGER)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_M_RECALC_ROWSISGONE_2 (
    PIDDOC INTEGER)
AS
BEGIN
  EXIT;
END^





CREATE PROCEDURE SP_M_RECALCAMOUNTS_1
RETURNS (
    RET INTEGER)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_M_RECALCAMOUNTS_2 (
    PIDDOC INTEGER)
RETURNS (
    RET INTEGER)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_M_RECALCITEM_01A (
    PSTARTDATE DATE,
    PPROGRESSTEP INTEGER)
RETURNS (
    RET INTEGER)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_M_RECALCITEM_01A_1 (
    PSTARTDATE DATE,
    PPROGRESSTEP INTEGER)
RETURNS (
    RET INTEGER)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_M_RECALCITEM_01B (
    PSTARTDATE DATE,
    PPROGRESSTEP INTEGER)
RETURNS (
    RET INTEGER)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_M_RECALCITEM_01C (
    PIDDOC INTEGER,
    PNEWDOCSTATE INTEGER,
    PPROGRESSTEP INTEGER)
RETURNS (
    RET INTEGER)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_M_RECALCITEM_01C_1 (
    PIDDOC INTEGER,
    PNEWDOCSTATE INTEGER,
    PPROGRESSTEP INTEGER)
RETURNS (
    RET INTEGER)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_M_RECALCITEM_04 (
    PIDROW INTEGER,
    PCURIDROW1 INTEGER)
RETURNS (
    RCURAMOUNTUSED DAMOUNT)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_M_RECALCITEM_05 (
    PIDROW INTEGER,
    PCURIDROW1 INTEGER)
RETURNS (
    RCURAMOUNTUSED INTEGER)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_M_RECALCITEM_06 (
    PIDROW INTEGER,
    PCURIDROW1 INTEGER)
RETURNS (
    RCURAMOUNTUSED INTEGER)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_M_RECALCITEM_07 (
    PIDROW INTEGER,
    PCURIDROW1 INTEGER)
RETURNS (
    RCURAMOUNTUSED INTEGER)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_M_RECALCLASTDATES_1
AS
BEGIN
  EXIT;
END^





CREATE PROCEDURE SP_M_REMOVELINKS_01 (
    PIDDOC INTEGER,
    PNEWDOCSTATE INTEGER)
RETURNS (
    RESULT VARCHAR(300))
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_M_REP_COSTACC_1 (
    PDT1 DATE,
    PDT2 DATE)
RETURNS (
    TP INTEGER,
    ACC1 VARCHAR(8) /* TYPE OF COLUMN M_DOCS.ACCIN */,
    ACC2 VARCHAR(8) /* TYPE OF COLUMN M_DOCS.ACCIN */,
    COST MONEY)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_M_REP_COSTACC_2 (
    PDT1 DATE,
    PDT2 DATE)
RETURNS (
    ID INTEGER /* TYPE OF COLUMN M_DOCS.ID */,
    DT DATE /* TYPE OF COLUMN M_DOCS.DT */,
    SR VARCHAR(10) /* TYPE OF COLUMN M_DOCS.SR */,
    NR VARCHAR(20) /* TYPE OF COLUMN M_DOCS.NR */,
    TP INTEGER /* TYPE OF COLUMN M_DOCS.TP */,
    IDSTOREOUT INTEGER /* TYPE OF COLUMN M_DOCS.IDSTOREOUT */,
    IDSTOREIN INTEGER /* TYPE OF COLUMN M_DOCS.IDSTOREIN */,
    ACC1 VARCHAR(8) /* TYPE OF COLUMN M_DOCS.ACCIN */,
    ACC2 VARCHAR(8) /* TYPE OF COLUMN M_DOCS.ACCIN */,
    COST MONEY)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_M_REP_ITEMLINKS_1 (
    PIDITEM INTEGER,
    PDT1 DATE,
    PDT2 DATE)
RETURNS (
    AIDD INTEGER /* TYPE OF COLUMN M_ROWS.ID */,
    AIDR INTEGER /* TYPE OF COLUMN M_DOCS.ID */,
    ADT DATE /* TYPE OF COLUMN M_DOCS.DT */,
    ASR VARCHAR(10) /* TYPE OF COLUMN M_DOCS.SR */,
    ANR VARCHAR(20) /* TYPE OF COLUMN M_DOCS.NR */,
    ATP INTEGER /* TYPE OF COLUMN M_DOCS.TP */,
    AIDSTOREIN INTEGER /* TYPE OF COLUMN M_DOCS.IDSTOREIN */,
    AIDSTOREOUT INTEGER /* TYPE OF COLUMN M_DOCS.IDSTOREOUT */,
    AAMOUNT NUMERIC(12,4) /* TYPE OF COLUMN M_ROWS.AMOUNT */,
    ABUYPRICE NUMERIC(15,4) /* TYPE OF COLUMN M_ROWS.BUYPRICE */,
    BIDD INTEGER /* TYPE OF COLUMN M_ROWS.ID */,
    BIDR INTEGER /* TYPE OF COLUMN M_DOCS.ID */,
    BDT DATE /* TYPE OF COLUMN M_DOCS.DT */,
    BSR VARCHAR(10) /* TYPE OF COLUMN M_DOCS.SR */,
    BNR VARCHAR(20) /* TYPE OF COLUMN M_DOCS.NR */,
    BTP INTEGER /* TYPE OF COLUMN M_DOCS.TP */,
    BIDSTOREIN INTEGER /* TYPE OF COLUMN M_DOCS.IDSTOREIN */,
    BIDSTOREOUT INTEGER /* TYPE OF COLUMN M_DOCS.IDSTOREOUT */,
    BAMOUNT NUMERIC(12,4) /* TYPE OF COLUMN M_ROWS.AMOUNT */,
    BBUYPRICE NUMERIC(15,4) /* TYPE OF COLUMN M_ROWS.BUYPRICE */,
    AMOUNTLINKED NUMERIC(12,4) /* TYPE OF COLUMN M_ROWS.AMOUNT */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_M_REP_ITEMSAMOUNTS_1 (
    PDT1 DATE,
    PDT2 DATE,
    PCAT INTEGER)
RETURNS (
    IDITEM INTEGER,
    TP INTEGER,
    AMOUNT DAMOUNT)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_M_REP_ITEMSAMOUNTS_2 (
    PDT1 DATE,
    PDT2 DATE,
    PCAT INTEGER)
RETURNS (
    IDITEM INTEGER,
    TP INTEGER,
    AMOUNT DAMOUNT,
    TBUYPRICE MONEY)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_M_REP_ITEMSAMOUNTS_3 (
    PDT1 DATE,
    PDT2 DATE,
    PCAT INTEGER)
RETURNS (
    IDITEM INTEGER,
    TP INTEGER,
    AMOUNT DAMOUNT,
    TSELLPRICE MONEY,
    TBUYPRICE MONEY,
    ITEMPRICE DPRICEX)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_M_REP_ITEMSAMOUNTS_4 (
    PDT1 DATE,
    PDT2 DATE,
    PCAT INTEGER)
RETURNS (
    IDSTORE INTEGER,
    TP INTEGER,
    AMOUNT DAMOUNT,
    TSELLPRICE MONEY,
    TBUYPRICE MONEY)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_M_REP_ITEMSAMOUNTS_5 (
    PDT1 DATE,
    PDT2 DATE,
    PCAT INTEGER)
RETURNS (
    IDCAT INTEGER,
    TP INTEGER,
    AMOUNT DAMOUNT,
    TSELLPRICE MONEY,
    TBUYPRICE MONEY)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_OPS_DELETE (
    ORIGINAL_ID INTEGER,
    ORIGINAL_DOCID INTEGER,
    ISNULL_DESCR INTEGER,
    ORIGINAL_DESCR VARCHAR(50),
    ORIGINAL_AC11 VARCHAR(8),
    ISNULL_AC12 INTEGER,
    ORIGINAL_AC12 VARCHAR(8),
    ISNULL_AC13 INTEGER,
    ORIGINAL_AC13 VARCHAR(5),
    ISNULL_AC14 INTEGER,
    ORIGINAL_AC14 VARCHAR(8),
    ISNULL_AC15 INTEGER,
    ORIGINAL_AC15 VARCHAR(5),
    ORIGINAL_AC21 VARCHAR(8),
    ISNULL_AC22 INTEGER,
    ORIGINAL_AC22 VARCHAR(8),
    ISNULL_AC23 INTEGER,
    ORIGINAL_AC23 VARCHAR(5),
    ISNULL_AC24 INTEGER,
    ORIGINAL_AC24 VARCHAR(8),
    ISNULL_AC25 INTEGER,
    ORIGINAL_AC25 VARCHAR(5),
    ORIGINAL_SUMMC NUMERIC(15,4),
    ORIGINAL_CUR VARCHAR(3),
    ORIGINAL_SUMM NUMERIC(15,4),
    ISNULL_QV INTEGER,
    ORIGINAL_QV FLOAT,
    ISNULL_ZDT INTEGER,
    ORIGINAL_ZDT TIMESTAMP)
AS
BEGIN
  EXIT;
END^





CREATE PROCEDURE SP_OPS_DELETE_LOG (
    ID INTEGER,
    USR VARCHAR(15),
    ORIGINAL_DOCID INTEGER,
    ORIGINAL_AC11 VARCHAR(8),
    ORIGINAL_AC12 VARCHAR(8),
    ORIGINAL_AC13 VARCHAR(5),
    ORIGINAL_AC14 VARCHAR(8),
    ORIGINAL_AC15 VARCHAR(5),
    ORIGINAL_AC21 VARCHAR(8),
    ORIGINAL_AC22 VARCHAR(8),
    ORIGINAL_AC23 VARCHAR(5),
    ORIGINAL_AC24 VARCHAR(8),
    ORIGINAL_AC25 VARCHAR(5),
    ORIGINAL_SUMMC NUMERIC(15,4),
    ORIGINAL_CUR VARCHAR(3),
    ORIGINAL_SUMM NUMERIC(15,4),
    ORIGINAL_QV FLOAT,
    ORIGINAL_ZDT TIMESTAMP)
AS
BEGIN
  EXIT;
END^





CREATE PROCEDURE SP_OPS_FILTER_AND (
    PDATE1 DATE,
    PDATE2 DATE,
    PTEXT VARCHAR(50),
    PCLID VARCHAR(15),
    PAC11 VARCHAR(8),
    PAC12 VARCHAR(8),
    PAC13 VARCHAR(5),
    PAC14 VARCHAR(8),
    PAC15 VARCHAR(5),
    PAC21 VARCHAR(8),
    PAC22 VARCHAR(8),
    PAC23 VARCHAR(5),
    PAC24 VARCHAR(8),
    PAC25 VARCHAR(5),
    PDOCGR VARCHAR(10))
RETURNS (
    ID INTEGER /* TYPE OF COLUMN OPS.ID */,
    DOCID INTEGER /* TYPE OF COLUMN OPS.DOCID */,
    DESCR VARCHAR(50) /* TYPE OF COLUMN OPS.DESCR */,
    AC11 VARCHAR(8) /* TYPE OF COLUMN OPS.AC11 */,
    AC12 VARCHAR(8) /* TYPE OF COLUMN OPS.AC12 */,
    AC13 VARCHAR(5) /* TYPE OF COLUMN OPS.AC13 */,
    AC14 VARCHAR(8) /* TYPE OF COLUMN OPS.AC14 */,
    AC15 VARCHAR(5) /* TYPE OF COLUMN OPS.AC15 */,
    AC21 VARCHAR(8) /* TYPE OF COLUMN OPS.AC21 */,
    AC22 VARCHAR(8) /* TYPE OF COLUMN OPS.AC22 */,
    AC23 VARCHAR(5) /* TYPE OF COLUMN OPS.AC23 */,
    AC24 VARCHAR(8) /* TYPE OF COLUMN OPS.AC24 */,
    AC25 VARCHAR(5) /* TYPE OF COLUMN OPS.AC25 */,
    SUMMC NUMERIC(15,2) /* TYPE OF COLUMN OPS.SUMMC */,
    CUR VARCHAR(3) /* TYPE OF COLUMN OPS.CUR */,
    SUMM NUMERIC(15,2) /* TYPE OF COLUMN OPS.SUMM */,
    QV FLOAT /* TYPE OF COLUMN OPS.QV */,
    NL SMALLINT /* TYPE OF COLUMN OPS.NL */,
    ZDT TIMESTAMP /* TYPE OF COLUMN OPS.ZDT */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_OPS_FILTER_OR (
    PDATE1 DATE,
    PDATE2 DATE,
    PTEXT VARCHAR(50),
    PCLID VARCHAR(15),
    PAC11 VARCHAR(8),
    PAC12 VARCHAR(8),
    PAC13 VARCHAR(5),
    PAC14 VARCHAR(8),
    PAC15 VARCHAR(5),
    PAC21 VARCHAR(8),
    PAC22 VARCHAR(8),
    PAC23 VARCHAR(5),
    PAC24 VARCHAR(8),
    PAC25 VARCHAR(5),
    PDOCGR VARCHAR(10))
RETURNS (
    ID INTEGER /* TYPE OF COLUMN OPS.ID */,
    DOCID INTEGER /* TYPE OF COLUMN OPS.DOCID */,
    DESCR VARCHAR(50) /* TYPE OF COLUMN OPS.DESCR */,
    AC11 VARCHAR(8) /* TYPE OF COLUMN OPS.AC11 */,
    AC12 VARCHAR(8) /* TYPE OF COLUMN OPS.AC12 */,
    AC13 VARCHAR(5) /* TYPE OF COLUMN OPS.AC13 */,
    AC14 VARCHAR(8) /* TYPE OF COLUMN OPS.AC14 */,
    AC15 VARCHAR(5) /* TYPE OF COLUMN OPS.AC15 */,
    AC21 VARCHAR(8) /* TYPE OF COLUMN OPS.AC21 */,
    AC22 VARCHAR(8) /* TYPE OF COLUMN OPS.AC22 */,
    AC23 VARCHAR(5) /* TYPE OF COLUMN OPS.AC23 */,
    AC24 VARCHAR(8) /* TYPE OF COLUMN OPS.AC24 */,
    AC25 VARCHAR(5) /* TYPE OF COLUMN OPS.AC25 */,
    SUMMC NUMERIC(15,2) /* TYPE OF COLUMN OPS.SUMMC */,
    CUR VARCHAR(3) /* TYPE OF COLUMN OPS.CUR */,
    SUMM NUMERIC(15,2) /* TYPE OF COLUMN OPS.SUMM */,
    QV FLOAT /* TYPE OF COLUMN OPS.QV */,
    NL SMALLINT /* TYPE OF COLUMN OPS.NL */,
    ZDT TIMESTAMP /* TYPE OF COLUMN OPS.ZDT */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_OPS_ID
RETURNS (
    NEXTID INTEGER)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_OPS_IDK (
    PK INTEGER)
RETURNS (
    NEXTID INTEGER)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_OPS_INSERT (
    PID INTEGER,
    PDOCID INTEGER,
    PDESCR VARCHAR(50),
    PAC11 VARCHAR(8),
    PAC12 VARCHAR(8),
    PAC13 VARCHAR(5),
    PAC14 VARCHAR(8),
    PAC15 VARCHAR(5),
    PAC21 VARCHAR(8),
    PAC22 VARCHAR(8),
    PAC23 VARCHAR(5),
    PAC24 VARCHAR(8),
    PAC25 VARCHAR(5),
    PSUMMC NUMERIC(15,4),
    PCUR VARCHAR(3),
    PSUMM NUMERIC(15,4),
    PQV FLOAT,
    PNL SMALLINT)
RETURNS (
    ID INTEGER /* TYPE OF COLUMN OPS.ID */,
    DOCID INTEGER /* TYPE OF COLUMN OPS.DOCID */,
    DESCR VARCHAR(50) /* TYPE OF COLUMN OPS.DESCR */,
    AC11 VARCHAR(8) /* TYPE OF COLUMN OPS.AC11 */,
    AC12 VARCHAR(8) /* TYPE OF COLUMN OPS.AC12 */,
    AC13 VARCHAR(5) /* TYPE OF COLUMN OPS.AC13 */,
    AC14 VARCHAR(8) /* TYPE OF COLUMN OPS.AC14 */,
    AC15 VARCHAR(5) /* TYPE OF COLUMN OPS.AC15 */,
    AC21 VARCHAR(8) /* TYPE OF COLUMN OPS.AC21 */,
    AC22 VARCHAR(8) /* TYPE OF COLUMN OPS.AC22 */,
    AC23 VARCHAR(5) /* TYPE OF COLUMN OPS.AC23 */,
    AC24 VARCHAR(8) /* TYPE OF COLUMN OPS.AC24 */,
    AC25 VARCHAR(5) /* TYPE OF COLUMN OPS.AC25 */,
    SUMMC NUMERIC(15,2) /* TYPE OF COLUMN OPS.SUMMC */,
    CUR VARCHAR(3) /* TYPE OF COLUMN OPS.CUR */,
    SUMM NUMERIC(15,2) /* TYPE OF COLUMN OPS.SUMM */,
    QV FLOAT /* TYPE OF COLUMN OPS.QV */,
    NL SMALLINT /* TYPE OF COLUMN OPS.NL */,
    ZDT TIMESTAMP /* TYPE OF COLUMN OPS.ZDT */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_OPS_UPDATE (
    PDOCID INTEGER,
    PDESCR VARCHAR(50),
    PAC11 VARCHAR(8),
    PAC12 VARCHAR(8),
    PAC13 VARCHAR(5),
    PAC14 VARCHAR(8),
    PAC15 VARCHAR(5),
    PAC21 VARCHAR(8),
    PAC22 VARCHAR(8),
    PAC23 VARCHAR(5),
    PAC24 VARCHAR(8),
    PAC25 VARCHAR(5),
    PSUMMC NUMERIC(15,4),
    PCUR VARCHAR(3),
    PSUMM NUMERIC(15,4),
    PQV FLOAT,
    PNL SMALLINT,
    ORIGINAL_ID INTEGER,
    ORIGINAL_DOCID INTEGER,
    ISNULL_DESCR INTEGER,
    ORIGINAL_DESCR VARCHAR(50),
    ORIGINAL_AC11 VARCHAR(8),
    ISNULL_AC12 INTEGER,
    ORIGINAL_AC12 VARCHAR(8),
    ISNULL_AC13 INTEGER,
    ORIGINAL_AC13 VARCHAR(5),
    ISNULL_AC14 INTEGER,
    ORIGINAL_AC14 VARCHAR(8),
    ISNULL_AC15 INTEGER,
    ORIGINAL_AC15 VARCHAR(5),
    ORIGINAL_AC21 VARCHAR(8),
    ISNULL_AC22 INTEGER,
    ORIGINAL_AC22 VARCHAR(8),
    ISNULL_AC23 INTEGER,
    ORIGINAL_AC23 VARCHAR(5),
    ISNULL_AC24 INTEGER,
    ORIGINAL_AC24 VARCHAR(8),
    ISNULL_AC25 INTEGER,
    ORIGINAL_AC25 VARCHAR(5),
    ORIGINAL_SUMMC NUMERIC(15,4),
    ORIGINAL_CUR VARCHAR(3),
    ORIGINAL_SUMM NUMERIC(15,4),
    ISNULL_QV INTEGER,
    ORIGINAL_QV FLOAT,
    ISNULL_NL INTEGER,
    ORIGINAL_NL SMALLINT,
    ISNULL_ZDT INTEGER,
    ORIGINAL_ZDT TIMESTAMP,
    PID INTEGER)
RETURNS (
    ID INTEGER /* TYPE OF COLUMN OPS.ID */,
    DOCID INTEGER /* TYPE OF COLUMN OPS.DOCID */,
    DESCR VARCHAR(50) /* TYPE OF COLUMN OPS.DESCR */,
    AC11 VARCHAR(8) /* TYPE OF COLUMN OPS.AC11 */,
    AC12 VARCHAR(8) /* TYPE OF COLUMN OPS.AC12 */,
    AC13 VARCHAR(5) /* TYPE OF COLUMN OPS.AC13 */,
    AC14 VARCHAR(8) /* TYPE OF COLUMN OPS.AC14 */,
    AC15 VARCHAR(5) /* TYPE OF COLUMN OPS.AC15 */,
    AC21 VARCHAR(8) /* TYPE OF COLUMN OPS.AC21 */,
    AC22 VARCHAR(8) /* TYPE OF COLUMN OPS.AC22 */,
    AC23 VARCHAR(5) /* TYPE OF COLUMN OPS.AC23 */,
    AC24 VARCHAR(8) /* TYPE OF COLUMN OPS.AC24 */,
    AC25 VARCHAR(5) /* TYPE OF COLUMN OPS.AC25 */,
    SUMMC NUMERIC(15,2) /* TYPE OF COLUMN OPS.SUMMC */,
    CUR VARCHAR(3) /* TYPE OF COLUMN OPS.CUR */,
    SUMM NUMERIC(15,2) /* TYPE OF COLUMN OPS.SUMM */,
    QV FLOAT /* TYPE OF COLUMN OPS.QV */,
    NL SMALLINT /* TYPE OF COLUMN OPS.NL */,
    ZDT TIMESTAMP /* TYPE OF COLUMN OPS.ZDT */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_OPS_UPDATE_LOG (
    ID INTEGER,
    USR VARCHAR(15),
    ORIGINAL_DOCID INTEGER,
    ORIGINAL_AC11 VARCHAR(8),
    ORIGINAL_AC12 VARCHAR(8),
    ORIGINAL_AC13 VARCHAR(5),
    ORIGINAL_AC14 VARCHAR(8),
    ORIGINAL_AC15 VARCHAR(5),
    ORIGINAL_AC21 VARCHAR(8),
    ORIGINAL_AC22 VARCHAR(8),
    ORIGINAL_AC23 VARCHAR(5),
    ORIGINAL_AC24 VARCHAR(8),
    ORIGINAL_AC25 VARCHAR(5),
    ORIGINAL_SUMMC NUMERIC(15,4),
    ORIGINAL_CUR VARCHAR(3),
    ORIGINAL_SUMM NUMERIC(15,4),
    ORIGINAL_QV FLOAT,
    ORIGINAL_ZDT TIMESTAMP)
AS
BEGIN
  EXIT;
END^





CREATE PROCEDURE SP_OPSD_DELETE (
    ORIGINAL_ID INTEGER,
    ORIGINAL_DATE DATE,
    ISNULL_NRX INTEGER,
    ORIGINAL_NRX VARCHAR(5),
    ISNULL_DOCTYP INTEGER,
    ORIGINAL_DOCTYP VARCHAR(10),
    ISNULL_DOCST INTEGER,
    ORIGINAL_DOCST VARCHAR(6),
    ISNULL_DOCNR INTEGER,
    ORIGINAL_DOCNR VARCHAR(15),
    ISNULL_CLID INTEGER,
    ORIGINAL_CLID VARCHAR(15),
    ISNULL_CLID2 INTEGER,
    ORIGINAL_CLID2 VARCHAR(15),
    ISNULL_DESCR INTEGER,
    ORIGINAL_DESCR VARCHAR(80),
    ORIGINAL_SUMM NUMERIC(15,4),
    ORIGINAL_PVN NUMERIC(15,4),
    ORIGINAL_ZNR INTEGER,
    ISNULL_ZU INTEGER,
    ORIGINAL_ZU VARCHAR(20),
    ISNULL_ZDT INTEGER,
    ORIGINAL_ZDT TIMESTAMP,
    ISNULL_DT2 INTEGER,
    ORIGINAL_DT2 DATE,
    ISNULL_IDDOCM INTEGER,
    ORIGINAL_IDDOCM INTEGER)
AS
BEGIN
  EXIT;
END^





CREATE PROCEDURE SP_OPSD_DELETE_LOG (
    ID INTEGER,
    USR VARCHAR(15),
    ORIGINAL_DATE DATE,
    ORIGINAL_NRX VARCHAR(5),
    ORIGINAL_DOCTYP VARCHAR(10),
    ORIGINAL_DOCST VARCHAR(6),
    ORIGINAL_DOCNR VARCHAR(15),
    ORIGINAL_CLID VARCHAR(15),
    ORIGINAL_CLID2 VARCHAR(15),
    ORIGINAL_DESCR VARCHAR(80),
    ORIGINAL_SUMM NUMERIC(15,4),
    ORIGINAL_PVN NUMERIC(15,4),
    ORIGINAL_ZNR INTEGER,
    ORIGINAL_ZDT TIMESTAMP)
AS
BEGIN
  EXIT;
END^





CREATE PROCEDURE SP_OPSD_FILTER_AND (
    PDATE1 DATE,
    PDATE2 DATE,
    PTEXT VARCHAR(50),
    PCLID VARCHAR(15),
    PAC11 VARCHAR(8),
    PAC12 VARCHAR(8),
    PAC13 VARCHAR(5),
    PAC14 VARCHAR(8),
    PAC15 VARCHAR(5),
    PAC21 VARCHAR(8),
    PAC22 VARCHAR(8),
    PAC23 VARCHAR(5),
    PAC24 VARCHAR(8),
    PAC25 VARCHAR(5),
    PDOCGR VARCHAR(10))
RETURNS (
    ID INTEGER /* TYPE OF COLUMN OPSD.ID */,
    DETE DATE /* TYPE OF COLUMN OPSD.DETE */,
    NRX VARCHAR(5) /* TYPE OF COLUMN OPSD.NRX */,
    DOCTYP VARCHAR(10) /* TYPE OF COLUMN OPSD.DOCTYP */,
    DOCST VARCHAR(6) /* TYPE OF COLUMN OPSD.DOCST */,
    DOCNR VARCHAR(15) /* TYPE OF COLUMN OPSD.DOCNR */,
    CLID VARCHAR(15) /* TYPE OF COLUMN OPSD.CLID */,
    CLID2 VARCHAR(15) /* TYPE OF COLUMN OPSD.CLID2 */,
    DESCR VARCHAR(80) /* TYPE OF COLUMN OPSD.DESCR */,
    SUMM NUMERIC(15,2) /* TYPE OF COLUMN OPSD.SUMM */,
    PVN NUMERIC(15,2) /* TYPE OF COLUMN OPSD.PVN */,
    OPT INTEGER /* TYPE OF COLUMN OPSD.OPT */,
    ZNR INTEGER /* TYPE OF COLUMN OPSD.ZNR */,
    ZU VARCHAR(20) /* TYPE OF COLUMN OPSD.ZU */,
    ZDT TIMESTAMP /* TYPE OF COLUMN OPSD.ZDT */,
    DT2 DATE /* TYPE OF COLUMN OPSD.DT2 */,
    YR SMALLINT /* TYPE OF COLUMN OPSD.YR */,
    NL SMALLINT /* TYPE OF COLUMN OPSD.NL */,
    IDDOCM INTEGER /* TYPE OF COLUMN OPSD.IDDOCM */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_OPSD_FILTER_OR (
    PDATE1 DATE,
    PDATE2 DATE,
    PTEXT VARCHAR(50),
    PCLID VARCHAR(15),
    PAC11 VARCHAR(8),
    PAC12 VARCHAR(8),
    PAC13 VARCHAR(5),
    PAC14 VARCHAR(8),
    PAC15 VARCHAR(5),
    PAC21 VARCHAR(8),
    PAC22 VARCHAR(8),
    PAC23 VARCHAR(5),
    PAC24 VARCHAR(8),
    PAC25 VARCHAR(5),
    PDOCGR VARCHAR(10))
RETURNS (
    ID INTEGER /* TYPE OF COLUMN OPSD.ID */,
    DETE DATE /* TYPE OF COLUMN OPSD.DETE */,
    NRX VARCHAR(5) /* TYPE OF COLUMN OPSD.NRX */,
    DOCTYP VARCHAR(10) /* TYPE OF COLUMN OPSD.DOCTYP */,
    DOCST VARCHAR(6) /* TYPE OF COLUMN OPSD.DOCST */,
    DOCNR VARCHAR(15) /* TYPE OF COLUMN OPSD.DOCNR */,
    CLID VARCHAR(15) /* TYPE OF COLUMN OPSD.CLID */,
    CLID2 VARCHAR(15) /* TYPE OF COLUMN OPSD.CLID2 */,
    DESCR VARCHAR(80) /* TYPE OF COLUMN OPSD.DESCR */,
    SUMM NUMERIC(15,2) /* TYPE OF COLUMN OPSD.SUMM */,
    PVN NUMERIC(15,2) /* TYPE OF COLUMN OPSD.PVN */,
    OPT INTEGER /* TYPE OF COLUMN OPSD.OPT */,
    ZNR INTEGER /* TYPE OF COLUMN OPSD.ZNR */,
    ZU VARCHAR(20) /* TYPE OF COLUMN OPSD.ZU */,
    ZDT TIMESTAMP /* TYPE OF COLUMN OPSD.ZDT */,
    DT2 DATE /* TYPE OF COLUMN OPSD.DT2 */,
    YR SMALLINT /* TYPE OF COLUMN OPSD.YR */,
    NL SMALLINT /* TYPE OF COLUMN OPSD.NL */,
    IDDOCM INTEGER /* TYPE OF COLUMN OPSD.IDDOCM */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_OPSD_GETNEXTNRFORYEARA (
    YR INTEGER)
RETURNS (
    NEXTNR INTEGER)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_OPSD_GETNEXTNRFORYEARA_K (
    YR INTEGER,
    PK INTEGER)
RETURNS (
    NEXTNR INTEGER)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_OPSD_ID
RETURNS (
    NEXTID INTEGER)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_OPSD_IDK (
    PK INTEGER)
RETURNS (
    NEXTID INTEGER)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_OPSD_INSERT (
    PID INTEGER,
    PDETE DATE,
    PNRX VARCHAR(5),
    PDOCTYP VARCHAR(10),
    PDOCST VARCHAR(6),
    PDOCNR VARCHAR(15),
    PCLID VARCHAR(15),
    PCLID2 VARCHAR(15),
    PDESCR VARCHAR(80),
    PSUMM NUMERIC(15,4),
    PPVN NUMERIC(15,4),
    POPT INTEGER,
    PZNR INTEGER,
    PZU VARCHAR(20),
    PZDT TIMESTAMP,
    PDT2 DATE,
    PNL SMALLINT,
    PIDDOCM INTEGER)
RETURNS (
    ID INTEGER /* TYPE OF COLUMN OPSD.ID */,
    DETE DATE /* TYPE OF COLUMN OPSD.DETE */,
    NRX VARCHAR(5) /* TYPE OF COLUMN OPSD.NRX */,
    DOCTYP VARCHAR(10) /* TYPE OF COLUMN OPSD.DOCTYP */,
    DOCST VARCHAR(6) /* TYPE OF COLUMN OPSD.DOCST */,
    DOCNR VARCHAR(15) /* TYPE OF COLUMN OPSD.DOCNR */,
    CLID VARCHAR(15) /* TYPE OF COLUMN OPSD.CLID */,
    CLID2 VARCHAR(15) /* TYPE OF COLUMN OPSD.CLID2 */,
    DESCR VARCHAR(80) /* TYPE OF COLUMN OPSD.DESCR */,
    SUMM NUMERIC(15,2) /* TYPE OF COLUMN OPSD.SUMM */,
    PVN NUMERIC(15,2) /* TYPE OF COLUMN OPSD.PVN */,
    OPT INTEGER /* TYPE OF COLUMN OPSD.OPT */,
    ZNR INTEGER /* TYPE OF COLUMN OPSD.ZNR */,
    ZU VARCHAR(20) /* TYPE OF COLUMN OPSD.ZU */,
    ZDT TIMESTAMP /* TYPE OF COLUMN OPSD.ZDT */,
    DT2 DATE /* TYPE OF COLUMN OPSD.DT2 */,
    YR SMALLINT /* TYPE OF COLUMN OPSD.YR */,
    NL SMALLINT /* TYPE OF COLUMN OPSD.NL */,
    IDDOCM INTEGER /* TYPE OF COLUMN OPSD.IDDOCM */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_OPSD_UPDATE (
    PDETE DATE,
    PNRX VARCHAR(5),
    PDOCTYP VARCHAR(10),
    PDOCST VARCHAR(6),
    PDOCNR VARCHAR(15),
    PCLID VARCHAR(15),
    PCLID2 VARCHAR(15),
    PDESCR VARCHAR(80),
    PSUMM NUMERIC(15,4),
    PPVN NUMERIC(15,4),
    POPT INTEGER,
    PZNR INTEGER,
    PZU VARCHAR(20),
    PZDT TIMESTAMP,
    PDT2 DATE,
    PNL SMALLINT,
    ORIGINAL_ID INTEGER,
    ORIGINAL_DATE DATE,
    ISNULL_NRX INTEGER,
    ORIGINAL_NRX VARCHAR(5),
    ISNULL_DOCTYP INTEGER,
    ORIGINAL_DOCTYP VARCHAR(10),
    ISNULL_DOCST INTEGER,
    ORIGINAL_DOCST VARCHAR(6),
    ISNULL_DOCNR INTEGER,
    ORIGINAL_DOCNR VARCHAR(15),
    ISNULL_CLID INTEGER,
    ORIGINAL_CLID VARCHAR(15),
    ISNULL_CLID2 INTEGER,
    ORIGINAL_CLID2 VARCHAR(15),
    ISNULL_DESCR INTEGER,
    ORIGINAL_DESCR VARCHAR(80),
    ORIGINAL_SUMM NUMERIC(15,4),
    ORIGINAL_PVN NUMERIC(15,4),
    ISNULL_OPT INTEGER,
    ORIGINAL_OPT INTEGER,
    ORIGINAL_ZNR INTEGER,
    ISNULL_ZU INTEGER,
    ORIGINAL_ZU VARCHAR(20),
    ISNULL_ZDT INTEGER,
    ORIGINAL_ZDT TIMESTAMP,
    ISNULL_DT2 INTEGER,
    ORIGINAL_DT2 DATE,
    ISNULL_NL INTEGER,
    ORIGINAL_NL SMALLINT,
    ISNULL_YR INTEGER,
    ORIGINAL_YR INTEGER,
    PID INTEGER,
    ISNULL_IDDOCM INTEGER,
    ORIGINAL_IDDOCM INTEGER,
    PIDDOCM INTEGER)
RETURNS (
    ID INTEGER /* TYPE OF COLUMN OPSD.ID */,
    DETE DATE /* TYPE OF COLUMN OPSD.DETE */,
    NRX VARCHAR(5) /* TYPE OF COLUMN OPSD.NRX */,
    DOCTYP VARCHAR(10) /* TYPE OF COLUMN OPSD.DOCTYP */,
    DOCST VARCHAR(6) /* TYPE OF COLUMN OPSD.DOCST */,
    DOCNR VARCHAR(15) /* TYPE OF COLUMN OPSD.DOCNR */,
    CLID VARCHAR(15) /* TYPE OF COLUMN OPSD.CLID */,
    CLID2 VARCHAR(15) /* TYPE OF COLUMN OPSD.CLID2 */,
    DESCR VARCHAR(80) /* TYPE OF COLUMN OPSD.DESCR */,
    SUMM NUMERIC(15,2) /* TYPE OF COLUMN OPSD.SUMM */,
    PVN NUMERIC(15,2) /* TYPE OF COLUMN OPSD.PVN */,
    OPT INTEGER /* TYPE OF COLUMN OPSD.OPT */,
    ZNR INTEGER /* TYPE OF COLUMN OPSD.ZNR */,
    ZU VARCHAR(20) /* TYPE OF COLUMN OPSD.ZU */,
    ZDT TIMESTAMP /* TYPE OF COLUMN OPSD.ZDT */,
    DT2 DATE /* TYPE OF COLUMN OPSD.DT2 */,
    YR SMALLINT /* TYPE OF COLUMN OPSD.YR */,
    NL SMALLINT /* TYPE OF COLUMN OPSD.NL */,
    IDDOCM INTEGER /* TYPE OF COLUMN OPSD.IDDOCM */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_OPSD_UPDATE_LOG (
    ID INTEGER,
    USR VARCHAR(15),
    ORIGINAL_DATE DATE,
    ORIGINAL_NRX VARCHAR(5),
    ORIGINAL_DOCTYP VARCHAR(10),
    ORIGINAL_DOCST VARCHAR(6),
    ORIGINAL_DOCNR VARCHAR(15),
    ORIGINAL_CLID VARCHAR(15),
    ORIGINAL_CLID2 VARCHAR(15),
    ORIGINAL_DESCR VARCHAR(80),
    ORIGINAL_SUMM NUMERIC(15,4),
    ORIGINAL_PVN NUMERIC(15,4),
    ORIGINAL_ZNR INTEGER,
    ORIGINAL_ZDT TIMESTAMP)
AS
BEGIN
  EXIT;
END^





CREATE PROCEDURE SP_PARAMS (
    USERNAME VARCHAR(20))
RETURNS (
    ID INTEGER /* TYPE OF COLUMN PARAMS.ID */,
    PNAME VARCHAR(20) /* TYPE OF COLUMN PARAMS.PNAME */,
    PVALUE VARCHAR(50) /* TYPE OF COLUMN PARAMS.PVALUE */,
    USR VARCHAR(15) /* TYPE OF COLUMN PARAMS.USR */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_REKINS_11 (
    PDID INTEGER)
RETURNS (
    ID INTEGER /* TYPE OF COLUMN OPS.ID */,
    DOCID INTEGER /* TYPE OF COLUMN OPS.DOCID */,
    DESCR VARCHAR(50) /* TYPE OF COLUMN OPS.DESCR */,
    AC11 VARCHAR(8) /* TYPE OF COLUMN OPS.AC11 */,
    AC12 VARCHAR(8) /* TYPE OF COLUMN OPS.AC12 */,
    AC13 VARCHAR(5) /* TYPE OF COLUMN OPS.AC13 */,
    AC14 VARCHAR(8) /* TYPE OF COLUMN OPS.AC14 */,
    AC15 VARCHAR(5) /* TYPE OF COLUMN OPS.AC15 */,
    AC21 VARCHAR(8) /* TYPE OF COLUMN OPS.AC21 */,
    AC22 VARCHAR(8) /* TYPE OF COLUMN OPS.AC22 */,
    AC23 VARCHAR(5) /* TYPE OF COLUMN OPS.AC23 */,
    AC24 VARCHAR(8) /* TYPE OF COLUMN OPS.AC24 */,
    AC25 VARCHAR(5) /* TYPE OF COLUMN OPS.AC25 */,
    SUMMC NUMERIC(15,2) /* TYPE OF COLUMN OPS.SUMMC */,
    CUR VARCHAR(3) /* TYPE OF COLUMN OPS.CUR */,
    SUMM NUMERIC(15,2) /* TYPE OF COLUMN OPS.SUMM */,
    QV FLOAT /* TYPE OF COLUMN OPS.QV */,
    NL SMALLINT /* TYPE OF COLUMN OPS.NL */,
    ZDT TIMESTAMP /* TYPE OF COLUMN OPS.ZDT */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_REP_APGR_01 (
    SDT DATE,
    EDT DATE,
    PAC VARCHAR(8))
RETURNS (
    ID INTEGER /* TYPE OF COLUMN ROPS2A.ID */,
    SPID INTEGER /* TYPE OF COLUMN ROPS2A.SPID */,
    AC VARCHAR(8) /* TYPE OF COLUMN ROPS2A.AC */,
    RAC VARCHAR(8) /* TYPE OF COLUMN ROPS2A.RAC */,
    NAME VARCHAR(150) /* TYPE OF COLUMN ROPS2A.NAME */,
    B0 NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.B0 */,
    SDB NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.SDB */,
    SCR NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.SCR */,
    TDB NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.TDB */,
    TCR NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.TCR */,
    CLID VARCHAR(15) /* TYPE OF COLUMN ROPS2A.CLID */,
    NAME1 VARCHAR(50) /* TYPE OF COLUMN ROPS2A.NAME1 */,
    REGNR VARCHAR(15) /* TYPE OF COLUMN ROPS2A.REGNR */,
    RNAME VARCHAR(150) /* TYPE OF COLUMN ROPS2A.RNAME */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_REP_APGR_01_CLID (
    SDT DATE,
    EDT DATE,
    PAC VARCHAR(8),
    PCLID VARCHAR(15))
RETURNS (
    ID INTEGER /* TYPE OF COLUMN ROPS2A.ID */,
    SPID INTEGER /* TYPE OF COLUMN ROPS2A.SPID */,
    AC VARCHAR(8) /* TYPE OF COLUMN ROPS2A.AC */,
    RAC VARCHAR(8) /* TYPE OF COLUMN ROPS2A.RAC */,
    NAME VARCHAR(150) /* TYPE OF COLUMN ROPS2A.NAME */,
    B0 NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.B0 */,
    SDB NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.SDB */,
    SCR NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.SCR */,
    TDB NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.TDB */,
    TCR NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.TCR */,
    CLID VARCHAR(15) /* TYPE OF COLUMN ROPS2A.CLID */,
    NAME1 VARCHAR(50) /* TYPE OF COLUMN ROPS2A.NAME1 */,
    REGNR VARCHAR(15) /* TYPE OF COLUMN ROPS2A.REGNR */,
    RNAME VARCHAR(150) /* TYPE OF COLUMN ROPS2A.RNAME */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_REP_APGR_01_CLID2 (
    SDT DATE,
    EDT DATE,
    PAC VARCHAR(8),
    PCLID VARCHAR(15))
RETURNS (
    ID INTEGER /* TYPE OF COLUMN ROPS2A.ID */,
    SPID INTEGER /* TYPE OF COLUMN ROPS2A.SPID */,
    AC VARCHAR(8) /* TYPE OF COLUMN ROPS2A.AC */,
    RAC VARCHAR(8) /* TYPE OF COLUMN ROPS2A.RAC */,
    NAME VARCHAR(150) /* TYPE OF COLUMN ROPS2A.NAME */,
    B0 NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.B0 */,
    SDB NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.SDB */,
    SCR NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.SCR */,
    TDB NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.TDB */,
    TCR NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.TCR */,
    CLID VARCHAR(15) /* TYPE OF COLUMN ROPS2A.CLID */,
    NAME1 VARCHAR(50) /* TYPE OF COLUMN ROPS2A.NAME1 */,
    REGNR VARCHAR(15) /* TYPE OF COLUMN ROPS2A.REGNR */,
    RNAME VARCHAR(150) /* TYPE OF COLUMN ROPS2A.RNAME */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_REP_APGR_02 (
    SDT DATE,
    EDT DATE,
    PAC VARCHAR(8))
RETURNS (
    ID INTEGER /* TYPE OF COLUMN ROPS2A.ID */,
    SPID INTEGER /* TYPE OF COLUMN ROPS2A.SPID */,
    AC VARCHAR(8) /* TYPE OF COLUMN ROPS2A.AC */,
    RAC VARCHAR(8) /* TYPE OF COLUMN ROPS2A.RAC */,
    NAME VARCHAR(150) /* TYPE OF COLUMN ROPS2A.NAME */,
    B0 NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.B0 */,
    SDB NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.SDB */,
    SCR NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.SCR */,
    TDB NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.TDB */,
    TCR NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.TCR */,
    CLID VARCHAR(15) /* TYPE OF COLUMN ROPS2A.CLID */,
    NAME1 VARCHAR(50) /* TYPE OF COLUMN ROPS2A.NAME1 */,
    REGNR VARCHAR(15) /* TYPE OF COLUMN ROPS2A.REGNR */,
    RNAME VARCHAR(150) /* TYPE OF COLUMN ROPS2A.RNAME */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_REP_APGR_02_CLID (
    SDT DATE,
    EDT DATE,
    PAC VARCHAR(8),
    PCLID VARCHAR(15))
RETURNS (
    ID INTEGER /* TYPE OF COLUMN ROPS2A.ID */,
    SPID INTEGER /* TYPE OF COLUMN ROPS2A.SPID */,
    AC VARCHAR(8) /* TYPE OF COLUMN ROPS2A.AC */,
    RAC VARCHAR(8) /* TYPE OF COLUMN ROPS2A.RAC */,
    NAME VARCHAR(150) /* TYPE OF COLUMN ROPS2A.NAME */,
    B0 NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.B0 */,
    SDB NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.SDB */,
    SCR NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.SCR */,
    TDB NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.TDB */,
    TCR NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.TCR */,
    CLID VARCHAR(15) /* TYPE OF COLUMN ROPS2A.CLID */,
    NAME1 VARCHAR(50) /* TYPE OF COLUMN ROPS2A.NAME1 */,
    REGNR VARCHAR(15) /* TYPE OF COLUMN ROPS2A.REGNR */,
    RNAME VARCHAR(150) /* TYPE OF COLUMN ROPS2A.RNAME */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_REP_APGR_10 (
    SDT DATE,
    EDT DATE,
    PAC VARCHAR(8))
RETURNS (
    ID INTEGER /* TYPE OF COLUMN ROPS2A.ID */,
    SPID INTEGER /* TYPE OF COLUMN ROPS2A.SPID */,
    AC VARCHAR(8) /* TYPE OF COLUMN ROPS2A.AC */,
    RAC VARCHAR(8) /* TYPE OF COLUMN ROPS2A.RAC */,
    NAME VARCHAR(150) /* TYPE OF COLUMN ROPS2A.NAME */,
    B0 NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.B0 */,
    SDB NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.SDB */,
    SCR NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.SCR */,
    TDB NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.TDB */,
    TCR NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.TCR */,
    CLID VARCHAR(15) /* TYPE OF COLUMN ROPS2A.CLID */,
    NAME1 VARCHAR(50) /* TYPE OF COLUMN ROPS2A.NAME1 */,
    REGNR VARCHAR(15) /* TYPE OF COLUMN ROPS2A.REGNR */,
    RNAME VARCHAR(150) /* TYPE OF COLUMN ROPS2A.RNAME */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_REP_APGR_10_CLID (
    SDT DATE,
    EDT DATE,
    PAC VARCHAR(8),
    PCLID VARCHAR(15))
RETURNS (
    ID INTEGER /* TYPE OF COLUMN ROPS2A.ID */,
    SPID INTEGER /* TYPE OF COLUMN ROPS2A.SPID */,
    AC VARCHAR(8) /* TYPE OF COLUMN ROPS2A.AC */,
    RAC VARCHAR(8) /* TYPE OF COLUMN ROPS2A.RAC */,
    NAME VARCHAR(150) /* TYPE OF COLUMN ROPS2A.NAME */,
    B0 NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.B0 */,
    SDB NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.SDB */,
    SCR NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.SCR */,
    TDB NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.TDB */,
    TCR NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.TCR */,
    CLID VARCHAR(15) /* TYPE OF COLUMN ROPS2A.CLID */,
    NAME1 VARCHAR(50) /* TYPE OF COLUMN ROPS2A.NAME1 */,
    REGNR VARCHAR(15) /* TYPE OF COLUMN ROPS2A.REGNR */,
    RNAME VARCHAR(150) /* TYPE OF COLUMN ROPS2A.RNAME */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_REP_APGR_11 (
    SDT DATE,
    EDT DATE,
    PAC VARCHAR(8))
RETURNS (
    ID INTEGER /* TYPE OF COLUMN ROPS2A.ID */,
    SPID INTEGER /* TYPE OF COLUMN ROPS2A.SPID */,
    AC VARCHAR(8) /* TYPE OF COLUMN ROPS2A.AC */,
    RAC VARCHAR(8) /* TYPE OF COLUMN ROPS2A.RAC */,
    NAME VARCHAR(150) /* TYPE OF COLUMN ROPS2A.NAME */,
    B0 NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.B0 */,
    SDB NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.SDB */,
    SCR NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.SCR */,
    TDB NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.TDB */,
    TCR NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.TCR */,
    CLID VARCHAR(15) /* TYPE OF COLUMN ROPS2A.CLID */,
    NAME1 VARCHAR(50) /* TYPE OF COLUMN ROPS2A.NAME1 */,
    REGNR VARCHAR(15) /* TYPE OF COLUMN ROPS2A.REGNR */,
    RNAME VARCHAR(150) /* TYPE OF COLUMN ROPS2A.RNAME */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_REP_APGR_21 (
    SDT DATE,
    EDT DATE,
    PAC VARCHAR(8),
    PACLEN INTEGER)
RETURNS (
    ID INTEGER /* TYPE OF COLUMN ROPS2A.ID */,
    SPID INTEGER /* TYPE OF COLUMN ROPS2A.SPID */,
    AC VARCHAR(8) /* TYPE OF COLUMN ROPS2A.AC */,
    RAC VARCHAR(8) /* TYPE OF COLUMN ROPS2A.RAC */,
    NAME VARCHAR(150) /* TYPE OF COLUMN ROPS2A.NAME */,
    B0 NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.B0 */,
    SDB NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.SDB */,
    SCR NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.SCR */,
    TDB NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.TDB */,
    TCR NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.TCR */,
    CLID VARCHAR(15) /* TYPE OF COLUMN ROPS2A.CLID */,
    NAME1 VARCHAR(50) /* TYPE OF COLUMN ROPS2A.NAME1 */,
    REGNR VARCHAR(15) /* TYPE OF COLUMN ROPS2A.REGNR */,
    RNAME VARCHAR(150) /* TYPE OF COLUMN ROPS2A.RNAME */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_REP_APGR_CUR_01 (
    SDT DATE,
    EDT DATE,
    PAC VARCHAR(8),
    PCUR VARCHAR(3))
RETURNS (
    ID INTEGER /* TYPE OF COLUMN ROPS2A.ID */,
    SPID INTEGER /* TYPE OF COLUMN ROPS2A.SPID */,
    AC VARCHAR(8) /* TYPE OF COLUMN ROPS2A.AC */,
    RAC VARCHAR(8) /* TYPE OF COLUMN ROPS2A.RAC */,
    NAME VARCHAR(150) /* TYPE OF COLUMN ROPS2A.NAME */,
    B0 NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.B0 */,
    SDB NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.SDB */,
    SCR NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.SCR */,
    TDB NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.TDB */,
    TCR NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.TCR */,
    CLID VARCHAR(15) /* TYPE OF COLUMN ROPS2A.CLID */,
    NAME1 VARCHAR(50) /* TYPE OF COLUMN ROPS2A.NAME1 */,
    REGNR VARCHAR(15) /* TYPE OF COLUMN ROPS2A.REGNR */,
    RNAME VARCHAR(150) /* TYPE OF COLUMN ROPS2A.RNAME */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_REP_APGR_CUR_01_CLID (
    SDT DATE,
    EDT DATE,
    PAC VARCHAR(8),
    PCLID VARCHAR(8),
    PCUR VARCHAR(3))
RETURNS (
    ID INTEGER /* TYPE OF COLUMN ROPS2A.ID */,
    SPID INTEGER /* TYPE OF COLUMN ROPS2A.SPID */,
    AC VARCHAR(8) /* TYPE OF COLUMN ROPS2A.AC */,
    RAC VARCHAR(8) /* TYPE OF COLUMN ROPS2A.RAC */,
    NAME VARCHAR(150) /* TYPE OF COLUMN ROPS2A.NAME */,
    B0 NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.B0 */,
    SDB NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.SDB */,
    SCR NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.SCR */,
    TDB NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.TDB */,
    TCR NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.TCR */,
    CLID VARCHAR(15) /* TYPE OF COLUMN ROPS2A.CLID */,
    NAME1 VARCHAR(50) /* TYPE OF COLUMN ROPS2A.NAME1 */,
    REGNR VARCHAR(15) /* TYPE OF COLUMN ROPS2A.REGNR */,
    RNAME VARCHAR(150) /* TYPE OF COLUMN ROPS2A.RNAME */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_REP_APGR_DZ_11 (
    SDT DATE,
    EDT DATE)
RETURNS (
    ID INTEGER /* TYPE OF COLUMN ROPS3A.ID */,
    SPID INTEGER /* TYPE OF COLUMN ROPS3A.SPID */,
    RAC VARCHAR(8) /* TYPE OF COLUMN ROPS3A.RAC */,
    NAME VARCHAR(50) /* TYPE OF COLUMN ROPS3A.NAME */,
    SDB NUMERIC(15,2) /* TYPE OF COLUMN ROPS3A.SDB */,
    SCR NUMERIC(15,2) /* TYPE OF COLUMN ROPS3A.SCR */,
    AC1 VARCHAR(8) /* TYPE OF COLUMN ROPS3A.AC1 */,
    CLID VARCHAR(15) /* TYPE OF COLUMN ROPS3A.CLID */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_REP_APGR_DZ_12 (
    SDT DATE,
    EDT DATE)
RETURNS (
    ID INTEGER /* TYPE OF COLUMN ROPS2A.ID */,
    SPID INTEGER /* TYPE OF COLUMN ROPS2A.SPID */,
    AC VARCHAR(8) /* TYPE OF COLUMN ROPS2A.AC */,
    RAC VARCHAR(8) /* TYPE OF COLUMN ROPS2A.RAC */,
    NAME VARCHAR(150) /* TYPE OF COLUMN ROPS2A.NAME */,
    B0 NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.B0 */,
    SDB NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.SDB */,
    SCR NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.SCR */,
    TDB NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.TDB */,
    TCR NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.TCR */,
    CLID VARCHAR(15) /* TYPE OF COLUMN ROPS2A.CLID */,
    NAME1 VARCHAR(50) /* TYPE OF COLUMN ROPS2A.NAME1 */,
    REGNR VARCHAR(15) /* TYPE OF COLUMN ROPS2A.REGNR */,
    RNAME VARCHAR(150) /* TYPE OF COLUMN ROPS2A.RNAME */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_REP_APGR_FULL_11 (
    SDT DATE,
    EDT DATE,
    PAC1 VARCHAR(8),
    PAC2 VARCHAR(8),
    PAC3 VARCHAR(5),
    PAC4 VARCHAR(8),
    PAC5 VARCHAR(5),
    PCLID VARCHAR(15),
    PXAC1 INTEGER,
    PXAC2 INTEGER,
    PXAC3 INTEGER,
    PXAC4 INTEGER,
    PXAC5 INTEGER,
    PXCLID INTEGER)
RETURNS (
    ID INTEGER /* TYPE OF COLUMN TREPAPAN.ID */,
    SPID INTEGER /* TYPE OF COLUMN TREPAPAN.SPID */,
    AC1 VARCHAR(8) /* TYPE OF COLUMN TREPAPAN.AC1 */,
    AC2 VARCHAR(8) /* TYPE OF COLUMN TREPAPAN.AC2 */,
    AC3 VARCHAR(15) /* TYPE OF COLUMN TREPAPAN.AC3 */,
    AC4 VARCHAR(15) /* TYPE OF COLUMN TREPAPAN.AC4 */,
    AC5 VARCHAR(15) /* TYPE OF COLUMN TREPAPAN.AC5 */,
    CL VARCHAR(15) /* TYPE OF COLUMN TREPAPAN.CL */,
    S1 NUMERIC(15,2) /* TYPE OF COLUMN TREPAPAN.S1 */,
    S2 NUMERIC(15,2) /* TYPE OF COLUMN TREPAPAN.S2 */,
    S3 NUMERIC(15,2) /* TYPE OF COLUMN TREPAPAN.S3 */,
    S4 NUMERIC(15,2) /* TYPE OF COLUMN TREPAPAN.S4 */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_REP_APGR_FULL_12 (
    SDT DATE,
    EDT DATE,
    PAC1 VARCHAR(8),
    PAC2 VARCHAR(8),
    PAC3 VARCHAR(5),
    PAC4 VARCHAR(8),
    PAC5 VARCHAR(5),
    PCLID VARCHAR(15))
RETURNS (
    ID INTEGER /* TYPE OF COLUMN TREPAPAN.ID */,
    SPID INTEGER /* TYPE OF COLUMN TREPAPAN.SPID */,
    AC1 VARCHAR(8) /* TYPE OF COLUMN TREPAPAN.AC1 */,
    AC2 VARCHAR(8) /* TYPE OF COLUMN TREPAPAN.AC2 */,
    AC3 VARCHAR(15) /* TYPE OF COLUMN TREPAPAN.AC3 */,
    AC4 VARCHAR(15) /* TYPE OF COLUMN TREPAPAN.AC4 */,
    AC5 VARCHAR(15) /* TYPE OF COLUMN TREPAPAN.AC5 */,
    CL VARCHAR(15) /* TYPE OF COLUMN TREPAPAN.CL */,
    S1 NUMERIC(15,2) /* TYPE OF COLUMN TREPAPAN.S1 */,
    S2 NUMERIC(15,2) /* TYPE OF COLUMN TREPAPAN.S2 */,
    S3 NUMERIC(15,2) /* TYPE OF COLUMN TREPAPAN.S3 */,
    S4 NUMERIC(15,2) /* TYPE OF COLUMN TREPAPAN.S4 */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_REP_APGR_MT_11 (
    SDT DATE,
    EDT DATE,
    PAC VARCHAR(8))
RETURNS (
    ID INTEGER /* TYPE OF COLUMN TREPMT.ID */,
    SPID INTEGER /* TYPE OF COLUMN TREPMT.SPID */,
    AD VARCHAR(3) /* TYPE OF COLUMN TREPMT.AD */,
    AC1 VARCHAR(15) /* TYPE OF COLUMN TREPMT.AC1 */,
    AC2 VARCHAR(15) /* TYPE OF COLUMN TREPMT.AC2 */,
    ACN1 VARCHAR(50) /* TYPE OF COLUMN TREPMT.ACN1 */,
    ACN2 VARCHAR(50) /* TYPE OF COLUMN TREPMT.ACN2 */,
    M1 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M1 */,
    M2 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M2 */,
    M3 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M3 */,
    M4 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M4 */,
    M5 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M5 */,
    M6 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M6 */,
    M7 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M7 */,
    M8 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M8 */,
    M9 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M9 */,
    M10 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M10 */,
    M11 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M11 */,
    M12 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M12 */,
    N1 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N1 */,
    N2 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N2 */,
    N3 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N3 */,
    N4 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N4 */,
    N5 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N5 */,
    N6 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N6 */,
    N7 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N7 */,
    N8 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N8 */,
    N9 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N9 */,
    N10 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N10 */,
    N11 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N11 */,
    N12 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N12 */,
    MT NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.MT */,
    NT NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.NT */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_REP_APGR_MT_12 (
    SDT DATE,
    EDT DATE,
    PAC VARCHAR(8))
RETURNS (
    ID INTEGER /* TYPE OF COLUMN TREPMT.ID */,
    SPID INTEGER /* TYPE OF COLUMN TREPMT.SPID */,
    AD VARCHAR(3) /* TYPE OF COLUMN TREPMT.AD */,
    AC1 VARCHAR(15) /* TYPE OF COLUMN TREPMT.AC1 */,
    AC2 VARCHAR(15) /* TYPE OF COLUMN TREPMT.AC2 */,
    ACN1 VARCHAR(50) /* TYPE OF COLUMN TREPMT.ACN1 */,
    ACN2 VARCHAR(50) /* TYPE OF COLUMN TREPMT.ACN2 */,
    M1 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M1 */,
    M2 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M2 */,
    M3 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M3 */,
    M4 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M4 */,
    M5 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M5 */,
    M6 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M6 */,
    M7 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M7 */,
    M8 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M8 */,
    M9 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M9 */,
    M10 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M10 */,
    M11 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M11 */,
    M12 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M12 */,
    N1 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N1 */,
    N2 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N2 */,
    N3 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N3 */,
    N4 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N4 */,
    N5 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N5 */,
    N6 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N6 */,
    N7 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N7 */,
    N8 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N8 */,
    N9 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N9 */,
    N10 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N10 */,
    N11 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N11 */,
    N12 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N12 */,
    MT NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.MT */,
    NT NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.NT */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_REP_APGR_MT_21 (
    SDT DATE,
    EDT DATE,
    PAC VARCHAR(8))
RETURNS (
    ID INTEGER /* TYPE OF COLUMN TREPMT.ID */,
    SPID INTEGER /* TYPE OF COLUMN TREPMT.SPID */,
    AD VARCHAR(3) /* TYPE OF COLUMN TREPMT.AD */,
    AC1 VARCHAR(15) /* TYPE OF COLUMN TREPMT.AC1 */,
    AC2 VARCHAR(15) /* TYPE OF COLUMN TREPMT.AC2 */,
    ACN1 VARCHAR(50) /* TYPE OF COLUMN TREPMT.ACN1 */,
    ACN2 VARCHAR(50) /* TYPE OF COLUMN TREPMT.ACN2 */,
    M1 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M1 */,
    M2 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M2 */,
    M3 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M3 */,
    M4 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M4 */,
    M5 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M5 */,
    M6 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M6 */,
    M7 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M7 */,
    M8 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M8 */,
    M9 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M9 */,
    M10 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M10 */,
    M11 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M11 */,
    M12 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M12 */,
    N1 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N1 */,
    N2 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N2 */,
    N3 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N3 */,
    N4 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N4 */,
    N5 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N5 */,
    N6 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N6 */,
    N7 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N7 */,
    N8 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N8 */,
    N9 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N9 */,
    N10 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N10 */,
    N11 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N11 */,
    N12 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N12 */,
    MT NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.MT */,
    NT NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.NT */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_REP_APGR_MT_22 (
    SDT DATE,
    EDT DATE,
    PAC VARCHAR(8))
RETURNS (
    ID INTEGER /* TYPE OF COLUMN TREPMT.ID */,
    SPID INTEGER /* TYPE OF COLUMN TREPMT.SPID */,
    AD VARCHAR(3) /* TYPE OF COLUMN TREPMT.AD */,
    AC1 VARCHAR(15) /* TYPE OF COLUMN TREPMT.AC1 */,
    AC2 VARCHAR(15) /* TYPE OF COLUMN TREPMT.AC2 */,
    ACN1 VARCHAR(50) /* TYPE OF COLUMN TREPMT.ACN1 */,
    ACN2 VARCHAR(50) /* TYPE OF COLUMN TREPMT.ACN2 */,
    M1 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M1 */,
    M2 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M2 */,
    M3 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M3 */,
    M4 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M4 */,
    M5 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M5 */,
    M6 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M6 */,
    M7 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M7 */,
    M8 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M8 */,
    M9 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M9 */,
    M10 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M10 */,
    M11 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M11 */,
    M12 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M12 */,
    N1 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N1 */,
    N2 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N2 */,
    N3 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N3 */,
    N4 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N4 */,
    N5 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N5 */,
    N6 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N6 */,
    N7 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N7 */,
    N8 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N8 */,
    N9 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N9 */,
    N10 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N10 */,
    N11 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N11 */,
    N12 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N12 */,
    MT NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.MT */,
    NT NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.NT */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_REP_APGR_NP_11 (
    SDT DATE,
    EDT DATE,
    PAC VARCHAR(8))
RETURNS (
    ID INTEGER /* TYPE OF COLUMN ROPS2A.ID */,
    SPID INTEGER /* TYPE OF COLUMN ROPS2A.SPID */,
    AC VARCHAR(8) /* TYPE OF COLUMN ROPS2A.AC */,
    RAC VARCHAR(8) /* TYPE OF COLUMN ROPS2A.RAC */,
    NAME VARCHAR(150) /* TYPE OF COLUMN ROPS2A.NAME */,
    B0 NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.B0 */,
    SDB NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.SDB */,
    SCR NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.SCR */,
    TDB NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.TDB */,
    TCR NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.TCR */,
    CLID VARCHAR(15) /* TYPE OF COLUMN ROPS2A.CLID */,
    NAME1 VARCHAR(50) /* TYPE OF COLUMN ROPS2A.NAME1 */,
    REGNR VARCHAR(15) /* TYPE OF COLUMN ROPS2A.REGNR */,
    RNAME VARCHAR(150) /* TYPE OF COLUMN ROPS2A.RNAME */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_REP_APGR_NP_12 (
    SDT DATE,
    EDT DATE,
    PAC VARCHAR(8),
    PACLEN INTEGER)
RETURNS (
    ID INTEGER /* TYPE OF COLUMN ROPS2A.ID */,
    SPID INTEGER /* TYPE OF COLUMN ROPS2A.SPID */,
    AC VARCHAR(8) /* TYPE OF COLUMN ROPS2A.AC */,
    RAC VARCHAR(8) /* TYPE OF COLUMN ROPS2A.RAC */,
    NAME VARCHAR(150) /* TYPE OF COLUMN ROPS2A.NAME */,
    B0 NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.B0 */,
    SDB NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.SDB */,
    SCR NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.SCR */,
    TDB NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.TDB */,
    TCR NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.TCR */,
    CLID VARCHAR(15) /* TYPE OF COLUMN ROPS2A.CLID */,
    NAME1 VARCHAR(50) /* TYPE OF COLUMN ROPS2A.NAME1 */,
    REGNR VARCHAR(15) /* TYPE OF COLUMN ROPS2A.REGNR */,
    RNAME VARCHAR(150) /* TYPE OF COLUMN ROPS2A.RNAME */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_REP_BAL_11 (
    SDT DATE,
    EDT DATE)
RETURNS (
    AC VARCHAR(8),
    S1 MONEY,
    S2 MONEY)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_REP_BAL_12 (
    SDT DATE,
    EDT DATE,
    PBALID VARCHAR(10))
RETURNS (
    ID INTEGER /* TYPE OF COLUMN BALA21.ID */,
    SPID INTEGER /* TYPE OF COLUMN BALA21.SPID */,
    BID INTEGER /* TYPE OF COLUMN BALA21.BID */,
    S1 NUMERIC(15,2) /* TYPE OF COLUMN BALA21.S1 */,
    S2 NUMERIC(15,2) /* TYPE OF COLUMN BALA21.S2 */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_REP_BAL_13 (
    PBALID VARCHAR(10))
RETURNS (
    AC VARCHAR(8) /* TYPE OF COLUMN ACP21.AC */,
    NAME VARCHAR(50) /* TYPE OF COLUMN ACP21.NAME */,
    ID1 VARCHAR(15) /* TYPE OF COLUMN ACP21.ID1 */,
    ID2 VARCHAR(15) /* TYPE OF COLUMN ACP21.ID2 */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_REP_BAL_21 (
    SDT DATE,
    EDT DATE)
RETURNS (
    AC VARCHAR(8),
    M0 MONEY,
    M1 MONEY,
    M2 MONEY,
    M3 MONEY,
    M4 MONEY,
    M5 MONEY,
    M6 MONEY,
    M7 MONEY,
    M8 MONEY,
    M9 MONEY,
    M10 MONEY,
    M11 MONEY,
    M12 MONEY)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_REP_BAL_22 (
    SDT DATE,
    EDT DATE,
    PBALID VARCHAR(10))
RETURNS (
    ID INTEGER,
    SPID INTEGER,
    BID INTEGER,
    M0 MONEY,
    M1 MONEY,
    M2 MONEY,
    M3 MONEY,
    M4 MONEY,
    M5 MONEY,
    M6 MONEY,
    M7 MONEY,
    M8 MONEY,
    M9 MONEY,
    M10 MONEY,
    M11 MONEY,
    M12 MONEY)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_REP_CURCHECK_01 (
    SDT DATE,
    EDT DATE,
    PAC VARCHAR(8),
    PCLID VARCHAR(8),
    PCUR VARCHAR(3))
RETURNS (
    ID INTEGER /* TYPE OF COLUMN ROPS1A.ID */,
    SPID INTEGER /* TYPE OF COLUMN ROPS1A.SPID */,
    DID INTEGER /* TYPE OF COLUMN ROPS1A.DID */,
    DETE DATE /* TYPE OF COLUMN ROPS1A.DETE */,
    NRX VARCHAR(5) /* TYPE OF COLUMN ROPS1A.NRX */,
    DOCTYP VARCHAR(10) /* TYPE OF COLUMN ROPS1A.DOCTYP */,
    DOCTYP1 VARCHAR(10) /* TYPE OF COLUMN ROPS1A.DOCTYP1 */,
    DOCTYP2 VARCHAR(10) /* TYPE OF COLUMN ROPS1A.DOCTYP2 */,
    DOCST VARCHAR(6) /* TYPE OF COLUMN ROPS1A.DOCST */,
    DOCNR VARCHAR(15) /* TYPE OF COLUMN ROPS1A.DOCNR */,
    CLID VARCHAR(15) /* TYPE OF COLUMN ROPS1A.CLID */,
    CLID2 VARCHAR(15) /* TYPE OF COLUMN ROPS1A.CLID2 */,
    NAME VARCHAR(50) /* TYPE OF COLUMN ROPS1A.NAME */,
    NAME2 VARCHAR(50) /* TYPE OF COLUMN ROPS1A.NAME2 */,
    REGNR VARCHAR(15) /* TYPE OF COLUMN ROPS1A.REGNR */,
    REGNR2 VARCHAR(15) /* TYPE OF COLUMN ROPS1A.REGNR2 */,
    B0 NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.B0 */,
    DESCR VARCHAR(80) /* TYPE OF COLUMN ROPS1A.DESCR */,
    DESCR2 VARCHAR(80) /* TYPE OF COLUMN ROPS1A.DESCR2 */,
    AC1 VARCHAR(8) /* TYPE OF COLUMN ROPS1A.AC1 */,
    AC2 VARCHAR(8) /* TYPE OF COLUMN ROPS1A.AC2 */,
    SAC1 VARCHAR(50) /* TYPE OF COLUMN ROPS1A.SAC1 */,
    SAC2 VARCHAR(50) /* TYPE OF COLUMN ROPS1A.SAC2 */,
    SUMMC NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.SUMMC */,
    CUR VARCHAR(3) /* TYPE OF COLUMN ROPS1A.CUR */,
    SUMM NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.SUMM */,
    PVN NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.PVN */,
    RAC VARCHAR(8) /* TYPE OF COLUMN ROPS1A.RAC */,
    SDB NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.SDB */,
    SCR NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.SCR */,
    RAC2 VARCHAR(8) /* TYPE OF COLUMN ROPS1A.RAC2 */,
    RAC3 VARCHAR(5) /* TYPE OF COLUMN ROPS1A.RAC3 */,
    RAC4 VARCHAR(8) /* TYPE OF COLUMN ROPS1A.RAC4 */,
    RAC5 VARCHAR(5) /* TYPE OF COLUMN ROPS1A.RAC5 */,
    QV FLOAT /* TYPE OF COLUMN ROPS1A.QV */,
    ZNR INTEGER /* TYPE OF COLUMN ROPS1A.ZNR */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_REP_CURRDIFF_01 (
    SDT DATE,
    EDT DATE,
    PAC VARCHAR(8),
    PCLID VARCHAR(8),
    PCUR VARCHAR(3))
RETURNS (
    ID INTEGER /* TYPE OF COLUMN ROPS2A.ID */,
    SPID INTEGER /* TYPE OF COLUMN ROPS2A.SPID */,
    AC VARCHAR(8) /* TYPE OF COLUMN ROPS2A.AC */,
    RAC VARCHAR(8) /* TYPE OF COLUMN ROPS2A.RAC */,
    NAME VARCHAR(150) /* TYPE OF COLUMN ROPS2A.NAME */,
    B0 NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.B0 */,
    SDB NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.SDB */,
    SCR NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.SCR */,
    TDB NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.TDB */,
    TCR NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.TCR */,
    CLID VARCHAR(15) /* TYPE OF COLUMN ROPS2A.CLID */,
    NAME1 VARCHAR(50) /* TYPE OF COLUMN ROPS2A.NAME1 */,
    REGNR VARCHAR(15) /* TYPE OF COLUMN ROPS2A.REGNR */,
    RNAME VARCHAR(150) /* TYPE OF COLUMN ROPS2A.RNAME */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_REP_DARZ_1 (
    SDT DATE,
    EDT DATE,
    PAC1 VARCHAR(8) /* TYPE OF COLUMN OPS.AC11 */,
    PAC3 VARCHAR(5) /* TYPE OF COLUMN OPS.AC13 */)
RETURNS (
    ID INTEGER /* TYPE OF COLUMN TREPDARZ1.ID */,
    SPID INTEGER /* TYPE OF COLUMN TREPDARZ1.SPID */,
    DID INTEGER /* TYPE OF COLUMN TREPDARZ1.DID */,
    RID INTEGER /* TYPE OF COLUMN TREPDARZ1.RID */,
    DETE DATE /* TYPE OF COLUMN TREPDARZ1.DETE */,
    NRX VARCHAR(5) /* TYPE OF COLUMN TREPDARZ1.NRX */,
    DOCTYP VARCHAR(10) /* TYPE OF COLUMN TREPDARZ1.DOCTYP */,
    DOCST VARCHAR(6) /* TYPE OF COLUMN TREPDARZ1.DOCST */,
    DOCNR VARCHAR(15) /* TYPE OF COLUMN TREPDARZ1.DOCNR */,
    CLID VARCHAR(15) /* TYPE OF COLUMN TREPDARZ1.CLID */,
    NAME VARCHAR(50) /* TYPE OF COLUMN TREPDARZ1.NAME */,
    REGNR VARCHAR(15) /* TYPE OF COLUMN TREPDARZ1.REGNR */,
    DESCR VARCHAR(80) /* TYPE OF COLUMN TREPDARZ1.DESCR */,
    AC1 VARCHAR(8) /* TYPE OF COLUMN TREPDARZ1.AC1 */,
    AC2 VARCHAR(8) /* TYPE OF COLUMN TREPDARZ1.AC2 */,
    AA NUMERIC(15,2) /* TYPE OF COLUMN TREPDARZ1.AA */,
    A1 NUMERIC(15,2) /* TYPE OF COLUMN TREPDARZ1.A1 */,
    A2 NUMERIC(15,2) /* TYPE OF COLUMN TREPDARZ1.A2 */,
    A3 NUMERIC(15,2) /* TYPE OF COLUMN TREPDARZ1.A3 */,
    A4 NUMERIC(15,2) /* TYPE OF COLUMN TREPDARZ1.A4 */,
    A5 NUMERIC(15,2) /* TYPE OF COLUMN TREPDARZ1.A5 */,
    A6 NUMERIC(15,2) /* TYPE OF COLUMN TREPDARZ1.A6 */,
    A7 NUMERIC(15,2) /* TYPE OF COLUMN TREPDARZ1.A7 */,
    A8 NUMERIC(15,2) /* TYPE OF COLUMN TREPDARZ1.A8 */,
    A9 NUMERIC(15,2) /* TYPE OF COLUMN TREPDARZ1.A9 */,
    A10 NUMERIC(15,2) /* TYPE OF COLUMN TREPDARZ1.A10 */,
    A11 NUMERIC(15,2) /* TYPE OF COLUMN TREPDARZ1.A11 */,
    A12 NUMERIC(15,2) /* TYPE OF COLUMN TREPDARZ1.A12 */,
    A13 NUMERIC(15,2) /* TYPE OF COLUMN TREPDARZ1.A13 */,
    A14 NUMERIC(15,2) /* TYPE OF COLUMN TREPDARZ1.A14 */,
    A15 NUMERIC(15,2) /* TYPE OF COLUMN TREPDARZ1.A15 */,
    A16 NUMERIC(15,2) /* TYPE OF COLUMN TREPDARZ1.A16 */,
    A17 NUMERIC(15,2) /* TYPE OF COLUMN TREPDARZ1.A17 */,
    A18 NUMERIC(15,2) /* TYPE OF COLUMN TREPDARZ1.A18 */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_REP_DARZ_2 (
    SDT DATE,
    EDT DATE,
    PAC1 VARCHAR(8) /* TYPE OF COLUMN OPS.AC11 */,
    PAC3 VARCHAR(5) /* TYPE OF COLUMN OPS.AC13 */)
RETURNS (
    ID INTEGER /* TYPE OF COLUMN TREPDARZ2.ID */,
    SPID INTEGER /* TYPE OF COLUMN TREPDARZ2.SPID */,
    RID0 INTEGER /* TYPE OF COLUMN TREPDARZ2.RID0 */,
    A1 NUMERIC(15,2) /* TYPE OF COLUMN TREPDARZ2.A1 */,
    A2 NUMERIC(15,2) /* TYPE OF COLUMN TREPDARZ2.A2 */,
    A3 NUMERIC(15,2) /* TYPE OF COLUMN TREPDARZ2.A3 */,
    A4 NUMERIC(15,2) /* TYPE OF COLUMN TREPDARZ2.A4 */,
    A5 NUMERIC(15,2) /* TYPE OF COLUMN TREPDARZ2.A5 */,
    A6 NUMERIC(15,2) /* TYPE OF COLUMN TREPDARZ2.A6 */,
    A7 NUMERIC(15,2) /* TYPE OF COLUMN TREPDARZ2.A7 */,
    A8 NUMERIC(15,2) /* TYPE OF COLUMN TREPDARZ2.A8 */,
    A9 NUMERIC(15,2) /* TYPE OF COLUMN TREPDARZ2.A9 */,
    A10 NUMERIC(15,2) /* TYPE OF COLUMN TREPDARZ2.A10 */,
    A11 NUMERIC(15,2) /* TYPE OF COLUMN TREPDARZ2.A11 */,
    A12 NUMERIC(15,2) /* TYPE OF COLUMN TREPDARZ2.A12 */,
    A13 NUMERIC(15,2) /* TYPE OF COLUMN TREPDARZ2.A13 */,
    A14 NUMERIC(15,2) /* TYPE OF COLUMN TREPDARZ2.A14 */,
    A15 NUMERIC(15,2) /* TYPE OF COLUMN TREPDARZ2.A15 */,
    A16 NUMERIC(15,2) /* TYPE OF COLUMN TREPDARZ2.A16 */,
    A17 NUMERIC(15,2) /* TYPE OF COLUMN TREPDARZ2.A17 */,
    A18 NUMERIC(15,2) /* TYPE OF COLUMN TREPDARZ2.A18 */,
    A19 NUMERIC(15,2) /* TYPE OF COLUMN TREPDARZ2.A19 */,
    A20 NUMERIC(15,2) /* TYPE OF COLUMN TREPDARZ2.A20 */,
    A21 NUMERIC(15,2) /* TYPE OF COLUMN TREPDARZ2.A21 */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_REP_DARZ_3 (
    SDT DATE,
    EDT DATE)
RETURNS (
    ID INTEGER /* TYPE OF COLUMN TREPDARZ1.ID */,
    SPID INTEGER /* TYPE OF COLUMN TREPDARZ1.SPID */,
    DID INTEGER /* TYPE OF COLUMN TREPDARZ1.DID */,
    RID INTEGER /* TYPE OF COLUMN TREPDARZ1.RID */,
    DETE DATE /* TYPE OF COLUMN TREPDARZ1.DETE */,
    NRX VARCHAR(5) /* TYPE OF COLUMN TREPDARZ1.NRX */,
    DOCTYP VARCHAR(10) /* TYPE OF COLUMN TREPDARZ1.DOCTYP */,
    DOCST VARCHAR(6) /* TYPE OF COLUMN TREPDARZ1.DOCST */,
    DOCNR VARCHAR(15) /* TYPE OF COLUMN TREPDARZ1.DOCNR */,
    CLID VARCHAR(15) /* TYPE OF COLUMN TREPDARZ1.CLID */,
    NAME VARCHAR(50) /* TYPE OF COLUMN TREPDARZ1.NAME */,
    REGNR VARCHAR(15) /* TYPE OF COLUMN TREPDARZ1.REGNR */,
    DESCR VARCHAR(80) /* TYPE OF COLUMN TREPDARZ1.DESCR */,
    AC1 VARCHAR(8) /* TYPE OF COLUMN TREPDARZ1.AC1 */,
    AC2 VARCHAR(8) /* TYPE OF COLUMN TREPDARZ1.AC2 */,
    AA NUMERIC(15,2) /* TYPE OF COLUMN TREPDARZ1.AA */,
    A1 NUMERIC(15,2) /* TYPE OF COLUMN TREPDARZ1.A1 */,
    A2 NUMERIC(15,2) /* TYPE OF COLUMN TREPDARZ1.A2 */,
    A3 NUMERIC(15,2) /* TYPE OF COLUMN TREPDARZ1.A3 */,
    A4 NUMERIC(15,2) /* TYPE OF COLUMN TREPDARZ1.A4 */,
    A5 NUMERIC(15,2) /* TYPE OF COLUMN TREPDARZ1.A5 */,
    A6 NUMERIC(15,2) /* TYPE OF COLUMN TREPDARZ1.A6 */,
    A7 NUMERIC(15,2) /* TYPE OF COLUMN TREPDARZ1.A7 */,
    A8 NUMERIC(15,2) /* TYPE OF COLUMN TREPDARZ1.A8 */,
    A9 NUMERIC(15,2) /* TYPE OF COLUMN TREPDARZ1.A9 */,
    A10 NUMERIC(15,2) /* TYPE OF COLUMN TREPDARZ1.A10 */,
    A11 NUMERIC(15,2) /* TYPE OF COLUMN TREPDARZ1.A11 */,
    A12 NUMERIC(15,2) /* TYPE OF COLUMN TREPDARZ1.A12 */,
    A13 NUMERIC(15,2) /* TYPE OF COLUMN TREPDARZ1.A13 */,
    A14 NUMERIC(15,2) /* TYPE OF COLUMN TREPDARZ1.A14 */,
    A15 NUMERIC(15,2) /* TYPE OF COLUMN TREPDARZ1.A15 */,
    A16 NUMERIC(15,2) /* TYPE OF COLUMN TREPDARZ1.A16 */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_REP_DARZ_4 (
    SDT DATE,
    EDT DATE)
RETURNS (
    ID INTEGER /* TYPE OF COLUMN TREPDARZ2.ID */,
    SPID INTEGER /* TYPE OF COLUMN TREPDARZ2.SPID */,
    RID0 INTEGER /* TYPE OF COLUMN TREPDARZ2.RID0 */,
    A1 NUMERIC(15,2) /* TYPE OF COLUMN TREPDARZ2.A1 */,
    A2 NUMERIC(15,2) /* TYPE OF COLUMN TREPDARZ2.A2 */,
    A3 NUMERIC(15,2) /* TYPE OF COLUMN TREPDARZ2.A3 */,
    A4 NUMERIC(15,2) /* TYPE OF COLUMN TREPDARZ2.A4 */,
    A5 NUMERIC(15,2) /* TYPE OF COLUMN TREPDARZ2.A5 */,
    A6 NUMERIC(15,2) /* TYPE OF COLUMN TREPDARZ2.A6 */,
    A7 NUMERIC(15,2) /* TYPE OF COLUMN TREPDARZ2.A7 */,
    A8 NUMERIC(15,2) /* TYPE OF COLUMN TREPDARZ2.A8 */,
    A9 NUMERIC(15,2) /* TYPE OF COLUMN TREPDARZ2.A9 */,
    A10 NUMERIC(15,2) /* TYPE OF COLUMN TREPDARZ2.A10 */,
    A11 NUMERIC(15,2) /* TYPE OF COLUMN TREPDARZ2.A11 */,
    A12 NUMERIC(15,2) /* TYPE OF COLUMN TREPDARZ2.A12 */,
    A13 NUMERIC(15,2) /* TYPE OF COLUMN TREPDARZ2.A13 */,
    A14 NUMERIC(15,2) /* TYPE OF COLUMN TREPDARZ2.A14 */,
    A15 NUMERIC(15,2) /* TYPE OF COLUMN TREPDARZ2.A15 */,
    A16 NUMERIC(15,2) /* TYPE OF COLUMN TREPDARZ2.A16 */,
    A17 NUMERIC(15,2) /* TYPE OF COLUMN TREPDARZ2.A17 */,
    A18 NUMERIC(15,2) /* TYPE OF COLUMN TREPDARZ2.A18 */,
    A19 NUMERIC(15,2) /* TYPE OF COLUMN TREPDARZ2.A19 */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_REP_DOKS_11 (
    PDATE1 DATE,
    PDATE2 DATE,
    PTEXT VARCHAR(50),
    PCLID VARCHAR(15),
    PAC11 VARCHAR(8),
    PAC12 VARCHAR(8),
    PAC13 VARCHAR(5),
    PAC14 VARCHAR(8),
    PAC15 VARCHAR(5),
    PAC21 VARCHAR(8),
    PAC22 VARCHAR(8),
    PAC23 VARCHAR(5),
    PAC24 VARCHAR(8),
    PAC25 VARCHAR(5),
    PDOCGR VARCHAR(10),
    PANDOR VARCHAR(3))
RETURNS (
    ID INTEGER /* TYPE OF COLUMN ROPS1A.ID */,
    SPID INTEGER /* TYPE OF COLUMN ROPS1A.SPID */,
    DID INTEGER /* TYPE OF COLUMN ROPS1A.DID */,
    DETE DATE /* TYPE OF COLUMN ROPS1A.DETE */,
    NRX VARCHAR(5) /* TYPE OF COLUMN ROPS1A.NRX */,
    DOCTYP VARCHAR(10) /* TYPE OF COLUMN ROPS1A.DOCTYP */,
    DOCTYP1 VARCHAR(10) /* TYPE OF COLUMN ROPS1A.DOCTYP1 */,
    DOCTYP2 VARCHAR(10) /* TYPE OF COLUMN ROPS1A.DOCTYP2 */,
    DOCST VARCHAR(6) /* TYPE OF COLUMN ROPS1A.DOCST */,
    DOCNR VARCHAR(15) /* TYPE OF COLUMN ROPS1A.DOCNR */,
    CLID VARCHAR(15) /* TYPE OF COLUMN ROPS1A.CLID */,
    CLID2 VARCHAR(15) /* TYPE OF COLUMN ROPS1A.CLID2 */,
    NAME VARCHAR(50) /* TYPE OF COLUMN ROPS1A.NAME */,
    NAME2 VARCHAR(50) /* TYPE OF COLUMN ROPS1A.NAME2 */,
    REGNR VARCHAR(15) /* TYPE OF COLUMN ROPS1A.REGNR */,
    REGNR2 VARCHAR(15) /* TYPE OF COLUMN ROPS1A.REGNR2 */,
    B0 NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.B0 */,
    DESCR VARCHAR(80) /* TYPE OF COLUMN ROPS1A.DESCR */,
    DESCR2 VARCHAR(80) /* TYPE OF COLUMN ROPS1A.DESCR2 */,
    AC1 VARCHAR(8) /* TYPE OF COLUMN ROPS1A.AC1 */,
    AC2 VARCHAR(8) /* TYPE OF COLUMN ROPS1A.AC2 */,
    SAC1 VARCHAR(50) /* TYPE OF COLUMN ROPS1A.SAC1 */,
    SAC2 VARCHAR(50) /* TYPE OF COLUMN ROPS1A.SAC2 */,
    SUMMC NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.SUMMC */,
    CUR VARCHAR(3) /* TYPE OF COLUMN ROPS1A.CUR */,
    SUMM NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.SUMM */,
    PVN NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.PVN */,
    RAC VARCHAR(8) /* TYPE OF COLUMN ROPS1A.RAC */,
    SDB NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.SDB */,
    SCR NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.SCR */,
    RAC2 VARCHAR(8) /* TYPE OF COLUMN ROPS1A.RAC2 */,
    RAC3 VARCHAR(5) /* TYPE OF COLUMN ROPS1A.RAC3 */,
    RAC4 VARCHAR(8) /* TYPE OF COLUMN ROPS1A.RAC4 */,
    RAC5 VARCHAR(5) /* TYPE OF COLUMN ROPS1A.RAC5 */,
    QV FLOAT /* TYPE OF COLUMN ROPS1A.QV */,
    ZNR INTEGER /* TYPE OF COLUMN ROPS1A.ZNR */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_REP_KG_11 (
    SDT DATE,
    EDT DATE,
    PAC VARCHAR(8))
RETURNS (
    ID INTEGER /* TYPE OF COLUMN ROPS1A.ID */,
    SPID INTEGER /* TYPE OF COLUMN ROPS1A.SPID */,
    DID INTEGER /* TYPE OF COLUMN ROPS1A.DID */,
    DETE DATE /* TYPE OF COLUMN ROPS1A.DETE */,
    NRX VARCHAR(5) /* TYPE OF COLUMN ROPS1A.NRX */,
    DOCTYP VARCHAR(10) /* TYPE OF COLUMN ROPS1A.DOCTYP */,
    DOCTYP1 VARCHAR(10) /* TYPE OF COLUMN ROPS1A.DOCTYP1 */,
    DOCTYP2 VARCHAR(10) /* TYPE OF COLUMN ROPS1A.DOCTYP2 */,
    DOCST VARCHAR(6) /* TYPE OF COLUMN ROPS1A.DOCST */,
    DOCNR VARCHAR(15) /* TYPE OF COLUMN ROPS1A.DOCNR */,
    CLID VARCHAR(15) /* TYPE OF COLUMN ROPS1A.CLID */,
    CLID2 VARCHAR(15) /* TYPE OF COLUMN ROPS1A.CLID2 */,
    NAME VARCHAR(50) /* TYPE OF COLUMN ROPS1A.NAME */,
    NAME2 VARCHAR(50) /* TYPE OF COLUMN ROPS1A.NAME2 */,
    REGNR VARCHAR(15) /* TYPE OF COLUMN ROPS1A.REGNR */,
    REGNR2 VARCHAR(15) /* TYPE OF COLUMN ROPS1A.REGNR2 */,
    B0 NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.B0 */,
    DESCR VARCHAR(80) /* TYPE OF COLUMN ROPS1A.DESCR */,
    DESCR2 VARCHAR(80) /* TYPE OF COLUMN ROPS1A.DESCR2 */,
    AC1 VARCHAR(8) /* TYPE OF COLUMN ROPS1A.AC1 */,
    AC2 VARCHAR(8) /* TYPE OF COLUMN ROPS1A.AC2 */,
    SAC1 VARCHAR(50) /* TYPE OF COLUMN ROPS1A.SAC1 */,
    SAC2 VARCHAR(50) /* TYPE OF COLUMN ROPS1A.SAC2 */,
    SUMMC NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.SUMMC */,
    CUR VARCHAR(3) /* TYPE OF COLUMN ROPS1A.CUR */,
    SUMM NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.SUMM */,
    PVN NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.PVN */,
    RAC VARCHAR(8) /* TYPE OF COLUMN ROPS1A.RAC */,
    SDB NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.SDB */,
    SCR NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.SCR */,
    RAC2 VARCHAR(8) /* TYPE OF COLUMN ROPS1A.RAC2 */,
    RAC3 VARCHAR(5) /* TYPE OF COLUMN ROPS1A.RAC3 */,
    RAC4 VARCHAR(8) /* TYPE OF COLUMN ROPS1A.RAC4 */,
    RAC5 VARCHAR(5) /* TYPE OF COLUMN ROPS1A.RAC5 */,
    QV FLOAT /* TYPE OF COLUMN ROPS1A.QV */,
    ZNR INTEGER /* TYPE OF COLUMN ROPS1A.ZNR */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_REP_KIEO_1 (
    PDID INTEGER)
RETURNS (
    ID INTEGER /* TYPE OF COLUMN ROPS1A.ID */,
    SPID INTEGER /* TYPE OF COLUMN ROPS1A.SPID */,
    DID INTEGER /* TYPE OF COLUMN ROPS1A.DID */,
    DETE DATE /* TYPE OF COLUMN ROPS1A.DETE */,
    NRX VARCHAR(5) /* TYPE OF COLUMN ROPS1A.NRX */,
    DOCTYP VARCHAR(10) /* TYPE OF COLUMN ROPS1A.DOCTYP */,
    DOCTYP1 VARCHAR(10) /* TYPE OF COLUMN ROPS1A.DOCTYP1 */,
    DOCTYP2 VARCHAR(10) /* TYPE OF COLUMN ROPS1A.DOCTYP2 */,
    DOCST VARCHAR(6) /* TYPE OF COLUMN ROPS1A.DOCST */,
    DOCNR VARCHAR(15) /* TYPE OF COLUMN ROPS1A.DOCNR */,
    CLID VARCHAR(15) /* TYPE OF COLUMN ROPS1A.CLID */,
    CLID2 VARCHAR(15) /* TYPE OF COLUMN ROPS1A.CLID2 */,
    NAME VARCHAR(50) /* TYPE OF COLUMN ROPS1A.NAME */,
    NAME2 VARCHAR(50) /* TYPE OF COLUMN ROPS1A.NAME2 */,
    REGNR VARCHAR(15) /* TYPE OF COLUMN ROPS1A.REGNR */,
    REGNR2 VARCHAR(15) /* TYPE OF COLUMN ROPS1A.REGNR2 */,
    B0 NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.B0 */,
    DESCR VARCHAR(80) /* TYPE OF COLUMN ROPS1A.DESCR */,
    DESCR2 VARCHAR(80) /* TYPE OF COLUMN ROPS1A.DESCR2 */,
    AC1 VARCHAR(8) /* TYPE OF COLUMN ROPS1A.AC1 */,
    AC2 VARCHAR(8) /* TYPE OF COLUMN ROPS1A.AC2 */,
    SAC1 VARCHAR(50) /* TYPE OF COLUMN ROPS1A.SAC1 */,
    SAC2 VARCHAR(50) /* TYPE OF COLUMN ROPS1A.SAC2 */,
    SUMMC NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.SUMMC */,
    CUR VARCHAR(3) /* TYPE OF COLUMN ROPS1A.CUR */,
    SUMM NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.SUMM */,
    PVN NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.PVN */,
    RAC VARCHAR(8) /* TYPE OF COLUMN ROPS1A.RAC */,
    SDB NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.SDB */,
    SCR NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.SCR */,
    RAC2 VARCHAR(8) /* TYPE OF COLUMN ROPS1A.RAC2 */,
    RAC3 VARCHAR(5) /* TYPE OF COLUMN ROPS1A.RAC3 */,
    RAC4 VARCHAR(8) /* TYPE OF COLUMN ROPS1A.RAC4 */,
    RAC5 VARCHAR(5) /* TYPE OF COLUMN ROPS1A.RAC5 */,
    QV FLOAT /* TYPE OF COLUMN ROPS1A.QV */,
    ZNR INTEGER /* TYPE OF COLUMN ROPS1A.ZNR */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_REP_KIEO_21 (
    SDT DATE,
    EDT DATE,
    PAC VARCHAR(8))
RETURNS (
    ID INTEGER /* TYPE OF COLUMN ROPS1A.ID */,
    SPID INTEGER /* TYPE OF COLUMN ROPS1A.SPID */,
    DID INTEGER /* TYPE OF COLUMN ROPS1A.DID */,
    DETE DATE /* TYPE OF COLUMN ROPS1A.DETE */,
    NRX VARCHAR(5) /* TYPE OF COLUMN ROPS1A.NRX */,
    DOCTYP VARCHAR(10) /* TYPE OF COLUMN ROPS1A.DOCTYP */,
    DOCTYP1 VARCHAR(10) /* TYPE OF COLUMN ROPS1A.DOCTYP1 */,
    DOCTYP2 VARCHAR(10) /* TYPE OF COLUMN ROPS1A.DOCTYP2 */,
    DOCST VARCHAR(6) /* TYPE OF COLUMN ROPS1A.DOCST */,
    DOCNR VARCHAR(15) /* TYPE OF COLUMN ROPS1A.DOCNR */,
    CLID VARCHAR(15) /* TYPE OF COLUMN ROPS1A.CLID */,
    CLID2 VARCHAR(15) /* TYPE OF COLUMN ROPS1A.CLID2 */,
    NAME VARCHAR(50) /* TYPE OF COLUMN ROPS1A.NAME */,
    NAME2 VARCHAR(50) /* TYPE OF COLUMN ROPS1A.NAME2 */,
    REGNR VARCHAR(15) /* TYPE OF COLUMN ROPS1A.REGNR */,
    REGNR2 VARCHAR(15) /* TYPE OF COLUMN ROPS1A.REGNR2 */,
    B0 NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.B0 */,
    DESCR VARCHAR(80) /* TYPE OF COLUMN ROPS1A.DESCR */,
    DESCR2 VARCHAR(80) /* TYPE OF COLUMN ROPS1A.DESCR2 */,
    AC1 VARCHAR(8) /* TYPE OF COLUMN ROPS1A.AC1 */,
    AC2 VARCHAR(8) /* TYPE OF COLUMN ROPS1A.AC2 */,
    SAC1 VARCHAR(50) /* TYPE OF COLUMN ROPS1A.SAC1 */,
    SAC2 VARCHAR(50) /* TYPE OF COLUMN ROPS1A.SAC2 */,
    SUMMC NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.SUMMC */,
    CUR VARCHAR(3) /* TYPE OF COLUMN ROPS1A.CUR */,
    SUMM NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.SUMM */,
    PVN NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.PVN */,
    RAC VARCHAR(8) /* TYPE OF COLUMN ROPS1A.RAC */,
    SDB NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.SDB */,
    SCR NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.SCR */,
    RAC2 VARCHAR(8) /* TYPE OF COLUMN ROPS1A.RAC2 */,
    RAC3 VARCHAR(5) /* TYPE OF COLUMN ROPS1A.RAC3 */,
    RAC4 VARCHAR(8) /* TYPE OF COLUMN ROPS1A.RAC4 */,
    RAC5 VARCHAR(5) /* TYPE OF COLUMN ROPS1A.RAC5 */,
    QV FLOAT /* TYPE OF COLUMN ROPS1A.QV */,
    ZNR INTEGER /* TYPE OF COLUMN ROPS1A.ZNR */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_REP_KIZO_21 (
    SDT DATE,
    EDT DATE,
    PAC VARCHAR(8))
RETURNS (
    ID INTEGER /* TYPE OF COLUMN ROPS1A.ID */,
    SPID INTEGER /* TYPE OF COLUMN ROPS1A.SPID */,
    DID INTEGER /* TYPE OF COLUMN ROPS1A.DID */,
    DETE DATE /* TYPE OF COLUMN ROPS1A.DETE */,
    NRX VARCHAR(5) /* TYPE OF COLUMN ROPS1A.NRX */,
    DOCTYP VARCHAR(10) /* TYPE OF COLUMN ROPS1A.DOCTYP */,
    DOCTYP1 VARCHAR(10) /* TYPE OF COLUMN ROPS1A.DOCTYP1 */,
    DOCTYP2 VARCHAR(10) /* TYPE OF COLUMN ROPS1A.DOCTYP2 */,
    DOCST VARCHAR(6) /* TYPE OF COLUMN ROPS1A.DOCST */,
    DOCNR VARCHAR(15) /* TYPE OF COLUMN ROPS1A.DOCNR */,
    CLID VARCHAR(15) /* TYPE OF COLUMN ROPS1A.CLID */,
    CLID2 VARCHAR(15) /* TYPE OF COLUMN ROPS1A.CLID2 */,
    NAME VARCHAR(50) /* TYPE OF COLUMN ROPS1A.NAME */,
    NAME2 VARCHAR(50) /* TYPE OF COLUMN ROPS1A.NAME2 */,
    REGNR VARCHAR(15) /* TYPE OF COLUMN ROPS1A.REGNR */,
    REGNR2 VARCHAR(15) /* TYPE OF COLUMN ROPS1A.REGNR2 */,
    B0 NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.B0 */,
    DESCR VARCHAR(80) /* TYPE OF COLUMN ROPS1A.DESCR */,
    DESCR2 VARCHAR(80) /* TYPE OF COLUMN ROPS1A.DESCR2 */,
    AC1 VARCHAR(8) /* TYPE OF COLUMN ROPS1A.AC1 */,
    AC2 VARCHAR(8) /* TYPE OF COLUMN ROPS1A.AC2 */,
    SAC1 VARCHAR(50) /* TYPE OF COLUMN ROPS1A.SAC1 */,
    SAC2 VARCHAR(50) /* TYPE OF COLUMN ROPS1A.SAC2 */,
    SUMMC NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.SUMMC */,
    CUR VARCHAR(3) /* TYPE OF COLUMN ROPS1A.CUR */,
    SUMM NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.SUMM */,
    PVN NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.PVN */,
    RAC VARCHAR(8) /* TYPE OF COLUMN ROPS1A.RAC */,
    SDB NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.SDB */,
    SCR NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.SCR */,
    RAC2 VARCHAR(8) /* TYPE OF COLUMN ROPS1A.RAC2 */,
    RAC3 VARCHAR(5) /* TYPE OF COLUMN ROPS1A.RAC3 */,
    RAC4 VARCHAR(8) /* TYPE OF COLUMN ROPS1A.RAC4 */,
    RAC5 VARCHAR(5) /* TYPE OF COLUMN ROPS1A.RAC5 */,
    QV FLOAT /* TYPE OF COLUMN ROPS1A.QV */,
    ZNR INTEGER /* TYPE OF COLUMN ROPS1A.ZNR */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_REP_KORESP_01 (
    SDT DATE,
    EDT DATE,
    PAC VARCHAR(8))
RETURNS (
    ID INTEGER /* TYPE OF COLUMN ROPS3A.ID */,
    SPID INTEGER /* TYPE OF COLUMN ROPS3A.SPID */,
    RAC VARCHAR(8) /* TYPE OF COLUMN ROPS3A.RAC */,
    NAME VARCHAR(50) /* TYPE OF COLUMN ROPS3A.NAME */,
    SDB NUMERIC(15,2) /* TYPE OF COLUMN ROPS3A.SDB */,
    SCR NUMERIC(15,2) /* TYPE OF COLUMN ROPS3A.SCR */,
    AC1 VARCHAR(8) /* TYPE OF COLUMN ROPS3A.AC1 */,
    CLID VARCHAR(15) /* TYPE OF COLUMN ROPS3A.CLID */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_REP_KORESP_01_CLID (
    SDT DATE,
    EDT DATE,
    PAC VARCHAR(8),
    PCLID VARCHAR(15))
RETURNS (
    ID INTEGER /* TYPE OF COLUMN ROPS3A.ID */,
    SPID INTEGER /* TYPE OF COLUMN ROPS3A.SPID */,
    RAC VARCHAR(8) /* TYPE OF COLUMN ROPS3A.RAC */,
    NAME VARCHAR(50) /* TYPE OF COLUMN ROPS3A.NAME */,
    SDB NUMERIC(15,2) /* TYPE OF COLUMN ROPS3A.SDB */,
    SCR NUMERIC(15,2) /* TYPE OF COLUMN ROPS3A.SCR */,
    AC1 VARCHAR(8) /* TYPE OF COLUMN ROPS3A.AC1 */,
    CLID VARCHAR(15) /* TYPE OF COLUMN ROPS3A.CLID */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_REP_KORESP_01_CLID2 (
    SDT DATE,
    EDT DATE,
    PAC VARCHAR(8),
    PCLID VARCHAR(15))
RETURNS (
    ID INTEGER /* TYPE OF COLUMN ROPS3A.ID */,
    SPID INTEGER /* TYPE OF COLUMN ROPS3A.SPID */,
    RAC VARCHAR(8) /* TYPE OF COLUMN ROPS3A.RAC */,
    NAME VARCHAR(50) /* TYPE OF COLUMN ROPS3A.NAME */,
    SDB NUMERIC(15,2) /* TYPE OF COLUMN ROPS3A.SDB */,
    SCR NUMERIC(15,2) /* TYPE OF COLUMN ROPS3A.SCR */,
    AC1 VARCHAR(8) /* TYPE OF COLUMN ROPS3A.AC1 */,
    CLID VARCHAR(15) /* TYPE OF COLUMN ROPS3A.CLID */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_REP_KORESP_01_CUR (
    SDT DATE,
    EDT DATE,
    PAC VARCHAR(8),
    PCLID VARCHAR(15),
    PCUR VARCHAR(3))
RETURNS (
    ID INTEGER /* TYPE OF COLUMN ROPS3A.ID */,
    SPID INTEGER /* TYPE OF COLUMN ROPS3A.SPID */,
    RAC VARCHAR(8) /* TYPE OF COLUMN ROPS3A.RAC */,
    NAME VARCHAR(50) /* TYPE OF COLUMN ROPS3A.NAME */,
    SDB NUMERIC(15,2) /* TYPE OF COLUMN ROPS3A.SDB */,
    SCR NUMERIC(15,2) /* TYPE OF COLUMN ROPS3A.SCR */,
    AC1 VARCHAR(8) /* TYPE OF COLUMN ROPS3A.AC1 */,
    CLID VARCHAR(15) /* TYPE OF COLUMN ROPS3A.CLID */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_REP_KORESP_02 (
    SDT DATE,
    EDT DATE,
    PAC VARCHAR(8))
RETURNS (
    ID INTEGER /* TYPE OF COLUMN ROPS3A.ID */,
    SPID INTEGER /* TYPE OF COLUMN ROPS3A.SPID */,
    RAC VARCHAR(8) /* TYPE OF COLUMN ROPS3A.RAC */,
    NAME VARCHAR(50) /* TYPE OF COLUMN ROPS3A.NAME */,
    SDB NUMERIC(15,2) /* TYPE OF COLUMN ROPS3A.SDB */,
    SCR NUMERIC(15,2) /* TYPE OF COLUMN ROPS3A.SCR */,
    AC1 VARCHAR(8) /* TYPE OF COLUMN ROPS3A.AC1 */,
    CLID VARCHAR(15) /* TYPE OF COLUMN ROPS3A.CLID */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_REP_KORESP_02_CLID (
    SDT DATE,
    EDT DATE,
    PAC VARCHAR(8),
    PCLID VARCHAR(15))
RETURNS (
    ID INTEGER /* TYPE OF COLUMN ROPS3A.ID */,
    SPID INTEGER /* TYPE OF COLUMN ROPS3A.SPID */,
    RAC VARCHAR(8) /* TYPE OF COLUMN ROPS3A.RAC */,
    NAME VARCHAR(50) /* TYPE OF COLUMN ROPS3A.NAME */,
    SDB NUMERIC(15,2) /* TYPE OF COLUMN ROPS3A.SDB */,
    SCR NUMERIC(15,2) /* TYPE OF COLUMN ROPS3A.SCR */,
    AC1 VARCHAR(8) /* TYPE OF COLUMN ROPS3A.AC1 */,
    CLID VARCHAR(15) /* TYPE OF COLUMN ROPS3A.CLID */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_REP_KORESP_11 (
    PSD DATE,
    PED DATE,
    PAC VARCHAR(8))
RETURNS (
    ID INTEGER /* TYPE OF COLUMN ROPS1A.ID */,
    SPID INTEGER /* TYPE OF COLUMN ROPS1A.SPID */,
    DID INTEGER /* TYPE OF COLUMN ROPS1A.DID */,
    DETE DATE /* TYPE OF COLUMN ROPS1A.DETE */,
    NRX VARCHAR(5) /* TYPE OF COLUMN ROPS1A.NRX */,
    DOCTYP VARCHAR(10) /* TYPE OF COLUMN ROPS1A.DOCTYP */,
    DOCTYP1 VARCHAR(10) /* TYPE OF COLUMN ROPS1A.DOCTYP1 */,
    DOCTYP2 VARCHAR(10) /* TYPE OF COLUMN ROPS1A.DOCTYP2 */,
    DOCST VARCHAR(6) /* TYPE OF COLUMN ROPS1A.DOCST */,
    DOCNR VARCHAR(15) /* TYPE OF COLUMN ROPS1A.DOCNR */,
    CLID VARCHAR(15) /* TYPE OF COLUMN ROPS1A.CLID */,
    CLID2 VARCHAR(15) /* TYPE OF COLUMN ROPS1A.CLID2 */,
    NAME VARCHAR(50) /* TYPE OF COLUMN ROPS1A.NAME */,
    NAME2 VARCHAR(50) /* TYPE OF COLUMN ROPS1A.NAME2 */,
    REGNR VARCHAR(15) /* TYPE OF COLUMN ROPS1A.REGNR */,
    REGNR2 VARCHAR(15) /* TYPE OF COLUMN ROPS1A.REGNR2 */,
    B0 NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.B0 */,
    DESCR VARCHAR(80) /* TYPE OF COLUMN ROPS1A.DESCR */,
    DESCR2 VARCHAR(80) /* TYPE OF COLUMN ROPS1A.DESCR2 */,
    AC1 VARCHAR(8) /* TYPE OF COLUMN ROPS1A.AC1 */,
    AC2 VARCHAR(8) /* TYPE OF COLUMN ROPS1A.AC2 */,
    SAC1 VARCHAR(50) /* TYPE OF COLUMN ROPS1A.SAC1 */,
    SAC2 VARCHAR(50) /* TYPE OF COLUMN ROPS1A.SAC2 */,
    SUMMC NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.SUMMC */,
    CUR VARCHAR(3) /* TYPE OF COLUMN ROPS1A.CUR */,
    SUMM NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.SUMM */,
    PVN NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.PVN */,
    RAC VARCHAR(8) /* TYPE OF COLUMN ROPS1A.RAC */,
    SDB NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.SDB */,
    SCR NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.SCR */,
    RAC2 VARCHAR(8) /* TYPE OF COLUMN ROPS1A.RAC2 */,
    RAC3 VARCHAR(5) /* TYPE OF COLUMN ROPS1A.RAC3 */,
    RAC4 VARCHAR(8) /* TYPE OF COLUMN ROPS1A.RAC4 */,
    RAC5 VARCHAR(5) /* TYPE OF COLUMN ROPS1A.RAC5 */,
    QV FLOAT /* TYPE OF COLUMN ROPS1A.QV */,
    ZNR INTEGER /* TYPE OF COLUMN ROPS1A.ZNR */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_REP_KORESP_11_CLID (
    PSD DATE,
    PED DATE,
    PAC VARCHAR(8),
    PCLID VARCHAR(15))
RETURNS (
    ID INTEGER /* TYPE OF COLUMN ROPS1A.ID */,
    SPID INTEGER /* TYPE OF COLUMN ROPS1A.SPID */,
    DID INTEGER /* TYPE OF COLUMN ROPS1A.DID */,
    DETE DATE /* TYPE OF COLUMN ROPS1A.DETE */,
    NRX VARCHAR(5) /* TYPE OF COLUMN ROPS1A.NRX */,
    DOCTYP VARCHAR(10) /* TYPE OF COLUMN ROPS1A.DOCTYP */,
    DOCTYP1 VARCHAR(10) /* TYPE OF COLUMN ROPS1A.DOCTYP1 */,
    DOCTYP2 VARCHAR(10) /* TYPE OF COLUMN ROPS1A.DOCTYP2 */,
    DOCST VARCHAR(6) /* TYPE OF COLUMN ROPS1A.DOCST */,
    DOCNR VARCHAR(15) /* TYPE OF COLUMN ROPS1A.DOCNR */,
    CLID VARCHAR(15) /* TYPE OF COLUMN ROPS1A.CLID */,
    CLID2 VARCHAR(15) /* TYPE OF COLUMN ROPS1A.CLID2 */,
    NAME VARCHAR(50) /* TYPE OF COLUMN ROPS1A.NAME */,
    NAME2 VARCHAR(50) /* TYPE OF COLUMN ROPS1A.NAME2 */,
    REGNR VARCHAR(15) /* TYPE OF COLUMN ROPS1A.REGNR */,
    REGNR2 VARCHAR(15) /* TYPE OF COLUMN ROPS1A.REGNR2 */,
    B0 NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.B0 */,
    DESCR VARCHAR(80) /* TYPE OF COLUMN ROPS1A.DESCR */,
    DESCR2 VARCHAR(80) /* TYPE OF COLUMN ROPS1A.DESCR2 */,
    AC1 VARCHAR(8) /* TYPE OF COLUMN ROPS1A.AC1 */,
    AC2 VARCHAR(8) /* TYPE OF COLUMN ROPS1A.AC2 */,
    SAC1 VARCHAR(50) /* TYPE OF COLUMN ROPS1A.SAC1 */,
    SAC2 VARCHAR(50) /* TYPE OF COLUMN ROPS1A.SAC2 */,
    SUMMC NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.SUMMC */,
    CUR VARCHAR(3) /* TYPE OF COLUMN ROPS1A.CUR */,
    SUMM NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.SUMM */,
    PVN NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.PVN */,
    RAC VARCHAR(8) /* TYPE OF COLUMN ROPS1A.RAC */,
    SDB NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.SDB */,
    SCR NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.SCR */,
    RAC2 VARCHAR(8) /* TYPE OF COLUMN ROPS1A.RAC2 */,
    RAC3 VARCHAR(5) /* TYPE OF COLUMN ROPS1A.RAC3 */,
    RAC4 VARCHAR(8) /* TYPE OF COLUMN ROPS1A.RAC4 */,
    RAC5 VARCHAR(5) /* TYPE OF COLUMN ROPS1A.RAC5 */,
    QV FLOAT /* TYPE OF COLUMN ROPS1A.QV */,
    ZNR INTEGER /* TYPE OF COLUMN ROPS1A.ZNR */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_REP_KORESP_11_CLID2 (
    PSD DATE,
    PED DATE,
    PAC VARCHAR(8),
    PCLID VARCHAR(15))
RETURNS (
    ID INTEGER /* TYPE OF COLUMN ROPS1A.ID */,
    SPID INTEGER /* TYPE OF COLUMN ROPS1A.SPID */,
    DID INTEGER /* TYPE OF COLUMN ROPS1A.DID */,
    DETE DATE /* TYPE OF COLUMN ROPS1A.DETE */,
    NRX VARCHAR(5) /* TYPE OF COLUMN ROPS1A.NRX */,
    DOCTYP VARCHAR(10) /* TYPE OF COLUMN ROPS1A.DOCTYP */,
    DOCTYP1 VARCHAR(10) /* TYPE OF COLUMN ROPS1A.DOCTYP1 */,
    DOCTYP2 VARCHAR(10) /* TYPE OF COLUMN ROPS1A.DOCTYP2 */,
    DOCST VARCHAR(6) /* TYPE OF COLUMN ROPS1A.DOCST */,
    DOCNR VARCHAR(15) /* TYPE OF COLUMN ROPS1A.DOCNR */,
    CLID VARCHAR(15) /* TYPE OF COLUMN ROPS1A.CLID */,
    CLID2 VARCHAR(15) /* TYPE OF COLUMN ROPS1A.CLID2 */,
    NAME VARCHAR(50) /* TYPE OF COLUMN ROPS1A.NAME */,
    NAME2 VARCHAR(50) /* TYPE OF COLUMN ROPS1A.NAME2 */,
    REGNR VARCHAR(15) /* TYPE OF COLUMN ROPS1A.REGNR */,
    REGNR2 VARCHAR(15) /* TYPE OF COLUMN ROPS1A.REGNR2 */,
    B0 NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.B0 */,
    DESCR VARCHAR(80) /* TYPE OF COLUMN ROPS1A.DESCR */,
    DESCR2 VARCHAR(80) /* TYPE OF COLUMN ROPS1A.DESCR2 */,
    AC1 VARCHAR(8) /* TYPE OF COLUMN ROPS1A.AC1 */,
    AC2 VARCHAR(8) /* TYPE OF COLUMN ROPS1A.AC2 */,
    SAC1 VARCHAR(50) /* TYPE OF COLUMN ROPS1A.SAC1 */,
    SAC2 VARCHAR(50) /* TYPE OF COLUMN ROPS1A.SAC2 */,
    SUMMC NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.SUMMC */,
    CUR VARCHAR(3) /* TYPE OF COLUMN ROPS1A.CUR */,
    SUMM NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.SUMM */,
    PVN NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.PVN */,
    RAC VARCHAR(8) /* TYPE OF COLUMN ROPS1A.RAC */,
    SDB NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.SDB */,
    SCR NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.SCR */,
    RAC2 VARCHAR(8) /* TYPE OF COLUMN ROPS1A.RAC2 */,
    RAC3 VARCHAR(5) /* TYPE OF COLUMN ROPS1A.RAC3 */,
    RAC4 VARCHAR(8) /* TYPE OF COLUMN ROPS1A.RAC4 */,
    RAC5 VARCHAR(5) /* TYPE OF COLUMN ROPS1A.RAC5 */,
    QV FLOAT /* TYPE OF COLUMN ROPS1A.QV */,
    ZNR INTEGER /* TYPE OF COLUMN ROPS1A.ZNR */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_REP_KORESP_11_CUR (
    PSD DATE,
    PED DATE,
    PAC VARCHAR(8),
    PCLID VARCHAR(15),
    PCUR VARCHAR(3))
RETURNS (
    ID INTEGER /* TYPE OF COLUMN ROPS1A.ID */,
    SPID INTEGER /* TYPE OF COLUMN ROPS1A.SPID */,
    DID INTEGER /* TYPE OF COLUMN ROPS1A.DID */,
    DETE DATE /* TYPE OF COLUMN ROPS1A.DETE */,
    NRX VARCHAR(5) /* TYPE OF COLUMN ROPS1A.NRX */,
    DOCTYP VARCHAR(10) /* TYPE OF COLUMN ROPS1A.DOCTYP */,
    DOCTYP1 VARCHAR(10) /* TYPE OF COLUMN ROPS1A.DOCTYP1 */,
    DOCTYP2 VARCHAR(10) /* TYPE OF COLUMN ROPS1A.DOCTYP2 */,
    DOCST VARCHAR(6) /* TYPE OF COLUMN ROPS1A.DOCST */,
    DOCNR VARCHAR(15) /* TYPE OF COLUMN ROPS1A.DOCNR */,
    CLID VARCHAR(15) /* TYPE OF COLUMN ROPS1A.CLID */,
    CLID2 VARCHAR(15) /* TYPE OF COLUMN ROPS1A.CLID2 */,
    NAME VARCHAR(50) /* TYPE OF COLUMN ROPS1A.NAME */,
    NAME2 VARCHAR(50) /* TYPE OF COLUMN ROPS1A.NAME2 */,
    REGNR VARCHAR(15) /* TYPE OF COLUMN ROPS1A.REGNR */,
    REGNR2 VARCHAR(15) /* TYPE OF COLUMN ROPS1A.REGNR2 */,
    B0 NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.B0 */,
    DESCR VARCHAR(80) /* TYPE OF COLUMN ROPS1A.DESCR */,
    DESCR2 VARCHAR(80) /* TYPE OF COLUMN ROPS1A.DESCR2 */,
    AC1 VARCHAR(8) /* TYPE OF COLUMN ROPS1A.AC1 */,
    AC2 VARCHAR(8) /* TYPE OF COLUMN ROPS1A.AC2 */,
    SAC1 VARCHAR(50) /* TYPE OF COLUMN ROPS1A.SAC1 */,
    SAC2 VARCHAR(50) /* TYPE OF COLUMN ROPS1A.SAC2 */,
    SUMMC NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.SUMMC */,
    CUR VARCHAR(3) /* TYPE OF COLUMN ROPS1A.CUR */,
    SUMM NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.SUMM */,
    PVN NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.PVN */,
    RAC VARCHAR(8) /* TYPE OF COLUMN ROPS1A.RAC */,
    SDB NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.SDB */,
    SCR NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.SCR */,
    RAC2 VARCHAR(8) /* TYPE OF COLUMN ROPS1A.RAC2 */,
    RAC3 VARCHAR(5) /* TYPE OF COLUMN ROPS1A.RAC3 */,
    RAC4 VARCHAR(8) /* TYPE OF COLUMN ROPS1A.RAC4 */,
    RAC5 VARCHAR(5) /* TYPE OF COLUMN ROPS1A.RAC5 */,
    QV FLOAT /* TYPE OF COLUMN ROPS1A.QV */,
    ZNR INTEGER /* TYPE OF COLUMN ROPS1A.ZNR */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_REP_NPMT_11 (
    SDT DATE,
    EDT DATE,
    PAD VARCHAR(3))
RETURNS (
    ID INTEGER /* TYPE OF COLUMN TREPMT.ID */,
    SPID INTEGER /* TYPE OF COLUMN TREPMT.SPID */,
    AD VARCHAR(3) /* TYPE OF COLUMN TREPMT.AD */,
    AC1 VARCHAR(15) /* TYPE OF COLUMN TREPMT.AC1 */,
    AC2 VARCHAR(15) /* TYPE OF COLUMN TREPMT.AC2 */,
    ACN1 VARCHAR(50) /* TYPE OF COLUMN TREPMT.ACN1 */,
    ACN2 VARCHAR(50) /* TYPE OF COLUMN TREPMT.ACN2 */,
    M1 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M1 */,
    M2 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M2 */,
    M3 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M3 */,
    M4 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M4 */,
    M5 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M5 */,
    M6 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M6 */,
    M7 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M7 */,
    M8 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M8 */,
    M9 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M9 */,
    M10 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M10 */,
    M11 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M11 */,
    M12 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M12 */,
    N1 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N1 */,
    N2 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N2 */,
    N3 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N3 */,
    N4 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N4 */,
    N5 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N5 */,
    N6 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N6 */,
    N7 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N7 */,
    N8 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N8 */,
    N9 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N9 */,
    N10 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N10 */,
    N11 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N11 */,
    N12 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N12 */,
    MT NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.MT */,
    NT NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.NT */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_REP_NPMT_12 (
    SDT DATE,
    EDT DATE,
    PAD VARCHAR(3))
RETURNS (
    ID INTEGER /* TYPE OF COLUMN TREPMT.ID */,
    SPID INTEGER /* TYPE OF COLUMN TREPMT.SPID */,
    AD VARCHAR(3) /* TYPE OF COLUMN TREPMT.AD */,
    AC1 VARCHAR(15) /* TYPE OF COLUMN TREPMT.AC1 */,
    AC2 VARCHAR(15) /* TYPE OF COLUMN TREPMT.AC2 */,
    ACN1 VARCHAR(50) /* TYPE OF COLUMN TREPMT.ACN1 */,
    ACN2 VARCHAR(50) /* TYPE OF COLUMN TREPMT.ACN2 */,
    M1 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M1 */,
    M2 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M2 */,
    M3 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M3 */,
    M4 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M4 */,
    M5 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M5 */,
    M6 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M6 */,
    M7 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M7 */,
    M8 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M8 */,
    M9 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M9 */,
    M10 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M10 */,
    M11 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M11 */,
    M12 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M12 */,
    N1 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N1 */,
    N2 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N2 */,
    N3 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N3 */,
    N4 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N4 */,
    N5 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N5 */,
    N6 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N6 */,
    N7 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N7 */,
    N8 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N8 */,
    N9 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N9 */,
    N10 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N10 */,
    N11 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N11 */,
    N12 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N12 */,
    MT NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.MT */,
    NT NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.NT */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_REP_NPMT_13 (
    SDT DATE,
    EDT DATE,
    PAD VARCHAR(3))
RETURNS (
    ID INTEGER /* TYPE OF COLUMN TREPMT.ID */,
    SPID INTEGER /* TYPE OF COLUMN TREPMT.SPID */,
    AD VARCHAR(3) /* TYPE OF COLUMN TREPMT.AD */,
    AC1 VARCHAR(15) /* TYPE OF COLUMN TREPMT.AC1 */,
    AC2 VARCHAR(15) /* TYPE OF COLUMN TREPMT.AC2 */,
    ACN1 VARCHAR(50) /* TYPE OF COLUMN TREPMT.ACN1 */,
    ACN2 VARCHAR(50) /* TYPE OF COLUMN TREPMT.ACN2 */,
    M1 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M1 */,
    M2 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M2 */,
    M3 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M3 */,
    M4 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M4 */,
    M5 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M5 */,
    M6 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M6 */,
    M7 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M7 */,
    M8 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M8 */,
    M9 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M9 */,
    M10 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M10 */,
    M11 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M11 */,
    M12 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M12 */,
    N1 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N1 */,
    N2 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N2 */,
    N3 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N3 */,
    N4 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N4 */,
    N5 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N5 */,
    N6 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N6 */,
    N7 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N7 */,
    N8 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N8 */,
    N9 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N9 */,
    N10 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N10 */,
    N11 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N11 */,
    N12 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N12 */,
    MT NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.MT */,
    NT NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.NT */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_REP_NPMT_14 (
    SDT DATE,
    EDT DATE)
RETURNS (
    ID INTEGER /* TYPE OF COLUMN TREPMT.ID */,
    SPID INTEGER /* TYPE OF COLUMN TREPMT.SPID */,
    AD VARCHAR(3) /* TYPE OF COLUMN TREPMT.AD */,
    AC1 VARCHAR(15) /* TYPE OF COLUMN TREPMT.AC1 */,
    AC2 VARCHAR(15) /* TYPE OF COLUMN TREPMT.AC2 */,
    ACN1 VARCHAR(50) /* TYPE OF COLUMN TREPMT.ACN1 */,
    ACN2 VARCHAR(50) /* TYPE OF COLUMN TREPMT.ACN2 */,
    M1 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M1 */,
    M2 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M2 */,
    M3 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M3 */,
    M4 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M4 */,
    M5 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M5 */,
    M6 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M6 */,
    M7 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M7 */,
    M8 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M8 */,
    M9 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M9 */,
    M10 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M10 */,
    M11 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M11 */,
    M12 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M12 */,
    N1 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N1 */,
    N2 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N2 */,
    N3 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N3 */,
    N4 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N4 */,
    N5 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N5 */,
    N6 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N6 */,
    N7 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N7 */,
    N8 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N8 */,
    N9 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N9 */,
    N10 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N10 */,
    N11 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N11 */,
    N12 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N12 */,
    MT NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.MT */,
    NT NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.NT */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_REP_NPMT_21 (
    SDT DATE,
    EDT DATE,
    PAD VARCHAR(3))
RETURNS (
    ID INTEGER /* TYPE OF COLUMN TREPMT.ID */,
    SPID INTEGER /* TYPE OF COLUMN TREPMT.SPID */,
    AD VARCHAR(3) /* TYPE OF COLUMN TREPMT.AD */,
    AC1 VARCHAR(15) /* TYPE OF COLUMN TREPMT.AC1 */,
    AC2 VARCHAR(15) /* TYPE OF COLUMN TREPMT.AC2 */,
    ACN1 VARCHAR(50) /* TYPE OF COLUMN TREPMT.ACN1 */,
    ACN2 VARCHAR(50) /* TYPE OF COLUMN TREPMT.ACN2 */,
    M1 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M1 */,
    M2 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M2 */,
    M3 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M3 */,
    M4 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M4 */,
    M5 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M5 */,
    M6 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M6 */,
    M7 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M7 */,
    M8 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M8 */,
    M9 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M9 */,
    M10 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M10 */,
    M11 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M11 */,
    M12 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M12 */,
    N1 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N1 */,
    N2 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N2 */,
    N3 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N3 */,
    N4 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N4 */,
    N5 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N5 */,
    N6 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N6 */,
    N7 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N7 */,
    N8 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N8 */,
    N9 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N9 */,
    N10 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N10 */,
    N11 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N11 */,
    N12 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N12 */,
    MT NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.MT */,
    NT NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.NT */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_REP_NPMT_22 (
    SDT DATE,
    EDT DATE,
    PAD VARCHAR(3))
RETURNS (
    ID INTEGER /* TYPE OF COLUMN TREPMT.ID */,
    SPID INTEGER /* TYPE OF COLUMN TREPMT.SPID */,
    AD VARCHAR(3) /* TYPE OF COLUMN TREPMT.AD */,
    AC1 VARCHAR(15) /* TYPE OF COLUMN TREPMT.AC1 */,
    AC2 VARCHAR(15) /* TYPE OF COLUMN TREPMT.AC2 */,
    ACN1 VARCHAR(50) /* TYPE OF COLUMN TREPMT.ACN1 */,
    ACN2 VARCHAR(50) /* TYPE OF COLUMN TREPMT.ACN2 */,
    M1 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M1 */,
    M2 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M2 */,
    M3 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M3 */,
    M4 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M4 */,
    M5 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M5 */,
    M6 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M6 */,
    M7 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M7 */,
    M8 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M8 */,
    M9 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M9 */,
    M10 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M10 */,
    M11 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M11 */,
    M12 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M12 */,
    N1 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N1 */,
    N2 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N2 */,
    N3 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N3 */,
    N4 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N4 */,
    N5 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N5 */,
    N6 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N6 */,
    N7 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N7 */,
    N8 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N8 */,
    N9 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N9 */,
    N10 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N10 */,
    N11 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N11 */,
    N12 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N12 */,
    MT NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.MT */,
    NT NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.NT */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_REP_NPMT_24 (
    SDT DATE,
    EDT DATE)
RETURNS (
    ID INTEGER /* TYPE OF COLUMN TREPMT.ID */,
    SPID INTEGER /* TYPE OF COLUMN TREPMT.SPID */,
    AD VARCHAR(3) /* TYPE OF COLUMN TREPMT.AD */,
    AC1 VARCHAR(15) /* TYPE OF COLUMN TREPMT.AC1 */,
    AC2 VARCHAR(15) /* TYPE OF COLUMN TREPMT.AC2 */,
    ACN1 VARCHAR(50) /* TYPE OF COLUMN TREPMT.ACN1 */,
    ACN2 VARCHAR(50) /* TYPE OF COLUMN TREPMT.ACN2 */,
    M1 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M1 */,
    M2 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M2 */,
    M3 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M3 */,
    M4 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M4 */,
    M5 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M5 */,
    M6 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M6 */,
    M7 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M7 */,
    M8 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M8 */,
    M9 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M9 */,
    M10 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M10 */,
    M11 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M11 */,
    M12 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M12 */,
    N1 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N1 */,
    N2 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N2 */,
    N3 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N3 */,
    N4 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N4 */,
    N5 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N5 */,
    N6 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N6 */,
    N7 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N7 */,
    N8 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N8 */,
    N9 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N9 */,
    N10 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N10 */,
    N11 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N11 */,
    N12 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N12 */,
    MT NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.MT */,
    NT NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.NT */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_REP_NPMT_31 (
    SDT DATE,
    EDT DATE)
RETURNS (
    ID INTEGER /* TYPE OF COLUMN TREPMT.ID */,
    SPID INTEGER /* TYPE OF COLUMN TREPMT.SPID */,
    AD VARCHAR(3) /* TYPE OF COLUMN TREPMT.AD */,
    AC1 VARCHAR(15) /* TYPE OF COLUMN TREPMT.AC1 */,
    AC2 VARCHAR(15) /* TYPE OF COLUMN TREPMT.AC2 */,
    ACN1 VARCHAR(50) /* TYPE OF COLUMN TREPMT.ACN1 */,
    ACN2 VARCHAR(50) /* TYPE OF COLUMN TREPMT.ACN2 */,
    M1 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M1 */,
    M2 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M2 */,
    M3 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M3 */,
    M4 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M4 */,
    M5 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M5 */,
    M6 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M6 */,
    M7 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M7 */,
    M8 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M8 */,
    M9 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M9 */,
    M10 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M10 */,
    M11 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M11 */,
    M12 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M12 */,
    N1 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N1 */,
    N2 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N2 */,
    N3 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N3 */,
    N4 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N4 */,
    N5 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N5 */,
    N6 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N6 */,
    N7 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N7 */,
    N8 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N8 */,
    N9 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N9 */,
    N10 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N10 */,
    N11 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N11 */,
    N12 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N12 */,
    MT NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.MT */,
    NT NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.NT */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_REP_NPMT_41 (
    SDT DATE,
    EDT DATE,
    PAD VARCHAR(3))
RETURNS (
    ID INTEGER /* TYPE OF COLUMN TREPMT.ID */,
    SPID INTEGER /* TYPE OF COLUMN TREPMT.SPID */,
    AD VARCHAR(3) /* TYPE OF COLUMN TREPMT.AD */,
    AC1 VARCHAR(15) /* TYPE OF COLUMN TREPMT.AC1 */,
    AC2 VARCHAR(15) /* TYPE OF COLUMN TREPMT.AC2 */,
    ACN1 VARCHAR(50) /* TYPE OF COLUMN TREPMT.ACN1 */,
    ACN2 VARCHAR(50) /* TYPE OF COLUMN TREPMT.ACN2 */,
    M1 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M1 */,
    M2 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M2 */,
    M3 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M3 */,
    M4 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M4 */,
    M5 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M5 */,
    M6 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M6 */,
    M7 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M7 */,
    M8 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M8 */,
    M9 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M9 */,
    M10 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M10 */,
    M11 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M11 */,
    M12 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M12 */,
    N1 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N1 */,
    N2 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N2 */,
    N3 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N3 */,
    N4 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N4 */,
    N5 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N5 */,
    N6 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N6 */,
    N7 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N7 */,
    N8 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N8 */,
    N9 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N9 */,
    N10 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N10 */,
    N11 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N11 */,
    N12 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N12 */,
    MT NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.MT */,
    NT NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.NT */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_REP_NPMT_42 (
    SDT DATE,
    EDT DATE,
    PAD VARCHAR(3))
RETURNS (
    ID INTEGER /* TYPE OF COLUMN TREPMT.ID */,
    SPID INTEGER /* TYPE OF COLUMN TREPMT.SPID */,
    AD VARCHAR(3) /* TYPE OF COLUMN TREPMT.AD */,
    AC1 VARCHAR(15) /* TYPE OF COLUMN TREPMT.AC1 */,
    AC2 VARCHAR(15) /* TYPE OF COLUMN TREPMT.AC2 */,
    ACN1 VARCHAR(50) /* TYPE OF COLUMN TREPMT.ACN1 */,
    ACN2 VARCHAR(50) /* TYPE OF COLUMN TREPMT.ACN2 */,
    M1 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M1 */,
    M2 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M2 */,
    M3 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M3 */,
    M4 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M4 */,
    M5 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M5 */,
    M6 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M6 */,
    M7 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M7 */,
    M8 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M8 */,
    M9 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M9 */,
    M10 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M10 */,
    M11 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M11 */,
    M12 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M12 */,
    N1 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N1 */,
    N2 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N2 */,
    N3 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N3 */,
    N4 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N4 */,
    N5 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N5 */,
    N6 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N6 */,
    N7 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N7 */,
    N8 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N8 */,
    N9 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N9 */,
    N10 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N10 */,
    N11 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N11 */,
    N12 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N12 */,
    MT NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.MT */,
    NT NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.NT */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_REP_NPMT_43 (
    SDT DATE,
    EDT DATE,
    PAD VARCHAR(3))
RETURNS (
    ID INTEGER /* TYPE OF COLUMN TREPMT.ID */,
    SPID INTEGER /* TYPE OF COLUMN TREPMT.SPID */,
    AD VARCHAR(3) /* TYPE OF COLUMN TREPMT.AD */,
    AC1 VARCHAR(15) /* TYPE OF COLUMN TREPMT.AC1 */,
    AC2 VARCHAR(15) /* TYPE OF COLUMN TREPMT.AC2 */,
    ACN1 VARCHAR(50) /* TYPE OF COLUMN TREPMT.ACN1 */,
    ACN2 VARCHAR(50) /* TYPE OF COLUMN TREPMT.ACN2 */,
    M1 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M1 */,
    M2 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M2 */,
    M3 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M3 */,
    M4 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M4 */,
    M5 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M5 */,
    M6 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M6 */,
    M7 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M7 */,
    M8 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M8 */,
    M9 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M9 */,
    M10 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M10 */,
    M11 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M11 */,
    M12 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M12 */,
    N1 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N1 */,
    N2 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N2 */,
    N3 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N3 */,
    N4 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N4 */,
    N5 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N5 */,
    N6 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N6 */,
    N7 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N7 */,
    N8 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N8 */,
    N9 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N9 */,
    N10 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N10 */,
    N11 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N11 */,
    N12 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N12 */,
    MT NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.MT */,
    NT NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.NT */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_REP_NPMT_44 (
    SDT DATE,
    EDT DATE)
RETURNS (
    ID INTEGER /* TYPE OF COLUMN TREPMT.ID */,
    SPID INTEGER /* TYPE OF COLUMN TREPMT.SPID */,
    AD VARCHAR(3) /* TYPE OF COLUMN TREPMT.AD */,
    AC1 VARCHAR(15) /* TYPE OF COLUMN TREPMT.AC1 */,
    AC2 VARCHAR(15) /* TYPE OF COLUMN TREPMT.AC2 */,
    ACN1 VARCHAR(50) /* TYPE OF COLUMN TREPMT.ACN1 */,
    ACN2 VARCHAR(50) /* TYPE OF COLUMN TREPMT.ACN2 */,
    M1 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M1 */,
    M2 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M2 */,
    M3 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M3 */,
    M4 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M4 */,
    M5 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M5 */,
    M6 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M6 */,
    M7 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M7 */,
    M8 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M8 */,
    M9 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M9 */,
    M10 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M10 */,
    M11 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M11 */,
    M12 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.M12 */,
    N1 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N1 */,
    N2 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N2 */,
    N3 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N3 */,
    N4 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N4 */,
    N5 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N5 */,
    N6 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N6 */,
    N7 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N7 */,
    N8 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N8 */,
    N9 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N9 */,
    N10 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N10 */,
    N11 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N11 */,
    N12 NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.N12 */,
    MT NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.MT */,
    NT NUMERIC(15,2) /* TYPE OF COLUMN TREPMT.NT */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_REP_PERS_11 (
    SDT DATE,
    EDT DATE,
    PAC VARCHAR(8),
    PCLID VARCHAR(15))
RETURNS (
    ID INTEGER /* TYPE OF COLUMN ROPS2A.ID */,
    SPID INTEGER /* TYPE OF COLUMN ROPS2A.SPID */,
    AC VARCHAR(8) /* TYPE OF COLUMN ROPS2A.AC */,
    RAC VARCHAR(8) /* TYPE OF COLUMN ROPS2A.RAC */,
    NAME VARCHAR(150) /* TYPE OF COLUMN ROPS2A.NAME */,
    B0 NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.B0 */,
    SDB NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.SDB */,
    SCR NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.SCR */,
    TDB NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.TDB */,
    TCR NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.TCR */,
    CLID VARCHAR(15) /* TYPE OF COLUMN ROPS2A.CLID */,
    NAME1 VARCHAR(50) /* TYPE OF COLUMN ROPS2A.NAME1 */,
    REGNR VARCHAR(15) /* TYPE OF COLUMN ROPS2A.REGNR */,
    RNAME VARCHAR(150) /* TYPE OF COLUMN ROPS2A.RNAME */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_REP_PERS_12 (
    SDT DATE,
    EDT DATE,
    PAC VARCHAR(8),
    PCLID VARCHAR(15))
RETURNS (
    ID INTEGER /* TYPE OF COLUMN ROPS2A.ID */,
    SPID INTEGER /* TYPE OF COLUMN ROPS2A.SPID */,
    AC VARCHAR(8) /* TYPE OF COLUMN ROPS2A.AC */,
    RAC VARCHAR(8) /* TYPE OF COLUMN ROPS2A.RAC */,
    NAME VARCHAR(150) /* TYPE OF COLUMN ROPS2A.NAME */,
    B0 NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.B0 */,
    SDB NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.SDB */,
    SCR NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.SCR */,
    TDB NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.TDB */,
    TCR NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.TCR */,
    CLID VARCHAR(15) /* TYPE OF COLUMN ROPS2A.CLID */,
    NAME1 VARCHAR(50) /* TYPE OF COLUMN ROPS2A.NAME1 */,
    REGNR VARCHAR(15) /* TYPE OF COLUMN ROPS2A.REGNR */,
    RNAME VARCHAR(150) /* TYPE OF COLUMN ROPS2A.RNAME */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_REP_PERS_13 (
    SDT DATE,
    EDT DATE,
    PAC VARCHAR(8),
    PCLID VARCHAR(15))
RETURNS (
    ID INTEGER /* TYPE OF COLUMN TREPA1.ID */,
    SPID INTEGER /* TYPE OF COLUMN TREPA1.SPID */,
    I1 VARCHAR(15) /* TYPE OF COLUMN TREPA1.I1 */,
    NM VARCHAR(50) /* TYPE OF COLUMN TREPA1.NM */,
    DT DATE /* TYPE OF COLUMN TREPA1.DT */,
    ST VARCHAR(6) /* TYPE OF COLUMN TREPA1.ST */,
    NR VARCHAR(15) /* TYPE OF COLUMN TREPA1.NR */,
    S1 NUMERIC(15,2) /* TYPE OF COLUMN TREPA1.S1 */,
    S2 NUMERIC(15,2) /* TYPE OF COLUMN TREPA1.S2 */,
    S3 NUMERIC(15,2) /* TYPE OF COLUMN TREPA1.S3 */,
    S4 NUMERIC(15,2) /* TYPE OF COLUMN TREPA1.S4 */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_REP_PERS_14 (
    SDT DATE,
    EDT DATE,
    PAC VARCHAR(8),
    PCLID VARCHAR(15))
RETURNS (
    ID INTEGER /* TYPE OF COLUMN TREPA1.ID */,
    SPID INTEGER /* TYPE OF COLUMN TREPA1.SPID */,
    I1 VARCHAR(15) /* TYPE OF COLUMN TREPA1.I1 */,
    NM VARCHAR(50) /* TYPE OF COLUMN TREPA1.NM */,
    DT DATE /* TYPE OF COLUMN TREPA1.DT */,
    ST VARCHAR(6) /* TYPE OF COLUMN TREPA1.ST */,
    NR VARCHAR(15) /* TYPE OF COLUMN TREPA1.NR */,
    S1 NUMERIC(15,2) /* TYPE OF COLUMN TREPA1.S1 */,
    S2 NUMERIC(15,2) /* TYPE OF COLUMN TREPA1.S2 */,
    S3 NUMERIC(15,2) /* TYPE OF COLUMN TREPA1.S3 */,
    S4 NUMERIC(15,2) /* TYPE OF COLUMN TREPA1.S4 */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_REP_PERS_15 (
    SDT DATE,
    EDT DATE,
    PAC VARCHAR(8),
    PCLID VARCHAR(15))
RETURNS (
    ID INTEGER /* TYPE OF COLUMN TREPA1.ID */,
    SPID INTEGER /* TYPE OF COLUMN TREPA1.SPID */,
    I1 VARCHAR(15) /* TYPE OF COLUMN TREPA1.I1 */,
    NM VARCHAR(50) /* TYPE OF COLUMN TREPA1.NM */,
    DT DATE /* TYPE OF COLUMN TREPA1.DT */,
    ST VARCHAR(6) /* TYPE OF COLUMN TREPA1.ST */,
    NR VARCHAR(15) /* TYPE OF COLUMN TREPA1.NR */,
    S1 NUMERIC(15,2) /* TYPE OF COLUMN TREPA1.S1 */,
    S2 NUMERIC(15,2) /* TYPE OF COLUMN TREPA1.S2 */,
    S3 NUMERIC(15,2) /* TYPE OF COLUMN TREPA1.S3 */,
    S4 NUMERIC(15,2) /* TYPE OF COLUMN TREPA1.S4 */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_REP_PERS_16 (
    SDT DATE,
    EDT DATE,
    PAC VARCHAR(8),
    PCLID VARCHAR(15))
RETURNS (
    ID INTEGER /* TYPE OF COLUMN TREPA1.ID */,
    SPID INTEGER /* TYPE OF COLUMN TREPA1.SPID */,
    I1 VARCHAR(15) /* TYPE OF COLUMN TREPA1.I1 */,
    NM VARCHAR(50) /* TYPE OF COLUMN TREPA1.NM */,
    DT DATE /* TYPE OF COLUMN TREPA1.DT */,
    ST VARCHAR(6) /* TYPE OF COLUMN TREPA1.ST */,
    NR VARCHAR(15) /* TYPE OF COLUMN TREPA1.NR */,
    S1 NUMERIC(15,2) /* TYPE OF COLUMN TREPA1.S1 */,
    S2 NUMERIC(15,2) /* TYPE OF COLUMN TREPA1.S2 */,
    S3 NUMERIC(15,2) /* TYPE OF COLUMN TREPA1.S3 */,
    S4 NUMERIC(15,2) /* TYPE OF COLUMN TREPA1.S4 */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_REP_PVN_10 (
    SDT DATE,
    EDT DATE)
RETURNS (
    ID INTEGER /* TYPE OF COLUMN ROPS2A.ID */,
    SPID INTEGER /* TYPE OF COLUMN ROPS2A.SPID */,
    AC VARCHAR(8) /* TYPE OF COLUMN ROPS2A.AC */,
    RAC VARCHAR(8) /* TYPE OF COLUMN ROPS2A.RAC */,
    NAME VARCHAR(150) /* TYPE OF COLUMN ROPS2A.NAME */,
    B0 NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.B0 */,
    SDB NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.SDB */,
    SCR NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.SCR */,
    TDB NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.TDB */,
    TCR NUMERIC(15,2) /* TYPE OF COLUMN ROPS2A.TCR */,
    CLID VARCHAR(15) /* TYPE OF COLUMN ROPS2A.CLID */,
    NAME1 VARCHAR(50) /* TYPE OF COLUMN ROPS2A.NAME1 */,
    REGNR VARCHAR(15) /* TYPE OF COLUMN ROPS2A.REGNR */,
    RNAME VARCHAR(150) /* TYPE OF COLUMN ROPS2A.RNAME */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_REP_PVN_21 (
    PSD DATE,
    PED DATE,
    RG1 MONEY,
    RG2 MONEY)
RETURNS (
    DID INTEGER /* TYPE OF COLUMN TTEMP_PVN1.DID */,
    CLID VARCHAR(15) /* TYPE OF COLUMN TTEMP_PVN1.CLID */,
    DOCTYP1 VARCHAR(10) /* TYPE OF COLUMN TTEMP_PVN1.DOCTYP1 */,
    DOCTYP2 VARCHAR(10) /* TYPE OF COLUMN TTEMP_PVN1.DOCTYP2 */,
    DOCTYPC INTEGER /* TYPE OF COLUMN TTEMP_PVN1.DOCTYPC */,
    RAC5 VARCHAR(8) /* TYPE OF COLUMN TTEMP_PVN1.RAC5 */,
    SUMM NUMERIC(15,2) /* TYPE OF COLUMN TTEMP_PVN1.SUMM */,
    PVN NUMERIC(15,2) /* TYPE OF COLUMN TTEMP_PVN1.PVN */,
    SUMMC NUMERIC(15,2) /* TYPE OF COLUMN TTEMP_PVN1.SUMMC */,
    CUR VARCHAR(3) /* TYPE OF COLUMN TTEMP_PVN1.CUR */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_REP_PVN_22 (
    PSD DATE,
    PED DATE,
    RG1 MONEY,
    RG2 MONEY)
RETURNS (
    ID INTEGER /* TYPE OF COLUMN ROPS1A.ID */,
    SPID INTEGER /* TYPE OF COLUMN ROPS1A.SPID */,
    DID INTEGER /* TYPE OF COLUMN ROPS1A.DID */,
    DETE DATE /* TYPE OF COLUMN ROPS1A.DETE */,
    NRX VARCHAR(5) /* TYPE OF COLUMN ROPS1A.NRX */,
    DOCTYP VARCHAR(10) /* TYPE OF COLUMN ROPS1A.DOCTYP */,
    DOCTYP1 VARCHAR(10) /* TYPE OF COLUMN ROPS1A.DOCTYP1 */,
    DOCTYP2 VARCHAR(10) /* TYPE OF COLUMN ROPS1A.DOCTYP2 */,
    DOCST VARCHAR(6) /* TYPE OF COLUMN ROPS1A.DOCST */,
    DOCNR VARCHAR(15) /* TYPE OF COLUMN ROPS1A.DOCNR */,
    CLID VARCHAR(15) /* TYPE OF COLUMN ROPS1A.CLID */,
    CLID2 VARCHAR(15) /* TYPE OF COLUMN ROPS1A.CLID2 */,
    NAME VARCHAR(50) /* TYPE OF COLUMN ROPS1A.NAME */,
    NAME2 VARCHAR(50) /* TYPE OF COLUMN ROPS1A.NAME2 */,
    REGNR VARCHAR(15) /* TYPE OF COLUMN ROPS1A.REGNR */,
    REGNR2 VARCHAR(15) /* TYPE OF COLUMN ROPS1A.REGNR2 */,
    B0 NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.B0 */,
    DESCR VARCHAR(80) /* TYPE OF COLUMN ROPS1A.DESCR */,
    DESCR2 VARCHAR(80) /* TYPE OF COLUMN ROPS1A.DESCR2 */,
    AC1 VARCHAR(8) /* TYPE OF COLUMN ROPS1A.AC1 */,
    AC2 VARCHAR(8) /* TYPE OF COLUMN ROPS1A.AC2 */,
    SAC1 VARCHAR(50) /* TYPE OF COLUMN ROPS1A.SAC1 */,
    SAC2 VARCHAR(50) /* TYPE OF COLUMN ROPS1A.SAC2 */,
    SUMMC NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.SUMMC */,
    CUR VARCHAR(3) /* TYPE OF COLUMN ROPS1A.CUR */,
    SUMM NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.SUMM */,
    PVN NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.PVN */,
    RAC VARCHAR(8) /* TYPE OF COLUMN ROPS1A.RAC */,
    SDB NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.SDB */,
    SCR NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.SCR */,
    RAC2 VARCHAR(8) /* TYPE OF COLUMN ROPS1A.RAC2 */,
    RAC3 VARCHAR(5) /* TYPE OF COLUMN ROPS1A.RAC3 */,
    RAC4 VARCHAR(8) /* TYPE OF COLUMN ROPS1A.RAC4 */,
    RAC5 VARCHAR(5) /* TYPE OF COLUMN ROPS1A.RAC5 */,
    QV FLOAT /* TYPE OF COLUMN ROPS1A.QV */,
    ZNR INTEGER /* TYPE OF COLUMN ROPS1A.ZNR */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_REP_PVN_31 (
    PSD DATE,
    PED DATE,
    RG1 MONEY,
    RG2 MONEY)
RETURNS (
    DID INTEGER /* TYPE OF COLUMN TTEMP_PVN1.DID */,
    CLID VARCHAR(15) /* TYPE OF COLUMN TTEMP_PVN1.CLID */,
    DOCTYP1 VARCHAR(10) /* TYPE OF COLUMN TTEMP_PVN1.DOCTYP1 */,
    DOCTYP2 VARCHAR(10) /* TYPE OF COLUMN TTEMP_PVN1.DOCTYP2 */,
    DOCTYPC INTEGER /* TYPE OF COLUMN TTEMP_PVN1.DOCTYPC */,
    RAC5 VARCHAR(8) /* TYPE OF COLUMN TTEMP_PVN1.RAC5 */,
    SUMM NUMERIC(15,2) /* TYPE OF COLUMN TTEMP_PVN1.SUMM */,
    PVN NUMERIC(15,2) /* TYPE OF COLUMN TTEMP_PVN1.PVN */,
    SUMMC NUMERIC(15,2) /* TYPE OF COLUMN TTEMP_PVN1.SUMMC */,
    CUR VARCHAR(3) /* TYPE OF COLUMN TTEMP_PVN1.CUR */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_REP_PVN_32 (
    PSD DATE,
    PED DATE,
    RG1 MONEY,
    RG2 MONEY)
RETURNS (
    ID INTEGER /* TYPE OF COLUMN ROPS1A.ID */,
    SPID INTEGER /* TYPE OF COLUMN ROPS1A.SPID */,
    DID INTEGER /* TYPE OF COLUMN ROPS1A.DID */,
    DETE DATE /* TYPE OF COLUMN ROPS1A.DETE */,
    NRX VARCHAR(5) /* TYPE OF COLUMN ROPS1A.NRX */,
    DOCTYP VARCHAR(10) /* TYPE OF COLUMN ROPS1A.DOCTYP */,
    DOCTYP1 VARCHAR(10) /* TYPE OF COLUMN ROPS1A.DOCTYP1 */,
    DOCTYP2 VARCHAR(10) /* TYPE OF COLUMN ROPS1A.DOCTYP2 */,
    DOCST VARCHAR(6) /* TYPE OF COLUMN ROPS1A.DOCST */,
    DOCNR VARCHAR(15) /* TYPE OF COLUMN ROPS1A.DOCNR */,
    CLID VARCHAR(15) /* TYPE OF COLUMN ROPS1A.CLID */,
    CLID2 VARCHAR(15) /* TYPE OF COLUMN ROPS1A.CLID2 */,
    NAME VARCHAR(50) /* TYPE OF COLUMN ROPS1A.NAME */,
    NAME2 VARCHAR(50) /* TYPE OF COLUMN ROPS1A.NAME2 */,
    REGNR VARCHAR(15) /* TYPE OF COLUMN ROPS1A.REGNR */,
    REGNR2 VARCHAR(15) /* TYPE OF COLUMN ROPS1A.REGNR2 */,
    B0 NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.B0 */,
    DESCR VARCHAR(80) /* TYPE OF COLUMN ROPS1A.DESCR */,
    DESCR2 VARCHAR(80) /* TYPE OF COLUMN ROPS1A.DESCR2 */,
    AC1 VARCHAR(8) /* TYPE OF COLUMN ROPS1A.AC1 */,
    AC2 VARCHAR(8) /* TYPE OF COLUMN ROPS1A.AC2 */,
    SAC1 VARCHAR(50) /* TYPE OF COLUMN ROPS1A.SAC1 */,
    SAC2 VARCHAR(50) /* TYPE OF COLUMN ROPS1A.SAC2 */,
    SUMMC NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.SUMMC */,
    CUR VARCHAR(3) /* TYPE OF COLUMN ROPS1A.CUR */,
    SUMM NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.SUMM */,
    PVN NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.PVN */,
    RAC VARCHAR(8) /* TYPE OF COLUMN ROPS1A.RAC */,
    SDB NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.SDB */,
    SCR NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.SCR */,
    RAC2 VARCHAR(8) /* TYPE OF COLUMN ROPS1A.RAC2 */,
    RAC3 VARCHAR(5) /* TYPE OF COLUMN ROPS1A.RAC3 */,
    RAC4 VARCHAR(8) /* TYPE OF COLUMN ROPS1A.RAC4 */,
    RAC5 VARCHAR(5) /* TYPE OF COLUMN ROPS1A.RAC5 */,
    QV FLOAT /* TYPE OF COLUMN ROPS1A.QV */,
    ZNR INTEGER /* TYPE OF COLUMN ROPS1A.ZNR */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_REP_PVN_41 (
    PSD DATE,
    PED DATE,
    RG1 MONEY,
    RG2 MONEY)
RETURNS (
    ID INTEGER /* TYPE OF COLUMN ROPS1A.ID */,
    SPID INTEGER /* TYPE OF COLUMN ROPS1A.SPID */,
    DID INTEGER /* TYPE OF COLUMN ROPS1A.DID */,
    DETE DATE /* TYPE OF COLUMN ROPS1A.DETE */,
    NRX VARCHAR(5) /* TYPE OF COLUMN ROPS1A.NRX */,
    DOCTYP VARCHAR(10) /* TYPE OF COLUMN ROPS1A.DOCTYP */,
    DOCTYP1 VARCHAR(10) /* TYPE OF COLUMN ROPS1A.DOCTYP1 */,
    DOCTYP2 VARCHAR(10) /* TYPE OF COLUMN ROPS1A.DOCTYP2 */,
    DOCST VARCHAR(6) /* TYPE OF COLUMN ROPS1A.DOCST */,
    DOCNR VARCHAR(15) /* TYPE OF COLUMN ROPS1A.DOCNR */,
    CLID VARCHAR(15) /* TYPE OF COLUMN ROPS1A.CLID */,
    CLID2 VARCHAR(15) /* TYPE OF COLUMN ROPS1A.CLID2 */,
    NAME VARCHAR(50) /* TYPE OF COLUMN ROPS1A.NAME */,
    NAME2 VARCHAR(50) /* TYPE OF COLUMN ROPS1A.NAME2 */,
    REGNR VARCHAR(15) /* TYPE OF COLUMN ROPS1A.REGNR */,
    REGNR2 VARCHAR(15) /* TYPE OF COLUMN ROPS1A.REGNR2 */,
    B0 NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.B0 */,
    DESCR VARCHAR(80) /* TYPE OF COLUMN ROPS1A.DESCR */,
    DESCR2 VARCHAR(80) /* TYPE OF COLUMN ROPS1A.DESCR2 */,
    AC1 VARCHAR(8) /* TYPE OF COLUMN ROPS1A.AC1 */,
    AC2 VARCHAR(8) /* TYPE OF COLUMN ROPS1A.AC2 */,
    SAC1 VARCHAR(50) /* TYPE OF COLUMN ROPS1A.SAC1 */,
    SAC2 VARCHAR(50) /* TYPE OF COLUMN ROPS1A.SAC2 */,
    SUMMC NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.SUMMC */,
    CUR VARCHAR(3) /* TYPE OF COLUMN ROPS1A.CUR */,
    SUMM NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.SUMM */,
    PVN NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.PVN */,
    RAC VARCHAR(8) /* TYPE OF COLUMN ROPS1A.RAC */,
    SDB NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.SDB */,
    SCR NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.SCR */,
    RAC2 VARCHAR(8) /* TYPE OF COLUMN ROPS1A.RAC2 */,
    RAC3 VARCHAR(5) /* TYPE OF COLUMN ROPS1A.RAC3 */,
    RAC4 VARCHAR(8) /* TYPE OF COLUMN ROPS1A.RAC4 */,
    RAC5 VARCHAR(5) /* TYPE OF COLUMN ROPS1A.RAC5 */,
    QV FLOAT /* TYPE OF COLUMN ROPS1A.QV */,
    ZNR INTEGER /* TYPE OF COLUMN ROPS1A.ZNR */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_REP_PVN_42 (
    PSD DATE,
    PED DATE,
    RG1 MONEY,
    RG2 MONEY)
RETURNS (
    ID INTEGER /* TYPE OF COLUMN ROPS1A.ID */,
    SPID INTEGER /* TYPE OF COLUMN ROPS1A.SPID */,
    DID INTEGER /* TYPE OF COLUMN ROPS1A.DID */,
    DETE DATE /* TYPE OF COLUMN ROPS1A.DETE */,
    NRX VARCHAR(5) /* TYPE OF COLUMN ROPS1A.NRX */,
    DOCTYP VARCHAR(10) /* TYPE OF COLUMN ROPS1A.DOCTYP */,
    DOCTYP1 VARCHAR(10) /* TYPE OF COLUMN ROPS1A.DOCTYP1 */,
    DOCTYP2 VARCHAR(10) /* TYPE OF COLUMN ROPS1A.DOCTYP2 */,
    DOCST VARCHAR(6) /* TYPE OF COLUMN ROPS1A.DOCST */,
    DOCNR VARCHAR(15) /* TYPE OF COLUMN ROPS1A.DOCNR */,
    CLID VARCHAR(15) /* TYPE OF COLUMN ROPS1A.CLID */,
    CLID2 VARCHAR(15) /* TYPE OF COLUMN ROPS1A.CLID2 */,
    NAME VARCHAR(50) /* TYPE OF COLUMN ROPS1A.NAME */,
    NAME2 VARCHAR(50) /* TYPE OF COLUMN ROPS1A.NAME2 */,
    REGNR VARCHAR(15) /* TYPE OF COLUMN ROPS1A.REGNR */,
    REGNR2 VARCHAR(15) /* TYPE OF COLUMN ROPS1A.REGNR2 */,
    B0 NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.B0 */,
    DESCR VARCHAR(80) /* TYPE OF COLUMN ROPS1A.DESCR */,
    DESCR2 VARCHAR(80) /* TYPE OF COLUMN ROPS1A.DESCR2 */,
    AC1 VARCHAR(8) /* TYPE OF COLUMN ROPS1A.AC1 */,
    AC2 VARCHAR(8) /* TYPE OF COLUMN ROPS1A.AC2 */,
    SAC1 VARCHAR(50) /* TYPE OF COLUMN ROPS1A.SAC1 */,
    SAC2 VARCHAR(50) /* TYPE OF COLUMN ROPS1A.SAC2 */,
    SUMMC NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.SUMMC */,
    CUR VARCHAR(3) /* TYPE OF COLUMN ROPS1A.CUR */,
    SUMM NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.SUMM */,
    PVN NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.PVN */,
    RAC VARCHAR(8) /* TYPE OF COLUMN ROPS1A.RAC */,
    SDB NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.SDB */,
    SCR NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.SCR */,
    RAC2 VARCHAR(8) /* TYPE OF COLUMN ROPS1A.RAC2 */,
    RAC3 VARCHAR(5) /* TYPE OF COLUMN ROPS1A.RAC3 */,
    RAC4 VARCHAR(8) /* TYPE OF COLUMN ROPS1A.RAC4 */,
    RAC5 VARCHAR(5) /* TYPE OF COLUMN ROPS1A.RAC5 */,
    QV FLOAT /* TYPE OF COLUMN ROPS1A.QV */,
    ZNR INTEGER /* TYPE OF COLUMN ROPS1A.ZNR */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_REP_PVN_51 (
    PSD DATE,
    PED DATE,
    RG1 MONEY,
    RG2 MONEY)
RETURNS (
    DID INTEGER /* TYPE OF COLUMN TTEMP_PVN1.DID */,
    CLID VARCHAR(15) /* TYPE OF COLUMN TTEMP_PVN1.CLID */,
    DOCTYP1 VARCHAR(10) /* TYPE OF COLUMN TTEMP_PVN1.DOCTYP1 */,
    DOCTYP2 VARCHAR(10) /* TYPE OF COLUMN TTEMP_PVN1.DOCTYP2 */,
    DOCTYPC INTEGER /* TYPE OF COLUMN TTEMP_PVN1.DOCTYPC */,
    RAC5 VARCHAR(8) /* TYPE OF COLUMN TTEMP_PVN1.RAC5 */,
    SUMM NUMERIC(15,2) /* TYPE OF COLUMN TTEMP_PVN1.SUMM */,
    PVN NUMERIC(15,2) /* TYPE OF COLUMN TTEMP_PVN1.PVN */,
    SUMMC NUMERIC(15,2) /* TYPE OF COLUMN TTEMP_PVN1.SUMMC */,
    CUR VARCHAR(3) /* TYPE OF COLUMN TTEMP_PVN1.CUR */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_REP_PVN_52 (
    PSD DATE,
    PED DATE,
    RG1 MONEY,
    RG2 MONEY)
RETURNS (
    ID INTEGER /* TYPE OF COLUMN ROPS1A.ID */,
    SPID INTEGER /* TYPE OF COLUMN ROPS1A.SPID */,
    DID INTEGER /* TYPE OF COLUMN ROPS1A.DID */,
    DETE DATE /* TYPE OF COLUMN ROPS1A.DETE */,
    NRX VARCHAR(5) /* TYPE OF COLUMN ROPS1A.NRX */,
    DOCTYP VARCHAR(10) /* TYPE OF COLUMN ROPS1A.DOCTYP */,
    DOCTYP1 VARCHAR(10) /* TYPE OF COLUMN ROPS1A.DOCTYP1 */,
    DOCTYP2 VARCHAR(10) /* TYPE OF COLUMN ROPS1A.DOCTYP2 */,
    DOCST VARCHAR(6) /* TYPE OF COLUMN ROPS1A.DOCST */,
    DOCNR VARCHAR(15) /* TYPE OF COLUMN ROPS1A.DOCNR */,
    CLID VARCHAR(15) /* TYPE OF COLUMN ROPS1A.CLID */,
    CLID2 VARCHAR(15) /* TYPE OF COLUMN ROPS1A.CLID2 */,
    NAME VARCHAR(50) /* TYPE OF COLUMN ROPS1A.NAME */,
    NAME2 VARCHAR(50) /* TYPE OF COLUMN ROPS1A.NAME2 */,
    REGNR VARCHAR(15) /* TYPE OF COLUMN ROPS1A.REGNR */,
    REGNR2 VARCHAR(15) /* TYPE OF COLUMN ROPS1A.REGNR2 */,
    B0 NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.B0 */,
    DESCR VARCHAR(80) /* TYPE OF COLUMN ROPS1A.DESCR */,
    DESCR2 VARCHAR(80) /* TYPE OF COLUMN ROPS1A.DESCR2 */,
    AC1 VARCHAR(8) /* TYPE OF COLUMN ROPS1A.AC1 */,
    AC2 VARCHAR(8) /* TYPE OF COLUMN ROPS1A.AC2 */,
    SAC1 VARCHAR(50) /* TYPE OF COLUMN ROPS1A.SAC1 */,
    SAC2 VARCHAR(50) /* TYPE OF COLUMN ROPS1A.SAC2 */,
    SUMMC NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.SUMMC */,
    CUR VARCHAR(3) /* TYPE OF COLUMN ROPS1A.CUR */,
    SUMM NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.SUMM */,
    PVN NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.PVN */,
    RAC VARCHAR(8) /* TYPE OF COLUMN ROPS1A.RAC */,
    SDB NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.SDB */,
    SCR NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.SCR */,
    RAC2 VARCHAR(8) /* TYPE OF COLUMN ROPS1A.RAC2 */,
    RAC3 VARCHAR(5) /* TYPE OF COLUMN ROPS1A.RAC3 */,
    RAC4 VARCHAR(8) /* TYPE OF COLUMN ROPS1A.RAC4 */,
    RAC5 VARCHAR(5) /* TYPE OF COLUMN ROPS1A.RAC5 */,
    QV FLOAT /* TYPE OF COLUMN ROPS1A.QV */,
    ZNR INTEGER /* TYPE OF COLUMN ROPS1A.ZNR */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_REP_PVN_CHECK_01 (
    PSD DATE,
    PED DATE,
    RG1 MONEY,
    LIKME MONEY)
RETURNS (
    ID INTEGER /* TYPE OF COLUMN ROPS1A.ID */,
    SPID INTEGER /* TYPE OF COLUMN ROPS1A.SPID */,
    DID INTEGER /* TYPE OF COLUMN ROPS1A.DID */,
    DETE DATE /* TYPE OF COLUMN ROPS1A.DETE */,
    NRX VARCHAR(5) /* TYPE OF COLUMN ROPS1A.NRX */,
    DOCTYP VARCHAR(10) /* TYPE OF COLUMN ROPS1A.DOCTYP */,
    DOCTYP1 VARCHAR(10) /* TYPE OF COLUMN ROPS1A.DOCTYP1 */,
    DOCTYP2 VARCHAR(10) /* TYPE OF COLUMN ROPS1A.DOCTYP2 */,
    DOCST VARCHAR(6) /* TYPE OF COLUMN ROPS1A.DOCST */,
    DOCNR VARCHAR(15) /* TYPE OF COLUMN ROPS1A.DOCNR */,
    CLID VARCHAR(15) /* TYPE OF COLUMN ROPS1A.CLID */,
    CLID2 VARCHAR(15) /* TYPE OF COLUMN ROPS1A.CLID2 */,
    NAME VARCHAR(50) /* TYPE OF COLUMN ROPS1A.NAME */,
    NAME2 VARCHAR(50) /* TYPE OF COLUMN ROPS1A.NAME2 */,
    REGNR VARCHAR(15) /* TYPE OF COLUMN ROPS1A.REGNR */,
    REGNR2 VARCHAR(15) /* TYPE OF COLUMN ROPS1A.REGNR2 */,
    B0 NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.B0 */,
    DESCR VARCHAR(80) /* TYPE OF COLUMN ROPS1A.DESCR */,
    DESCR2 VARCHAR(80) /* TYPE OF COLUMN ROPS1A.DESCR2 */,
    AC1 VARCHAR(8) /* TYPE OF COLUMN ROPS1A.AC1 */,
    AC2 VARCHAR(8) /* TYPE OF COLUMN ROPS1A.AC2 */,
    SAC1 VARCHAR(50) /* TYPE OF COLUMN ROPS1A.SAC1 */,
    SAC2 VARCHAR(50) /* TYPE OF COLUMN ROPS1A.SAC2 */,
    SUMMC NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.SUMMC */,
    CUR VARCHAR(3) /* TYPE OF COLUMN ROPS1A.CUR */,
    SUMM NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.SUMM */,
    PVN NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.PVN */,
    RAC VARCHAR(8) /* TYPE OF COLUMN ROPS1A.RAC */,
    SDB NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.SDB */,
    SCR NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.SCR */,
    RAC2 VARCHAR(8) /* TYPE OF COLUMN ROPS1A.RAC2 */,
    RAC3 VARCHAR(5) /* TYPE OF COLUMN ROPS1A.RAC3 */,
    RAC4 VARCHAR(8) /* TYPE OF COLUMN ROPS1A.RAC4 */,
    RAC5 VARCHAR(5) /* TYPE OF COLUMN ROPS1A.RAC5 */,
    QV FLOAT /* TYPE OF COLUMN ROPS1A.QV */,
    ZNR INTEGER /* TYPE OF COLUMN ROPS1A.ZNR */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_REP_PVN_CHECK_02 (
    PSD DATE,
    PED DATE,
    RG1 MONEY,
    LIKME MONEY)
RETURNS (
    ID INTEGER /* TYPE OF COLUMN ROPS1A.ID */,
    SPID INTEGER /* TYPE OF COLUMN ROPS1A.SPID */,
    DID INTEGER /* TYPE OF COLUMN ROPS1A.DID */,
    DETE DATE /* TYPE OF COLUMN ROPS1A.DETE */,
    NRX VARCHAR(5) /* TYPE OF COLUMN ROPS1A.NRX */,
    DOCTYP VARCHAR(10) /* TYPE OF COLUMN ROPS1A.DOCTYP */,
    DOCTYP1 VARCHAR(10) /* TYPE OF COLUMN ROPS1A.DOCTYP1 */,
    DOCTYP2 VARCHAR(10) /* TYPE OF COLUMN ROPS1A.DOCTYP2 */,
    DOCST VARCHAR(6) /* TYPE OF COLUMN ROPS1A.DOCST */,
    DOCNR VARCHAR(15) /* TYPE OF COLUMN ROPS1A.DOCNR */,
    CLID VARCHAR(15) /* TYPE OF COLUMN ROPS1A.CLID */,
    CLID2 VARCHAR(15) /* TYPE OF COLUMN ROPS1A.CLID2 */,
    NAME VARCHAR(50) /* TYPE OF COLUMN ROPS1A.NAME */,
    NAME2 VARCHAR(50) /* TYPE OF COLUMN ROPS1A.NAME2 */,
    REGNR VARCHAR(15) /* TYPE OF COLUMN ROPS1A.REGNR */,
    REGNR2 VARCHAR(15) /* TYPE OF COLUMN ROPS1A.REGNR2 */,
    B0 NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.B0 */,
    DESCR VARCHAR(80) /* TYPE OF COLUMN ROPS1A.DESCR */,
    DESCR2 VARCHAR(80) /* TYPE OF COLUMN ROPS1A.DESCR2 */,
    AC1 VARCHAR(8) /* TYPE OF COLUMN ROPS1A.AC1 */,
    AC2 VARCHAR(8) /* TYPE OF COLUMN ROPS1A.AC2 */,
    SAC1 VARCHAR(50) /* TYPE OF COLUMN ROPS1A.SAC1 */,
    SAC2 VARCHAR(50) /* TYPE OF COLUMN ROPS1A.SAC2 */,
    SUMMC NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.SUMMC */,
    CUR VARCHAR(3) /* TYPE OF COLUMN ROPS1A.CUR */,
    SUMM NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.SUMM */,
    PVN NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.PVN */,
    RAC VARCHAR(8) /* TYPE OF COLUMN ROPS1A.RAC */,
    SDB NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.SDB */,
    SCR NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.SCR */,
    RAC2 VARCHAR(8) /* TYPE OF COLUMN ROPS1A.RAC2 */,
    RAC3 VARCHAR(5) /* TYPE OF COLUMN ROPS1A.RAC3 */,
    RAC4 VARCHAR(8) /* TYPE OF COLUMN ROPS1A.RAC4 */,
    RAC5 VARCHAR(5) /* TYPE OF COLUMN ROPS1A.RAC5 */,
    QV FLOAT /* TYPE OF COLUMN ROPS1A.QV */,
    ZNR INTEGER /* TYPE OF COLUMN ROPS1A.ZNR */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_REP_PVNZ_01 (
    SDT DATE,
    EDT DATE)
RETURNS (
    ID INTEGER /* TYPE OF COLUMN TREPPVNZ1.ID */,
    SPID INTEGER /* TYPE OF COLUMN TREPPVNZ1.SPID */,
    DID INTEGER /* TYPE OF COLUMN TREPPVNZ1.DID */,
    RID INTEGER /* TYPE OF COLUMN TREPPVNZ1.RID */,
    DETE DATE /* TYPE OF COLUMN TREPPVNZ1.DETE */,
    NRX VARCHAR(5) /* TYPE OF COLUMN TREPPVNZ1.NRX */,
    DOCTYP VARCHAR(10) /* TYPE OF COLUMN TREPPVNZ1.DOCTYP */,
    DOCST VARCHAR(6) /* TYPE OF COLUMN TREPPVNZ1.DOCST */,
    DOCNR VARCHAR(15) /* TYPE OF COLUMN TREPPVNZ1.DOCNR */,
    DOCSTR VARCHAR(200) /* TYPE OF COLUMN TREPPVNZ1.DOCSTR */,
    CLID VARCHAR(15) /* TYPE OF COLUMN TREPPVNZ1.CLID */,
    NAME VARCHAR(50) /* TYPE OF COLUMN TREPPVNZ1.NAME */,
    REGNR VARCHAR(15) /* TYPE OF COLUMN TREPPVNZ1.REGNR */,
    DESCR VARCHAR(80) /* TYPE OF COLUMN TREPPVNZ1.DESCR */,
    AA NUMERIC(15,2) /* TYPE OF COLUMN TREPPVNZ1.AA */,
    A8 NUMERIC(15,2) /* TYPE OF COLUMN TREPPVNZ1.A8 */,
    A9 NUMERIC(15,2) /* TYPE OF COLUMN TREPPVNZ1.A9 */,
    A10 NUMERIC(15,2) /* TYPE OF COLUMN TREPPVNZ1.A10 */,
    A11 VARCHAR(8) /* TYPE OF COLUMN TREPPVNZ1.A11 */,
    A12 NUMERIC(15,2) /* TYPE OF COLUMN TREPPVNZ1.A12 */,
    A13 NUMERIC(15,2) /* TYPE OF COLUMN TREPPVNZ1.A13 */,
    A14 NUMERIC(15,2) /* TYPE OF COLUMN TREPPVNZ1.A14 */,
    A15 NUMERIC(15,2) /* TYPE OF COLUMN TREPPVNZ1.A15 */,
    A16 NUMERIC(15,2) /* TYPE OF COLUMN TREPPVNZ1.A16 */,
    A17 NUMERIC(15,2) /* TYPE OF COLUMN TREPPVNZ1.A17 */,
    A18 NUMERIC(15,2) /* TYPE OF COLUMN TREPPVNZ1.A18 */,
    A19 NUMERIC(15,2) /* TYPE OF COLUMN TREPPVNZ1.A19 */,
    A20 NUMERIC(15,2) /* TYPE OF COLUMN TREPPVNZ1.A20 */,
    A21 NUMERIC(15,2) /* TYPE OF COLUMN TREPPVNZ1.A21 */,
    A22 NUMERIC(15,2) /* TYPE OF COLUMN TREPPVNZ1.A22 */,
    A23 NUMERIC(15,2) /* TYPE OF COLUMN TREPPVNZ1.A23 */,
    A24 NUMERIC(15,2) /* TYPE OF COLUMN TREPPVNZ1.A24 */,
    A25 NUMERIC(15,2) /* TYPE OF COLUMN TREPPVNZ1.A25 */,
    A26 NUMERIC(15,2) /* TYPE OF COLUMN TREPPVNZ1.A26 */,
    A27 NUMERIC(15,2) /* TYPE OF COLUMN TREPPVNZ1.A27 */,
    A28 NUMERIC(15,2) /* TYPE OF COLUMN TREPPVNZ1.A28 */,
    A29 NUMERIC(15,2) /* TYPE OF COLUMN TREPPVNZ1.A29 */,
    A30 NUMERIC(15,2) /* TYPE OF COLUMN TREPPVNZ1.A30 */,
    A31 NUMERIC(15,2) /* TYPE OF COLUMN TREPPVNZ1.A31 */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_REP_SKAIDRA_01 (
    SDT DATE,
    EDT DATE,
    PSUMM NUMERIC(14,5),
    PPERTYP VARCHAR(5))
RETURNS (
    ID INTEGER /* TYPE OF COLUMN ROPS1A.ID */,
    SPID INTEGER /* TYPE OF COLUMN ROPS1A.SPID */,
    DID INTEGER /* TYPE OF COLUMN ROPS1A.DID */,
    DETE DATE /* TYPE OF COLUMN ROPS1A.DETE */,
    NRX VARCHAR(5) /* TYPE OF COLUMN ROPS1A.NRX */,
    DOCTYP VARCHAR(10) /* TYPE OF COLUMN ROPS1A.DOCTYP */,
    DOCTYP1 VARCHAR(10) /* TYPE OF COLUMN ROPS1A.DOCTYP1 */,
    DOCTYP2 VARCHAR(10) /* TYPE OF COLUMN ROPS1A.DOCTYP2 */,
    DOCST VARCHAR(6) /* TYPE OF COLUMN ROPS1A.DOCST */,
    DOCNR VARCHAR(15) /* TYPE OF COLUMN ROPS1A.DOCNR */,
    CLID VARCHAR(15) /* TYPE OF COLUMN ROPS1A.CLID */,
    CLID2 VARCHAR(15) /* TYPE OF COLUMN ROPS1A.CLID2 */,
    NAME VARCHAR(50) /* TYPE OF COLUMN ROPS1A.NAME */,
    NAME2 VARCHAR(50) /* TYPE OF COLUMN ROPS1A.NAME2 */,
    REGNR VARCHAR(15) /* TYPE OF COLUMN ROPS1A.REGNR */,
    REGNR2 VARCHAR(15) /* TYPE OF COLUMN ROPS1A.REGNR2 */,
    B0 NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.B0 */,
    DESCR VARCHAR(80) /* TYPE OF COLUMN ROPS1A.DESCR */,
    DESCR2 VARCHAR(80) /* TYPE OF COLUMN ROPS1A.DESCR2 */,
    AC1 VARCHAR(8) /* TYPE OF COLUMN ROPS1A.AC1 */,
    AC2 VARCHAR(8) /* TYPE OF COLUMN ROPS1A.AC2 */,
    SAC1 VARCHAR(50) /* TYPE OF COLUMN ROPS1A.SAC1 */,
    SAC2 VARCHAR(50) /* TYPE OF COLUMN ROPS1A.SAC2 */,
    SUMMC NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.SUMMC */,
    CUR VARCHAR(3) /* TYPE OF COLUMN ROPS1A.CUR */,
    SUMM NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.SUMM */,
    PVN NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.PVN */,
    RAC VARCHAR(8) /* TYPE OF COLUMN ROPS1A.RAC */,
    SDB NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.SDB */,
    SCR NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.SCR */,
    RAC2 VARCHAR(8) /* TYPE OF COLUMN ROPS1A.RAC2 */,
    RAC3 VARCHAR(5) /* TYPE OF COLUMN ROPS1A.RAC3 */,
    RAC4 VARCHAR(8) /* TYPE OF COLUMN ROPS1A.RAC4 */,
    RAC5 VARCHAR(5) /* TYPE OF COLUMN ROPS1A.RAC5 */,
    QV FLOAT /* TYPE OF COLUMN ROPS1A.QV */,
    ZNR INTEGER /* TYPE OF COLUMN ROPS1A.ZNR */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_REP_SKAIDRA_02 (
    SDT DATE,
    EDT DATE,
    PSUMM NUMERIC(14,5),
    PPERTYP VARCHAR(5))
RETURNS (
    ID INTEGER /* TYPE OF COLUMN ROPS1A.ID */,
    SPID INTEGER /* TYPE OF COLUMN ROPS1A.SPID */,
    DID INTEGER /* TYPE OF COLUMN ROPS1A.DID */,
    DETE DATE /* TYPE OF COLUMN ROPS1A.DETE */,
    NRX VARCHAR(5) /* TYPE OF COLUMN ROPS1A.NRX */,
    DOCTYP VARCHAR(10) /* TYPE OF COLUMN ROPS1A.DOCTYP */,
    DOCTYP1 VARCHAR(10) /* TYPE OF COLUMN ROPS1A.DOCTYP1 */,
    DOCTYP2 VARCHAR(10) /* TYPE OF COLUMN ROPS1A.DOCTYP2 */,
    DOCST VARCHAR(6) /* TYPE OF COLUMN ROPS1A.DOCST */,
    DOCNR VARCHAR(15) /* TYPE OF COLUMN ROPS1A.DOCNR */,
    CLID VARCHAR(15) /* TYPE OF COLUMN ROPS1A.CLID */,
    CLID2 VARCHAR(15) /* TYPE OF COLUMN ROPS1A.CLID2 */,
    NAME VARCHAR(50) /* TYPE OF COLUMN ROPS1A.NAME */,
    NAME2 VARCHAR(50) /* TYPE OF COLUMN ROPS1A.NAME2 */,
    REGNR VARCHAR(15) /* TYPE OF COLUMN ROPS1A.REGNR */,
    REGNR2 VARCHAR(15) /* TYPE OF COLUMN ROPS1A.REGNR2 */,
    B0 NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.B0 */,
    DESCR VARCHAR(80) /* TYPE OF COLUMN ROPS1A.DESCR */,
    DESCR2 VARCHAR(80) /* TYPE OF COLUMN ROPS1A.DESCR2 */,
    AC1 VARCHAR(8) /* TYPE OF COLUMN ROPS1A.AC1 */,
    AC2 VARCHAR(8) /* TYPE OF COLUMN ROPS1A.AC2 */,
    SAC1 VARCHAR(50) /* TYPE OF COLUMN ROPS1A.SAC1 */,
    SAC2 VARCHAR(50) /* TYPE OF COLUMN ROPS1A.SAC2 */,
    SUMMC NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.SUMMC */,
    CUR VARCHAR(3) /* TYPE OF COLUMN ROPS1A.CUR */,
    SUMM NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.SUMM */,
    PVN NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.PVN */,
    RAC VARCHAR(8) /* TYPE OF COLUMN ROPS1A.RAC */,
    SDB NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.SDB */,
    SCR NUMERIC(15,2) /* TYPE OF COLUMN ROPS1A.SCR */,
    RAC2 VARCHAR(8) /* TYPE OF COLUMN ROPS1A.RAC2 */,
    RAC3 VARCHAR(5) /* TYPE OF COLUMN ROPS1A.RAC3 */,
    RAC4 VARCHAR(8) /* TYPE OF COLUMN ROPS1A.RAC4 */,
    RAC5 VARCHAR(5) /* TYPE OF COLUMN ROPS1A.RAC5 */,
    QV FLOAT /* TYPE OF COLUMN ROPS1A.QV */,
    ZNR INTEGER /* TYPE OF COLUMN ROPS1A.ZNR */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_RESET_YEAR_GEN
AS
BEGIN
  EXIT;
END^





CREATE PROCEDURE SP_SET_KIEONR (
    SDT DATE,
    EDT DATE,
    PAC VARCHAR(8),
    PNR INTEGER)
AS
BEGIN
  EXIT;
END^





CREATE PROCEDURE SP_SET_KIZONR (
    SDT DATE,
    EDT DATE,
    PAC VARCHAR(8),
    PNR INTEGER)
AS
BEGIN
  EXIT;
END^





CREATE PROCEDURE SP_SET_USERNAME (
    USERNAME VARCHAR(15))
AS
BEGIN
  EXIT;
END^





CREATE PROCEDURE SP_VWOPS_FILTER_AND (
    PDATE1 DATE,
    PDATE2 DATE,
    PTEXT VARCHAR(50),
    PCLID VARCHAR(15),
    PAC11 VARCHAR(8),
    PAC12 VARCHAR(8),
    PAC13 VARCHAR(5),
    PAC14 VARCHAR(8),
    PAC15 VARCHAR(5),
    PAC21 VARCHAR(8),
    PAC22 VARCHAR(8),
    PAC23 VARCHAR(5),
    PAC24 VARCHAR(8),
    PAC25 VARCHAR(5),
    PDOCGR VARCHAR(10))
RETURNS (
    ID INTEGER /* TYPE OF COLUMN OPS.ID */,
    DOCID INTEGER /* TYPE OF COLUMN OPS.DOCID */,
    DETE DATE /* TYPE OF COLUMN OPSD.DETE */,
    NRX VARCHAR(5) /* TYPE OF COLUMN OPSD.NRX */,
    ZNR INTEGER /* TYPE OF COLUMN OPSD.ZNR */,
    DOCTYP VARCHAR(10) /* TYPE OF COLUMN OPSD.DOCTYP */,
    DOCST VARCHAR(6) /* TYPE OF COLUMN OPSD.DOCST */,
    DOCNR VARCHAR(15) /* TYPE OF COLUMN OPSD.DOCNR */,
    DOCTYP2 VARCHAR(10) /* TYPE OF COLUMN DOCTYP.ID1 */,
    CLID VARCHAR(15) /* TYPE OF COLUMN OPSD.CLID */,
    NAME VARCHAR(50) /* TYPE OF COLUMN PERSONS.NAME */,
    REGNR VARCHAR(15) /* TYPE OF COLUMN PERSONS.REGNR */,
    PVNREGNR VARCHAR(15) /* TYPE OF COLUMN PERSONS.PVNREGNR */,
    CLID2 VARCHAR(15) /* TYPE OF COLUMN OPSD.CLID2 */,
    NAME2 VARCHAR(50) /* TYPE OF COLUMN PERSONS.NAME */,
    REGNR2 VARCHAR(15) /* TYPE OF COLUMN PERSONS.REGNR */,
    DESCR VARCHAR(80) /* TYPE OF COLUMN OPSD.DESCR */,
    AC11 VARCHAR(8) /* TYPE OF COLUMN OPS.AC11 */,
    AC12 VARCHAR(8) /* TYPE OF COLUMN OPS.AC12 */,
    AC13 VARCHAR(5) /* TYPE OF COLUMN OPS.AC13 */,
    AC14 VARCHAR(8) /* TYPE OF COLUMN OPS.AC14 */,
    AC15 VARCHAR(5) /* TYPE OF COLUMN OPS.AC15 */,
    AC21 VARCHAR(8) /* TYPE OF COLUMN OPS.AC21 */,
    AC22 VARCHAR(8) /* TYPE OF COLUMN OPS.AC22 */,
    AC23 VARCHAR(5) /* TYPE OF COLUMN OPS.AC23 */,
    AC24 VARCHAR(8) /* TYPE OF COLUMN OPS.AC24 */,
    AC25 VARCHAR(5) /* TYPE OF COLUMN OPS.AC25 */,
    SUMMC NUMERIC(15,2) /* TYPE OF COLUMN OPS.SUMMC */,
    CUR VARCHAR(3) /* TYPE OF COLUMN OPS.CUR */,
    SUMM NUMERIC(15,2) /* TYPE OF COLUMN OPS.SUMM */,
    QV FLOAT /* TYPE OF COLUMN OPS.QV */,
    DESCR2 VARCHAR(50) /* TYPE OF COLUMN OPS.DESCR */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP_VWOPS_FILTER_OR (
    PDATE1 DATE,
    PDATE2 DATE,
    PTEXT VARCHAR(50),
    PCLID VARCHAR(15),
    PAC11 VARCHAR(8),
    PAC12 VARCHAR(8),
    PAC13 VARCHAR(5),
    PAC14 VARCHAR(8),
    PAC15 VARCHAR(5),
    PAC21 VARCHAR(8),
    PAC22 VARCHAR(8),
    PAC23 VARCHAR(5),
    PAC24 VARCHAR(8),
    PAC25 VARCHAR(5),
    PDOCGR VARCHAR(10))
RETURNS (
    ID INTEGER /* TYPE OF COLUMN OPS.ID */,
    DOCID INTEGER /* TYPE OF COLUMN OPS.DOCID */,
    DETE DATE /* TYPE OF COLUMN OPSD.DETE */,
    NRX VARCHAR(5) /* TYPE OF COLUMN OPSD.NRX */,
    ZNR INTEGER /* TYPE OF COLUMN OPSD.ZNR */,
    DOCTYP VARCHAR(10) /* TYPE OF COLUMN OPSD.DOCTYP */,
    DOCST VARCHAR(6) /* TYPE OF COLUMN OPSD.DOCST */,
    DOCNR VARCHAR(15) /* TYPE OF COLUMN OPSD.DOCNR */,
    DOCTYP2 VARCHAR(10) /* TYPE OF COLUMN DOCTYP.ID1 */,
    CLID VARCHAR(15) /* TYPE OF COLUMN OPSD.CLID */,
    NAME VARCHAR(50) /* TYPE OF COLUMN PERSONS.NAME */,
    REGNR VARCHAR(15) /* TYPE OF COLUMN PERSONS.REGNR */,
    PVNREGNR VARCHAR(15) /* TYPE OF COLUMN PERSONS.PVNREGNR */,
    CLID2 VARCHAR(15) /* TYPE OF COLUMN OPSD.CLID2 */,
    NAME2 VARCHAR(50) /* TYPE OF COLUMN PERSONS.NAME */,
    REGNR2 VARCHAR(15) /* TYPE OF COLUMN PERSONS.REGNR */,
    DESCR VARCHAR(80) /* TYPE OF COLUMN OPSD.DESCR */,
    AC11 VARCHAR(8) /* TYPE OF COLUMN OPS.AC11 */,
    AC12 VARCHAR(8) /* TYPE OF COLUMN OPS.AC12 */,
    AC13 VARCHAR(5) /* TYPE OF COLUMN OPS.AC13 */,
    AC14 VARCHAR(8) /* TYPE OF COLUMN OPS.AC14 */,
    AC15 VARCHAR(5) /* TYPE OF COLUMN OPS.AC15 */,
    AC21 VARCHAR(8) /* TYPE OF COLUMN OPS.AC21 */,
    AC22 VARCHAR(8) /* TYPE OF COLUMN OPS.AC22 */,
    AC23 VARCHAR(5) /* TYPE OF COLUMN OPS.AC23 */,
    AC24 VARCHAR(8) /* TYPE OF COLUMN OPS.AC24 */,
    AC25 VARCHAR(5) /* TYPE OF COLUMN OPS.AC25 */,
    SUMMC NUMERIC(15,2) /* TYPE OF COLUMN OPS.SUMMC */,
    CUR VARCHAR(3) /* TYPE OF COLUMN OPS.CUR */,
    SUMM NUMERIC(15,2) /* TYPE OF COLUMN OPS.SUMM */,
    QV FLOAT /* TYPE OF COLUMN OPS.QV */,
    DESCR2 VARCHAR(50) /* TYPE OF COLUMN OPS.DESCR */)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE SP1
RETURNS (
    RET INTEGER)
AS
BEGIN
  SUSPEND;
END^





CREATE PROCEDURE TEST
RETURNS (
    V1 INTEGER,
    V2 INTEGER)
AS
BEGIN
  SUSPEND;
END^






SET TERM ; ^



/******************************************************************************/
/***                                 Tables                                 ***/
/******************************************************************************/



CREATE TABLE ACP1 (
    ACPID  CHAR(1) NOT NULL,
    NAME   VARCHAR(50)
);

CREATE TABLE ACP21 (
    AC    VARCHAR(8) NOT NULL,
    NAME  VARCHAR(50),
    ID1   VARCHAR(15),
    ID2   VARCHAR(15)
);

CREATE TABLE ACP211 (
    IDX   VARCHAR(15) NOT NULL,
    NAME  VARCHAR(50),
    ID1   CHAR(2)
);

CREATE TABLE ACP22 (
    IDX   VARCHAR(15) NOT NULL,
    NAME  VARCHAR(50)
);

CREATE TABLE ACP23 (
    IDX   VARCHAR(5) NOT NULL,
    NAME  VARCHAR(50),
    ID1   CHAR(2),
    ID2   INTEGER
);

CREATE TABLE ACP24 (
    IDX    VARCHAR(8) NOT NULL,
    NAME   VARCHAR(50),
    UNIT   VARCHAR(10),
    PRICE  MONEY DEFAULT 0.0
);

CREATE TABLE ACP25 (
    IDX   VARCHAR(5) NOT NULL,
    NAME  VARCHAR(150),
    ID1   CHAR(2)
);

CREATE TABLE ACP25A (
    IDX   VARCHAR(5) NOT NULL,
    NAME  VARCHAR(50)
);

CREATE TABLE ACP6 (
    IDX   VARCHAR(15) NOT NULL,
    NAME  VARCHAR(50)
);

CREATE TABLE ACPLAN (
    AC    VARCHAR(8) NOT NULL,
    NAME  VARCHAR(90),
    B0    NUMERIC(15,4),
    AP1   VARCHAR(15),
    AP2   VARCHAR(15),
    AP3   VARCHAR(15),
    AP4   VARCHAR(15),
    AP5   VARCHAR(15)
);

CREATE TABLE ACPVN (
    ID    VARCHAR(8) NOT NULL,
    NM    VARCHAR(250),
    T     FLOAT,
    PZ1   VARCHAR(5),
    PZ2   INTEGER NOT NULL,
    PZ2A  INTEGER NOT NULL,
    PZ3   INTEGER NOT NULL,
    PZ4   INTEGER NOT NULL,
    PZ5   INTEGER NOT NULL
);

CREATE TABLE BAL0 (
    ID       INTEGER NOT NULL,
    AC11     VARCHAR(8) NOT NULL,
    AC24     VARCHAR(8),
    CLID     VARCHAR(15),
    SUMMDC   MONEY NOT NULL,
    SUMMCC   MONEY NOT NULL,
    CUR      VARCHAR(3) NOT NULL,
    CURRATE  NUMERIC(15,4) NOT NULL,
    SUMMD    MONEY NOT NULL,
    SUMMC    MONEY NOT NULL
);

CREATE TABLE BALA1 (
    BALID  VARCHAR(10) NOT NULL,
    DESCR  VARCHAR(50),
    TA     VARCHAR(50),
    TP     VARCHAR(50)
);

CREATE TABLE BALA2 (
    ID     INTEGER NOT NULL,
    NR     VARCHAR(5),
    BALID  VARCHAR(10),
    DC     DMV2,
    TP     DMV2 DEFAULT 'V',
    DESCR  VARCHAR(150),
    NR1    VARCHAR(5),
    NR2    VARCHAR(5),
    S1     MONEY,
    S2     MONEY
);

CREATE TABLE BALA21 (
    ID    INTEGER NOT NULL,
    SPID  INTEGER,
    BID   INTEGER,
    S1    MONEY,
    S2    MONEY
);

CREATE TABLE BALA3 (
    ID   INTEGER NOT NULL,
    ID2  INTEGER,
    TP   DMV2 DEFAULT 'Db',
    AC   VARCHAR(8)
);

CREATE TABLE BANKS (
    ID    VARCHAR(8) NOT NULL,
    NAME  VARCHAR(50) NOT NULL
);

CREATE TABLE CURRENCY (
    ID    VARCHAR(3) NOT NULL,
    DETE  DATE NOT NULL,
    RATE  NUMERIC(15,4) NOT NULL
);

CREATE TABLE DOCS0 (
    ID      INTEGER NOT NULL,
    DETE    DATE NOT NULL,
    DOCTYP  VARCHAR(10),
    DOCST   VARCHAR(6),
    DOCNR   VARCHAR(15),
    CLID    VARCHAR(15),
    DESCR   VARCHAR(80),
    SUMM    MONEY NOT NULL,
    PVN     MONEY NOT NULL,
    AC      VARCHAR(8) NOT NULL
);

CREATE TABLE DOCTYP (
    ID      VARCHAR(10) NOT NULL,
    NAME    VARCHAR(50),
    ID1     VARCHAR(10),
    NAME1   VARCHAR(50),
    TPZ     VARCHAR(10),
    PVNPAZ  VARCHAR(10)
);

CREATE TABLE DOCTYPA (
    ID    VARCHAR(10) NOT NULL,
    NAME  VARCHAR(50)
);

CREATE TABLE DOCTYPB (
    IDA  VARCHAR(10) NOT NULL,
    ID   VARCHAR(10) NOT NULL
);

CREATE TABLE LOGX (
    ID   INTEGER NOT NULL,
    LID  VARCHAR(5),
    DT   TIMESTAMP,
    USR  VARCHAR(15)
);

CREATE TABLE LOPS (
    IDL    INTEGER NOT NULL,
    ID     INTEGER,
    DTL    TIMESTAMP,
    DTLD   TIMESTAMP,
    USL    VARCHAR(15),
    TPL    INTEGER,
    DOCID  INTEGER,
    AC11   VARCHAR(8) NOT NULL,
    AC12   VARCHAR(8),
    AC13   VARCHAR(5),
    AC14   VARCHAR(8),
    AC15   VARCHAR(5),
    AC21   VARCHAR(8) NOT NULL,
    AC22   VARCHAR(8),
    AC23   VARCHAR(5),
    AC24   VARCHAR(8),
    AC25   VARCHAR(5),
    SUMMC  MONEY NOT NULL,
    CUR    VARCHAR(3) NOT NULL,
    SUMM   MONEY NOT NULL,
    QV     FLOAT,
    NL     SMALLINT,
    ODT    TIMESTAMP
);

CREATE TABLE LOPSD (
    IDL     INTEGER NOT NULL,
    ID      INTEGER,
    DTLD    TIMESTAMP,
    USL     VARCHAR(15),
    TPL     INTEGER,
    DETE    DATE,
    NRX     VARCHAR(5),
    DOCTYP  VARCHAR(10),
    DOCST   VARCHAR(6),
    DOCNR   VARCHAR(15),
    CLID    VARCHAR(15),
    CLID2   VARCHAR(15),
    DESCR   VARCHAR(80),
    SUMM    MONEY,
    PVN     MONEY,
    OPT     INTEGER,
    ZNR     INTEGER NOT NULL,
    ZU      VARCHAR(20),
    ZDT     TIMESTAMP,
    NL      SMALLINT,
    ODT     TIMESTAMP
);

CREATE TABLE LXOP (
    ID  INTEGER NOT NULL,
    AD  INTEGER,
    AR  INTEGER
);

CREATE TABLE M_ACCOUNTS (
    ID    DMAC1 NOT NULL,
    NAME  VARCHAR(100),
    TP    INTEGER
);

CREATE TABLE M_ACCOUNTTYPE (
    ID    INTEGER NOT NULL,
    NAME  VARCHAR(20)
);

CREATE TABLE M_ADDRESSSES (
    ID         INTEGER NOT NULL,
    IDSTORE    INTEGER,
    IDCOUNTRY  INTEGER,
    NAME       VARCHAR(300) NOT NULL,
    ADDRESS    VARCHAR(300) NOT NULL
);

CREATE TABLE M_BANKACCOUNTS (
    ID       INTEGER NOT NULL,
    IDBANK   INTEGER NOT NULL,
    IDSTORE  INTEGER,
    ACCOUNT  VARCHAR(30) DEFAULT '?''' NOT NULL
);

CREATE TABLE M_BANKS (
    ID    INTEGER NOT NULL,
    CODE  VARCHAR(10),
    NAME  VARCHAR(100)
);

CREATE TABLE M_CONTACTS (
    ID       INTEGER NOT NULL,
    IDSTORE  INTEGER,
    NAME     VARCHAR(50) NOT NULL,
    DESCR    VARCHAR(200),
    PHONE    VARCHAR(20),
    EMAIL    VARCHAR(50)
);

CREATE TABLE M_COUNTRIES (
    ID     INTEGER NOT NULL,
    NAME   VARCHAR(50) NOT NULL,
    CODE3  VARCHAR(5) NOT NULL,
    CODE2  VARCHAR(5) NOT NULL
);

CREATE TABLE M_DOCS (
    ID                 INTEGER NOT NULL,
    DT                 DATE NOT NULL,
    SR                 VARCHAR(10),
    NR                 VARCHAR(20),
    TP                 INTEGER DEFAULT 1 NOT NULL,
    PVNTYPE            INTEGER DEFAULT 1 NOT NULL,
    STATE              INTEGER DEFAULT 0 NOT NULL,
    IDSTOREIN          INTEGER DEFAULT 1 NOT NULL,
    IDSTOREOUT         INTEGER DEFAULT 1 NOT NULL,
    IDCREDDOC          INTEGER,
    CREDDOCDT          DATE,
    SUMM               MONEY DEFAULT 0 NOT NULL,
    IDSEQ              BIGINT DEFAULT 0 NOT NULL,
    ACCIN              DMAC1 DEFAULT '.?' NOT NULL,
    ACCOUT             DMAC1 DEFAULT '.?' NOT NULL,
    CREDDOCSR          VARCHAR(10),
    CREDDOCNR          VARCHAR(20),
    IDCARRIER          INTEGER,
    IDADDRESSOUT       INTEGER,
    IDADDRESSIN        INTEGER,
    IDVEHICLE          INTEGER,
    IDTRANSACTIONTYPE  INTEGER DEFAULT 1 NOT NULL,
    IDPAYMENTTYPE      INTEGER,
    IDDRIVER           INTEGER,
    ACCOUNTINGTP       SMALLINT DEFAULT 0 NOT NULL,
    ACCTP1             SMALLINT DEFAULT 1 NOT NULL,
    ACCTP2             SMALLINT DEFAULT 1 NOT NULL,
    DUEDATE            DATE
);

CREATE TABLE M_DOCTYPES (
    ID      INTEGER NOT NULL,
    CODE    VARCHAR(50),
    NAME    VARCHAR(200),
    OPTYPE  INTEGER DEFAULT 0 NOT NULL
);

CREATE TABLE M_ITEMS (
    ID             INTEGER NOT NULL,
    BARCODE        VARCHAR(30) DEFAULT '?''' NOT NULL,
    NAME           VARCHAR(300) DEFAULT '?''' NOT NULL,
    CAT            INTEGER DEFAULT 1 NOT NULL,
    UNITS          INTEGER DEFAULT 1 NOT NULL,
    STORE1         INTEGER DEFAULT 1 NOT NULL,
    PVNRATE        INTEGER DEFAULT 2 NOT NULL,
    ISSERVICE      INTEGER DEFAULT 0 NOT NULL,
    SELLPRICE      DPRICEX DEFAULT 0 NOT NULL,
    BUYPRICE       DPRICEX DEFAULT 0 NOT NULL,
    LASTBUYPRICE   DPRICEX DEFAULT 0 NOT NULL,
    AMOUNTINSTORE  DAMOUNT DEFAULT 0 NOT NULL,
    LASTSALEDATE   DATE,
    LASTBUYDATE    DATE
);

CREATE TABLE M_ITEMS_CAT (
    ID          INTEGER NOT NULL,
    NAME        VARCHAR(300) DEFAULT '?''' NOT NULL,
    CODE        VARCHAR(200) NOT NULL,
    ISGROUP     INTEGER DEFAULT 0 NOT NULL,
    METHOD      INTEGER DEFAULT 0 NOT NULL,
    ISSERVICES  INTEGER DEFAULT 0 NOT NULL,
    ACC6        DMAC1 DEFAULT '.?' NOT NULL,
    ACC7        DMAC1 DEFAULT '.?' NOT NULL
);

CREATE TABLE M_ITEMS_PER_STORE (
    IDITEM   INTEGER NOT NULL,
    IDSTORE  INTEGER NOT NULL,
    AMOUNT   DAMOUNT DEFAULT 0 NOT NULL
);

CREATE TABLE M_LINKS (
    ID1     INTEGER NOT NULL,
    ID2     INTEGER NOT NULL,
    IDITEM  INTEGER NOT NULL,
    AMOUNT  DAMOUNT DEFAULT 0 NOT NULL
);

CREATE TABLE M_PAYMENTTYPE (
    ID    INTEGER NOT NULL,
    NAME  VARCHAR(200)
);

CREATE TABLE M_PVNRATES (
    ID         INTEGER NOT NULL,
    CODE       VARCHAR(10) DEFAULT '?''' NOT NULL,
    NAME       VARCHAR(300),
    RATE       MONEY DEFAULT 0 NOT NULL,
    ISREVERSE  INTEGER DEFAULT 0 NOT NULL
);

CREATE TABLE M_PVNRATES2 (
    ID             INTEGER NOT NULL,
    IDRATE         INTEGER DEFAULT 1 NOT NULL,
    IDTP           INTEGER DEFAULT 0 NOT NULL,
    IDTRTP         INTEGER DEFAULT 0 NOT NULL,
    INCURMT        INTEGER DEFAULT 0 NOT NULL,
    CHANGESIGN     INTEGER DEFAULT 0 NOT NULL,
    BASE_DEB_FIN   INTEGER NOT NULL,
    BASE_DEB_PVN   VARCHAR(10),
    BASE_CRED_FIN  INTEGER NOT NULL,
    BASE_CRED_PVN  VARCHAR(10),
    PVN_DEB_FIN    INTEGER NOT NULL,
    PVN_DEB_PVN    VARCHAR(10),
    PVN_CRED_FIN   INTEGER NOT NULL,
    PVN_CRED_PVN   VARCHAR(10),
    IDPVNTEXT      INTEGER
);

CREATE TABLE M_PVNTEXTS (
    ID         INTEGER NOT NULL,
    CODE       VARCHAR(10) DEFAULT '?''' NOT NULL,
    "VERSION"  VARCHAR(10) DEFAULT '2022''',
    TAG1       VARCHAR(300),
    TAG2       VARCHAR(300)
);

CREATE TABLE M_PVNTYPE (
    ID    INTEGER NOT NULL,
    CODE  VARCHAR(15),
    NAME  VARCHAR(200)
);

CREATE TABLE M_ROWS (
    ID         INTEGER NOT NULL,
    IDDOC      INTEGER NOT NULL,
    IDITEM     INTEGER DEFAULT 1 NOT NULL,
    IDPVNRATE  INTEGER NOT NULL,
    UNITS      INTEGER DEFAULT 1 NOT NULL,
    IDCREDROW  INTEGER,
    AMOUNT     DAMOUNT DEFAULT 0 NOT NULL,
    DISCOUNT   FLOAT DEFAULT 0 NOT NULL,
    PRICE0     DPRICEX DEFAULT 0 NOT NULL,
    PRICE      DPRICEX DEFAULT 0 NOT NULL,
    BUYPRICE   DPRICEX DEFAULT 0 NOT NULL,
    OLDPRICE   DPRICEX DEFAULT 0 NOT NULL,
    TOLDPRICE  MONEY DEFAULT 0,
    TPRICE     MONEY DEFAULT 0 NOT NULL,
    TBUYPRICE  MONEY DEFAULT 0 NOT NULL,
    IDSEQ      BIGINT DEFAULT 0 NOT NULL,
    ACC6       DMAC1 DEFAULT '.?' NOT NULL,
    ACC7       DMAC1 DEFAULT '.?' NOT NULL,
    ISGONE     INTEGER DEFAULT 0 NOT NULL
);

CREATE TABLE M_STORES (
    ID        INTEGER NOT NULL,
    CODE      VARCHAR(20),
    NAME      VARCHAR(200),
    TP        INTEGER DEFAULT 1 NOT NULL,
    REGNR     VARCHAR(20),
    PVNREGNR  VARCHAR(20),
    ADDR      VARCHAR(500),
    PVNTP     INTEGER DEFAULT 1 NOT NULL,
    ACC21     DMAC1 DEFAULT '.?' NOT NULL,
    ACC23     DMAC1 DEFAULT '.?' NOT NULL,
    ACC53     DMAC1 DEFAULT '.?' NOT NULL
);

CREATE TABLE M_STORETYPE (
    ID          INTEGER NOT NULL,
    NAME        VARCHAR(200),
    TRACKSTOCK  INTEGER DEFAULT 1 NOT NULL
);

CREATE TABLE M_TRANSACTIONTYPE (
    ID    INTEGER NOT NULL,
    NAME  VARCHAR(200)
);

CREATE TABLE M_UNITS (
    ID    INTEGER NOT NULL,
    CODE  VARCHAR(20) DEFAULT '?' NOT NULL,
    NAME  VARCHAR(100)
);

CREATE TABLE M_VEHICLES (
    ID       INTEGER NOT NULL,
    IDSTORE  INTEGER,
    NAME     VARCHAR(20),
    REGNR    VARCHAR(15)
);

CREATE TABLE OPS (
    ID     INTEGER NOT NULL,
    DOCID  INTEGER NOT NULL,
    DESCR  VARCHAR(50),
    AC11   VARCHAR(8) NOT NULL,
    AC12   VARCHAR(8),
    AC13   VARCHAR(5),
    AC14   VARCHAR(8),
    AC15   VARCHAR(5),
    AC21   VARCHAR(8) NOT NULL,
    AC22   VARCHAR(8),
    AC23   VARCHAR(5),
    AC24   VARCHAR(8),
    AC25   VARCHAR(5),
    SUMMC  MONEY NOT NULL,
    CUR    VARCHAR(3) DEFAULT 'EUR' NOT NULL,
    SUMM   MONEY NOT NULL,
    QV     FLOAT DEFAULT 0.0,
    NL     SMALLINT DEFAULT 0,
    ZDT    TIMESTAMP
);

CREATE TABLE OPSD (
    ID      INTEGER NOT NULL,
    DETE    DATE NOT NULL,
    NRX     VARCHAR(5),
    DOCTYP  VARCHAR(10),
    DOCST   VARCHAR(6),
    DOCNR   VARCHAR(15),
    CLID    VARCHAR(15),
    CLID2   VARCHAR(15),
    DESCR   VARCHAR(80),
    SUMM    MONEY NOT NULL,
    PVN     MONEY NOT NULL,
    OPT     INTEGER DEFAULT 0 NOT NULL,
    ZNR     INTEGER DEFAULT 0 NOT NULL,
    ZU      VARCHAR(20),
    ZDT     TIMESTAMP DEFAULT LOCALTIMESTAMP(0) NOT NULL,
    DT2     DATE,
    NL      SMALLINT DEFAULT 0,
    YR      COMPUTED BY (extract(year from dete)),
    IDDOCM  INTEGER
);

CREATE TABLE OPSD_YEAR_SEQ (
    YR      INTEGER NOT NULL,
    NEXTNR  INTEGER NOT NULL
);

CREATE TABLE PARAMS (
    ID      INTEGER NOT NULL,
    PNAME   VARCHAR(20),
    PVALUE  VARCHAR(50),
    USR     VARCHAR(15)
);

CREATE TABLE PERSONS (
    CLID      VARCHAR(15) NOT NULL,
    NAME      VARCHAR(50),
    REGNR     VARCHAR(15),
    PVNREGNR  VARCHAR(15),
    TP        VARCHAR(15) DEFAULT 'KR',
    TP2       VARCHAR(5) DEFAULT 'JP',
    TP3       VARCHAR(5) DEFAULT 'Ir',
    ADDR      VARCHAR(100),
    ADDR2     VARCHAR(100),
    BANKID    VARCHAR(8),
    BANK      VARCHAR(50),
    BANKACC   VARCHAR(25),
    PHONE     VARCHAR(10),
    ATK       VARCHAR(6),
    ACT       INTEGER DEFAULT 1
);

CREATE TABLE PERSONTYP (
    ID    INTEGER NOT NULL,
    IDX   VARCHAR(15) NOT NULL,
    NAME  VARCHAR(50)
);

CREATE TABLE ROPS1A (
    ID       INTEGER NOT NULL,
    SPID     INTEGER,
    DID      INTEGER,
    DETE     DATE,
    NRX      VARCHAR(5),
    DOCTYP   VARCHAR(10),
    DOCTYP1  VARCHAR(10),
    DOCTYP2  VARCHAR(10),
    DOCST    VARCHAR(6),
    DOCNR    VARCHAR(15),
    CLID     VARCHAR(15),
    CLID2    VARCHAR(15),
    NAME     VARCHAR(50),
    NAME2    VARCHAR(50),
    REGNR    VARCHAR(15),
    REGNR2   VARCHAR(15),
    B0       MONEY,
    DESCR    VARCHAR(80),
    DESCR2   VARCHAR(80),
    AC1      VARCHAR(8),
    AC2      VARCHAR(8),
    SAC1     VARCHAR(50),
    SAC2     VARCHAR(50),
    SUMMC    MONEY,
    CUR      VARCHAR(3),
    SUMM     MONEY,
    PVN      MONEY,
    RAC      VARCHAR(8),
    SDB      MONEY,
    SCR      MONEY,
    RAC2     VARCHAR(8),
    RAC3     VARCHAR(5),
    RAC4     VARCHAR(8),
    RAC5     VARCHAR(5),
    QV       FLOAT,
    ZNR      INTEGER
);

CREATE TABLE ROPS2A (
    ID     INTEGER NOT NULL,
    SPID   INTEGER,
    AC     VARCHAR(8),
    RAC    VARCHAR(8),
    NAME   VARCHAR(150),
    B0     MONEY,
    SDB    MONEY,
    SCR    MONEY,
    TDB    MONEY,
    TCR    MONEY,
    CLID   VARCHAR(15),
    NAME1  VARCHAR(50),
    REGNR  VARCHAR(15),
    RNAME  VARCHAR(150)
);

CREATE TABLE ROPS2B (
    ID    INTEGER NOT NULL,
    SPID  INTEGER,
    AC    VARCHAR(8),
    NAME  VARCHAR(50),
    B0    MONEY,
    SDB   MONEY,
    SCR   MONEY,
    TDB   MONEY,
    TCR   MONEY
);

CREATE TABLE ROPS3A (
    ID    INTEGER NOT NULL,
    SPID  INTEGER,
    RAC   VARCHAR(8),
    NAME  VARCHAR(50),
    SDB   MONEY,
    SCR   MONEY,
    AC1   VARCHAR(8),
    CLID  VARCHAR(15)
);

CREATE TABLE TABLE1 (
    ID       INTEGER NOT NULL,
    FIELD1   VARCHAR(27),
    FIELD2   INTEGER,
    FIELD3   VARCHAR(50),
    FIELD4   VARCHAR(50),
    FIELD5   INTEGER,
    FIELD6   VARCHAR(50),
    FIELD7   VARCHAR(50),
    FIELD8   INTEGER,
    FIELD9   VARCHAR(50),
    FIELD10  INTEGER,
    FIELD11  INTEGER,
    FIELD12  INTEGER,
    FIELD13  FLOAT,
    FIELD14  FLOAT
);

CREATE TABLE TREM (
    ID    INTEGER NOT NULL,
    AID   VARCHAR(20),
    TEXT  BLOB SUB_TYPE 1 SEGMENT SIZE 80
);

CREATE TABLE TREPA1 (
    ID    INTEGER NOT NULL,
    SPID  INTEGER,
    I1    VARCHAR(15),
    NM    VARCHAR(50),
    DT    DATE,
    ST    VARCHAR(6),
    NR    VARCHAR(15),
    S1    MONEY,
    S2    MONEY,
    S3    MONEY,
    S4    MONEY
);

CREATE TABLE TREPAPAN (
    ID    INTEGER NOT NULL,
    SPID  INTEGER,
    AC1   VARCHAR(8),
    AC2   VARCHAR(8),
    AC3   VARCHAR(15),
    AC4   VARCHAR(15),
    AC5   VARCHAR(15),
    CL    VARCHAR(15),
    S1    MONEY,
    S2    MONEY,
    S3    MONEY,
    S4    MONEY
);

CREATE TABLE TREPDARZ1 (
    ID      INTEGER NOT NULL,
    SPID    INTEGER,
    DID     INTEGER,
    RID     INTEGER,
    DETE    DATE,
    NRX     VARCHAR(5),
    DOCTYP  VARCHAR(10),
    DOCST   VARCHAR(6),
    DOCNR   VARCHAR(15),
    DOCSTR  VARCHAR(200),
    CLID    VARCHAR(15),
    NAME    VARCHAR(50),
    REGNR   VARCHAR(15),
    DESCR   VARCHAR(80),
    AC1     VARCHAR(8),
    AC2     VARCHAR(8),
    AA      MONEY,
    A1      MONEY,
    A2      MONEY,
    A3      MONEY,
    A4      MONEY,
    A5      MONEY,
    A6      MONEY,
    A7      MONEY,
    A8      MONEY,
    A9      MONEY,
    A10     MONEY,
    A11     MONEY,
    A12     MONEY,
    A13     MONEY,
    A14     MONEY,
    A15     MONEY,
    A16     MONEY,
    A17     MONEY,
    A18     MONEY
);

CREATE TABLE TREPDARZ2 (
    ID    INTEGER NOT NULL,
    SPID  INTEGER,
    RID0  INTEGER,
    A1    MONEY,
    A2    MONEY,
    A3    MONEY,
    A4    MONEY,
    A5    MONEY,
    A6    MONEY,
    A7    MONEY,
    A8    MONEY,
    A9    MONEY,
    A10   MONEY,
    A11   MONEY,
    A12   MONEY,
    A13   MONEY,
    A14   MONEY,
    A15   MONEY,
    A16   MONEY,
    A17   MONEY,
    A18   MONEY,
    A19   MONEY,
    A20   MONEY,
    A21   MONEY
);

CREATE TABLE TREPDOCS1 (
    ID    INTEGER NOT NULL,
    SPID  INTEGER,
    SR    VARCHAR(6),
    NR    VARCHAR(9),
    S1    NUMERIC(15,4),
    S2    NUMERIC(15,4)
);

CREATE TABLE TREPDOCS2 (
    ID    INTEGER NOT NULL,
    SPID  INTEGER,
    SR    VARCHAR(6),
    NR1   VARCHAR(9),
    NR2   VARCHAR(9),
    S1    MONEY,
    S2    MONEY,
    VX    CHAR(1)
);

CREATE TABLE TREPDOCSS (
    ID    INTEGER NOT NULL,
    SPID  INTEGER,
    DID   INTEGER,
    S1    NUMERIC(15,4),
    S2    NUMERIC(15,4),
    S3    NUMERIC(15,4)
);

CREATE TABLE TREPMT (
    ID    INTEGER NOT NULL,
    SPID  INTEGER,
    AD    VARCHAR(3),
    AC1   VARCHAR(15),
    AC2   VARCHAR(15),
    ACN1  VARCHAR(50),
    ACN2  VARCHAR(50),
    M1    MONEY,
    M2    MONEY,
    M3    MONEY,
    M4    MONEY,
    M5    MONEY,
    M6    MONEY,
    M7    MONEY,
    M8    MONEY,
    M9    MONEY,
    M10   MONEY,
    M11   MONEY,
    M12   MONEY,
    N1    MONEY,
    N2    MONEY,
    N3    MONEY,
    N4    MONEY,
    N5    MONEY,
    N6    MONEY,
    N7    MONEY,
    N8    MONEY,
    N9    MONEY,
    N10   MONEY,
    N11   MONEY,
    N12   MONEY,
    MT    MONEY,
    NT    MONEY
);

CREATE TABLE TREPOPS (
    ID     INTEGER NOT NULL,
    DOCID  INTEGER NOT NULL,
    DESCR  VARCHAR(50),
    AC11   VARCHAR(8) NOT NULL,
    AC12   VARCHAR(8),
    AC13   VARCHAR(5),
    AC14   VARCHAR(8),
    AC15   VARCHAR(5),
    AC21   VARCHAR(8) NOT NULL,
    AC22   VARCHAR(8),
    AC23   VARCHAR(5),
    AC24   VARCHAR(8),
    AC25   VARCHAR(5),
    SUMMC  MONEY,
    CUR    VARCHAR(3),
    SUMM   MONEY,
    QV     FLOAT,
    NL     SMALLINT,
    ZDT    TIMESTAMP
);

CREATE TABLE TREPOPSD (
    ID      INTEGER NOT NULL,
    DETE    DATE NOT NULL,
    NRX     VARCHAR(5),
    DOCTYP  VARCHAR(10),
    DOCST   VARCHAR(6),
    DOCNR   VARCHAR(15),
    CLID    VARCHAR(15),
    CLID2   VARCHAR(15),
    DESCR   VARCHAR(80),
    SUMM    MONEY NOT NULL,
    PVN     MONEY NOT NULL,
    OPT     INTEGER,
    ZNR     INTEGER,
    ZU      VARCHAR(20),
    ZDT     TIMESTAMP,
    DT2     DATE,
    NL      SMALLINT,
    YR      INTEGER
);

CREATE TABLE TREPPVNZ1 (
    ID      INTEGER NOT NULL,
    SPID    INTEGER,
    DID     INTEGER,
    RID     INTEGER,
    DETE    DATE,
    NRX     VARCHAR(5),
    DOCTYP  VARCHAR(10),
    DOCST   VARCHAR(6),
    DOCNR   VARCHAR(15),
    DOCSTR  VARCHAR(200),
    CLID    VARCHAR(15),
    NAME    VARCHAR(50),
    REGNR   VARCHAR(15),
    DESCR   VARCHAR(80),
    AA      MONEY,
    A8      MONEY,
    A9      MONEY,
    A10     MONEY,
    A11     VARCHAR(8),
    A12     MONEY,
    A13     MONEY,
    A14     MONEY,
    A15     MONEY,
    A16     MONEY,
    A17     MONEY,
    A18     MONEY,
    A19     MONEY,
    A20     MONEY,
    A21     MONEY,
    A22     MONEY,
    A23     MONEY,
    A24     MONEY,
    A25     MONEY,
    A26     MONEY,
    A27     MONEY,
    A28     MONEY,
    A29     MONEY,
    A30     MONEY,
    A31     MONEY
);

CREATE TABLE TREPUDOCS (
    ID    INTEGER NOT NULL,
    SPID  INTEGER,
    LD    INTEGER,
    T0    INTEGER,
    TT    VARCHAR(50),
    T1    CHAR(1),
    T2    CHAR(1),
    T3    CHAR(2),
    DT1   VARCHAR(27),
    SR    VARCHAR(6),
    CT    SMALLINT,
    N1    VARCHAR(9),
    N2    VARCHAR(9),
    S1    FLOAT,
    S2    FLOAT
);

CREATE GLOBAL TEMPORARY TABLE TTEMP_BALA21 (
    ID    INTEGER NOT NULL,
    AC    VARCHAR(8),
    S1    MONEY DEFAULT 0,
    S2    MONEY DEFAULT 0,
    BID   INTEGER DEFAULT 0,
    SPID  COMPUTED BY (CURRENT_CONNECTION)
) ON COMMIT DELETE ROWS;

CREATE GLOBAL TEMPORARY TABLE TTEMP_BALAC (
    ID    INTEGER NOT NULL,
    BID   INTEGER DEFAULT 0,
    S1    MONEY DEFAULT 0,
    S2    MONEY DEFAULT 0,
    AC    VARCHAR(8),
    SPID  COMPUTED BY (CURRENT_CONNECTION)
) ON COMMIT DELETE ROWS;

CREATE GLOBAL TEMPORARY TABLE TTEMP_BALMT1 (
    ID    INTEGER NOT NULL,
    SPID  INTEGER DEFAULT 0,
    AC    VARCHAR(8) NOT NULL,
    M0    MONEY DEFAULT 0 NOT NULL,
    M1    MONEY DEFAULT 0 NOT NULL,
    M2    MONEY DEFAULT 0 NOT NULL,
    M3    MONEY DEFAULT 0 NOT NULL,
    M4    MONEY DEFAULT 0 NOT NULL,
    M5    MONEY DEFAULT 0 NOT NULL,
    M6    MONEY DEFAULT 0 NOT NULL,
    M7    MONEY DEFAULT 0 NOT NULL,
    M8    MONEY DEFAULT 0 NOT NULL,
    M9    MONEY DEFAULT 0 NOT NULL,
    M10   MONEY DEFAULT 0 NOT NULL,
    M11   MONEY DEFAULT 0 NOT NULL,
    M12   MONEY DEFAULT 0 NOT NULL
) ON COMMIT DELETE ROWS;

CREATE GLOBAL TEMPORARY TABLE TTEMP_BALMT2 (
    ID    INTEGER NOT NULL,
    SPID  INTEGER,
    BID   INTEGER DEFAULT 0 NOT NULL,
    M0    MONEY DEFAULT 0 NOT NULL,
    M1    MONEY DEFAULT 0 NOT NULL,
    M2    MONEY DEFAULT 0 NOT NULL,
    M3    MONEY DEFAULT 0 NOT NULL,
    M4    MONEY DEFAULT 0 NOT NULL,
    M5    MONEY DEFAULT 0 NOT NULL,
    M6    MONEY DEFAULT 0 NOT NULL,
    M7    MONEY DEFAULT 0 NOT NULL,
    M8    MONEY DEFAULT 0 NOT NULL,
    M9    MONEY DEFAULT 0 NOT NULL,
    M10   MONEY DEFAULT 0 NOT NULL,
    M11   MONEY DEFAULT 0 NOT NULL,
    M12   MONEY DEFAULT 0 NOT NULL
) ON COMMIT DELETE ROWS;

CREATE GLOBAL TEMPORARY TABLE TTEMP_DIFF2 (
    IDL1   INTEGER,
    IDL2   INTEGER,
    DOCID  INTEGER,
    ROWID  INTEGER
) ON COMMIT DELETE ROWS;

CREATE GLOBAL TEMPORARY TABLE TTEMP_PVN1 (
    ID       INTEGER NOT NULL,
    DID      INTEGER NOT NULL,
    CLID     VARCHAR(15),
    DOCTYP1  VARCHAR(10),
    DOCTYP2  VARCHAR(10),
    DOCTYPC  INTEGER,
    RAC5     VARCHAR(8),
    SUMM     MONEY DEFAULT 0,
    PVN      MONEY DEFAULT 0,
    SUMMC    MONEY DEFAULT 0,
    CUR      VARCHAR(3),
    SUMMDOC  MONEY
) ON COMMIT DELETE ROWS;

CREATE GLOBAL TEMPORARY TABLE TTEMP_PVN2 (
    CLID  VARCHAR(15) NOT NULL
) ON COMMIT DELETE ROWS;

CREATE TABLE TUDOCLISTS (
    ID   INTEGER NOT NULL,
    T1   CHAR(1),
    DT1  VARCHAR(27),
    DT2  VARCHAR(27)
);

CREATE TABLE TUDOCS (
    ID   INTEGER NOT NULL,
    LD   INTEGER,
    T1   CHAR(1),
    T2   CHAR(1),
    T3   CHAR(1),
    DT1  VARCHAR(27),
    SR   VARCHAR(6),
    CT   SMALLINT,
    N1   VARCHAR(9),
    N2   VARCHAR(9),
    S1   FLOAT,
    S2   FLOAT
);

CREATE TABLE TUPDFIELDS (
    ID    VARCHAR(20) NOT NULL,
    TEXT  VARCHAR(50),
    N     VARCHAR(3)
);

CREATE TABLE TUPVN1 (
    ID   INTEGER NOT NULL,
    DID  INTEGER,
    S    NUMERIC(15,4),
    S1   NUMERIC(15,4),
    S2   NUMERIC(15,4)
);

CREATE TABLE TUSERS (
    NM   VARCHAR(15) NOT NULL,
    PSW  VARCHAR(15),
    TP   CHAR(1),
    NR   INTEGER DEFAULT 0 NOT NULL
);

CREATE TABLE VW_OPS (
    ID       INTEGER NOT NULL,
    DOCID    INTEGER NOT NULL,
    DETE     DATE NOT NULL,
    NRX      VARCHAR(5),
    ZNR      INTEGER NOT NULL,
    DOCTYP   VARCHAR(10),
    DOCST    VARCHAR(6),
    DOCNR    VARCHAR(15),
    DOCTYP2  VARCHAR(10),
    CLID     VARCHAR(15),
    NAME     VARCHAR(50),
    REGNR    VARCHAR(15),
    CLID2    VARCHAR(15),
    NAME2    VARCHAR(50),
    REGNR2   VARCHAR(15),
    DESCR    VARCHAR(80),
    AC11     VARCHAR(8) NOT NULL,
    AC12     VARCHAR(8),
    AC13     VARCHAR(5),
    AC14     VARCHAR(8),
    AC15     VARCHAR(5),
    AC21     VARCHAR(8) NOT NULL,
    AC22     VARCHAR(8),
    AC23     VARCHAR(5),
    AC24     VARCHAR(8),
    AC25     VARCHAR(5),
    SUMMC    MONEY NOT NULL,
    CUR      VARCHAR(3) NOT NULL,
    SUMM     MONEY NOT NULL,
    QV       FLOAT,
    DESCR2   VARCHAR(80)
);

INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('11', 'NemateriƒÅlie ieguldijumi', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('1210', 'Zeme, ƒìkas', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('1220', 'IekƒÅrtas un ma≈°ƒ´nas', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('1221', 'IekƒÅrtas un ma≈°ƒ´nas ar ES finansƒìjumu', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('1230', 'PƒÅrƒìjie pamatlƒ´dzekƒºi', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('1231', 'PƒÅrƒìie pamatlƒ´dzekƒºi lƒ´zings', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('1240', 'Pamatlƒ´dzekƒºu izveido≈°anas izmaksas', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('1291', 'ƒíku nolietojums', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('1292', 'IekƒÅrtu un ma≈°ƒ´nu nolietojums', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('1293', 'PƒÅrƒìjo pamatlƒ´dzekƒºu nolietojums', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('1294', 'IekƒÅrtu un ma≈°ƒ´nu ar ES finansƒìjumu nolietojums', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('13', 'Ilgtermi≈Üa finansu ieguldijumi', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('2110', 'Izejvielas un materiƒÅli', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('2120', 'Nepabeigtie ra≈æojumi', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('2130', 'Gatavie ra≈æojumi un preces pƒÅrdo≈°anai', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('2140', 'Nepabeigtie pas≈´tijumi', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('2190', 'Avansa maksƒÅjumi par precƒìm', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('22', 'Produktƒ´vie un darba lopi', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('2310', 'Norƒìƒ∑ini ar pircƒìjiem un pas≈´tƒ´tƒÅjiem', NULL, 'DB');
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('2380', 'Avansa norƒìƒ∑ini', 'CN', NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('2410', 'NƒÅkamo periodu izdevumi', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('2610', 'kase', 'KA', NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('2620', 'Swedbank EUR', 'BA', NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('2621', 'Swedbank', 'BA', NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('3110', 'PamatkapitƒÅls', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('3210', 'PrivƒÅtiem nol≈´kiem iz≈Üemti lƒ´dzekƒºi', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('3220', 'PrivƒÅtie ieguldijumi', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('3310', 'Rezerves kapitƒÅls', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('3330', 'Citas likumƒÅ paredzƒìtas rezerves', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('3350', 'Stat≈´tos paredzƒìtƒÅs rezerves', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('3360', 'PƒÅrƒìjƒÅs rezerves', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('3410', 'PƒÅrskata gada nesadalƒ´tƒÅ peƒº≈Üa', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('3420', 'Iepriek≈°ƒìjo gadu nesadalƒ´tƒÅ peƒº≈Üa', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('5140', 'Citi aiz≈Üƒìmumi', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('51411', 'Lƒ´zings 1', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('51412', 'Lƒ´zings 2', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('5150', 'ƒ™stermi≈Üa aiz≈Üƒìmumi no kredƒ´tiestƒÅdƒìm', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('5160', 'Ilgtermi≈Üa aiz≈Üƒìmumi no kredƒ´tiestƒÅdƒìm', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('5210', 'Norƒìƒ∑ini par sa≈Üemtajiem avansiem', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('5310', 'Norƒìƒ∑ini ar piegƒÅdƒÅtƒÅjiem', NULL, 'KR');
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('5550', 'Norƒìƒ∑ini par parƒÅdiem personƒÅlam', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('5610', 'Norƒìƒ∑ini ar personƒÅlu', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('5620', 'Norƒìƒ∑ini par ieturƒìjumiem', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('5710', 'UIN', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('5722', 'IIN', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('5723', 'VSAOI', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('5724', 'NekustƒÅmƒÅ ƒ´pa≈°uma nodklis', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('5725', 'Dabas resursu nodokis', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('5726', 'Akcƒ´zes nodoklis', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('5727', 'Valsts nodevas', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('5731', 'PVN', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('5736', 'KokmateriƒÅlu PVN', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('5910', 'NƒÅkamo periodu ie≈Üƒìmumi (ilgtermi≈Üa)', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('5920', 'NƒÅkamo periodu ie≈Üƒìmumi (ƒ´stermi≈Üa)', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('6111', 'Lauksaimn.ie≈Üƒìmumi', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('6112', 'Nelauksaimn.ie≈Üƒìmumi', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('6113', 'Pakalpojumi', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('6114', 'Blakusprodukti', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('6520', 'PƒÅrƒìjie ie≈Üƒìmumi', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('6521', 'Subsƒ´dijas', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('6522', 'Akcƒ´zes nodokƒºa kompensƒÅcija', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('6530', 'Ie≈Üƒìmumi no zemes gabalu iznomƒÅ≈°anas', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('6540', 'Ie≈Üƒìmumi no apgrozƒÅmo lƒ´dzekƒºu pƒÅrdo≈°anas', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('6550', 'Ie≈Üƒìmumi no pamatlƒ´dzekƒºu pƒÅrdo≈°anas', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('6580', 'Papildu ieguldijumi', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('6590', 'KapitƒÅlieguldijumiem veiktie darbi', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('7110', 'MateriƒÅli', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('7111', 'MateriƒÅli', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('7112', 'Tehnikas uzturƒì≈°ana', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('7113', 'Smƒìrvielas', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('7114', 'KurinƒÅmais', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('71151', 'Benzƒ´ns', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('71152', 'Dƒ´zelis', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('71153', 'Smƒìrvielas', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('71154', 'Tehnikas uzturƒì≈°ana', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('7117', 'KurinƒÅmais', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('7118', 'Pakalpojumi', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('7119', 'Citi materiƒÅli', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('7120', 'Preƒçu iepirk≈°anas un piegƒÅdes izdevumi', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('7140', 'Taras izdevumi', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('7150', 'Muitas un ievednodevas', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('7160', 'PƒÅrƒìjie ƒÅrƒìjie izdevumi', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('7170', 'Samaksa par darbiem un pakalpojumiem no ƒÅrienes', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('7190', 'KrƒÅjumu vƒìrtƒ´bas izmai≈Üas', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('7210', 'StrƒÅdnieku algas', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('7211', 'Algas nelauksaimnieciskajai ra≈æo≈°anai', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('7310', 'SociƒÅlƒÅs apdro≈°inƒÅ≈°anas maksƒÅjumi', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('7311', 'VSAOI nelauksaimnieciskajai ra≈æo≈°anai', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('7330', 'Uz≈Üƒìmƒìjdarbƒ´bas riska nodeva', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('7410', 'NemateriƒÅlo ieguldijumu vƒìrtƒ´bas norakstƒ´≈°ana', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('7420', 'Pamatlƒ´dzekƒºu nolietojums', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('7421', 'Nolietojums pamatlƒ´dzekƒºiem ar ES finansƒìjumu', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('7510', 'Dabas aizsardzƒ´bas izdevumi', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('7521', 'Saimniecƒ´bas izdevumi', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('7522', 'Elektrƒ´ba', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('7523', 'GƒÅze', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('7524', 'Atkritumu izve≈°ana', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('7525', 'Tehnikas uzturƒì≈°ana', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('7526', 'Telpu uzturƒì≈°ana', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('7527', 'KomunƒÅlie maksƒÅjumi', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('7528', 'Nomas maksa', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('7529', 'Da≈æƒÅdi materiƒÅli', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('7540', 'Apdro≈°inƒÅ≈°anas maksƒÅjumi', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('7550', 'PƒÅrƒìjie saimnieciskƒÅs darbƒ´bas izdevumi', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('7552', 'Nodevas', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('7553', 'NeizskaitƒÅmais PVN', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('7560', 'Darbinieku apmƒÅcƒ´bas izdevumi', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('7570', 'Komandƒìjumu izdevumi', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('7610', 'Tara', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('7620', 'Preƒçu transportƒì≈°anas izdevumi', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('7630', 'Preƒçu transporta apdro≈°inƒÅ≈°ana', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('7640', 'SamaksƒÅtƒÅs komisijas naudas', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('7650', 'Citi pƒÅrdo≈°anas izdevumi', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('7651', 'ReklƒÅma', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('7710', 'Sakaru izdevumi', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('7711', 'Pasta izdevumi', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('7720', 'Kantora (biroja) izdevumi', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('7730', 'Jurista pakalpojumu apmaksa', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('7740', 'Gada pƒÅrskata un revƒ´zijas izdevumi', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('7750', 'Naudas apgrozijuma blakus izdevumi', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('7760', 'Transporta izdevumi administrƒÅcijas vajadzƒ´bƒÅm', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('7770', 'Citi administrƒÅcijas izdevumi', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('7771', 'KonsultƒÅcijas', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('7772', 'ReprezentƒÅcijas', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('7810', 'Iepriek≈°ƒìjo periodu izmaksas', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('8120', 'PƒÅrƒìjie ie≈Üƒìmumi no procentiem', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('8150', 'IenƒÅkumi no val≈´tas kursa samazinƒÅ≈°anƒÅs', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('8160', 'Sa≈ÜemtƒÅs soda naudas un lƒ´gumsodi', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('8170', 'Peƒº≈Üa no val≈´tas pirk≈°anas vai pƒÅrdo≈°anas', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('8190', 'Citi ie≈Üƒìmumi', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('8191', 'Personƒ´gie ie≈Üƒìmumi', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('8192', 'Attaisnotie personƒ´gie ie≈Üƒìmumi', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('8193', 'ES projekta finansƒìjums', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('8220', 'SamaksƒÅtie procenti', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('8240', 'Ilgtermi≈Üa aizdevumu procentu samaksa', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('8250', 'Zaudƒìjumi no val≈´tas kursa pazeminƒÅ≈°anƒÅs', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('8260', 'SamaksƒÅtas soda naudas un lƒ´gumsodi', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('8270', 'Zaudƒìjumi no val≈´tas pirk≈°anas vai pƒÅrdo≈°anas', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('8290', 'Citi izdevumi', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('8291', 'Personƒ´gie izdevumi', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('8292', 'Attaisnotie personƒ´gie izdevumi', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('8293', 'Ziedojumi', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('8310', 'ƒÄrkƒÅrtas ie≈Üƒìmumi', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('8410', 'ƒÄrkƒÅrtas izdevumi', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('8610', 'Peƒº≈Üa vai zaudƒìjumi', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('8810', 'UIN', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('8820', 'Dabas resursu nodoklis', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('8830', 'NekustƒÅmƒÅ ƒ´pa≈°uma nodoklis', NULL, NULL);
INSERT INTO ACP21 (AC, NAME, ID1, ID2) VALUES ('2131', 'Noliktava 2', NULL, NULL);


COMMIT WORK;

INSERT INTO ACP23 (IDX, NAME, ID1, ID2) VALUES ('BA', 'Banka', '01      ', 1);
INSERT INTO ACP23 (IDX, NAME, ID1, ID2) VALUES ('CIE', 'IenƒÅkumi, kas neattiecas uz nodokli', '08      ', 4);
INSERT INTO ACP23 (IDX, NAME, ID1, ID2) VALUES ('CIZ', 'NeuzrƒÅdƒÅmie izdevumi', '13      ', 4);
INSERT INTO ACP23 (IDX, NAME, ID1, ID2) VALUES ('CN', 'Cita nauda', '03      ', 1);
INSERT INTO ACP23 (IDX, NAME, ID1, ID2) VALUES ('DIZ', 'Darba alga un tai pielƒ´dzinƒÅmie izdevumi', NULL, 3);
INSERT INTO ACP23 (IDX, NAME, ID1, ID2) VALUES ('KA', 'Kase', '02      ', 1);
INSERT INTO ACP23 (IDX, NAME, ID1, ID2) VALUES ('LIE', 'IenƒÅkumi no lauksaimniecƒ´bas', '04      ', 2);
INSERT INTO ACP23 (IDX, NAME, ID1, ID2) VALUES ('LIZ', 'Izdevumi lauksaimniecƒ´bai', '09      ', 3);
INSERT INTO ACP23 (IDX, NAME, ID1, ID2) VALUES ('MIZ', 'SamaksƒÅtais mikrouz≈Üƒìmuma nodoklis', NULL, 3);
INSERT INTO ACP23 (IDX, NAME, ID1, ID2) VALUES ('NIE', 'IenƒÅkumi no citurienes', '05      ', 2);
INSERT INTO ACP23 (IDX, NAME, ID1, ID2) VALUES ('NIZ', 'Nelauksaimnieciskie izdevumi', '10      ', 3);
INSERT INTO ACP23 (IDX, NAME, ID1, ID2) VALUES ('PIZ', 'ProporcionƒÅli sadalƒÅmie izdevumi', '11      ', 3);
INSERT INTO ACP23 (IDX, NAME, ID1, ID2) VALUES ('SUB', 'Subsƒ´dijas', '06      ', 2);
INSERT INTO ACP23 (IDX, NAME, ID1, ID2) VALUES ('ZIE', 'Neapliekamie ienƒÅkumi', '07      ', 4);
INSERT INTO ACP23 (IDX, NAME, ID1, ID2) VALUES ('ZIZ', 'NeatskaitƒÅmie izdevumi', '12      ', 4);
INSERT INTO ACP23 (IDX, NAME, ID1, ID2) VALUES ('LIZ1', 'Izdevumi lauksaimniecƒ´bai ierobe≈æotƒÅ apmƒìrƒÅ', '14      ', 3);
INSERT INTO ACP23 (IDX, NAME, ID1, ID2) VALUES ('NIZ1', 'Nelauksaimnieciskie izdevumi ierobe≈æotƒÅ apmƒìrƒÅ', '15      ', 3);


COMMIT WORK;

INSERT INTO ACP24 (IDX, NAME, UNIT, PRICE) VALUES ('aa', 'aaa', NULL, 0);
INSERT INTO ACP24 (IDX, NAME, UNIT, PRICE) VALUES ('fff', 'qqq', NULL, 0);
INSERT INTO ACP24 (IDX, NAME, UNIT, PRICE) VALUES ('LK', 'Saimniecƒ´ba', NULL, 0);
INSERT INTO ACP24 (IDX, NAME, UNIT, PRICE) VALUES ('sss', 'qqq', NULL, 0);
INSERT INTO ACP24 (IDX, NAME, UNIT, PRICE) VALUES ('TL', 'Vekals + saimniecƒ´ba', NULL, 0);
INSERT INTO ACP24 (IDX, NAME, UNIT, PRICE) VALUES ('TR', 'Veikals', NULL, 0);


COMMIT WORK;

INSERT INTO ACP25 (IDX, NAME, ID1) VALUES ('0', 'Nav PVN', '0       ');
INSERT INTO ACP25 (IDX, NAME, ID1) VALUES ('104', 'ar PVN 21 % likmi apliekamie darƒ´jumi (arƒ´ pa≈°patƒìri≈Ü≈°)', '0       ');
INSERT INTO ACP25 (IDX, NAME, ID1) VALUES ('106', 'Atgriezta prece', '0       ');
INSERT INTO ACP25 (IDX, NAME, ID1) VALUES ('107', 'apliekami ar PVN 22% likmi', '0       ');
INSERT INTO ACP25 (IDX, NAME, ID1) VALUES ('108', 'apliekami ar PVN 12% likmi', '0       ');
INSERT INTO ACP25 (IDX, NAME, ID1) VALUES ('204', 'PVN ar 21 % likmi apliekamiem darƒ´jumiem', '0       ');
INSERT INTO ACP25 (IDX, NAME, ID1) VALUES ('206', 'PVN ar 22 % likmi apliekamiem darƒ´jumiem', '1       ');
INSERT INTO ACP25 (IDX, NAME, ID1) VALUES ('207', 'PVN ar 12 % likmi apliekamiem darƒ´jumiem', '1       ');
INSERT INTO ACP25 (IDX, NAME, ID1) VALUES ('305', 'PVN 21 % par precƒìm un pakalpojumiem iek≈°zemƒì savas saimnieciskƒÅs darbƒ´bas nodro≈°inƒÅ≈°anai', '0       ');
INSERT INTO ACP25 (IDX, NAME, ID1) VALUES ('307', 'PVN 22 % par precƒìm un pakalpojumiem iek≈°zemƒì savas saimnieciskƒÅs darbƒ´bas nodro≈°inƒÅ≈°anai', '1       ');
INSERT INTO ACP25 (IDX, NAME, ID1) VALUES ('308', 'PVN 12 % par precƒìm un pakalpojumiem iek≈°zemƒì savas saimnieciskƒÅs darbƒ´bas nodro≈°inƒÅ≈°anai', '1       ');
INSERT INTO ACP25 (IDX, NAME, ID1) VALUES ('400', 'Ar PVN neapliekamie izdevumi', '0       ');
INSERT INTO ACP25 (IDX, NAME, ID1) VALUES ('401', 'Sa≈ÜemtƒÅs preces un pakalpojumi iek≈°zemƒì ', '0       ');
INSERT INTO ACP25 (IDX, NAME, ID1) VALUES ('505', 'Atkal PVN 21%', '0       ');
INSERT INTO ACP25 (IDX, NAME, ID1) VALUES ('507', 'Atkal PVN 22%', '0       ');
INSERT INTO ACP25 (IDX, NAME, ID1) VALUES ('508', 'Atkal PVN 12%', '0       ');
INSERT INTO ACP25 (IDX, NAME, ID1) VALUES ('A01', 'SamaksƒÅts PVN bud≈æetam', '0       ');
INSERT INTO ACP25 (IDX, NAME, ID1) VALUES ('A02', 'Atgriezta pƒÅrmaksa', '0       ');
INSERT INTO ACP25 (IDX, NAME, ID1) VALUES ('K041', 'PiegƒÅdƒÅto kokmateriƒÅli apliekamƒÅm personƒÅm (neizmantojot mazumtirdzniecƒ´bas tƒ´klu) ', '0       ');
INSERT INTO ACP25 (IDX, NAME, ID1) VALUES ('K044', 'piegƒÅdƒÅti kokmater. CitƒÅs ES dalƒ´bvalstƒ´s', '0       ');
INSERT INTO ACP25 (IDX, NAME, ID1) VALUES ('K051', 'Sniegto pakalpojumi apliekamƒÅm personƒÅm', '0       ');
INSERT INTO ACP25 (IDX, NAME, ID1) VALUES ('K061', 'Sa≈Üemto kokmateriƒÅli no apliekamƒÅm personƒÅm (neizmantojot mazumtirdzniecƒ´bas tƒ´klu) ', '0       ');
INSERT INTO ACP25 (IDX, NAME, ID1) VALUES ('K063', 'no neapliekamƒÅm personƒÅm (neizmantojot mazumtirdzniecƒ´bas tƒ´klu)', '0       ');
INSERT INTO ACP25 (IDX, NAME, ID1) VALUES ('K071', 'Sa≈Üemto pakalpojumi no apliekamƒÅm personƒÅm', '0       ');
INSERT INTO ACP25 (IDX, NAME, ID1) VALUES ('K101', 'PVN par kokmateriƒÅliem, kas sa≈Üemti no apliekamƒÅm personƒÅm', '0       ');
INSERT INTO ACP25 (IDX, NAME, ID1) VALUES ('K105', 'PVN par pakalpojumiem, kas sa≈Üemti no apliekamƒÅm personƒÅm', '0       ');
INSERT INTO ACP25 (IDX, NAME, ID1) VALUES ('K108', 'PVN par kokmateriƒÅliem, kas piegƒÅdƒÅti apliekamƒÅm personƒÅm', '0       ');
INSERT INTO ACP25 (IDX, NAME, ID1) VALUES ('K109', 'PVN par pakalpojumiem, kas sniegti apliekamƒÅm personƒÅm', '0       ');
INSERT INTO ACP25 (IDX, NAME, ID1) VALUES ('G01', 'PiegƒÅdƒÅta prece (graudaugi un tehniskas kult≈´ras)', NULL);
INSERT INTO ACP25 (IDX, NAME, ID1) VALUES ('D02', 'Sa≈Üemta prece (mobƒ´lie telefoni, plan≈°etdatori, klƒìpjdatori, ...)', NULL);
INSERT INTO ACP25 (IDX, NAME, ID1) VALUES ('D11', 'PVN par pƒÅrdoto (mobƒ´lie telefoni, plan≈°etdatori, klƒìpjdatori, ...)', NULL);
INSERT INTO ACP25 (IDX, NAME, ID1) VALUES ('D12', 'PVN par sa≈Üemto (mobƒ´lie telefoni, plan≈°etdatori, klƒìpjdatori, ...)', NULL);
INSERT INTO ACP25 (IDX, NAME, ID1) VALUES ('G02', 'Sa≈Üemta prece (graudaugi un tehniskas kult≈´ras)', NULL);
INSERT INTO ACP25 (IDX, NAME, ID1) VALUES ('G12', 'PVN par sa≈Üemto prece (graudaugi un tehniskas kult≈´ras)', NULL);
INSERT INTO ACP25 (IDX, NAME, ID1) VALUES ('D01', 'PƒÅrdota prece (mobƒ´lie telefoni, plan≈°etdatori, klƒìpjdatori, ...)', NULL);


COMMIT WORK;

INSERT INTO ACP25A (IDX, NAME) VALUES ('0', 'Nav PVN');
INSERT INTO ACP25A (IDX, NAME) VALUES ('1', 'Ir PVN');


COMMIT WORK;

INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('101', 'ar PVN 18 % likmi apliekamie darƒ´jumi (arƒ´ pa≈°patƒìri≈Ü≈°)', 18, '41', 8, 31, 1, 0, 0);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('102', 'ar PVN 5 % likmi apliekamie darƒ´jumi (arƒ´ pa≈°patƒìri≈Ü≈°)', 5, '42.1', 9, 31, 1, 0, 0);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('104', 'ar PVN 21 % likmi apliekamie darƒ´jumi (arƒ´ pa≈°patƒìri≈Ü≈°)', 21, '41', 8, 31, 1, 0, 0);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('105', 'ar PVN 10 % likmi apliekamie darƒ´jumi (arƒ´ pa≈°patƒìri≈Ü≈°)', 10, '42', 9, 31, 1, 0, 0);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('106', 'Atgriezta prece', 0, '', 0, 0, 0, 0, 0);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('107', 'ar PVN 22 % likmi apliekamie darƒ´jumi (arƒ´ pa≈°patƒìri≈Ü≈°)', 22, '41', 8, 31, 1, 0, 0);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('108', 'ar PVN 12 % likmi apliekamie darƒ´jumi (arƒ´ pa≈°patƒìri≈Ü≈°)', 12, '42', 9, 31, 1, 0, 0);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('110', 'Ar 0% apliekamie darijumi', 0, '', 10, 0, 0, 0, 0);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('111', '- darƒ´jumi, kas veikti  brƒ´vostƒÅs un SEZ', 0, '44', 101, 31, 1, 0, 0);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('112', '- uz ES dalƒ´bvalstƒ´m piegƒÅdƒÅtƒÅs preces', 0, 'G', 102, 0, 71, 0, 0);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('113', '- citƒÅs ES dalƒ´bvalstƒ´s uzstƒÅdƒ´tƒÅs vai montƒìtƒÅs preces', 0, '46', 103, 0, 0, 0, 0);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('114', '- uz ES dalƒ´bvalstƒ´m piegƒÅdƒÅtie jaunie transportlƒ´dzekƒºi', 0, '47', 104, 0, 0, 0, 0);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('115', '- par sniegtajiem pakalpojumiem', 0, '48', 105, 0, 0, 0, 0);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('116', '- eksportƒìtƒÅs preces', 0, '481', 106, 0, 0, 0, 0);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('117', 'ƒÅrpuskopienas preƒçu piegƒÅdes muitas noliktavƒÅs un brƒ´vajƒÅs zonƒÅs', 0, '46', 103, 0, 0, 0, 0);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('118', 'CitƒÅs valstƒ´s veiktie darƒ´jumi', 0, '48.2', 12, 31, 1, 0, 0);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('121', 'Ar PVN neapliekamie darƒ´jumi', 0, '', 13, 0, 0, 0, 0);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('131', 'No ES dalƒ´bvalstƒ´m sa≈ÜemtƒÅs preces (18 %)', 18, 'G', 14, 0, 12, 0, 0);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('132', 'No ES dalƒ´bvalstƒ´m sa≈ÜemtƒÅs preces (5 %)', 5, 'G', 15, 0, 12, 0, 0);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('133', 'No ES dalƒ´bvalstƒ´m sa≈ÜemtƒÅs preces (21 %)', 21, 'G', 14, 0, 12, 0, 0);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('134', 'No ES dalƒ´bvalstƒ´m sa≈ÜemtƒÅs preces (10 %)', 10, 'G', 15, 0, 12, 0, 0);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('135', 'No ES dalƒ´bvalstƒ´m sa≈Üemtie pakalpojumi (21 %)', 21, 'P', 14, 0, 12, 0, 0);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('136', 'No ES dalƒ´bvalstƒ´m sa≈ÜemtƒÅs preces (22 %)', 22, 'G', 14, 0, 12, 0, 0);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('137', 'No ES dalƒ´bvalstƒ´m sa≈Üemtie pakalpojumi (22 %)', 22, 'P', 14, 0, 12, 0, 0);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('201', 'PVN ar 18 % likmi apliekamiem darƒ´jumiem', 18, '41', 16, 32, 2, 0, 1);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('202', 'PVN ar 5 % likmi apliekamiem darƒ´jumiem', 5, '42.1', 17, 32, 2, 0, 1);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('204', 'PVN ar 21 % likmi apliekamiem darƒ´jumiem', 21, '41', 16, 32, 2, 0, 1);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('205', 'PVN ar 10 % likmi apliekamiem darƒ´jumiem', 10, '42', 17, 32, 2, 0, 1);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('206', 'PVN ar 22 % likmi apliekamiem darƒ´jumiem', 22, '41', 16, 32, 2, 0, 1);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('207', 'PVN ar 12 % likmi apliekamiem darƒ´jumiem', 12, '42', 17, 32, 2, 0, 1);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('211', 'par sa≈Üemtajiem pakalpojumiem', 21, '48.2', 18, 32, 2, 0, 1);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('231', 'PVN ar 18 % likmi apliekamƒÅm precƒìm, kas sa≈Üemtas no ES dalƒ´bvalstƒ´m', 18, '', 19, 0, 13, 0, 2);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('232', 'PVN ar 5 % likmi apliekamƒÅm precƒìm, kas sa≈Üemtas no ES dalƒ´bvalstƒ´m', 5, '', 20, 0, 13, 0, 2);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('233', 'PVN ar 21 % likmi apliekamƒÅm precƒìm, kas sa≈Üemtas no ES dalƒ´bvalstƒ´m', 21, '', 19, 0, 13, 0, 2);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('234', 'PVN ar 10 % likmi apliekamƒÅm precƒìm, kas sa≈Üemtas no ES dalƒ´bvalstƒ´m', 10, '', 20, 0, 13, 0, 2);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('235', 'PVN ar 21 % likmi apliekamiem pakalpojumiem, kas sa≈Üemtas no ES dalƒ´bvalstƒ´m', 21, '', 19, 0, 13, 0, 2);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('236', 'PVN ar 22 % likmi apliekamƒÅm precƒìm, kas sa≈Üemtas no ES dalƒ´bvalstƒ´m', 22, '', 19, 0, 13, 0, 2);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('237', 'PVN ar 12 % likmi apliekamƒÅm precƒìm, kas sa≈Üemtas no ES dalƒ´bvalstƒ´m', 12, '', 20, 0, 13, 0, 2);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('238', 'PVN ar 22 % likmi apliekamiem pakalpojumiem, kas sa≈Üemtas no ES dalƒ´bvalstƒ´m', 22, '', 19, 0, 13, 0, 2);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('251', 'AtskaitƒÅmais priek≈°nodoklis vai aprƒìƒ∑inƒÅtais nodoklis saska≈ÜƒÅ ar likuma 13.2 pantu', 21, '', 0, 0, 0, 0, 1);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('301', 'PVN 18 % par precƒìm un pakalpojumiem iek≈°zemƒì savas saimnieciskƒÅs darbƒ´bas nodro≈°inƒÅ≈°anai', 18, 'A', 27, 1, 4, 0, 1);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('302', 'PVN 5 % par precƒìm un pakalpojumiem iek≈°zemƒì savas saimnieciskƒÅs darbƒ´bas nodro≈°inƒÅ≈°anai', 5, 'A', 27, 1, 4, 0, 1);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('304', 'zemnieku saimniecƒ´bƒÅm izmaksƒÅtƒÅ PVN kompensƒÅcija', 12, 'K', 30, 1, 4, 0, 0);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('305', 'PVN 21 % par precƒìm un pakalpojumiem iek≈°zemƒì savas saimnieciskƒÅs darbƒ´bas nodro≈°inƒÅ≈°anai', 21, 'A', 27, 1, 4, 0, 1);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('306', 'PVN 10 % par precƒìm un pakalpojumiem iek≈°zemƒì savas saimnieciskƒÅs darbƒ´bas nodro≈°inƒÅ≈°anai', 10, 'A', 27, 1, 4, 0, 1);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('307', 'PVN 22 % par precƒìm un pakalpojumiem iek≈°zemƒì savas saimnieciskƒÅs darbƒ´bas nodro≈°inƒÅ≈°anai', 22, 'A', 27, 1, 4, 0, 1);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('308', 'PVN 12 % par precƒìm un pakalpojumiem iek≈°zemƒì savas saimnieciskƒÅs darbƒ´bas nodro≈°inƒÅ≈°anai', 12, 'A', 27, 1, 4, 0, 1);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('311', 'par importƒìtajƒÅm precƒìm savas saimnieciskƒÅs darbƒ´bas nodro≈°inƒÅ≈°anai', 1, 'I', 26, 1, 4, 0, 3);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('321', 'Aprƒìƒ∑inƒÅtƒÅ PVN summa saska≈ÜƒÅ ar likuma 92.panta pirmƒÅs daƒºas 4.punktu (iz≈Üemot 64.rindu)', 1, 'N', 28, 1, 4, 0, 3);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('331', 'aprƒìƒ∑inƒÅtais priek≈°nodoklis par precƒìm, kas sa≈Üemtas no ES dalƒ´bvalstƒ´m', 1, 'G', 29, 2, 6, 0, 2);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('332', 'aprƒìƒ∑inƒÅtais priek≈°nodoklis par pakalpojumiem, kas sa≈Üemtas no ES dalƒ´bvalstƒ´m', 1, 'P', 29, 2, 6, 0, 2);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('341', 'NeatskaitƒÅmais priek≈°nodoklis', 0, '', 0, 0, 0, 0, 0);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('351', 'AtskaitƒÅmais priek≈°nodoklis vai aprƒìƒ∑inƒÅtais nodoklis saska≈ÜƒÅ ar likuma 13.2 pantu', 0, '', 0, 0, 0, 0, 0);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('400', 'Ar PVN neapliekamie izdevumi', 0, '', 0, 0, 9, 0, 0);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('401', 'Sa≈ÜemtƒÅs preces un pakalpojumi iek≈°zemƒì ', 0, 'A', 23, 0, 8, 0, 0);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('411', 'ImportƒìtƒÅs preces ', 0, 'I', 22, 0, 8, 0, 0);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('421', 'Sa≈Üemtie pakalpojumi, par kuriem PVN maksƒÅ pakalpojumu sa≈Üƒìmƒìjs', 0, '', 24, 0, 8, 0, 0);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('431', 'Preces, kas sa≈Üemtas no ES dalƒ´bvalstƒ´m', 0, 'G', 25, 0, 0, 0, 0);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('501', 'Atkal PVN 18%', 18, '', 0, 0, 9, 0, 1);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('502', 'Atkal PVN 5%', 5, '', 0, 0, 9, 0, 1);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('504', 'Atkal PVN 12%', 12, '', 0, 0, 9, 0, 1);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('505', 'Atkal PVN 21%', 21, '', 0, 0, 9, 0, 1);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('506', 'Atkal PVN 10%', 10, '', 0, 0, 9, 0, 1);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('507', 'Atkal PVN 22%', 22, '', 0, 0, 9, 0, 1);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('508', 'Atkal PVN 12%', 12, '', 0, 0, 9, 0, 1);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('A01', 'MaksƒÅjumi bud≈æetam', 0, '', 0, 0, 10, 0, 0);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('A02', 'Atgriezta pƒÅrmaksa', 0, '', 0, 0, 10, 0, 0);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('B01', 'ie≈Üƒìmumi no b≈´vniecƒ´bas pakalpojumiem', 0, '41.1', 8, 21, 1, 1, 0);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('B02', 'sa≈Üemtie b≈´vniecƒ´bas pakalpojumi', 0, 'R3', 23, 0, 8, 1, 0);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('B11', 'aprƒìƒ∑inƒÅtais PVN no b≈´vniecƒ´bas pakalpojumiem', 1, '41.1', 8, 22, 2, 1, 2);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('B12', 'PVN par sa≈Üemtajiem b≈´vniecƒ´bas pakalpojumiem', 1, 'R3', 201, 0, 5, 1, 2);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('K041', 'PiegƒÅdƒÅtie kokmateriƒÅli apliekamƒÅm personƒÅm (neizmantojot mazumtirdzniecƒ´bas tƒ´klu) ', 0, '41.1', 8, 21, 1, 1, 0);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('K042', 'PiegƒÅdƒÅtie kokmateriƒÅli, izmantojot mazumtirdzniecƒ´bas tƒ´klu', 0, '', 8, 0, 1, 1, 0);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('K043', 'PiegƒÅdƒÅtie kokmateriƒÅli, neapliekamƒÅm personƒÅm (neizmantojot mazumtirdzniecƒ´bas tƒ´klu) ', 0, '41', 8, 31, 1, 1, 0);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('K044', 'PiegƒÅdƒÅtie kokmateriƒÅli  citƒÅs Eiropas Savienƒ´bas dalƒ´bvalstƒ´s', 0, 'G', 12, 0, 71, 1, 0);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('K045', 'PiegƒÅdƒÅtie kokmateriƒÅli brƒ´vajƒÅs zonƒÅs un muitas noliktavƒÅs piegƒÅdƒÅtie kokmateriƒÅli, kas ievesti Latvijas RepublikƒÅ no treƒÅjƒÅm valstƒ´m vai tre≈°ajƒÅm teritorijƒÅm un nav izlaisti brƒ´vam apgrozijumam iek≈°zemƒì', 0, '', 0, 0, 0, 1, 0);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('K046', 'PiegƒÅdƒÅto kokmateriƒÅli tre≈°ajƒÅs valstƒ´s, vai tre≈°ajƒÅs teritorijƒÅs reƒ£istrƒìtƒÅm personƒÅm, kas nav reƒ£istrƒìtas VID apliekamo personu reƒ£istrƒÅ', 0, '481', 16, 0, 8, 1, 0);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('K051', 'Sniegtie pakalpojumi apliekamƒÅm personƒÅm', 0, '41.1', 8, 21, 1, 1, 0);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('K052', 'Sniegtie pakalpojumi neapliekamƒÅm personƒÅm', 0, '41', 8, 31, 1, 1, 0);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('K053', 'Sniegtie pakalpojumi citƒÅs Eiropas Savienƒ´bas dalƒ´bvalstƒ´s', 0, 'P', 15, 0, 72, 1, 0);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('K054', 'Sniegtie pakalpojumi brƒ´vajƒÅs zonƒÅs un muitas noliktavƒÅs sniegtie pakalpojumi, kas tie≈°i saistƒ´ti ar kokmateriƒÅliem, kas ievesti Latvijas RepublikƒÅ no treƒÅjƒÅm valstƒ´m vai tre≈°ajƒÅm teritorijƒÅm un nav izlaisti brƒ´vam apgrozijumam iek≈°zemƒì', 0, '', 0, 0, 0, 1, 0);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('K055', 'Sniegto pakalpojumi tre≈°ajƒÅs valstƒ´s, vai tre≈°ajƒÅs teritorijƒÅs reƒ£istrƒìtƒÅm personƒÅm, kas nav reƒ£istrƒìtas VID apliekamo personu reƒ£istrƒÅ', 0, '481', 16, 0, 0, 1, 0);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('K061', 'Sa≈Üemtie kokmateriƒÅli no apliekamƒÅm personƒÅm (neizmantojot mazumtirdzniecƒ´bas tƒ´klu) ', 0, 'R1', 23, 0, 8, 1, 0);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('K062', 'Sa≈Üemtie kokmateriƒÅli, izmantojot mazumtirdzniecƒ´bas tƒ´klu', 0, '', 23, 0, 8, 1, 0);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('K063', 'no neapliekamƒÅm personƒÅm (neizmantojot mazumtirdzniecƒ´bas tƒ´klu)', 0, '', 0, 0, 0, 1, 0);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('K064', 'brƒ´vajƒÅs zonƒÅs un muitas noliktavƒÅs piegƒÅdƒÅtie kokmateriƒÅli, kas ievesti Latvijas RepublikƒÅ no treƒÅjƒÅm valstƒ´m vai tre≈°ajƒÅm teritorijƒÅm un nav izlaisti brƒ´vam apgrozijumam iek≈°zemƒì', 0, '', 0, 0, 0, 1, 0);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('K065', 'brƒ´vajƒÅs zonƒÅs un muitas noliktavƒÅs ar PVN 0 % likmi sa≈Üemto kokmateriƒÅlu vƒìrtƒ´ba, ja kokmateriƒÅli ievesti Latvijas RepublikƒÅ no tre≈°ajƒÅm valstƒ´m vai tre≈°ajƒÅm teritorijƒÅm un nav izlaisti brƒ´vam apgrozƒ´jumam iek≈°zemƒì', 0, '', 23, 0, 8, 1, 0);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('K071', 'Sa≈Üemtie pakalpojumi no apliekamƒÅm personƒÅm', 0, 'R1', 23, 0, 8, 1, 0);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('K072', 'Sa≈Üemtie pakalpojumi no neapliekamƒÅm personƒÅm', 0, '', 0, 0, 0, 1, 0);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('K073', 'Sa≈Üemtie pakalpojumi pakalpojumi, kas apliekami ar PVN 0 procentu likmi ', 0, '', 0, 0, 0, 1, 0);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('K08', 'Neapliekamo darƒ´jumu veik≈°anai izmantoto kokmateriƒÅlu vƒìrtƒ´ba', 0, '', 0, 0, 0, 1, 0);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('K09', 'Neapliekamo darƒ´jumu veik≈°anai izmantoto pakalpojumu vƒìrtƒ´ba', 0, '', 0, 0, 0, 1, 0);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('K101', 'PVN par kokmateriƒÅliem, kas sa≈Üemti no apliekamƒÅm personƒÅm', 1, 'R1', 201, 11, 5, 1, 2);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('K102', 'PVN par kokmateriƒÅliem, kas piegƒÅdƒÅti, izmantojot mazumtirdzniecƒ´bas tƒ´klu', 1, '', 16, 0, 0, 1, 3);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('K103', 'PVN par kokmateriƒÅliem, kas piegƒÅdƒÅti neapliekamƒÅm personƒÅmi, neizmantojot mazumtirdzniecƒ´bas tƒ´klu', 1, '41', 16, 32, 2, 1, 3);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('K104', 'PVN par kokmateriƒÅliem, kas piegƒÅdƒÅti citƒÅs ES dalƒ´bvalstƒ´s vai tre≈°ajƒÅs valstƒ´s, vai tre≈°ajƒÅs teritorijƒÅs reƒ£istrƒìtƒÅm personƒÅm, kas nav reƒ£istrƒìtas VID', 1, '', 16, 0, 0, 1, 2);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('K105', 'PVN par pakalpojumiem, kas sa≈Üemti no apliekamƒÅm personƒÅm', 1, 'R1', 201, 11, 5, 1, 2);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('K106', 'PVN par pakalpojumiem, kas sniegti neapliekamƒÅm personƒÅm', 1, '41.1', 16, 32, 2, 1, 3);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('K107', 'PVN par pakalopjumiem, kas sniegti citƒÅs ES dalƒ´bvalstƒ´s vai tre≈°ajƒÅs valstƒ´s, vai tre≈°ajƒÅs teritorijƒÅs reƒ£istrƒìtƒÅm personƒÅm, kas nav reƒ£istrƒìtas VID', 1, '', 16, 0, 3, 1, 2);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('K108', 'PVN par kokmateriƒÅliem, kas piegƒÅdƒÅti apliekamƒÅm personƒÅm', 1, '41.1', 16, 22, 2, 1, 2);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('K109', 'PVN par pakalpojumiem, kas sniegti apliekamƒÅm personƒÅm', 1, '41.1', 16, 22, 2, 1, 2);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('K111', 'SamaksƒÅtais PVN par kokmateriƒÅliem, kas iegƒÅdƒÅti, izmantojot mazumtirdzniecƒ´bas tƒ´klu', 0, 'A', 27, 0, 4, 1, 0);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('D01', 'PƒÅrdota prece (mobƒ´lie telefoni, plan≈°etdatori, klƒìpjdatori, ...)', 0, '41.1', 8, 21, 1, 1, 0);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('D02', 'Sa≈Üemta prece (mobƒ´lie telefoni, plan≈°etdatori, klƒìpjdatori, ...)', 0, 'R4', 23, 0, 8, 1, 0);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('D11', 'PVN par pƒÅrdoto (mobƒ´lie telefoni, plan≈°etdatori, klƒìpjdatori, ...)', 1, '41.1', 8, 22, 2, 1, 2);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('D12', 'PVN par sa≈Üemto (mobƒ´lie telefoni, plan≈°etdatori, klƒìpjdatori, ...)', 1, 'R4', 201, 0, 5, 1, 2);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('1121', '- uz ES dalƒ´bvalstƒ´m piegƒÅdƒÅtƒÅs preces (42.p.)', 0, 'G', 102, 0, 71, 0, 0);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('138', 'No ES dalƒ´bvalstƒ´m sa≈ÜemtƒÅs preces (12 %)', 12, 'G', 14, 0, 12, 0, 0);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('B03', 'ie≈Üƒìmumi no b≈´vniecƒ´bas izstrƒÅdƒÅjumu piegƒÅdƒìm', 0, '41.1', 8, 21, 1, 1, 0);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('B04', 'sa≈Üemtie b≈´vniecƒ´bas izstrƒÅdƒÅjumi', 0, 'R9', 23, 0, 8, 1, 0);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('B13', 'aprƒìƒ∑inƒÅtais PVN no b≈´vniecƒ´bas izstrƒÅdƒÅjumu piegƒÅdƒìm', 1, '41.1', 8, 22, 2, 1, 2);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('B14', 'PVN par sa≈Üemtajiem b≈´vniecƒ´bas izstrƒÅdƒÅjumiem', 1, 'R9', 201, 0, 5, 1, 2);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('D03', 'PƒÅrdota prece (sadzƒ´ves elektronisko iekƒÅrtas un aparat≈´ra)', 0, '41.1', 8, 21, 1, 1, 0);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('D04', 'Sa≈Üemta prece (sadzƒ´ves elektronisko iekƒÅrtas un aparat≈´ra)', 0, 'R8', 23, 0, 8, 1, 0);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('D13', 'PVN par pƒÅrdoto (sadzƒ´ves elektronisko iekƒÅrtas un aparat≈´ra)', 1, '41.1', 8, 22, 2, 1, 2);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('D14', 'PVN par sa≈Üemto (sadzƒ´ves elektronisko iekƒÅrtas un aparat≈´ra)', 1, 'R8', 201, 0, 5, 1, 2);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('M01', 'ie≈Üƒìmumi no metƒÅlizstrƒÅdƒÅjumu piegƒÅdƒìm un saistƒ´tiem pakalpojumiem', 0, '41.1', 8, 21, 1, 1, 0);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('M02', 'sa≈Üemtie metƒÅlizstrƒÅdƒÅjumi un saistƒ´tie pakalpojumi', 0, 'R7', 23, 0, 8, 1, 0);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('M11', 'aprƒìƒ∑inƒÅtais PVN no ie≈Üƒìmumi no metƒÅlizstrƒÅdƒÅjumu piegƒÅdƒìm un saistƒ´tiem pakalpojumiem', 1, '41.1', 8, 22, 2, 1, 2);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('M12', 'PVN par sa≈Üemtajiem metƒÅlizstrƒÅdƒÅjumiem un saistƒ´tiem pakalpojumiem', 1, 'R7', 201, 0, 5, 1, 2);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('361', 'Vieglo transportlƒ´dzekƒºu iegƒÅde un imports, PVN 21% likme', 21, 'C', 27, 1, 4, 0, 1);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('432', 'Pakalpojumi, kas sa≈Üemtas no ES dalƒ´bvalstƒ´m', 0, 'P', 25, 0, 0, 0, 0);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('G01', 'PiegƒÅdƒÅta prece (graudaugi un tehniskas kult≈´ras)', 0, '41.1', 8, 21, 1, 1, 0);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('G02', 'Sa≈Üemta prece (graudaugi un tehniskas kult≈´ras)', 0, 'R5', 23, 0, 8, 1, 0);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('G11', 'PVN par piegƒÅdƒÅto prece (graudaugi un tehniskas kult≈´ras)', 1, '41.1', 8, 22, 2, 1, 2);
INSERT INTO ACPVN (ID, NM, T, PZ1, PZ2, PZ2A, PZ3, PZ4, PZ5) VALUES ('G12', 'PVN par sa≈Üemto prece (graudaugi un tehniskas kult≈´ras)', 1, 'R5', 201, 0, 5, 1, 2);


COMMIT WORK;

INSERT INTO PERSONS (CLID, NAME, REGNR, PVNREGNR, TP, TP2, TP3, ADDR, ADDR2, BANKID, BANK, BANKACC, PHONE, ATK, ACT) VALUES ('es pats', 'Es Pats', '010101-10000', NULL, 'KR', 'FP', 'Nav', NULL, NULL, NULL, NULL, NULL, NULL, NULL, 1);
INSERT INTO PERSONS (CLID, NAME, REGNR, PVNREGNR, TP, TP2, TP3, ADDR, ADDR2, BANKID, BANK, BANKACC, PHONE, ATK, ACT) VALUES ('pieg1', 'SIA PiegƒÅdƒÅtƒÅjs 1', '40000000001', 'LV40000000001', 'KR', 'JP', 'Ir', NULL, NULL, NULL, NULL, NULL, NULL, NULL, 1);
INSERT INTO PERSONS (CLID, NAME, REGNR, PVNREGNR, TP, TP2, TP3, ADDR, ADDR2, BANKID, BANK, BANKACC, PHONE, ATK, ACT) VALUES ('pieg2', 'SIA PiegƒÅdƒÅtƒÅjs 2', '40000000002', 'LV40000000002', 'KR', 'JP', 'Ir', NULL, NULL, NULL, NULL, NULL, NULL, NULL, 1);
INSERT INTO PERSONS (CLID, NAME, REGNR, PVNREGNR, TP, TP2, TP3, ADDR, ADDR2, BANKID, BANK, BANKACC, PHONE, ATK, ACT) VALUES ('pirc1', 'SIA Pircƒìjs 1', '40000000003', 'LV40000000003', 'DB', 'JP', 'Ir', NULL, NULL, NULL, NULL, NULL, NULL, NULL, 1);
INSERT INTO PERSONS (CLID, NAME, REGNR, PVNREGNR, TP, TP2, TP3, ADDR, ADDR2, BANKID, BANK, BANKACC, PHONE, ATK, ACT) VALUES ('pirc2', 'SIA Pircƒìjs 2', '40000000004', 'LV40000000004', 'DB', 'JP', 'Ir', NULL, NULL, NULL, NULL, NULL, NULL, NULL, 1);
INSERT INTO PERSONS (CLID, NAME, REGNR, PVNREGNR, TP, TP2, TP3, ADDR, ADDR2, BANKID, BANK, BANKACC, PHONE, ATK, ACT) VALUES ('telef', 'SIA Telefons', '40000000005', 'LV40000000005', 'KR', 'JP', 'Ir', NULL, NULL, NULL, NULL, NULL, NULL, NULL, 1);
INSERT INTO PERSONS (CLID, NAME, REGNR, PVNREGNR, TP, TP2, TP3, ADDR, ADDR2, BANKID, BANK, BANKACC, PHONE, ATK, ACT) VALUES ('benz', 'SIA Benzƒ´ns', '40000000006', 'LV40000000006', 'KR', 'JP', 'Ir', NULL, NULL, NULL, NULL, NULL, NULL, NULL, 1);
INSERT INTO PERSONS (CLID, NAME, REGNR, PVNREGNR, TP, TP2, TP3, ADDR, ADDR2, BANKID, BANK, BANKACC, PHONE, ATK, ACT) VALUES ('pieg 1', 'SIA PiegƒÅdƒÅtƒÅjs1', '40000000011', 'LV40000000011', 'KR', 'JP', 'Ir', NULL, NULL, NULL, NULL, NULL, NULL, NULL, 1);


COMMIT WORK;

INSERT INTO BALA1 (BALID, DESCR, TA, TP) VALUES ('B1', 'Bilance', 'Aktƒ´vs', 'Pasƒ´vs');
INSERT INTO BALA1 (BALID, DESCR, TA, TP) VALUES ('P1', 'Peƒº≈Üas un zaudƒìjumu aprƒìƒ∑ins', NULL, NULL);


COMMIT WORK;

INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (3, '001', 'B1', 'AK', 'V', '1.ILGTERMI≈ÖA IEGULDƒ™JUMI', '230', NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (23, '002', 'B1', 'AK', 'V', '     1. NemateriƒÅlie ieguldijumi', '060', NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (24, '010', 'B1', 'AK', 'S', '       1. Pƒìtniecƒ´bas darba un uz≈Üƒìmuma attƒ´stibas izmaksas', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (28, '020', 'B1', 'AK', 'S', '       2. Koncesijas, patenti, licences, preƒçu zƒ´mes un tamlƒ´dzƒ´gas tiesƒ´bas', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (29, '030', 'B1', 'AK', 'S', '       3. Citi nemateriƒÅlie ieguldijumi', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (30, '040', 'B1', 'AK', 'S', '       4. Uz≈Üƒìmuma nemateriƒÅlƒÅ vƒìrtiba', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (31, '050', 'B1', 'AK', 'S', '       5. Avansa maksƒÅjumi par nemateriƒÅlajiem ieguldƒ´jumiem', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (32, '060', 'B1', 'AK', 'K', '     1.KOPƒÄ', '010', '050', NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (33, '07', 'B1', 'AK', 'V', '     2. Pamatlƒ´dzekƒºi', '130', NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (34, '070', 'B1', 'AK', 'S', '       1. Zemes gabali, ƒìkas, b≈´ves un ilggadƒ´gie stƒÅdijumi', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (35, '080', 'B1', 'AK', 'S', '       2. Ilgtermi≈Üa ieguldijumi nomƒÅtos pamatlƒ´dzekƒºos', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (36, '090', 'B1', 'AK', 'S', '       3. IekƒÅrtas un ma≈°ƒ´nas', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (37, '100', 'B1', 'AK', 'S', '       4. PƒÅrƒìjie pamatlƒ´dzekƒºi un inventƒÅrs', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (38, '110', 'B1', 'AK', 'S', '       5. Pamatlƒ´dzekƒºu izveido≈°ana un nepabeigto celtniecƒ´bas objektu izmaksas', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (39, '120', 'B1', 'AK', 'S', '       6. Avansa maksƒÅjumi par pamatlƒ´dzekƒºiem', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (40, '130', 'B1', 'AK', 'K', '     2.KOPƒÄ', '070', '120', NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (41, '14', 'B1', 'AK', 'V', '     3. Ilgtermi≈Üa finansu ieguldijumi', '220', NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (42, '140', 'B1', 'AK', 'S', '       1. Lƒ´dzdalƒ´ba radniecƒ´go uz≈Üƒìmumu kapitƒÅlƒÅ', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (43, '150', 'B1', 'AK', 'S', '       2. Aizdevumi radniecƒ´gajiem uz≈Üƒìmumiem', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (44, '160', 'B1', 'AK', 'S', '       3. Lƒ´dzdalƒ´ba asociƒìto uz≈Üƒìmumu kapitƒÅlƒÅ', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (45, '170', 'B1', 'AK', 'S', '       4. Aizdevumi asociƒìtajiem uz≈Üƒìmumiem', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (46, '180', 'B1', 'AK', 'S', '       5. PƒÅrƒìjie vƒìrtspapƒ´ri un ieguldijumi', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (47, '190', 'B1', 'AK', 'S', '       6. PƒÅrƒìjie aizdevumi', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (48, '200', 'B1', 'AK', 'S', '       7. Pa≈°u akcijas un daƒºas', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (49, '210', 'B1', 'AK', 'S', '       8. Aizdevumi uz≈Üƒìmuma lƒ´dzƒ´pa≈°niekiem un vadƒ´bai', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (50, '220', 'B1', 'AK', 'K', '     3.KOPƒÄ', '140', '210', NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (51, '230', 'B1', 'AK', 'K', '1.iedaƒºas kopsumma', '010', '210', NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (52, '238', 'B1', 'AK', 'V', '2.APGROZƒÄMIE Lƒ™DZEKƒªI', '450', NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (53, '239', 'B1', 'AK', 'V', '     1. KrƒÅjumi', '300', NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (54, '240', 'B1', 'AK', 'S', '       1. Izejvielas, pamatmateriƒÅli un palƒ´gmateriƒÅli', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (55, '250', 'B1', 'AK', 'S', '       2. Nepabeigtie ra≈æojumi', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (56, '260', 'B1', 'AK', 'S', '       3. Gatavie ra≈æojumi un preces pƒÅrdo≈°anai', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (57, '270', 'B1', 'AK', 'S', '       4. Nepabeigtie pas≈´tƒ´jumi', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (58, '280', 'B1', 'AK', 'S', '       5. Avansa maksƒÅjumi par precƒìm', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (59, '290', 'B1', 'AK', 'S', '       6. Darba dzƒ´vniekieki un produktivie dzƒ´vniekieki', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (60, '300', 'B1', 'AK', 'K', '     1.KOPƒÄ', '240', '290', NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (61, '31', 'B1', 'AK', 'V', '     2. Debitori', '390', NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (62, '310', 'B1', 'AK', 'S', '       1. Pircƒìju un pas≈´tƒ´tƒÅju parƒÅdi', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (63, '320', 'B1', 'AK', 'S', '       2. Radniecƒ´go uz≈Üƒìmumu parƒÅdi', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (64, '330', 'B1', 'AK', 'S', '       3. Asociƒìto uz≈Üƒìmumu parƒÅdi', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (65, '340', 'B1', 'AK', 'S', '       4. Citi debitori', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (66, '350', 'B1', 'AK', 'S', '       5. NeiemaksƒÅtƒÅs daƒºas sabiedrƒ´bas kapitƒÅlƒÅ', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (67, '360', 'B1', 'AK', 'S', '       6. Aizdevumi uz≈Üƒìmuma lƒ´dzƒ´pa≈°niekiem un vadƒ´bai', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (68, '370', 'B1', 'AK', 'S', '       7. NƒÅkamo periodu izmaksas', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (69, '380', 'B1', 'AK', 'S', '       8. UzkrƒÅtie ie≈Üƒìmumi', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (70, '390', 'B1', 'AK', 'K', '     2.KOPƒÄ', '310', '380', NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (71, '40', 'B1', 'AK', 'V', '     3.Vƒìrtspapiri un lƒ´dzdalƒ´ba kapitƒÅlos', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (72, '400', 'B1', 'AK', 'S', '       1. Lƒ´dzdalƒ´ba radniecƒ´go uz≈Üƒìmuma kapitƒÅlƒÅ', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (73, '410', 'B1', 'AK', 'S', '       2. Pa≈°u akcijas un daƒºas', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (74, '420', 'B1', 'AK', 'S', '       3. PƒÅrƒìjie vƒìrtspapƒ´ri un lƒ´dzdalƒ´ba kapitƒÅlos', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (75, '430', 'B1', 'AK', 'K', '     3.KOPƒÄ', '400', '420', NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (76, '440', 'B1', 'AK', 'S', '     4. NAUDA', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (77, '450', 'B1', 'AK', 'K', '2.iedaƒºas kopsumma', '240', '420', NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (78, '460', 'B1', 'AK', 'K', 'BILANCE', '010', '440', NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (79, '46', 'B1', 'PA', 'V', '1.PA≈†U KAPITƒÄLS', '560', NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (80, '460', 'B1', 'PA', 'S', '  1. Akciju vai daƒºu kapitƒÅls (pamatkapitƒÅls)', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (81, '470', 'B1', 'PA', 'S', '  2. Akciju emisijas uzcenojums', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (82, '480', 'B1', 'PA', 'S', '  3. Ilgtermi≈Üa ieguldƒ´jumu pƒÅrvƒìrtƒì≈°anas rezerve', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (83, '49', 'B1', 'PA', 'S', '  4. Rezerves', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (84, '490', 'B1', 'PA', 'S', '    a) likumƒÅ noteiktƒÅs rezerves', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (85, '500', 'B1', 'PA', 'S', '    b) rezerves pa≈°u akcijƒÅm vai daƒºƒÅm', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (86, '510', 'B1', 'PA', 'S', '    c) uz≈Üƒìmuma stat≈´tos noteiktƒÅs rezerves', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (87, '520', 'B1', 'PA', 'S', '    d) pƒÅrƒìjƒÅs rezerves', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (88, '530', 'B1', 'PA', 'K', '  4.KOPƒÄ', '490', '520', NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (89, '54', 'B1', 'PA', 'S', '  5. Nesadalƒ´tƒÅ peƒº≈Üa', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (90, '540', 'B1', 'PA', 'S', '    a) iepriek≈°ƒìjo gadu nesadalitƒÅ peƒº≈Üa', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (91, '550', 'B1', 'PA', 'S', '    b) pƒÅrskata gada nesadalƒ´tƒÅ peƒº≈Üa', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (92, '560', 'B1', 'PA', 'K', '1.iedaƒºas kopsumma', '460', '560', NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (93, '57', 'B1', 'PA', 'V', '2.UZKRƒÄJUMI', '600', NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (94, '570', 'B1', 'PA', 'S', ' 1. UzkrƒÅjumi pensijƒÅm un tamlƒ´dzƒ´gƒÅm saistƒ´bƒÅm', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (95, '580', 'B1', 'PA', 'S', ' 2. UzkrƒÅjumi paredzamajiem nodokƒºiem', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (96, '590', 'B1', 'PA', 'S', ' 3. Citi uzkrƒÅjumi', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (97, '600', 'B1', 'PA', 'K', '2.iedaƒºas kopsumma', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (98, '608', 'B1', 'PA', 'V', '3.KREDITORI (ƒ´stermi≈Üa un ilgtermi≈Üa)', '920', NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (99, '609', 'B1', 'PA', 'V', '1.Ilgtermi≈Üa kreditori', '750', NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (100, '610', 'B1', 'PA', 'S', ' 1. Aiz≈Üƒìmumi pret obligƒÅcijƒÅm', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (101, '620', 'B1', 'PA', 'S', ' 2. AkcijƒÅs pƒÅrvƒìr≈°amie aiz≈Üƒìmumi', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (102, '630', 'B1', 'PA', 'S', ' 3. Aiz≈Üƒìmumi no kredƒ´tiestƒÅdƒìm', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (103, '640', 'B1', 'PA', 'S', ' 4. Citi aiz≈Üƒìmumi', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (104, '650', 'B1', 'PA', 'S', ' 5. No pircƒìjiem sa≈Üamtie avansi', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (105, '660', 'B1', 'PA', 'S', ' 6. ParƒÅdi piegƒÅdatƒÅjiem un darbuz≈Üƒìmƒìjiem', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (106, '670', 'B1', 'PA', 'S', ' 7. MaksƒÅjamie vekseƒºi', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (107, '680', 'B1', 'PA', 'S', ' 8. ParƒÅdi radniecƒ´gajiem uz≈Üƒìmumiem', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (108, '690', 'B1', 'PA', 'S', ' 9. ParƒÅdi asociƒìtajiem uz≈Üƒìmumiem', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (109, '700', 'B1', 'PA', 'S', ' 10. Nodokƒºi un sociƒÅlƒÅs nodro≈°inƒÅ≈°anas maksƒÅjumi', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (110, '710', 'B1', 'PA', 'S', ' 11. PƒÅrƒìjie kreditori', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (111, '720', 'B1', 'PA', 'S', ' 12. NƒÅkamo periodu ie≈Üƒìmumi', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (112, '730', 'B1', 'PA', 'S', ' 13. PƒÅrskata gada dividendes', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (113, '740', 'B1', 'PA', 'S', ' 14. Iepriek≈°ƒìjo gadu neizmaksƒÅtƒÅs dividendes', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (114, '750', 'B1', 'PA', 'S', '1.KOPƒÄ', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (115, '76', 'B1', 'PA', 'V', '1.ƒ™stermi≈Üa kreditori', '910', NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (131, '760', 'B1', 'PA', 'S', ' 1. Aiz≈Üƒìmumi pret obligƒÅcijƒÅm', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (132, '770', 'B1', 'PA', 'S', ' 2. AkcijƒÅs pƒÅrvƒìr≈°amie aiz≈Üƒìmumi', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (133, '780', 'B1', 'PA', 'S', ' 3. Aiz≈Üƒìmumi no kredƒ´tiestƒÅdƒìm', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (134, '790', 'B1', 'PA', 'S', ' 4. Citi aiz≈Üƒìmumi', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (135, '800', 'B1', 'PA', 'S', ' 5. No pircƒìjiem sa≈Üamtie avansi', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (136, '810', 'B1', 'PA', 'S', ' 6. ParƒÅdi piegƒÅdatƒÅjiem un darbuz≈Üƒìmƒìjiem', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (137, '820', 'B1', 'PA', 'S', ' 7. MaksƒÅjamie vekseƒºi', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (138, '830', 'B1', 'PA', 'S', ' 8. ParƒÅdi radniecƒ´gajiem uz≈Üƒìmumiem', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (139, '840', 'B1', 'PA', 'S', ' 9. ParƒÅdi asociƒìtajiem uz≈Üƒìmumiem', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (140, '850', 'B1', 'PA', 'S', ' 10. Nodokƒºi un sociƒÅlƒÅs nodro≈°inƒÅ≈°anas maksƒÅjumi', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (141, '860', 'B1', 'PA', 'S', ' 11. PƒÅrƒìjie kreditori', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (142, '870', 'B1', 'PA', 'S', ' 12. NƒÅkamo periodu ie≈Üƒìmumi', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (143, '880', 'B1', 'PA', 'S', ' 13. PƒÅrskata gada dividendes', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (144, '890', 'B1', 'PA', 'S', ' 14. Iepriek≈°ƒìjo gadu neizmaksƒÅtƒÅs dividendes', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (145, '900', 'B1', 'PA', 'S', ' 15. UzkrƒÅtƒÅs saistƒ´bas', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (146, '910', 'B1', 'PA', 'K', '2.KOPƒÄ', '760', '900', NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (147, '920', 'B1', 'PA', 'K', '3.iedaƒºas kopsumma', '620', '900', NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (148, '930', 'B1', 'PA', 'K', 'BILANCE', '460', '900', NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (149, '010', 'P1', 'PA', 'K', 'Neto apgrozijums', '011', '019', NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (150, '011', 'P1', 'PA', 'S', '  ie≈Üƒìmumi no veikala', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (151, '012', 'P1', 'PA', 'S', '  lauksaimniecƒ´bas ie≈Üƒìmumi', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (152, '020', 'P1', 'PA', 'K', 'PƒÅrdotƒÅs produkcijas ra≈æo≈°anas izmaksas', '021', '039', NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (153, '021', 'P1', 'PA', 'S', '  izejvielas, materiƒÅli un preces pƒÅrdo≈°anai', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (154, '022', 'P1', 'PA', 'S', '  degviela', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (155, '023', 'P1', 'PA', 'S', '  algas', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (156, '024', 'P1', 'PA', 'S', '  elektrƒ´ba', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (157, '025', 'P1', 'PA', 'S', '  nomas maksa', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (158, '026', 'P1', 'PA', 'S', '  saimniecƒ´bas izdevumi, telpu uzturƒì≈°ana', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (160, '027', 'P1', 'PA', 'S', '  nolietojums', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (161, '028', 'P1', 'PA', 'S', '  tehnikas uzturƒì≈°ana', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (162, '029', 'P1', 'PA', 'S', '  pƒÅrƒìjƒÅs izmaksaas', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (163, '040', 'P1', 'PA', 'K', 'Bruto peƒº≈Üa', '001', '039', NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (164, '050', 'P1', 'PA', 'K', 'PƒÅrdo≈°anas izmaksas', '051', '059', NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (165, '051', 'P1', 'PA', 'S', '  nomas maksa', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (166, '052', 'P1', 'PA', 'S', '  reklƒÅma', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (167, '053', 'P1', 'PA', 'S', '  preƒçu transports', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (168, '054', 'P1', 'PA', 'S', '  tara', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (169, '055', 'P1', 'PA', 'S', '  citi', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (170, '060', 'P1', 'PA', 'K', 'AdministrƒÅcijas izmaksas', '061', '069', NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (171, '061', 'P1', 'PA', 'S', '  sakari', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (172, '062', 'P1', 'PA', 'S', '  biroja izdevumi', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (173, '063', 'P1', 'PA', 'S', '  grƒÅmatvedƒ´bas, juristu un citi pakalpojumi', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (174, '064', 'P1', 'PA', 'S', '  bankas pakalpojumi', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (175, '065', 'P1', 'PA', 'S', '  transporta izdevumi', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (176, '066', 'P1', 'PA', 'S', '  pƒÅrƒìjie', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (177, '080', 'P1', 'PA', 'K', 'PƒÅrƒìjƒÅs uz≈Üƒìmuma saimnieciskƒÅs darbƒ´bas izmaksas', '081', '099', NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (178, '081', 'P1', 'PA', 'S', '  apdro≈°inƒÅ≈°ana', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (179, '082', 'P1', 'PA', 'S', '  nodevas', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (180, '083', 'P1', 'PA', 'S', '  pƒÅrƒìjie', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (181, '084', 'P1', 'PA', 'S', '  neatskaitƒÅmais PVN', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (182, '085', 'P1', 'PA', 'S', '  komandƒìjumi', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (183, '086', 'P1', 'PA', 'S', '  zaudƒìjumi no val≈´tas kursa pazeminƒÅ≈°anƒÅs', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (184, '087', 'P1', 'PA', 'S', '  soda naudas', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (185, '088', 'P1', 'PA', 'S', '  personƒ´gie izdevumi', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (186, '089', 'P1', 'PA', 'S', '  pƒÅrƒìjie', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (187, '100', 'P1', 'PA', 'K', 'PƒÅrƒìjie procentu ie≈Üƒìmumi un tamlƒ´dzƒ´gi ie≈Üƒìmumi', '101', '109', NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (188, '070', 'P1', 'PA', 'K', 'PƒÅrƒìjie uz≈Üƒìmuma saimnieciskƒÅs darbƒ´bas ie≈Üƒìmumi', '070', '079', NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (189, '071', 'P1', 'PA', 'S', '  subsƒ´dijas', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (190, '072', 'P1', 'PA', 'S', '  akcƒ´zes nodokƒºa kompensƒÅcija', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (191, '073', 'P1', 'PA', 'S', '  ie≈Üƒìmumi no pamatlƒ´dzekƒºu pƒÅrdo≈°anas', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (192, '074', 'P1', 'PA', 'S', '  pƒÅrƒìjie', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (193, '101', 'P1', 'PA', 'S', NULL, NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (194, '110', 'P1', 'PA', 'K', 'Procentu maksƒÅjumi un tamlƒ´dzƒ´gas izmaksas', '111', '119', NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (195, '111', 'P1', 'PA', 'S', '  samaksƒÅtie %', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (196, '112', 'P1', 'PA', 'S', '  val≈´tas kursu svƒÅrstƒ´bas', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (197, '113', 'P1', 'PA', 'S', '  citi', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (198, '150', 'P1', 'PA', 'K', 'ƒÄrkƒÅrtas ie≈Üƒìmumi', '151', '159', NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (199, '151', 'P1', 'PA', 'S', NULL, NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (200, '160', 'P1', 'PA', 'K', 'ƒÄrkƒÅrtas izdevumi', '161', '169', NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (201, '161', 'P1', 'PA', 'S', NULL, NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (202, '170', 'P1', 'PA', 'K', 'Peƒº≈Üa vai zaudƒìjumi pirms nodokƒºiem', '001', '169', NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (203, '180', 'P1', 'PA', 'S', 'Uz≈Üƒìmuma ienƒÅkuma nodoklis par pƒÅrskata periodu', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (204, '181', 'P1', 'PA', 'S', 'PƒÅrƒìjie nodokƒºi', NULL, NULL, NULL, NULL);
INSERT INTO BALA2 (ID, NR, BALID, DC, TP, DESCR, NR1, NR2, S1, S2) VALUES (205, '200', 'P1', 'PA', 'K', 'Peƒº≈Üa vai zaudƒìjumi pƒìc nodokƒºiem', '001', '199', NULL, NULL);


COMMIT WORK;

INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (15, 3, 'Db', '1*');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (19, 34, 'Db', '1210');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (20, 36, 'Db', '1220');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (21, 37, 'Db', '1230');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (22, 38, 'Db', '1240');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (23, 34, 'Kr', '1291');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (24, 36, 'Kr', '1292');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (25, 37, 'Kr', '1293');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (26, 54, 'Db', '2110');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (27, 55, 'Db', '2120');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (28, 56, 'Db', '2130');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (29, 57, 'Db', '2140');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (30, 58, 'Db', '2190');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (31, 59, 'Db', '22');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (32, 62, 'Db', '2310');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (33, 65, 'Db', '2380');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (34, 68, 'Db', '2410');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (35, 76, 'Db', '26*');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (36, 80, 'Kr', '3110');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (37, 84, 'Kr', '3310');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (38, 84, 'Kr', '3330');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (39, 86, 'Kr', '3350');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (40, 87, 'Kr', '3360');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (41, 90, 'Kr', '3420');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (42, 91, 'Kr', '6*');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (43, 91, 'Kr', '7*');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (44, 91, 'Kr', '8*');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (45, 102, 'Kr', '5160');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (46, 133, 'Kr', '5150');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (47, 134, 'Kr', '5140');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (48, 135, 'Kr', '5210');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (49, 136, 'Kr', '531*');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (50, 140, 'Kr', '57*');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (51, 141, 'Kr', '5550');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (52, 141, 'Kr', '56*');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (53, 153, 'Kr', '7110');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (54, 153, 'Kr', '7112');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (55, 153, 'Kr', '7113');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (56, 153, 'Kr', '7114');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (57, 154, 'Kr', '71151');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (58, 154, 'Kr', '71152');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (59, 155, 'Kr', '7210');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (60, 155, 'Kr', '7211');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (61, 155, 'Kr', '7310');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (62, 155, 'Kr', '7311');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (63, 155, 'Kr', '7330');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (64, 156, 'Kr', '7522');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (66, 158, 'Kr', '7521');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (67, 158, 'Kr', '7524');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (68, 158, 'Kr', '7526');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (69, 158, 'Kr', '7527');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (70, 158, 'Kr', '7523');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (71, 160, 'Kr', '7410');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (72, 160, 'Kr', '7420');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (73, 161, 'Kr', '7525');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (75, 162, 'Kr', '7120');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (76, 162, 'Kr', '7140');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (77, 162, 'Kr', '7150');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (78, 162, 'Kr', '7160');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (79, 162, 'Kr', '717*');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (80, 162, 'Kr', '7529');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (81, 165, 'Kr', '7528');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (82, 166, 'Kr', '7651');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (83, 167, 'Kr', '7620');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (84, 167, 'Kr', '7630');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (85, 168, 'Kr', '7610');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (86, 169, 'Kr', '7650');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (87, 171, 'Kr', '771*');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (88, 172, 'Kr', '7720');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (89, 173, 'Kr', '7730');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (90, 173, 'Kr', '7740');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (91, 174, 'Kr', '7750');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (92, 175, 'Kr', '7760');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (93, 173, 'Kr', '7771');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (94, 176, 'Kr', '7770');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (95, 176, 'Kr', '7772');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (96, 178, 'Kr', '7540');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (97, 179, 'Kr', '7552');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (98, 180, 'Kr', '7550');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (99, 180, 'Kr', '7551');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (100, 181, 'Kr', '7553');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (101, 182, 'Kr', '7570');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (102, 180, 'Kr', '7560');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (103, 183, 'Kr', '8250');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (104, 184, 'Kr', '8260');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (105, 185, 'Kr', '8291');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (106, 185, 'Kr', '8292');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (107, 186, 'Kr', '8290');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (108, 186, 'Kr', '8293');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (109, 189, 'Kr', '6521');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (110, 190, 'Kr', '6522');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (111, 191, 'Kr', '6550');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (112, 192, 'Kr', '6520');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (113, 192, 'Kr', '6530');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (114, 192, 'Kr', '6540');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (115, 192, 'Kr', '6580');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (116, 192, 'Kr', '6590');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (117, 193, 'Kr', '8120');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (118, 193, 'Kr', '8150');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (119, 193, 'Kr', '8160');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (120, 193, 'Kr', '8170');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (121, 193, 'Kr', '8190');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (122, 192, 'Kr', '8190');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (123, 192, 'Kr', '8191');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (124, 192, 'Kr', '8192');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (125, 195, 'Kr', '8220');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (126, 195, 'Kr', '8240');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (127, 196, 'Kr', '8250');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (128, 196, 'Kr', '8270');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (130, 199, 'Kr', '8310');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (131, 201, 'Kr', '8410');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (132, 203, 'Kr', '8810');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (133, 204, 'Kr', '8820');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (134, 204, 'Kr', '8830');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (135, 150, 'Kr', '6*');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (136, 151, 'Kr', '6111');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (137, 157, 'Kr', NULL);
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (138, 87, 'Kr', '3220');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (139, 153, 'Db', '7111');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (140, 158, 'Db', '75292');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (141, 154, 'Kr', '71153');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (142, 161, 'Kr', '71154');
INSERT INTO BALA3 (ID, ID2, TP, AC) VALUES (143, 153, 'Kr', '7119');


COMMIT WORK;

INSERT INTO BANKS (ID, NAME) VALUES ('HABALV55', 'AS Swedbank');


COMMIT WORK;

INSERT INTO DOCTYP (ID, NAME, ID1, NAME1, TPZ, PVNPAZ) VALUES ('EKA ƒç', NULL, 'EKA ƒç', NULL, NULL, '2');
INSERT INTO DOCTYP (ID, NAME, ID1, NAME1, TPZ, PVNPAZ) VALUES ('iep.ak.', 'Iepirkuma akts', 'Iep.ak.', NULL, NULL, '5');
INSERT INTO DOCTYP (ID, NAME, ID1, NAME1, TPZ, PVNPAZ) VALUES ('Kr.rƒìƒ∑.', 'Kredƒ´trƒìƒ∑ins', 'Kr.rƒìƒ∑', NULL, NULL, '4');
INSERT INTO DOCTYP (ID, NAME, ID1, NAME1, TPZ, PVNPAZ) VALUES ('KTPRi', 'Izrakstƒ´ta KTPR', 'KTPR', NULL, NULL, '1');
INSERT INTO DOCTYP (ID, NAME, ID1, NAME1, TPZ, PVNPAZ) VALUES ('KTPRm', 'ApmaksƒÅta KTPR', 'KTPR', NULL, NULL, '1');
INSERT INTO DOCTYP (ID, NAME, ID1, NAME1, TPZ, PVNPAZ) VALUES ('KTPRs', 'Sa≈Üemta KTPR', 'KTPR', NULL, NULL, '1');
INSERT INTO DOCTYP (ID, NAME, ID1, NAME1, TPZ, PVNPAZ) VALUES ('KV', NULL, 'KV', NULL, NULL, '2');
INSERT INTO DOCTYP (ID, NAME, ID1, NAME1, TPZ, PVNPAZ) VALUES ('Lƒ´g.', 'Lƒ´gums', 'Lƒ´g.', NULL, NULL, '5');
INSERT INTO DOCTYP (ID, NAME, ID1, NAME1, TPZ, PVNPAZ) VALUES ('MD', 'Muitas deklarƒÅcija', NULL, NULL, NULL, '6');
INSERT INTO DOCTYP (ID, NAME, ID1, NAME1, TPZ, PVNPAZ) VALUES ('MU', 'MaksƒÅjuma uzdevums', NULL, NULL, NULL, '3');
INSERT INTO DOCTYP (ID, NAME, ID1, NAME1, TPZ, PVNPAZ) VALUES ('PPRdi', 'Izrakstƒ´ta PPR debitors', 'PPR', NULL, 'IZRPZ', '1');
INSERT INTO DOCTYP (ID, NAME, ID1, NAME1, TPZ, PVNPAZ) VALUES ('PPRdm', 'Sa≈Üemta samaksa par PPR no debitora', 'PPR', NULL, NULL, '1');
INSERT INTO DOCTYP (ID, NAME, ID1, NAME1, TPZ, PVNPAZ) VALUES ('PPRdu', 'Izrakstƒ´ta un apmaksƒÅta PPR', 'PPR', NULL, 'IZRPZ', '1');
INSERT INTO DOCTYP (ID, NAME, ID1, NAME1, TPZ, PVNPAZ) VALUES ('PPRka', 'Atgriezta prece piegƒÅdƒÅtƒÅjam', 'PPR', NULL, 'IZRPZ', '1');
INSERT INTO DOCTYP (ID, NAME, ID1, NAME1, TPZ, PVNPAZ) VALUES ('PPRkm', 'SamaksƒÅta PPR kreditoram', 'PPR', NULL, NULL, '1');
INSERT INTO DOCTYP (ID, NAME, ID1, NAME1, TPZ, PVNPAZ) VALUES ('PPRks', 'Sa≈Üemta PPR kreditors', 'PPR', NULL, 'SANPZ', '1');
INSERT INTO DOCTYP (ID, NAME, ID1, NAME1, TPZ, PVNPAZ) VALUES ('PPRku', 'Sa≈Üemta un apmaksƒÅta PPR', 'PPR', NULL, 'SANPZ', '1');
INSERT INTO DOCTYP (ID, NAME, ID1, NAME1, TPZ, PVNPAZ) VALUES ('Rƒìƒ∑', 'Rƒìƒ∑ins', 'Rƒìƒ∑', NULL, NULL, '1');
INSERT INTO DOCTYP (ID, NAME, ID1, NAME1, TPZ, PVNPAZ) VALUES ('Akts', 'Akts', 'Akts', NULL, NULL, '5');
INSERT INTO DOCTYP (ID, NAME, ID1, NAME1, TPZ, PVNPAZ) VALUES ('IPP', 'Iek≈°ƒìjƒÅ preƒçu pavadzƒ´me', 'IPP', NULL, NULL, '5');
INSERT INTO DOCTYP (ID, NAME, ID1, NAME1, TPZ, PVNPAZ) VALUES ('PPR', 'Preƒçu pavadzƒ´me rƒìƒ∑ins', 'PPR', NULL, NULL, '1');


COMMIT WORK;

INSERT INTO DOCTYPA (ID, NAME) VALUES ('APMPZ', 'ApmaksƒÅtƒÅs PZ');
INSERT INTO DOCTYPA (ID, NAME) VALUES ('IEPAK', NULL);
INSERT INTO DOCTYPA (ID, NAME) VALUES ('IZRPZ', 'Izrakstƒ´ta PPR');
INSERT INTO DOCTYPA (ID, NAME) VALUES ('KTPRI', 'Izrakstƒ´ta KTPR');
INSERT INTO DOCTYPA (ID, NAME) VALUES ('KTPRS', 'Sa≈Üemta KTPR');
INSERT INTO DOCTYPA (ID, NAME) VALUES ('KtprVA', 'Atgriezts pƒìc ..');
INSERT INTO DOCTYPA (ID, NAME) VALUES ('KtprVR', 'RealizƒÅcija');
INSERT INTO DOCTYPA (ID, NAME) VALUES ('KtprVS', 'Strukt≈´rvienƒ´bƒÅm');
INSERT INTO DOCTYPA (ID, NAME) VALUES ('nePPR', 'Ne PPR');
INSERT INTO DOCTYPA (ID, NAME) VALUES ('PPRdi', 'Izrakstƒ´ta PPR debitors');
INSERT INTO DOCTYPA (ID, NAME) VALUES ('PPRdm', 'Sa≈Üemta samaksa par PPR no debitora');
INSERT INTO DOCTYPA (ID, NAME) VALUES ('PPRdu', 'Izrakstƒ´ta un apmaksƒÅta PPR');
INSERT INTO DOCTYPA (ID, NAME) VALUES ('PPRka', 'Atgriezta prece piegƒÅdƒÅtƒÅjam');
INSERT INTO DOCTYPA (ID, NAME) VALUES ('PPRkm', 'SamaksƒÅta PPR kreditoram');
INSERT INTO DOCTYPA (ID, NAME) VALUES ('PPRks', 'Sa≈Üemta PPR kreditors');
INSERT INTO DOCTYPA (ID, NAME) VALUES ('PPRku', 'Sa≈Üemta un apmaksƒÅta PPR');
INSERT INTO DOCTYPA (ID, NAME) VALUES ('SANPZ', 'Sa≈ÜemtƒÅs PZ');


COMMIT WORK;

INSERT INTO DOCTYPB (IDA, ID) VALUES ('APMPZ', 'EKA ƒç');
INSERT INTO DOCTYPB (IDA, ID) VALUES ('IEPAK', 'iep.ak.');
INSERT INTO DOCTYPB (IDA, ID) VALUES ('IZRPZ', 'PPRdi');
INSERT INTO DOCTYPB (IDA, ID) VALUES ('KTPRI', 'KTPRi');
INSERT INTO DOCTYPB (IDA, ID) VALUES ('KTPRS', 'KTPRs');
INSERT INTO DOCTYPB (IDA, ID) VALUES ('KtprVR', 'KTPRi');
INSERT INTO DOCTYPB (IDA, ID) VALUES ('nePPR', 'EKA ƒç');
INSERT INTO DOCTYPB (IDA, ID) VALUES ('PPRdi', 'PPRdi');
INSERT INTO DOCTYPB (IDA, ID) VALUES ('PPRdm', 'PPRdm');
INSERT INTO DOCTYPB (IDA, ID) VALUES ('PPRdu', 'PPRdu');
INSERT INTO DOCTYPB (IDA, ID) VALUES ('PPRka', 'PPRka');
INSERT INTO DOCTYPB (IDA, ID) VALUES ('PPRkm', 'PPRkm');
INSERT INTO DOCTYPB (IDA, ID) VALUES ('PPRks', 'PPRks');
INSERT INTO DOCTYPB (IDA, ID) VALUES ('PPRku', 'PPRku');
INSERT INTO DOCTYPB (IDA, ID) VALUES ('SANPZ', 'PPRks');
INSERT INTO DOCTYPB (IDA, ID) VALUES ('IZRPZ', 'PPRdu');
INSERT INTO DOCTYPB (IDA, ID) VALUES ('SANPZ', 'PPRku');


COMMIT WORK;

INSERT INTO LOPS (IDL, ID, DTL, DTLD, USL, TPL, DOCID, AC11, AC12, AC13, AC14, AC15, AC21, AC22, AC23, AC24, AC25, SUMMC, CUR, SUMM, QV, NL, ODT) VALUES (4, 21, '2017-06-21 13:33:42', '2017-06-21 13:35:21', 'Admin', NULL, 12, '2310', NULL, NULL, NULL, NULL, '6113', NULL, NULL, NULL, '104', 206.61, 'EUR', 206.61, 0, NULL, '2014-01-29 00:00:00');
INSERT INTO LOPS (IDL, ID, DTL, DTLD, USL, TPL, DOCID, AC11, AC12, AC13, AC14, AC15, AC21, AC22, AC23, AC24, AC25, SUMMC, CUR, SUMM, QV, NL, ODT) VALUES (5, 22, '2017-06-21 13:33:42', '2017-06-21 13:35:21', 'Admin', NULL, 12, '2310', NULL, NULL, NULL, NULL, '5731', NULL, NULL, NULL, '204', 43.39, 'EUR', 43.39, 0, NULL, '2014-01-29 00:00:00');
INSERT INTO LOPS (IDL, ID, DTL, DTLD, USL, TPL, DOCID, AC11, AC12, AC13, AC14, AC15, AC21, AC22, AC23, AC24, AC25, SUMMC, CUR, SUMM, QV, NL, ODT) VALUES (6, 16, '2017-06-21 13:35:34', '2017-06-21 13:35:34', 'Admin', NULL, 10, '7710', '7710', 'NIZ', NULL, NULL, '2620', '2620', 'BA', NULL, NULL, 16.53, 'EUR', 16.53, 0, NULL, '2014-01-25 00:00:00');
INSERT INTO LOPS (IDL, ID, DTL, DTLD, USL, TPL, DOCID, AC11, AC12, AC13, AC14, AC15, AC21, AC22, AC23, AC24, AC25, SUMMC, CUR, SUMM, QV, NL, ODT) VALUES (7, 17, '2017-06-21 13:35:34', '2017-06-21 13:35:34', 'Admin', NULL, 10, '5731', '5731', 'CIZ', NULL, '305', '2620', '2620', 'BA', NULL, NULL, 3.47, 'EUR', 3.47, 0, NULL, '2014-01-25 00:00:00');
INSERT INTO LOPS (IDL, ID, DTL, DTLD, USL, TPL, DOCID, AC11, AC12, AC13, AC14, AC15, AC21, AC22, AC23, AC24, AC25, SUMMC, CUR, SUMM, QV, NL, ODT) VALUES (8, 50, '2019-09-22 18:13:50', '2019-09-22 18:13:50', 'Admin', NULL, 17, '2310', NULL, NULL, NULL, NULL, '6113', NULL, NULL, NULL, '0', 1000, 'EUR', 1000, 0, NULL, '2014-01-29 00:00:00');
INSERT INTO LOPS (IDL, ID, DTL, DTLD, USL, TPL, DOCID, AC11, AC12, AC13, AC14, AC15, AC21, AC22, AC23, AC24, AC25, SUMMC, CUR, SUMM, QV, NL, ODT) VALUES (9, 51, '2019-09-22 18:13:53', '2019-09-22 18:13:53', 'Admin', NULL, 17, '2310', NULL, NULL, NULL, NULL, '5731', NULL, NULL, NULL, '505', 210, 'EUR', 210, 0, NULL, '2014-01-29 00:00:00');
INSERT INTO LOPS (IDL, ID, DTL, DTLD, USL, TPL, DOCID, AC11, AC12, AC13, AC14, AC15, AC21, AC22, AC23, AC24, AC25, SUMMC, CUR, SUMM, QV, NL, ODT) VALUES (10, 72, '2019-09-25 09:15:43', NULL, 'Admin', NULL, 28, '7110', NULL, NULL, NULL, NULL, '5310', NULL, NULL, NULL, NULL, 405.79, 'EUR', 405.79, 0, NULL, '2014-02-02 00:00:00');
INSERT INTO LOPS (IDL, ID, DTL, DTLD, USL, TPL, DOCID, AC11, AC12, AC13, AC14, AC15, AC21, AC22, AC23, AC24, AC25, SUMMC, CUR, SUMM, QV, NL, ODT) VALUES (11, 73, '2019-09-25 09:15:43', NULL, 'Admin', NULL, 28, '5731', NULL, NULL, NULL, '305', '5310', NULL, NULL, NULL, NULL, 85.21, 'EUR', 85.21, 0, NULL, '2014-02-02 00:00:00');
INSERT INTO LOPS (IDL, ID, DTL, DTLD, USL, TPL, DOCID, AC11, AC12, AC13, AC14, AC15, AC21, AC22, AC23, AC24, AC25, SUMMC, CUR, SUMM, QV, NL, ODT) VALUES (12, 65, '2019-11-27 14:07:31', NULL, 'Admin', NULL, 25, '2620', '2620', 'BA', NULL, NULL, '2310', '6112', 'NIE', NULL, NULL, 165.29, 'EUR', 165.29, 0, NULL, '2014-02-01 00:00:00');
INSERT INTO LOPS (IDL, ID, DTL, DTLD, USL, TPL, DOCID, AC11, AC12, AC13, AC14, AC15, AC21, AC22, AC23, AC24, AC25, SUMMC, CUR, SUMM, QV, NL, ODT) VALUES (13, 66, '2019-11-27 14:07:31', NULL, 'Admin', NULL, 25, '2620', '2620', 'BA', NULL, NULL, '2310', '5731', 'CIE', NULL, '505', 34.71, 'EUR', 34.71, 0, NULL, '2014-02-01 00:00:00');
INSERT INTO LOPS (IDL, ID, DTL, DTLD, USL, TPL, DOCID, AC11, AC12, AC13, AC14, AC15, AC21, AC22, AC23, AC24, AC25, SUMMC, CUR, SUMM, QV, NL, ODT) VALUES (14, 67, '2019-11-27 14:10:11', NULL, 'Admin', NULL, 26, '5310', '7110', 'NIZ1', NULL, NULL, '2620', '2620', 'BA', NULL, NULL, 165.29, 'EUR', 165.29, 0, NULL, '2014-01-31 00:00:00');
INSERT INTO LOPS (IDL, ID, DTL, DTLD, USL, TPL, DOCID, AC11, AC12, AC13, AC14, AC15, AC21, AC22, AC23, AC24, AC25, SUMMC, CUR, SUMM, QV, NL, ODT) VALUES (15, 68, '2019-11-27 14:10:11', NULL, 'Admin', NULL, 26, '5310', '5731', 'CIZ', NULL, '505', '2620', '2620', 'BA', NULL, NULL, 34.71, 'EUR', 34.71, 0, NULL, '2014-01-31 00:00:00');
INSERT INTO LOPS (IDL, ID, DTL, DTLD, USL, TPL, DOCID, AC11, AC12, AC13, AC14, AC15, AC21, AC22, AC23, AC24, AC25, SUMMC, CUR, SUMM, QV, NL, ODT) VALUES (16, 86, '2022-06-21 17:32:55', NULL, 'Admin', NULL, 34, '7110', NULL, NULL, NULL, 'G02', '5310', NULL, NULL, NULL, NULL, 200, 'EUR', 200, 0, NULL, '2022-01-01 00:00:00');
INSERT INTO LOPS (IDL, ID, DTL, DTLD, USL, TPL, DOCID, AC11, AC12, AC13, AC14, AC15, AC21, AC22, AC23, AC24, AC25, SUMMC, CUR, SUMM, QV, NL, ODT) VALUES (17, 87, '2022-06-21 17:32:55', NULL, 'Admin', NULL, 34, '5731', NULL, NULL, NULL, 'G12', '5731', NULL, NULL, NULL, '0', 42, 'EUR', 42, 0, NULL, '2022-01-01 00:00:00');
INSERT INTO LOPS (IDL, ID, DTL, DTLD, USL, TPL, DOCID, AC11, AC12, AC13, AC14, AC15, AC21, AC22, AC23, AC24, AC25, SUMMC, CUR, SUMM, QV, NL, ODT) VALUES (18, 86, '2022-06-29 11:54:15', NULL, 'Admin', NULL, 34, '7110', NULL, NULL, NULL, 'G02', '5310', NULL, NULL, NULL, NULL, 200, 'EUR', 200, 0, NULL, '2022-06-21 17:32:55');
INSERT INTO LOPS (IDL, ID, DTL, DTLD, USL, TPL, DOCID, AC11, AC12, AC13, AC14, AC15, AC21, AC22, AC23, AC24, AC25, SUMMC, CUR, SUMM, QV, NL, ODT) VALUES (19, 87, '2022-06-29 11:54:15', NULL, 'Admin', NULL, 34, '5731', NULL, NULL, NULL, 'G12', '5731', NULL, NULL, NULL, '0', 42, 'EUR', 42, 0, NULL, '2022-06-21 17:32:55');
INSERT INTO LOPS (IDL, ID, DTL, DTLD, USL, TPL, DOCID, AC11, AC12, AC13, AC14, AC15, AC21, AC22, AC23, AC24, AC25, SUMMC, CUR, SUMM, QV, NL, ODT) VALUES (20, 8, '2022-07-06 10:03:14', NULL, 'Admin', NULL, 6, '7110', NULL, NULL, NULL, NULL, '5310', NULL, NULL, NULL, NULL, 413.22, 'EUR', 413.22, 0, NULL, '2014-11-22 20:12:09');
INSERT INTO LOPS (IDL, ID, DTL, DTLD, USL, TPL, DOCID, AC11, AC12, AC13, AC14, AC15, AC21, AC22, AC23, AC24, AC25, SUMMC, CUR, SUMM, QV, NL, ODT) VALUES (21, 90, '2023-01-21 12:12:05', '2023-01-21 12:12:05', 'Admin', NULL, 38, '2110', NULL, NULL, NULL, '401', '5310', NULL, NULL, NULL, NULL, 18, 'EUR', 18, 0, NULL, '2022-12-11 16:14:13');
INSERT INTO LOPS (IDL, ID, DTL, DTLD, USL, TPL, DOCID, AC11, AC12, AC13, AC14, AC15, AC21, AC22, AC23, AC24, AC25, SUMMC, CUR, SUMM, QV, NL, ODT) VALUES (22, 91, '2023-01-21 12:12:05', '2023-01-21 12:12:05', 'Admin', NULL, 38, '5731', NULL, NULL, NULL, '305', '5310', NULL, NULL, NULL, NULL, 3.78, 'EUR', 3.78, 0, NULL, '2022-12-11 16:14:13');
INSERT INTO LOPS (IDL, ID, DTL, DTLD, USL, TPL, DOCID, AC11, AC12, AC13, AC14, AC15, AC21, AC22, AC23, AC24, AC25, SUMMC, CUR, SUMM, QV, NL, ODT) VALUES (23, 92, '2023-01-21 12:12:07', '2023-01-21 12:12:07', 'Admin', NULL, 39, '2110', NULL, NULL, NULL, '401', '5310', NULL, NULL, NULL, NULL, 18, 'EUR', 18, 0, NULL, '2022-12-11 17:42:45');
INSERT INTO LOPS (IDL, ID, DTL, DTLD, USL, TPL, DOCID, AC11, AC12, AC13, AC14, AC15, AC21, AC22, AC23, AC24, AC25, SUMMC, CUR, SUMM, QV, NL, ODT) VALUES (24, 93, '2023-01-21 12:12:07', '2023-01-21 12:12:07', 'Admin', NULL, 39, '5731', NULL, NULL, NULL, '305', '5310', NULL, NULL, NULL, NULL, 3.78, 'EUR', 3.78, 0, NULL, '2022-12-11 17:42:45');
INSERT INTO LOPS (IDL, ID, DTL, DTLD, USL, TPL, DOCID, AC11, AC12, AC13, AC14, AC15, AC21, AC22, AC23, AC24, AC25, SUMMC, CUR, SUMM, QV, NL, ODT) VALUES (25, 94, '2023-01-21 12:12:08', '2023-01-21 12:12:08', 'Admin', NULL, 40, '2110', NULL, NULL, NULL, '401', '5310', NULL, NULL, NULL, NULL, 18, 'EUR', 18, 0, NULL, '2022-12-11 17:44:39');
INSERT INTO LOPS (IDL, ID, DTL, DTLD, USL, TPL, DOCID, AC11, AC12, AC13, AC14, AC15, AC21, AC22, AC23, AC24, AC25, SUMMC, CUR, SUMM, QV, NL, ODT) VALUES (26, 95, '2023-01-21 12:12:08', '2023-01-21 12:12:08', 'Admin', NULL, 40, '5731', NULL, NULL, NULL, '305', '5310', NULL, NULL, NULL, NULL, 3.78, 'EUR', 3.78, 0, NULL, '2022-12-11 17:44:39');


COMMIT WORK;

INSERT INTO LOPSD (IDL, ID, DTLD, USL, TPL, DETE, NRX, DOCTYP, DOCST, DOCNR, CLID, CLID2, DESCR, SUMM, PVN, OPT, ZNR, ZU, ZDT, NL, ODT) VALUES (14, 8, NULL, NULL, NULL, '2014-01-21', NULL, 'PPRkm', 'AA', '000111', 'pieg1', NULL, 'izejmater.', 200, 34.71, NULL, 8, 'Admin', '2016-09-30 11:45:21', NULL, '2014-01-21 00:00:00');
INSERT INTO LOPSD (IDL, ID, DTLD, USL, TPL, DETE, NRX, DOCTYP, DOCST, DOCNR, CLID, CLID2, DESCR, SUMM, PVN, OPT, ZNR, ZU, ZDT, NL, ODT) VALUES (15, 1, NULL, NULL, NULL, '2014-01-10', NULL, NULL, NULL, NULL, 'es pats', NULL, 'ieguldijums pamatkapitƒÅlƒÅ', 20000, 0, NULL, 1, 'Admin', '2016-09-30 11:50:32', NULL, '2014-01-10 00:00:00');
INSERT INTO LOPSD (IDL, ID, DTLD, USL, TPL, DETE, NRX, DOCTYP, DOCST, DOCNR, CLID, CLID2, DESCR, SUMM, PVN, OPT, ZNR, ZU, ZDT, NL, ODT) VALUES (16, 3, NULL, NULL, NULL, '2014-01-10', NULL, NULL, NULL, NULL, NULL, 'es pats', 'avansa norƒìƒ∑iniem', 200, 0, NULL, 3, 'Admin', '2016-09-30 12:01:42', NULL, '2014-01-10 00:00:00');
INSERT INTO LOPSD (IDL, ID, DTLD, USL, TPL, DETE, NRX, DOCTYP, DOCST, DOCNR, CLID, CLID2, DESCR, SUMM, PVN, OPT, ZNR, ZU, ZDT, NL, ODT) VALUES (17, 5, NULL, NULL, NULL, '2014-01-11', NULL, 'EKA ƒç', NULL, '12312', 'benz', 'es pats', 'benzƒ´ns', 25, 4.34, NULL, 5, 'Admin', '2016-09-30 12:01:50', NULL, '2014-01-11 00:00:00');
INSERT INTO LOPSD (IDL, ID, DTLD, USL, TPL, DETE, NRX, DOCTYP, DOCST, DOCNR, CLID, CLID2, DESCR, SUMM, PVN, OPT, ZNR, ZU, ZDT, NL, ODT) VALUES (18, 8, NULL, NULL, NULL, '2014-01-21', NULL, 'PPRkm', 'AA', '000111', 'pieg1', NULL, 'izejmater.', 200, 34.71, NULL, 8, 'admin', '2016-11-01 17:13:21', NULL, '2016-09-30 11:45:21');
INSERT INTO LOPSD (IDL, ID, DTLD, USL, TPL, DETE, NRX, DOCTYP, DOCST, DOCNR, CLID, CLID2, DESCR, SUMM, PVN, OPT, ZNR, ZU, ZDT, NL, ODT) VALUES (19, 11, NULL, NULL, NULL, '2014-01-30', NULL, 'PPRdm', 'XXX', '000001', 'pirc1', NULL, 'realizƒÅcija.', 150, 0, NULL, 11, 'admin', '2016-11-01 17:13:50', NULL, '2014-01-30 00:00:00');
INSERT INTO LOPSD (IDL, ID, DTLD, USL, TPL, DETE, NRX, DOCTYP, DOCST, DOCNR, CLID, CLID2, DESCR, SUMM, PVN, OPT, ZNR, ZU, ZDT, NL, ODT) VALUES (20, 9, NULL, NULL, NULL, '2014-01-25', NULL, 'PPRdi', 'XXX', '000001', 'pirc1', NULL, 'realizƒÅcija.', 150, 26.03, NULL, 9, 'admin', '2016-11-01 17:15:38', NULL, '2014-01-25 00:00:00');
INSERT INTO LOPSD (IDL, ID, DTLD, USL, TPL, DETE, NRX, DOCTYP, DOCST, DOCNR, CLID, CLID2, DESCR, SUMM, PVN, OPT, ZNR, ZU, ZDT, NL, ODT) VALUES (21, 12, '2017-06-21 13:35:21', NULL, NULL, '2014-01-29', NULL, 'PPRdi', 'XXX', '000002', 'pirc1', NULL, 'realizƒÅcija', 250, 43.39, NULL, 12, 'admin', '2016-11-01 17:15:57', NULL, '2014-01-29 00:00:00');
INSERT INTO LOPSD (IDL, ID, DTLD, USL, TPL, DETE, NRX, DOCTYP, DOCST, DOCNR, CLID, CLID2, DESCR, SUMM, PVN, OPT, ZNR, ZU, ZDT, NL, ODT) VALUES (22, 11, NULL, NULL, NULL, '2014-01-30', NULL, 'PPRdm', 'XXX', '000001', 'pirc1', NULL, 'realizƒÅcija.', 150, 26.03, NULL, 11, 'Admin', '2017-06-21 13:03:14', NULL, '2016-11-01 17:13:50');
INSERT INTO LOPSD (IDL, ID, DTLD, USL, TPL, DETE, NRX, DOCTYP, DOCST, DOCNR, CLID, CLID2, DESCR, SUMM, PVN, OPT, ZNR, ZU, ZDT, NL, ODT) VALUES (23, 12, '2017-06-21 13:35:21', NULL, NULL, '2014-01-29', NULL, 'PPRdi', 'XXX', '000002', 'pirc1', NULL, 'realizƒÅcija', 250, 43.39, NULL, 12, 'Admin', '2017-06-21 13:33:42', NULL, '2017-06-21 13:35:21');
INSERT INTO LOPSD (IDL, ID, DTLD, USL, TPL, DETE, NRX, DOCTYP, DOCST, DOCNR, CLID, CLID2, DESCR, SUMM, PVN, OPT, ZNR, ZU, ZDT, NL, ODT) VALUES (24, 10, '2017-06-21 13:35:34', NULL, NULL, '2014-01-25', NULL, 'Rƒìƒ∑', NULL, '1213321', 'telef', NULL, 'sakaru pakalp.', 20, 3.47, NULL, 10, 'Admin', '2017-06-21 13:35:34', NULL, '2014-01-25 00:00:00');
INSERT INTO LOPSD (IDL, ID, DTLD, USL, TPL, DETE, NRX, DOCTYP, DOCST, DOCNR, CLID, CLID2, DESCR, SUMM, PVN, OPT, ZNR, ZU, ZDT, NL, ODT) VALUES (25, 17, NULL, NULL, NULL, '2014-01-29', NULL, 'PPRdi', 'XXX', '000003', 'pirc1', NULL, 'realizƒÅcija', 3210, 557.11, NULL, 16, 'Admin', '2019-09-22 18:13:57', NULL, '2014-01-29 00:00:00');
INSERT INTO LOPSD (IDL, ID, DTLD, USL, TPL, DETE, NRX, DOCTYP, DOCST, DOCNR, CLID, CLID2, DESCR, SUMM, PVN, OPT, ZNR, ZU, ZDT, NL, ODT) VALUES (26, 28, NULL, NULL, NULL, '2014-02-02', NULL, 'PPRks', 'SS', '123000', 'pieg2', NULL, 'izejmater.', 491, 85.21, NULL, 27, 'Admin', '2019-09-25 09:15:43', NULL, '2014-02-02 00:00:00');
INSERT INTO LOPSD (IDL, ID, DTLD, USL, TPL, DETE, NRX, DOCTYP, DOCST, DOCNR, CLID, CLID2, DESCR, SUMM, PVN, OPT, ZNR, ZU, ZDT, NL, ODT) VALUES (27, 25, NULL, NULL, NULL, '2014-02-01', NULL, 'PPRdm', 'XXX', '000001', 'pirc1', NULL, 'realizƒÅcija.', 200, 34.71, NULL, 24, 'Admin', '2019-11-27 14:07:31', NULL, '2014-02-01 00:00:00');
INSERT INTO LOPSD (IDL, ID, DTLD, USL, TPL, DETE, NRX, DOCTYP, DOCST, DOCNR, CLID, CLID2, DESCR, SUMM, PVN, OPT, ZNR, ZU, ZDT, NL, ODT) VALUES (28, 26, NULL, NULL, NULL, '2014-01-31', NULL, 'PPRkm', 'AA', '000119', 'pieg1', NULL, 'izejmater.', 200, 34.71, NULL, 25, 'Admin', '2019-11-27 14:10:11', NULL, '2014-01-31 00:00:00');
INSERT INTO LOPSD (IDL, ID, DTLD, USL, TPL, DETE, NRX, DOCTYP, DOCST, DOCNR, CLID, CLID2, DESCR, SUMM, PVN, OPT, ZNR, ZU, ZDT, NL, ODT) VALUES (29, 25, NULL, NULL, NULL, '2014-02-01', NULL, 'PPRdm', 'XXX', '000001', 'pirc1', NULL, 'realizƒÅcija.', 200, 34.71, NULL, 24, 'Admin', '2020-08-21 10:15:56', NULL, '2019-11-27 14:07:31');
INSERT INTO LOPSD (IDL, ID, DTLD, USL, TPL, DETE, NRX, DOCTYP, DOCST, DOCNR, CLID, CLID2, DESCR, SUMM, PVN, OPT, ZNR, ZU, ZDT, NL, ODT) VALUES (30, 34, NULL, NULL, NULL, '2022-01-01', NULL, 'PPRks', 'FF', '110011', 'pieg1', NULL, 'pirkti graudi', 200, 42, NULL, 1, 'Admin', '2022-06-21 17:32:55', NULL, '2022-01-01 00:00:00');
INSERT INTO LOPSD (IDL, ID, DTLD, USL, TPL, DETE, NRX, DOCTYP, DOCST, DOCNR, CLID, CLID2, DESCR, SUMM, PVN, OPT, ZNR, ZU, ZDT, NL, ODT) VALUES (31, 34, NULL, NULL, NULL, '2022-01-01', NULL, 'PPRks', 'FF', '110011', 'pieg1', NULL, 'pirkti graudi', 200, 42, NULL, 1, 'Admin', '2022-06-29 11:54:15', NULL, '2022-06-21 17:32:55');
INSERT INTO LOPSD (IDL, ID, DTLD, USL, TPL, DETE, NRX, DOCTYP, DOCST, DOCNR, CLID, CLID2, DESCR, SUMM, PVN, OPT, ZNR, ZU, ZDT, NL, ODT) VALUES (32, 6, NULL, NULL, NULL, '2014-01-11', NULL, 'PPRks', 'AA', '000111', 'pieg1', NULL, 'izejmater.', 500, 86.78, NULL, 6, 'Admin', '2022-07-06 10:03:14', NULL, '2014-11-22 20:12:20');
INSERT INTO LOPSD (IDL, ID, DTLD, USL, TPL, DETE, NRX, DOCTYP, DOCST, DOCNR, CLID, CLID2, DESCR, SUMM, PVN, OPT, ZNR, ZU, ZDT, NL, ODT) VALUES (33, 38, '2023-01-21 12:12:05', NULL, NULL, '2022-12-11', NULL, 'PPRks', NULL, '1', 'pieg 1', NULL, 'Preƒçu piegƒÅde', 21.78, 3.78, NULL, 5, 'Admin', '2023-01-21 12:12:05', NULL, '2022-12-11 16:14:13');
INSERT INTO LOPSD (IDL, ID, DTLD, USL, TPL, DETE, NRX, DOCTYP, DOCST, DOCNR, CLID, CLID2, DESCR, SUMM, PVN, OPT, ZNR, ZU, ZDT, NL, ODT) VALUES (34, 39, '2023-01-21 12:12:07', NULL, NULL, '2022-12-11', NULL, 'PPRks', NULL, '1', 'pieg 1', NULL, 'preƒçu piegƒÅde', 21.78, 3.78, NULL, 6, 'Admin', '2023-01-21 12:12:07', NULL, '2022-12-11 17:42:45');
INSERT INTO LOPSD (IDL, ID, DTLD, USL, TPL, DETE, NRX, DOCTYP, DOCST, DOCNR, CLID, CLID2, DESCR, SUMM, PVN, OPT, ZNR, ZU, ZDT, NL, ODT) VALUES (35, 40, '2023-01-21 12:12:08', NULL, NULL, '2022-12-11', NULL, 'PPRks', NULL, '1', 'pieg 1', NULL, 'preƒçu piegƒÅde', 21.78, 3.78, NULL, 7, 'Admin', '2023-01-21 12:12:08', NULL, '2022-12-11 17:44:39');


COMMIT WORK;

INSERT INTO M_ACCOUNTTYPE (ID, NAME) VALUES (1, '.?');
INSERT INTO M_ACCOUNTTYPE (ID, NAME) VALUES (2, 'Noliktava');
INSERT INTO M_ACCOUNTTYPE (ID, NAME) VALUES (3, 'Izmaksas');
INSERT INTO M_ACCOUNTTYPE (ID, NAME) VALUES (4, 'Ie≈Üƒìmumi');
INSERT INTO M_ACCOUNTTYPE (ID, NAME) VALUES (5, 'Debitors');
INSERT INTO M_ACCOUNTTYPE (ID, NAME) VALUES (6, 'Kreditors');


COMMIT WORK;

INSERT INTO M_ACCOUNTS (ID, NAME, TP) VALUES ('2110', 'Izejvielas5', 2);
INSERT INTO M_ACCOUNTS (ID, NAME, TP) VALUES ('2131', 'Preces pƒÅrdo≈°anai A', 2);
INSERT INTO M_ACCOUNTS (ID, NAME, TP) VALUES ('2132', 'Preces pƒÅrdo≈°anai B', 2);
INSERT INTO M_ACCOUNTS (ID, NAME, TP) VALUES ('7110', 'Iepirkuma izmaksas', 3);
INSERT INTO M_ACCOUNTS (ID, NAME, TP) VALUES ('.?', 'Nenoteikts', 1);
INSERT INTO M_ACCOUNTS (ID, NAME, TP) VALUES ('7191', 'Korekcijas', 3);
INSERT INTO M_ACCOUNTS (ID, NAME, TP) VALUES ('6111', 'PƒÅrdotƒÅ prece', 4);
INSERT INTO M_ACCOUNTS (ID, NAME, TP) VALUES ('2310', 'Debitori', 5);
INSERT INTO M_ACCOUNTS (ID, NAME, TP) VALUES ('5310', 'Kreditori', 6);
INSERT INTO M_ACCOUNTS (ID, NAME, TP) VALUES ('6112', 'PiegƒÅdes pakalpojumi', 4);
INSERT INTO M_ACCOUNTS (ID, NAME, TP) VALUES ('7170', 'PiegƒÅdes pakalpojumi', 3);
INSERT INTO M_ACCOUNTS (ID, NAME, TP) VALUES ('8000', '?', 1);


COMMIT WORK;

INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (1, 'AfganistƒÅna', 'AFG', 'AF');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (2, 'AlbƒÅnija', 'ALB', 'AL');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (3, 'Al≈æƒ´rija', 'DZA', 'DZ');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (4, 'AmerikƒÅ≈Üu Samoa', 'ASM', 'AS');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (5, 'Amerikas SavienotƒÅs Valstis', 'USA', 'US');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (6, 'Andora', 'AND', 'AD');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (7, 'Angilja', 'AIA', 'AI');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (8, 'Angola', 'AGO', 'AO');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (9, 'Antarktika', 'ATA', 'AQ');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (10, 'Antigva un Barbuda', 'ATG', 'AG');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (11, 'Apvienotie ArƒÅbu EmirƒÅti', 'ARE', 'AE');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (12, 'Argentƒ´na', 'ARG', 'AR');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (13, 'Armƒìnija', 'ARM', 'AM');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (14, 'Aruba', 'ABW', 'AW');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (15, 'ASV MazƒÅs Aizj≈´ras Salas', 'UMI', 'UM');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (16, 'ASV Vird≈æƒ´nas', 'VIR', 'VI');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (17, 'AustrƒÅlija', 'AUS', 'AU');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (18, 'Austrija', 'AUT', 'AT');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (19, 'Austrumtimora', 'TLS', 'TL');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (20, 'Azerbaid≈æƒÅna', 'AZE', 'AZ');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (21, 'Bahamas', 'BHS', 'BS');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (22, 'Bahreina', 'BHR', 'BH');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (23, 'Banglade≈°a', 'BGD', 'BD');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (24, 'Barbadosa', 'BRB', 'BB');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (25, 'Baltkrievija', 'BLR', 'BY');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (26, 'Beliza', 'BLZ', 'BZ');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (27, 'Beƒºƒ£ija', 'BEL', 'BE');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (28, 'Benina', 'BEN', 'BJ');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (29, 'Bermuda', 'BMU', 'BM');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (30, 'Bolƒ´vija', 'BOL', 'BO');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (31, 'Bonaire, Sintƒìstatiusa un Saba[a]', 'BES', 'BQ');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (32, 'Bosnija un Hercegovina', 'BIH', 'BA');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (33, 'Botsvana', 'BWA', 'BW');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (34, 'Brazƒ´lija', 'BRA', 'BR');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (35, 'Britu Vird≈æƒ´nas', 'VGB', 'VG');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (36, 'Bruneja', 'BRN', 'BN');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (37, 'BulgƒÅrija', 'BGR', 'BG');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (38, 'Burkinafaso', 'BFA', 'BF');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (39, 'Burundi', 'BDI', 'BI');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (40, 'ButƒÅna', 'BTN', 'BT');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (41, 'Buvƒì Sala', 'BVT', 'BV');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (42, 'CentrƒÅlƒÅfrikas Republika', 'CAF', 'CF');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (43, 'ƒåada', 'TCD', 'TD');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (44, 'ƒåehija', 'CZE', 'CZ');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (45, 'ƒåƒ´le', 'CHL', 'CL');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (46, 'DƒÅnija', 'DNK', 'DK');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (47, 'DienvidƒÅfrika', 'ZAF', 'ZA');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (48, 'Dienvidd≈æord≈æija un Dienvidsendviƒçu Salas', 'SGS', 'GS');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (49, 'DienvidsudƒÅna', 'SSD', 'SS');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (50, 'Dominika', 'DMA', 'DM');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (51, 'DominikƒÅna', 'DOM', 'DO');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (52, 'D≈æƒìrsija', 'JEY', 'JE');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (53, 'D≈æibutija', 'DJI', 'DJ');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (54, 'ƒíƒ£ipte', 'EGY', 'EG');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (55, 'Ekvadora', 'ECU', 'EC');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (56, 'EkvatoriƒÅlƒÅ Gvineja', 'GNQ', 'GQ');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (57, 'Eritreja', 'ERI', 'ER');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (58, 'Etiopija', 'ETH', 'ET');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (59, 'Fƒìru Salas', 'FRO', 'FO');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (60, 'Fid≈æi', 'FJI', 'FJ');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (61, 'Filipƒ´nas', 'PHL', 'PH');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (62, 'Folklenda Salas', 'FLK', 'FK');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (63, 'Francija', 'FRA', 'FR');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (64, 'Francijas Dienvidj≈´ru un Antarktikas Zemes', 'ATF', 'TF');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (65, 'Franƒçu Polinƒìzija', 'PYF', 'PF');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (66, 'Gabona', 'GAB', 'GA');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (67, 'GajƒÅna', 'GUY', 'GY');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (68, 'Gambija', 'GMB', 'GM');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (69, 'Gana', 'GHA', 'GH');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (70, 'Gƒìrnsija', 'GGY', 'GG');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (71, 'GibraltƒÅrs', 'GIB', 'GI');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (72, 'GrenƒÅda', 'GRD', 'GD');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (73, 'Grenlande', 'GRL', 'GL');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (74, 'Grieƒ∑ija', 'GRC', 'GR');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (75, 'Gruzija', 'GEO', 'GE');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (76, 'Guama', 'GUM', 'GU');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (77, 'Gvadelupa', 'GLP', 'GP');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (78, 'Gvatemala', 'GTM', 'GT');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (79, 'GviƒÅna', 'GUF', 'GF');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (80, 'Gvineja', 'GIN', 'GN');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (81, 'Gvineja-Bisava', 'GNB', 'GW');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (82, 'Haiti', 'HTI', 'HT');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (83, 'Hƒìrda Sala un Makdonalda Salas', 'HMD', 'HM');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (84, 'Hondurasa', 'HND', 'HN');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (85, 'Honkonga (Sjangana)', 'HKG', 'HK');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (86, 'HorvƒÅtija', 'HRV', 'HR');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (87, 'Igaunija', 'EST', 'EE');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (88, 'Indija', 'IND', 'IN');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (89, 'Indijas OkeƒÅna Britu Teritorija', 'IOT', 'IO');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (90, 'Indonƒìzija', 'IDN', 'ID');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (91, 'IrƒÅka', 'IRQ', 'IQ');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (92, 'IrƒÅna', 'IRN', 'IR');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (93, 'ƒ™rija', 'IRL', 'IE');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (94, 'ƒ™slande', 'ISL', 'IS');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (95, 'ItƒÅlija', 'ITA', 'IT');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (96, 'Izraƒìla', 'ISR', 'IL');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (97, 'Jamaika', 'JAM', 'JM');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (98, 'JapƒÅna', 'JPN', 'JP');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (99, 'Jaunkaledonija', 'NCL', 'NC');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (100, 'Jaunzƒìlande', 'NZL', 'NZ');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (101, 'Jemena', 'YEM', 'YE');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (102, 'JordƒÅnija', 'JOR', 'JO');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (103, 'Kaboverde', 'CPV', 'CV');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (104, 'Kaimanu Salas', 'CYM', 'KY');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (105, 'Kambod≈æa', 'KHM', 'KH');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (106, 'Kamer≈´na', 'CMR', 'CM');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (107, 'KanƒÅda', 'CAN', 'CA');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (108, 'Katara', 'QAT', 'QA');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (109, 'KazahstƒÅna', 'KAZ', 'KZ');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (110, 'Kenija', 'KEN', 'KE');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (111, 'Kipra', 'CYP', 'CY');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (112, 'Kirasao', 'CUW', 'CW');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (113, 'KirgizstƒÅna', 'KGZ', 'KG');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (114, 'Kiribati', 'KIR', 'KI');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (115, 'Kokosu (Kƒ´linga) Salas', 'CCK', 'CC');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (116, 'Kolumbija', 'COL', 'CO');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (117, 'Komoras', 'COM', 'KM');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (118, 'Kongo', 'COG', 'CG');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (119, 'Kongo DemokrƒÅtiskƒÅ Republika', 'COD', 'CD');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (120, 'Korejas Republika (Dienvidkoreja)[b]', 'KOR', 'KR');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (121, 'Korejas TDR (Ziemeƒºkoreja)[c]', 'PRK', 'KP');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (122, 'Kostarika', 'CRI', 'CR');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (123, 'KotdivuƒÅra', 'CIV', 'CI');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (124, 'Krievija', 'RUS', 'RU');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (125, 'Kuba', 'CUB', 'CU');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (126, 'Kuka Salas', 'COK', 'CK');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (127, 'Kuveita', 'KWT', 'KW');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (128, 'ƒ∂ƒ´na', 'CHN', 'CN');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (129, 'Laosa', 'LAO', 'LA');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (130, 'Latvija', 'LVA', 'LV');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (131, 'Lesoto', 'LSO', 'LS');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (132, 'LibƒÅna', 'LBN', 'LB');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (133, 'Libƒìrija', 'LBR', 'LR');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (134, 'Lƒ´bija', 'LBY', 'LY');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (135, 'LielbritƒÅnija', 'GBR', 'GB');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (136, 'Lietuva', 'LTU', 'LT');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (137, 'Lihten≈°teina', 'LIE', 'LI');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (138, 'Luksemburga', 'LUX', 'LU');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (139, 'Madagaskara', 'MDG', 'MG');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (140, 'Majota', 'MYT', 'YT');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (141, 'Makao (Aomi≈Üa)', 'MAC', 'MO');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (142, 'Malaizija', 'MYS', 'MY');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (143, 'MalƒÅvija', 'MWI', 'MW');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (144, 'Maldƒ´vija', 'MDV', 'MV');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (145, 'Mali', 'MLI', 'ML');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (146, 'Malta', 'MLT', 'MT');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (147, 'Maroka', 'MAR', 'MA');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (148, 'MƒÅr≈°ala Salas', 'MHL', 'MH');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (149, 'Martinika', 'MTQ', 'MQ');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (150, 'Maurƒ´cija', 'MUS', 'MU');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (151, 'MauritƒÅnija', 'MRT', 'MR');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (152, 'Meksika', 'MEX', 'MX');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (153, 'Melnkalne', 'MNE', 'ME');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (154, 'Mena', 'IMN', 'IM');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (155, 'Mikronƒìzija', 'FSM', 'FM');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (156, 'Mjanma', 'MMR', 'MM');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (157, 'Moldova', 'MDA', 'MD');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (158, 'Monako', 'MCO', 'MC');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (159, 'Mongolija', 'MNG', 'MN');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (160, 'Montserrata', 'MSR', 'MS');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (161, 'Mozambika', 'MOZ', 'MZ');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (162, 'Namƒ´bija', 'NAM', 'NA');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (163, 'Nauru', 'NRU', 'NR');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (164, 'NepƒÅla', 'NPL', 'NP');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (165, 'Nƒ´derlande', 'NLD', 'NL');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (166, 'Nigƒìra', 'NER', 'NE');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (167, 'Nigƒìrija', 'NGA', 'NG');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (168, 'Nikaragva', 'NIC', 'NI');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (169, 'Niue', 'NIU', 'NU');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (170, 'Norfolkas Sala', 'NFK', 'NF');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (171, 'Norvƒìƒ£ija', 'NOR', 'NO');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (172, 'Olande', 'ALA', 'AX');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (173, 'OmƒÅna', 'OMN', 'OM');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (174, 'PakistƒÅna', 'PAK', 'PK');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (175, 'Palau', 'PLW', 'PW');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (176, 'Palestƒ´na', 'PSE', 'PS');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (177, 'Panama', 'PAN', 'PA');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (178, 'Papua-Jaungvineja', 'PNG', 'PG');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (179, 'Paragvaja', 'PRY', 'PY');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (180, 'Peru', 'PER', 'PE');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (181, 'Pitkƒìrna', 'PCN', 'PN');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (182, 'Polija', 'POL', 'PL');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (183, 'PortugƒÅle', 'PRT', 'PT');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (184, 'Puertoriko', 'PRI', 'PR');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (185, 'Reinjona', 'REU', 'RE');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (186, 'RietumsahƒÅra', 'ESH', 'EH');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (187, 'Ruanda', 'RWA', 'RW');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (188, 'RumƒÅnija', 'ROU', 'RO');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (189, 'Salvadora', 'SLV', 'SV');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (190, 'Samoa', 'WSM', 'WS');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (191, 'Sanmarƒ´no', 'SMR', 'SM');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (192, 'Santome un Prinsipi', 'STP', 'ST');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (193, 'Sa≈´da ArƒÅbija', 'SAU', 'SA');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (194, 'Sei≈°elas', 'SYC', 'SC');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (195, 'Senbartelmƒ´', 'BLM', 'BL');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (196, 'SenegƒÅla', 'SEN', 'SN');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (197, 'Senmartƒìna', 'MAF', 'MF');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (198, 'Senpjƒìra un Mikelona', 'SPM', 'PM');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (199, 'Sentkitsa un Nevisa', 'KNA', 'KN');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (200, 'Sentl≈´sija', 'LCA', 'LC');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (201, 'Sentvinsenta un Grenadƒ´nas', 'VCT', 'VC');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (202, 'Serbija', 'SRB', 'RS');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (203, 'Singap≈´ra', 'SGP', 'SG');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (204, 'Sƒ´rija', 'SYR', 'SY');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (205, 'SintmƒÅrtena', 'SXM', 'SX');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (206, 'Sjerraleone', 'SLE', 'SL');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (207, 'SlovƒÅkija', 'SVK', 'SK');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (208, 'Slovƒìnija', 'SVN', 'SI');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (209, 'SomƒÅlija', 'SOM', 'SO');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (210, 'Somija', 'FIN', 'FI');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (211, 'SpƒÅnija', 'ESP', 'ES');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (212, 'SudƒÅna', 'SDN', 'SD');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (213, 'Surinama', 'SUR', 'SR');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (214, 'SvalbƒÅra, Jana Majena sala', 'SJM', 'SJ');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (215, 'Svazilenda', 'SWZ', 'SZ');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (216, 'SvƒìtƒÅs Helƒìnas Sala', 'SHN', 'SH');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (217, '≈†rilanka', 'LKA', 'LK');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (218, '≈†veice', 'CHE', 'CH');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (219, 'Tad≈æikistƒÅna', 'TJK', 'TJ');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (220, 'TaivƒÅna', 'TWN', 'TW');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (221, 'Taizeme', 'THA', 'TH');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (222, 'TanzƒÅnija', 'TZA', 'TZ');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (223, 'Tƒìrksas un Kaikosas', 'TCA', 'TC');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (224, 'Togo', 'TGO', 'TG');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (225, 'Tokelau', 'TKL', 'TK');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (226, 'Tonga', 'TON', 'TO');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (227, 'TrinidƒÅda un TobƒÅgo', 'TTO', 'TT');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (228, 'Tunisija', 'TUN', 'TN');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (229, 'Turcija', 'TUR', 'TR');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (230, 'TurkmenistƒÅna', 'TKM', 'TM');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (231, 'Tuvalu', 'TUV', 'TV');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (232, 'Uganda', 'UGA', 'UG');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (233, 'Ukraina', 'UKR', 'UA');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (234, 'UngƒÅrija', 'HUN', 'HU');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (235, 'Urugvaja', 'URY', 'UY');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (236, 'UzbekistƒÅna', 'UZB', 'UZ');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (237, 'VƒÅcija', 'DEU', 'DE');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (238, 'Vanuatu', 'VUT', 'VU');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (239, 'VatikƒÅns (Svƒìtais Krƒìsls)', 'VAT', 'VA');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (240, 'Venecuƒìla', 'VEN', 'VE');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (241, 'Vjetnama', 'VNM', 'VN');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (242, 'Volisa un Futuna', 'WLF', 'WF');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (243, 'ZƒÅlamana Salas', 'SLB', 'SB');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (244, 'Zambija', 'ZMB', 'ZM');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (245, 'Ziemeƒºmaƒ∑edonija', 'MKD', 'MK');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (246, 'Ziemeƒºu Marianas Salas', 'MNP', 'MP');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (247, 'Ziemsvƒìtku Sala', 'CXR', 'CX');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (248, 'Zimbabve', 'ZWE', 'ZW');
INSERT INTO M_COUNTRIES (ID, NAME, CODE3, CODE2) VALUES (249, 'Zviedrija', 'SWE', 'SE');


COMMIT WORK;

INSERT INTO M_PVNTYPE (ID, CODE, NAME) VALUES (1, '.?', 'Nenoteikts');
INSERT INTO M_PVNTYPE (ID, CODE, NAME) VALUES (2, 'IA', 'Iek≈°zemƒì apliekama persona');
INSERT INTO M_PVNTYPE (ID, CODE, NAME) VALUES (7, 'NAV', 'Nav PVN');
INSERT INTO M_PVNTYPE (ID, CODE, NAME) VALUES (3, 'IN', 'Iek≈°zemƒì neapliekama persona');
INSERT INTO M_PVNTYPE (ID, CODE, NAME) VALUES (4, 'EA', 'Eiropas kopienƒÅ apliekama persona');
INSERT INTO M_PVNTYPE (ID, CODE, NAME) VALUES (5, 'EN', 'Eiropas kopienƒÅ neapliekama persona');
INSERT INTO M_PVNTYPE (ID, CODE, NAME) VALUES (6, 'T', 'Tre≈°ƒÅs valstis');


COMMIT WORK;

INSERT INTO M_STORETYPE (ID, NAME, TRACKSTOCK) VALUES (1, 'nenoteikts', 0);
INSERT INTO M_STORETYPE (ID, NAME, TRACKSTOCK) VALUES (2, 'noliktava', 1);
INSERT INTO M_STORETYPE (ID, NAME, TRACKSTOCK) VALUES (3, 'darbinieks', 1);
INSERT INTO M_STORETYPE (ID, NAME, TRACKSTOCK) VALUES (4, 'partneris', 0);
INSERT INTO M_STORETYPE (ID, NAME, TRACKSTOCK) VALUES (6, 'pakalpojumi', 0);
INSERT INTO M_STORETYPE (ID, NAME, TRACKSTOCK) VALUES (7, 'citi', 0);
INSERT INTO M_STORETYPE (ID, NAME, TRACKSTOCK) VALUES (5, 'partneris turƒìtƒÅjs', 1);
INSERT INTO M_STORETYPE (ID, NAME, TRACKSTOCK) VALUES (8, 'Noliktava ƒÅrpus', 0);
INSERT INTO M_STORETYPE (ID, NAME, TRACKSTOCK) VALUES (9, 'Ra≈æo≈°ana', 0);


COMMIT WORK;

INSERT INTO M_STORES (ID, CODE, NAME, TP, REGNR, PVNREGNR, ADDR, PVNTP, ACC21, ACC23, ACC53) VALUES (2, 'N1', 'Noliktava 1', 2, NULL, NULL, NULL, 2, '2131', '2310', '5310');
INSERT INTO M_STORES (ID, CODE, NAME, TP, REGNR, PVNREGNR, ADDR, PVNTP, ACC21, ACC23, ACC53) VALUES (3, 'N2', 'Noliktava 2', 2, NULL, NULL, NULL, 2, '2131', '2310', '5310');
INSERT INTO M_STORES (ID, CODE, NAME, TP, REGNR, PVNREGNR, ADDR, PVNTP, ACC21, ACC23, ACC53) VALUES (4, 'pieg1', 'PiegƒÅdƒÅtƒÅjs 1', 4, NULL, NULL, NULL, 2, '2131', '2310', '5310');
INSERT INTO M_STORES (ID, CODE, NAME, TP, REGNR, PVNREGNR, ADDR, PVNTP, ACC21, ACC23, ACC53) VALUES (5, 'pieg2', 'PiegƒÅdƒÅtƒÅjs 2', 4, NULL, NULL, NULL, 2, '2131', '2310', '5310');
INSERT INTO M_STORES (ID, CODE, NAME, TP, REGNR, PVNREGNR, ADDR, PVNTP, ACC21, ACC23, ACC53) VALUES (6, 'pieg3', 'PiegƒÅdƒÅtƒÅjs 3', 4, NULL, NULL, NULL, 2, '2131', '2310', '5310');
INSERT INTO M_STORES (ID, CODE, NAME, TP, REGNR, PVNREGNR, ADDR, PVNTP, ACC21, ACC23, ACC53) VALUES (7, 'pirc1', 'Pircƒìjs 1', 4, NULL, NULL, NULL, 2, '2110', '2310', '5310');
INSERT INTO M_STORES (ID, CODE, NAME, TP, REGNR, PVNREGNR, ADDR, PVNTP, ACC21, ACC23, ACC53) VALUES (8, 'pirc2', 'Pircƒìjs 2', 4, NULL, NULL, NULL, 2, '2110', '2310', '5310');
INSERT INTO M_STORES (ID, CODE, NAME, TP, REGNR, PVNREGNR, ADDR, PVNTP, ACC21, ACC23, ACC53) VALUES (9, 'pirc3', 'Pircƒìjs 3', 4, NULL, NULL, NULL, 2, '2110', '2310', '5310');
INSERT INTO M_STORES (ID, CODE, NAME, TP, REGNR, PVNREGNR, ADDR, PVNTP, ACC21, ACC23, ACC53) VALUES (1, '.?', 'Nenoteikts', 1, NULL, NULL, NULL, 1, '.?', '.?', '.?');


COMMIT WORK;

INSERT INTO M_BANKS (ID, CODE, NAME) VALUES (1, NULL, '"Swedbank" AS');
INSERT INTO M_BANKS (ID, CODE, NAME) VALUES (2, NULL, 'AS "SEB banka"');
INSERT INTO M_BANKS (ID, CODE, NAME) VALUES (3, NULL, 'AS "Citadele banka"');


COMMIT WORK;

INSERT INTO M_DOCTYPES (ID, CODE, NAME, OPTYPE) VALUES (1, '.?', 'Nenoteikts', 0);
INSERT INTO M_DOCTYPES (ID, CODE, NAME, OPTYPE) VALUES (2, 'Iepirkums', 'Iepirkums', 1);
INSERT INTO M_DOCTYPES (ID, CODE, NAME, OPTYPE) VALUES (3, 'Realizƒìts', 'Realizacija', 2);
INSERT INTO M_DOCTYPES (ID, CODE, NAME, OPTYPE) VALUES (4, 'Atgr.pieg.', 'Atgriezts piegƒÅdƒÅtajam', 2);
INSERT INTO M_DOCTYPES (ID, CODE, NAME, OPTYPE) VALUES (8, 'PƒÅrvietots', 'PƒÅrvietots', 0);
INSERT INTO M_DOCTYPES (ID, CODE, NAME, OPTYPE) VALUES (5, 'Pirc.atgr.', 'Atgriezts no pircƒìja', 2);
INSERT INTO M_DOCTYPES (ID, CODE, NAME, OPTYPE) VALUES (9, 'SƒÅk.atl.', 'SƒÅkuma atlikumi', 1);
INSERT INTO M_DOCTYPES (ID, CODE, NAME, OPTYPE) VALUES (10, 'Norakstƒ´ts', 'Norakstƒ´ts', 2);
INSERT INTO M_DOCTYPES (ID, CODE, NAME, OPTYPE) VALUES (11, 'Pierakstƒ´ts', 'Pierakstƒ´ts', 1);
INSERT INTO M_DOCTYPES (ID, CODE, NAME, OPTYPE) VALUES (6, 'Kr.iep.', 'Kredƒ´trƒìƒ∑ins no piegƒÅdƒÅtƒÅja', 2);
INSERT INTO M_DOCTYPES (ID, CODE, NAME, OPTYPE) VALUES (7, 'Kr.pirc.', 'Kredƒ´trƒìƒ∑ins pircƒìjam', 2);
INSERT INTO M_DOCTYPES (ID, CODE, NAME, OPTYPE) VALUES (12, 'Uz noliktavu', 'Nos≈´tƒ´ts uz citu noliktavu', 2);
INSERT INTO M_DOCTYPES (ID, CODE, NAME, OPTYPE) VALUES (13, 'No noliktavas', 'Sa≈Üemts no citas noliktavas', 1);
INSERT INTO M_DOCTYPES (ID, CODE, NAME, OPTYPE) VALUES (14, 'Izlietots', 'Izlietots', 2);
INSERT INTO M_DOCTYPES (ID, CODE, NAME, OPTYPE) VALUES (15, 'Sara≈æots', 'Sara≈æots', 1);
INSERT INTO M_DOCTYPES (ID, CODE, NAME, OPTYPE) VALUES (16, 'Sa≈Üemti pakalp.', 'Sa≈Üemti pakalpojumi', 0);
INSERT INTO M_DOCTYPES (ID, CODE, NAME, OPTYPE) VALUES (17, 'Sniegti pakalp.', 'Sniegti pakalpojumi', 0);


COMMIT WORK;

INSERT INTO M_PAYMENTTYPE (ID, NAME) VALUES (1, 'Bankas pƒÅrskaitijums');
INSERT INTO M_PAYMENTTYPE (ID, NAME) VALUES (2, 'SkaidrƒÅ naudƒÅ');
INSERT INTO M_PAYMENTTYPE (ID, NAME) VALUES (3, 'Ar priek≈°apmaksu');


COMMIT WORK;

INSERT INTO M_TRANSACTIONTYPE (ID, NAME) VALUES (1, 'Preƒçu piegƒÅde');
INSERT INTO M_TRANSACTIONTYPE (ID, NAME) VALUES (2, 'Preƒçu atgrie≈°ana');
INSERT INTO M_TRANSACTIONTYPE (ID, NAME) VALUES (3, 'Iek≈°ƒìja pƒÅrvieto≈°ana');
INSERT INTO M_TRANSACTIONTYPE (ID, NAME) VALUES (4, 'SƒÅkuma atlikumi');
INSERT INTO M_TRANSACTIONTYPE (ID, NAME) VALUES (5, 'Atlikumu korekcijas');
INSERT INTO M_TRANSACTIONTYPE (ID, NAME) VALUES (0, '.?');


COMMIT WORK;

INSERT INTO M_DOCS (ID, DT, SR, NR, TP, PVNTYPE, STATE, IDSTOREIN, IDSTOREOUT, IDCREDDOC, CREDDOCDT, SUMM, IDSEQ, ACCIN, ACCOUT, CREDDOCSR, CREDDOCNR, IDCARRIER, IDADDRESSOUT, IDADDRESSIN, IDVEHICLE, IDTRANSACTIONTYPE, IDPAYMENTTYPE, IDDRIVER, ACCOUNTINGTP, ACCTP1, ACCTP2, DUEDATE) VALUES (2, '2023-01-01', NULL, '1', 2, 2, 3, 2, 4, NULL, NULL, 350.9, 3, '2131', '5310', NULL, NULL, NULL, NULL, NULL, NULL, 1, NULL, NULL, 1, 1, 1, NULL);
INSERT INTO M_DOCS (ID, DT, SR, NR, TP, PVNTYPE, STATE, IDSTOREIN, IDSTOREOUT, IDCREDDOC, CREDDOCDT, SUMM, IDSEQ, ACCIN, ACCOUT, CREDDOCSR, CREDDOCNR, IDCARRIER, IDADDRESSOUT, IDADDRESSIN, IDVEHICLE, IDTRANSACTIONTYPE, IDPAYMENTTYPE, IDDRIVER, ACCOUNTINGTP, ACCTP1, ACCTP2, DUEDATE) VALUES (3, '2023-01-02', NULL, NULL, 3, 2, 3, 7, 2, NULL, NULL, 90.75, 6, '2310', '2131', NULL, NULL, NULL, NULL, NULL, NULL, 1, NULL, NULL, 1, 1, 1, NULL);
INSERT INTO M_DOCS (ID, DT, SR, NR, TP, PVNTYPE, STATE, IDSTOREIN, IDSTOREOUT, IDCREDDOC, CREDDOCDT, SUMM, IDSEQ, ACCIN, ACCOUT, CREDDOCSR, CREDDOCNR, IDCARRIER, IDADDRESSOUT, IDADDRESSIN, IDVEHICLE, IDTRANSACTIONTYPE, IDPAYMENTTYPE, IDDRIVER, ACCOUNTINGTP, ACCTP1, ACCTP2, DUEDATE) VALUES (4, '2023-01-02', NULL, NULL, 3, 2, 3, 7, 2, NULL, NULL, 121, 8, '2310', '2131', NULL, NULL, NULL, NULL, NULL, NULL, 1, NULL, NULL, 1, 0, 1, NULL);
INSERT INTO M_DOCS (ID, DT, SR, NR, TP, PVNTYPE, STATE, IDSTOREIN, IDSTOREOUT, IDCREDDOC, CREDDOCDT, SUMM, IDSEQ, ACCIN, ACCOUT, CREDDOCSR, CREDDOCNR, IDCARRIER, IDADDRESSOUT, IDADDRESSIN, IDVEHICLE, IDTRANSACTIONTYPE, IDPAYMENTTYPE, IDDRIVER, ACCOUNTINGTP, ACCTP1, ACCTP2, DUEDATE) VALUES (7, '2023-01-04', NULL, NULL, 3, 2, 3, 7, 2, NULL, NULL, 272.25, 22, '2310', '2131', NULL, NULL, NULL, NULL, NULL, NULL, 1, NULL, NULL, 1, 0, 1, NULL);
INSERT INTO M_DOCS (ID, DT, SR, NR, TP, PVNTYPE, STATE, IDSTOREIN, IDSTOREOUT, IDCREDDOC, CREDDOCDT, SUMM, IDSEQ, ACCIN, ACCOUT, CREDDOCSR, CREDDOCNR, IDCARRIER, IDADDRESSOUT, IDADDRESSIN, IDVEHICLE, IDTRANSACTIONTYPE, IDPAYMENTTYPE, IDDRIVER, ACCOUNTINGTP, ACCTP1, ACCTP2, DUEDATE) VALUES (5, '2023-01-03', NULL, NULL, 2, 2, 3, 2, 4, NULL, NULL, 36.3, 10, '2131', '5310', NULL, NULL, NULL, NULL, NULL, NULL, 1, NULL, NULL, 1, 0, 1, NULL);
INSERT INTO M_DOCS (ID, DT, SR, NR, TP, PVNTYPE, STATE, IDSTOREIN, IDSTOREOUT, IDCREDDOC, CREDDOCDT, SUMM, IDSEQ, ACCIN, ACCOUT, CREDDOCSR, CREDDOCNR, IDCARRIER, IDADDRESSOUT, IDADDRESSIN, IDVEHICLE, IDTRANSACTIONTYPE, IDPAYMENTTYPE, IDDRIVER, ACCOUNTINGTP, ACCTP1, ACCTP2, DUEDATE) VALUES (6, '2023-01-04', NULL, NULL, 5, 2, 3, 7, 2, NULL, NULL, -90.75, 16, '2310', '2131', NULL, NULL, NULL, NULL, NULL, NULL, 1, NULL, NULL, 1, 0, 1, NULL);


COMMIT WORK;

INSERT INTO M_ITEMS_CAT (ID, NAME, CODE, ISGROUP, METHOD, ISSERVICES, ACC6, ACC7) VALUES (1, 'Nenoteikts', '.?', 0, 0, 0, '?', '?');
INSERT INTO M_ITEMS_CAT (ID, NAME, CODE, ISGROUP, METHOD, ISSERVICES, ACC6, ACC7) VALUES (2, 'Kat. A', 'A', 1, 0, 0, '?', '?');
INSERT INTO M_ITEMS_CAT (ID, NAME, CODE, ISGROUP, METHOD, ISSERVICES, ACC6, ACC7) VALUES (3, 'Kat. A-A', 'A-A', 1, 0, 0, '?', '?');
INSERT INTO M_ITEMS_CAT (ID, NAME, CODE, ISGROUP, METHOD, ISSERVICES, ACC6, ACC7) VALUES (4, 'Kat. A-B', 'A-B', 1, 0, 0, '6111', '7110');
INSERT INTO M_ITEMS_CAT (ID, NAME, CODE, ISGROUP, METHOD, ISSERVICES, ACC6, ACC7) VALUES (5, 'Kat. A-A-01', 'A-A-01', 0, 0, 0, '6111', '7110');
INSERT INTO M_ITEMS_CAT (ID, NAME, CODE, ISGROUP, METHOD, ISSERVICES, ACC6, ACC7) VALUES (6, 'Kat. A-A-02', 'A-A-02', 0, 0, 0, '6111', '7110');
INSERT INTO M_ITEMS_CAT (ID, NAME, CODE, ISGROUP, METHOD, ISSERVICES, ACC6, ACC7) VALUES (7, 'Kat. A-A-03', 'A-A-03', 0, 0, 0, '6111', '7110');
INSERT INTO M_ITEMS_CAT (ID, NAME, CODE, ISGROUP, METHOD, ISSERVICES, ACC6, ACC7) VALUES (8, 'Kat. A-B-01', 'A-B-01', 0, 0, 0, '6111', '7110');
INSERT INTO M_ITEMS_CAT (ID, NAME, CODE, ISGROUP, METHOD, ISSERVICES, ACC6, ACC7) VALUES (9, 'Kat. A-B-02', 'A-B-02', 0, 0, 0, '6111', '7110');
INSERT INTO M_ITEMS_CAT (ID, NAME, CODE, ISGROUP, METHOD, ISSERVICES, ACC6, ACC7) VALUES (10, 'Kat. B', 'B', 1, 0, 0, '6111', '7110');
INSERT INTO M_ITEMS_CAT (ID, NAME, CODE, ISGROUP, METHOD, ISSERVICES, ACC6, ACC7) VALUES (11, 'Kat. B-01', 'B-01', 0, 0, 0, '6112', '7170');


COMMIT WORK;

INSERT INTO M_PVNRATES (ID, CODE, NAME, RATE, ISREVERSE) VALUES (1, 'A21', 'Prece 21%', 21, 0);
INSERT INTO M_PVNRATES (ID, CODE, NAME, RATE, ISREVERSE) VALUES (2, 'A05', 'Prece 5%', 5, 0);
INSERT INTO M_PVNRATES (ID, CODE, NAME, RATE, ISREVERSE) VALUES (4, 'D21', 'Datortehnika 21%', 21, 1);
INSERT INTO M_PVNRATES (ID, CODE, NAME, RATE, ISREVERSE) VALUES (5, 'G21', 'Graudaugi 21%', 21, 1);
INSERT INTO M_PVNRATES (ID, CODE, NAME, RATE, ISREVERSE) VALUES (6, 'M21', 'MetƒÅlizstrƒÅdƒÅjumi 21%', 21, 1);
INSERT INTO M_PVNRATES (ID, CODE, NAME, RATE, ISREVERSE) VALUES (7, 'B21', 'B≈´vniecƒ´bas pakalpojumi 21%', 21, 1);
INSERT INTO M_PVNRATES (ID, CODE, NAME, RATE, ISREVERSE) VALUES (8, 'K21', 'KokmateriƒÅli 21%', 21, 1);
INSERT INTO M_PVNRATES (ID, CODE, NAME, RATE, ISREVERSE) VALUES (3, 'P21', 'Pakalpojumi 21%', 21, 0);


COMMIT WORK;

INSERT INTO M_UNITS (ID, CODE, NAME) VALUES (1, '.?', 'Nenoteikts');
INSERT INTO M_UNITS (ID, CODE, NAME) VALUES (2, 'gab.', 'Gabali');
INSERT INTO M_UNITS (ID, CODE, NAME) VALUES (3, 'kg', 'Kilogrami');
INSERT INTO M_UNITS (ID, CODE, NAME) VALUES (4, 't', 'Tonnas');
INSERT INTO M_UNITS (ID, CODE, NAME) VALUES (5, 'litri', 'Litri');
INSERT INTO M_UNITS (ID, CODE, NAME) VALUES (6, 'm3', 'Kubikmetri');
INSERT INTO M_UNITS (ID, CODE, NAME) VALUES (7, 'm2', 'Kvadrtmetri');


COMMIT WORK;

INSERT INTO M_ITEMS (ID, BARCODE, NAME, CAT, UNITS, STORE1, PVNRATE, ISSERVICE, SELLPRICE, BUYPRICE, LASTBUYPRICE, AMOUNTINSTORE, LASTSALEDATE, LASTBUYDATE) VALUES (1, '.?', 'Nenoteikts', 1, 1, 1, 1, 0, 0, 0, 0, 0, NULL, NULL);
INSERT INTO M_ITEMS (ID, BARCODE, NAME, CAT, UNITS, STORE1, PVNRATE, ISSERVICE, SELLPRICE, BUYPRICE, LASTBUYPRICE, AMOUNTINSTORE, LASTSALEDATE, LASTBUYDATE) VALUES (2, '002', 'Prece 2', 5, 2, 2, 1, 0, 10, 7, 0, 15, NULL, NULL);
INSERT INTO M_ITEMS (ID, BARCODE, NAME, CAT, UNITS, STORE1, PVNRATE, ISSERVICE, SELLPRICE, BUYPRICE, LASTBUYPRICE, AMOUNTINSTORE, LASTSALEDATE, LASTBUYDATE) VALUES (3, '001', 'Prece 1', 5, 2, 2, 1, 0, 5, 3, 0, 5, NULL, NULL);
INSERT INTO M_ITEMS (ID, BARCODE, NAME, CAT, UNITS, STORE1, PVNRATE, ISSERVICE, SELLPRICE, BUYPRICE, LASTBUYPRICE, AMOUNTINSTORE, LASTSALEDATE, LASTBUYDATE) VALUES (4, '003', 'Prece 3', 6, 2, 2, 1, 0, 7, 5, 0, 0, NULL, NULL);
INSERT INTO M_ITEMS (ID, BARCODE, NAME, CAT, UNITS, STORE1, PVNRATE, ISSERVICE, SELLPRICE, BUYPRICE, LASTBUYPRICE, AMOUNTINSTORE, LASTSALEDATE, LASTBUYDATE) VALUES (5, '004', 'Prece 4', 11, 2, 2, 1, 0, 20, 15, 0, 0, NULL, NULL);


COMMIT WORK;

INSERT INTO M_ITEMS_PER_STORE (IDITEM, IDSTORE, AMOUNT) VALUES (3, 2, 5);
INSERT INTO M_ITEMS_PER_STORE (IDITEM, IDSTORE, AMOUNT) VALUES (2, 2, 15);


COMMIT WORK;

INSERT INTO M_ROWS (ID, IDDOC, IDITEM, IDPVNRATE, UNITS, IDCREDROW, AMOUNT, DISCOUNT, PRICE0, PRICE, BUYPRICE, OLDPRICE, TOLDPRICE, TPRICE, TBUYPRICE, IDSEQ, ACC6, ACC7, ISGONE) VALUES (1, 2, 3, 1, 2, NULL, 50, 0, 3, 3, 3, 0, 0, 150, 150, 1, '6111', '7110', 0);
INSERT INTO M_ROWS (ID, IDDOC, IDITEM, IDPVNRATE, UNITS, IDCREDROW, AMOUNT, DISCOUNT, PRICE0, PRICE, BUYPRICE, OLDPRICE, TOLDPRICE, TPRICE, TBUYPRICE, IDSEQ, ACC6, ACC7, ISGONE) VALUES (2, 2, 2, 1, 2, NULL, 20, 0, 7, 7, 7, 0, 0, 140, 140, 2, '6111', '7110', 0);
INSERT INTO M_ROWS (ID, IDDOC, IDITEM, IDPVNRATE, UNITS, IDCREDROW, AMOUNT, DISCOUNT, PRICE0, PRICE, BUYPRICE, OLDPRICE, TOLDPRICE, TPRICE, TBUYPRICE, IDSEQ, ACC6, ACC7, ISGONE) VALUES (3, 3, 3, 1, 2, NULL, 5, 0, 5, 5, 3, 0, 0, 25, 15, 4, '6111', '7110', 0);
INSERT INTO M_ROWS (ID, IDDOC, IDITEM, IDPVNRATE, UNITS, IDCREDROW, AMOUNT, DISCOUNT, PRICE0, PRICE, BUYPRICE, OLDPRICE, TOLDPRICE, TPRICE, TBUYPRICE, IDSEQ, ACC6, ACC7, ISGONE) VALUES (4, 3, 2, 1, 2, NULL, 5, 0, 10, 10, 7, 0, 0, 50, 35, 5, '6111', '7110', 0);
INSERT INTO M_ROWS (ID, IDDOC, IDITEM, IDPVNRATE, UNITS, IDCREDROW, AMOUNT, DISCOUNT, PRICE0, PRICE, BUYPRICE, OLDPRICE, TOLDPRICE, TPRICE, TBUYPRICE, IDSEQ, ACC6, ACC7, ISGONE) VALUES (5, 4, 3, 1, 2, NULL, 20, 0, 5, 5, 3, 0, 0, 100, 60, 7, '6111', '7110', 0);
INSERT INTO M_ROWS (ID, IDDOC, IDITEM, IDPVNRATE, UNITS, IDCREDROW, AMOUNT, DISCOUNT, PRICE0, PRICE, BUYPRICE, OLDPRICE, TOLDPRICE, TPRICE, TBUYPRICE, IDSEQ, ACC6, ACC7, ISGONE) VALUES (6, 5, 3, 1, 2, NULL, 10, 0, 3, 3, 3, 0, 0, 30, 30, 9, '6111', '7110', 0);
INSERT INTO M_ROWS (ID, IDDOC, IDITEM, IDPVNRATE, UNITS, IDCREDROW, AMOUNT, DISCOUNT, PRICE0, PRICE, BUYPRICE, OLDPRICE, TOLDPRICE, TPRICE, TBUYPRICE, IDSEQ, ACC6, ACC7, ISGONE) VALUES (7, 6, 3, 1, 2, NULL, -15, 0, 5, 5, 3, 5, 75, -75, 45, 15, '6111', '7110', 0);
INSERT INTO M_ROWS (ID, IDDOC, IDITEM, IDPVNRATE, UNITS, IDCREDROW, AMOUNT, DISCOUNT, PRICE0, PRICE, BUYPRICE, OLDPRICE, TOLDPRICE, TPRICE, TBUYPRICE, IDSEQ, ACC6, ACC7, ISGONE) VALUES (8, 7, 3, 1, 2, NULL, 45, 0, 5, 5, 3, 0, 0, 225, 135, 21, '6111', '7110', 0);


COMMIT WORK;

INSERT INTO M_LINKS (ID1, ID2, IDITEM, AMOUNT) VALUES (1, 8, 3, 40);
INSERT INTO M_LINKS (ID1, ID2, IDITEM, AMOUNT) VALUES (6, 8, 3, 5);
INSERT INTO M_LINKS (ID1, ID2, IDITEM, AMOUNT) VALUES (2, 4, 2, 5);
INSERT INTO M_LINKS (ID1, ID2, IDITEM, AMOUNT) VALUES (1, 3, 3, 5);
INSERT INTO M_LINKS (ID1, ID2, IDITEM, AMOUNT) VALUES (1, 5, 3, 20);
INSERT INTO M_LINKS (ID1, ID2, IDITEM, AMOUNT) VALUES (1, 7, 3, -15);
INSERT INTO M_LINKS (ID1, ID2, IDITEM, AMOUNT) VALUES (5, 7, 3, 15);


COMMIT WORK;

INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (78, 6, 2, 2, 0, 0, 2, 'M02', 4, NULL, 1, 'M12', 1, '0', 9);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (3, 1, 2, 2, 0, 0, 2, '401', 4, NULL, 1, '305', 4, NULL, 1);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (4, 1, 3, 2, 0, 0, 2, NULL, 4, NULL, 0, NULL, 0, NULL, NULL);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (79, 6, 3, 2, 0, 0, 2, NULL, 4, NULL, 0, NULL, 0, NULL, NULL);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (80, 6, 4, 2, 0, 0, 2, NULL, 4, '133', 1, '331', 1, '233', NULL);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (5, 1, 4, 2, 0, 0, 2, NULL, 4, '133', 1, '331', 1, '233', NULL);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (6, 1, 5, 2, 0, 0, 2, NULL, 4, NULL, 0, NULL, 0, NULL, NULL);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (7, 1, 6, 2, 0, 0, 2, NULL, 4, NULL, 0, NULL, 0, NULL, NULL);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (8, 1, 2, 3, 0, 0, 3, NULL, 5, '104', 3, NULL, 1, '204', 1);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (9, 1, 3, 3, 0, 0, 3, NULL, 5, '104', 3, NULL, 1, '204', 1);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (10, 1, 4, 3, 0, 0, 3, NULL, 5, '112', 0, NULL, 0, NULL, 5);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (11, 1, 5, 3, 0, 0, 3, NULL, 5, '104', 3, NULL, 1, '204', 1);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (12, 1, 6, 3, 0, 0, 3, NULL, 5, '118', 0, NULL, 0, NULL, 4);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (13, 2, 2, 2, 0, 0, 2, '401', 4, NULL, 1, '302', 4, NULL, 2);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (14, 2, 3, 2, 0, 0, 2, NULL, 4, NULL, 0, NULL, 0, NULL, NULL);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (81, 6, 5, 2, 0, 0, 2, NULL, 4, NULL, 0, NULL, 0, NULL, NULL);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (16, 1, 2, 4, 0, 0, 4, NULL, 2, NULL, 4, NULL, 1, '305', 1);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (17, 1, 3, 4, 0, 0, 4, NULL, 2, NULL, 0, NULL, 0, NULL, NULL);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (18, 1, 2, 5, 0, 1, 5, '104', 3, NULL, 1, '204', 3, NULL, 1);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (19, 1, 3, 5, 0, 1, 5, '104', 3, NULL, 1, '204', 3, NULL, 1);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (20, 1, 2, 6, 0, 0, 4, NULL, 2, NULL, 4, NULL, 1, '305', 1);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (21, 1, 3, 6, 0, 0, 4, NULL, 2, NULL, 0, NULL, 0, NULL, NULL);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (22, 1, 2, 7, 0, 1, 5, '104', 3, NULL, 1, '204', 3, NULL, 1);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (23, 1, 3, 7, 0, 1, 5, '104', 3, NULL, 1, '204', 3, NULL, 1);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (82, 6, 6, 2, 0, 0, 2, NULL, 4, NULL, 0, NULL, 0, NULL, NULL);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (83, 6, 2, 3, 0, 0, 3, NULL, 5, 'M01', 0, NULL, 0, NULL, 9);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (84, 6, 3, 3, 0, 0, 3, NULL, 5, '104', 3, NULL, 1, '204', 1);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (85, 6, 4, 3, 0, 0, 3, NULL, 5, '112', 0, NULL, 0, NULL, 5);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (86, 6, 5, 3, 0, 0, 3, NULL, 5, '104', 3, NULL, 1, '204', 1);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (87, 6, 6, 3, 0, 0, 3, NULL, 5, '118', 0, NULL, 0, NULL, 4);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (26, 2, 2, 3, 0, 0, 3, NULL, 5, '102', 3, NULL, 1, '202', 2);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (28, 2, 2, 4, 0, 0, 4, NULL, 2, NULL, 4, NULL, 1, '302', 2);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (29, 2, 3, 4, 0, 0, 4, NULL, 2, NULL, 0, NULL, 0, NULL, NULL);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (30, 2, 2, 5, 0, 0, 5, '102', 3, NULL, 1, '202', 3, NULL, 2);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (31, 2, 3, 5, 0, 0, 5, '102', 3, NULL, 1, '202', 3, NULL, 2);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (32, 2, 2, 6, 0, 0, 4, NULL, 2, NULL, 4, NULL, 1, '302', 2);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (33, 2, 3, 6, 0, 0, 4, NULL, 2, NULL, 0, NULL, 0, NULL, NULL);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (34, 2, 2, 7, 0, 0, 5, '102', 3, NULL, 1, '202', 3, NULL, 2);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (35, 2, 3, 7, 0, 0, 5, '102', 3, NULL, 1, '202', 3, NULL, 2);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (36, 3, 2, 2, 0, 0, 6, '401', 4, NULL, 1, '305', 4, NULL, 1);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (37, 3, 3, 2, 0, 0, 6, NULL, 4, NULL, 0, NULL, 0, NULL, NULL);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (38, 3, 4, 2, 0, 0, 6, NULL, 4, '135', 1, '332', 1, '235', NULL);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (39, 3, 5, 2, 0, 0, 6, NULL, 4, NULL, 0, NULL, 0, NULL, NULL);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (40, 3, 6, 2, 0, 0, 6, NULL, 4, NULL, 0, NULL, 0, NULL, NULL);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (41, 3, 2, 3, 0, 0, 3, NULL, 5, '104', 3, NULL, 1, '204', 1);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (42, 3, 3, 3, 0, 0, 3, NULL, 5, '104', 3, NULL, 1, '204', 1);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (43, 3, 4, 3, 0, 0, 3, NULL, 5, '104', 3, NULL, 1, '204', NULL);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (44, 3, 5, 3, 0, 0, 3, NULL, 5, '104', 3, NULL, 1, '204', 1);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (45, 3, 6, 3, 0, 0, 3, NULL, 5, '104', 3, NULL, 1, '204', NULL);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (88, 6, 2, 4, 0, 0, 4, NULL, 2, 'M02', 1, '0', 1, 'M12', 9);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (89, 6, 3, 4, 0, 0, 4, NULL, 2, NULL, 0, NULL, 0, NULL, NULL);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (90, 6, 2, 5, 0, 0, 5, 'M01', 3, NULL, 0, NULL, 0, NULL, 9);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (91, 6, 3, 5, 0, 0, 5, '104', 3, NULL, 1, '204', 3, NULL, 1);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (92, 6, 2, 6, 0, 0, 4, NULL, 2, 'M02', 1, '0', 1, 'M12', 9);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (93, 6, 3, 6, 0, 0, 4, NULL, 2, NULL, 0, NULL, 0, NULL, NULL);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (94, 6, 2, 7, 0, 0, 5, 'M01', 3, NULL, 0, NULL, 0, NULL, 9);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (95, 6, 3, 7, 0, 0, 5, '104', 3, NULL, 1, '204', 3, NULL, 1);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (96, 7, 2, 2, 0, 0, 2, 'B02', 4, NULL, 1, 'B12', 1, '0', 8);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (97, 7, 3, 2, 0, 0, 2, NULL, 4, NULL, 0, NULL, 0, NULL, NULL);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (98, 7, 4, 2, 0, 0, 2, NULL, 4, '133', 1, '331', 1, '233', NULL);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (99, 7, 5, 2, 0, 0, 2, NULL, 4, NULL, 0, NULL, 0, NULL, NULL);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (46, 4, 2, 2, 0, 0, 2, 'D02', 4, NULL, 1, 'D12', 1, '0', 10);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (47, 4, 3, 2, 0, 0, 2, NULL, 4, NULL, 0, NULL, 0, NULL, NULL);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (48, 4, 4, 2, 0, 0, 2, NULL, 4, '133', 1, '331', 1, '233', NULL);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (49, 4, 5, 2, 0, 0, 2, NULL, 4, NULL, 0, NULL, 0, NULL, NULL);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (50, 4, 6, 2, 0, 0, 2, NULL, 4, NULL, 0, NULL, 0, NULL, NULL);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (51, 4, 2, 3, 0, 0, 3, NULL, 5, 'D01', 0, NULL, 0, NULL, 10);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (52, 4, 3, 3, 0, 0, 3, NULL, 5, '104', 3, NULL, 1, '204', 1);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (53, 4, 4, 3, 0, 0, 3, NULL, 5, '112', 0, NULL, 0, NULL, 5);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (54, 4, 5, 3, 0, 0, 3, NULL, 5, '104', 3, NULL, 1, '204', 1);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (55, 4, 6, 3, 0, 0, 3, NULL, 5, '118', 0, NULL, 0, NULL, 4);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (100, 7, 6, 2, 0, 0, 2, NULL, 4, NULL, 0, NULL, 0, NULL, NULL);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (101, 7, 2, 3, 0, 0, 3, NULL, 5, 'B01', 0, NULL, 0, NULL, 8);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (102, 7, 3, 3, 0, 0, 3, NULL, 5, '104', 3, NULL, 1, '204', 1);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (103, 7, 4, 3, 0, 0, 3, NULL, 5, '112', 0, NULL, 0, NULL, NULL);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (56, 4, 2, 4, 0, 0, 4, NULL, 2, 'D02', 1, '0', 1, 'D12', 10);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (57, 4, 3, 4, 0, 0, 4, NULL, 2, NULL, 0, NULL, 0, NULL, NULL);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (58, 4, 2, 5, 0, 0, 5, 'D01', 3, NULL, 0, NULL, 0, NULL, 10);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (59, 4, 3, 5, 0, 0, 5, '104', 3, NULL, 1, '204', 3, NULL, 1);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (60, 4, 2, 6, 0, 0, 4, NULL, 2, 'D02', 1, '0', 1, 'D12', 10);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (61, 4, 3, 6, 0, 0, 4, NULL, 2, NULL, 0, NULL, 0, NULL, NULL);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (62, 4, 2, 7, 0, 0, 5, 'D01', 3, NULL, 0, NULL, 0, NULL, 10);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (63, 4, 3, 7, 0, 0, 5, '104', 3, NULL, 1, '204', 3, NULL, 1);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (104, 7, 5, 3, 0, 0, 3, NULL, 5, '104', 3, NULL, 1, '204', 1);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (64, 5, 2, 2, 0, 0, 2, 'G02', 4, NULL, 1, 'G12', 1, '0', 11);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (65, 5, 3, 2, 0, 0, 2, NULL, 4, NULL, 0, NULL, 0, NULL, NULL);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (66, 5, 4, 2, 0, 0, 2, NULL, 4, '133', 1, '331', 1, '233', NULL);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (67, 5, 5, 2, 0, 0, 2, NULL, 4, NULL, 0, NULL, 0, NULL, NULL);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (68, 5, 6, 2, 0, 0, 2, NULL, 4, NULL, 0, NULL, 0, NULL, NULL);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (105, 7, 6, 3, 0, 0, 3, NULL, 5, '118', 0, NULL, 0, NULL, 1);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (106, 7, 2, 4, 0, 0, 4, NULL, 2, 'B02', 1, '0', 1, 'B12', 8);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (107, 7, 3, 4, 0, 0, 4, NULL, 2, NULL, 0, NULL, 0, NULL, NULL);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (108, 7, 2, 5, 0, 0, 5, 'B01', 3, NULL, 0, NULL, 0, NULL, 8);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (109, 7, 3, 5, 0, 0, 5, '104', 3, NULL, 1, '204', 3, NULL, 1);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (110, 7, 2, 6, 0, 0, 4, NULL, 2, 'B02', 1, '0', 1, 'B12', 8);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (69, 5, 2, 3, 0, 0, 3, NULL, 5, 'G01', 0, NULL, 0, NULL, 11);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (70, 5, 3, 3, 0, 0, 3, NULL, 5, '104', 3, NULL, 1, '204', 1);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (71, 5, 4, 3, 0, 0, 3, NULL, 5, '112', 0, NULL, 0, NULL, 5);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (72, 5, 5, 3, 0, 0, 3, NULL, 5, '104', 3, NULL, 1, '204', 1);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (73, 5, 6, 3, 0, 0, 3, NULL, 5, '118', 0, NULL, 0, NULL, 4);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (111, 7, 3, 6, 0, 0, 4, NULL, 2, NULL, 0, NULL, 0, NULL, NULL);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (112, 7, 2, 7, 0, 0, 5, 'B01', 3, NULL, 0, NULL, 0, NULL, 8);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (113, 7, 3, 7, 0, 0, 5, '104', 3, NULL, 1, '204', 3, NULL, 1);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (114, 8, 2, 2, 0, 0, 2, 'K061', 4, NULL, 1, 'K101', 1, '0', 7);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (115, 8, 3, 2, 0, 0, 2, 'K063', 4, NULL, 0, NULL, 0, NULL, NULL);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (116, 8, 4, 2, 0, 0, 2, NULL, 4, '133', 1, '331', 1, '233', NULL);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (74, 5, 2, 4, 0, 0, 4, NULL, 2, 'G02', 1, '0', 1, 'G12', 11);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (75, 5, 3, 4, 0, 0, 4, NULL, 2, NULL, 0, NULL, 0, NULL, NULL);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (117, 8, 5, 2, 0, 0, 2, NULL, 4, NULL, 0, NULL, 0, NULL, NULL);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (118, 8, 6, 2, 0, 0, 2, NULL, 4, NULL, 0, NULL, 0, NULL, NULL);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (119, 8, 2, 3, 0, 0, 3, NULL, 5, 'K041', 0, NULL, 0, NULL, 7);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (120, 8, 3, 3, 0, 0, 3, NULL, 5, 'K043', 3, NULL, 1, 'K103', 1);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (121, 8, 4, 3, 0, 0, 3, NULL, 5, 'K044', 0, NULL, 0, NULL, 5);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (122, 8, 5, 3, 0, 0, 3, NULL, 5, 'K043', 3, NULL, 1, 'K103', 1);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (123, 8, 6, 3, 0, 0, 3, NULL, 5, 'K046', 0, NULL, 0, NULL, 4);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (124, 8, 2, 4, 0, 0, 4, NULL, 2, 'K061', 1, '0', 1, 'K101', 7);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (125, 8, 3, 4, 0, 0, 4, NULL, 2, 'K063', 0, NULL, 0, NULL, NULL);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (126, 8, 2, 5, 0, 0, 5, 'K041', 3, NULL, 0, NULL, 0, NULL, 7);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (127, 8, 3, 5, 0, 0, 5, 'K043', 3, NULL, 1, 'K103', 3, NULL, 1);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (128, 8, 2, 6, 0, 0, 4, NULL, 2, 'K061', 1, '0', 1, 'K101', 7);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (129, 8, 3, 6, 0, 0, 4, NULL, 2, 'K063', 0, NULL, 0, NULL, NULL);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (130, 8, 2, 7, 0, 0, 5, 'K041', 3, NULL, 0, NULL, 0, NULL, 7);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (131, 8, 3, 7, 0, 0, 5, 'K043', 3, NULL, 1, 'K103', 3, NULL, 1);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (132, 5, 2, 5, 0, 0, 5, 'G01', 3, NULL, 0, NULL, 0, NULL, 11);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (133, 5, 2, 6, 0, 0, 4, NULL, 2, 'G02', 1, '0', 1, 'G12', 11);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (134, 5, 2, 7, 0, 0, 5, 'G01', 3, NULL, 0, NULL, 0, NULL, 11);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (135, 5, 3, 5, 0, 0, 5, '104', 3, NULL, 1, '204', 3, NULL, 1);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (136, 5, 3, 6, 0, 0, 4, NULL, 2, NULL, 0, NULL, 0, NULL, NULL);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (137, 5, 3, 7, 0, 0, 5, '104', 3, NULL, 1, '204', 3, NULL, 1);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (138, 2, 3, 3, 0, 0, 3, NULL, 5, '102', 3, NULL, 1, '202', 2);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (139, 1, 2, 7, 1, 0, 3, NULL, 5, '104', 3, NULL, 1, '204', 1);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (140, 1, 3, 7, 1, 0, 3, NULL, 5, '104', 3, NULL, 1, '204', 1);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (141, 2, 2, 7, 1, 0, 3, NULL, 5, '102', 3, NULL, 1, '202', 2);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (142, 2, 3, 7, 1, 0, 3, NULL, 5, '102', 3, NULL, 1, '202', 2);
INSERT INTO M_PVNRATES2 (ID, IDRATE, IDTP, IDTRTP, INCURMT, CHANGESIGN, BASE_DEB_FIN, BASE_DEB_PVN, BASE_CRED_FIN, BASE_CRED_PVN, PVN_DEB_FIN, PVN_DEB_PVN, PVN_CRED_FIN, PVN_CRED_PVN, IDPVNTEXT) VALUES (143, 1, 2, 6, 1, 1, 2, '401', 4, NULL, 1, '305', 4, NULL, 1);


COMMIT WORK;

INSERT INTO M_PVNTEXTS (ID, CODE, "VERSION", TAG1, TAG2) VALUES (1, 'A21', NULL, 'Ar PVN 21% likmi apliekamie darijumi', 'PVN 21%');
INSERT INTO M_PVNTEXTS (ID, CODE, "VERSION", TAG1, TAG2) VALUES (2, 'A5', NULL, 'Ar PVN 5% likmi apliekamie darijumi', 'PVN 5%');
INSERT INTO M_PVNTEXTS (ID, CODE, "VERSION", TAG1, TAG2) VALUES (3, 'A12', NULL, 'Ar PVN 12% likmi apliekamie darijumi', 'PVN 12%');
INSERT INTO M_PVNTEXTS (ID, CODE, "VERSION", TAG1, TAG2) VALUES (4, 'PrExp0', NULL, 'Ar 0% likmi apliekamie darijumi saska≈ÜƒÅ ar likuma 43. pantu 1. punktu', 'PVN 0%');
INSERT INTO M_PVNTEXTS (ID, CODE, "VERSION", TAG1, TAG2) VALUES (5, 'EK0', NULL, 'Ar 0% likmi apliekamie darijumi saska≈ÜƒÅ ar likuma 43. pantu 4. punktu', 'PVN 0%');
INSERT INTO M_PVNTEXTS (ID, CODE, "VERSION", TAG1, TAG2) VALUES (6, 'PaExp0', NULL, 'Ar 0% likmi apliekamie darijumi saska≈ÜƒÅ ar likuma 46. pantu 1. punktu', 'PVN 0%');
INSERT INTO M_PVNTEXTS (ID, CODE, "VERSION", TAG1, TAG2) VALUES (7, 'Koks', NULL, 'Darijumu summa, kurai piemƒìro likuma 141. pantu', NULL);
INSERT INTO M_PVNTEXTS (ID, CODE, "VERSION", TAG1, TAG2) VALUES (8, 'Buvp.', NULL, 'Darijumu summa, kurai piemƒìro likuma 142. pantu', NULL);
INSERT INTO M_PVNTEXTS (ID, CODE, "VERSION", TAG1, TAG2) VALUES (9, 'Met', NULL, 'Darijumu summa, kurai piemƒìro likuma 143.4. pantu', NULL);
INSERT INTO M_PVNTEXTS (ID, CODE, "VERSION", TAG1, TAG2) VALUES (10, 'Dat', NULL, 'Darijumu summa, kurai piemƒìro likuma 143.1. pantu', NULL);
INSERT INTO M_PVNTEXTS (ID, CODE, "VERSION", TAG1, TAG2) VALUES (11, 'Graudi', NULL, 'Darijumu summa, kurai piemƒìro likuma 143.2. pantu', NULL);


COMMIT WORK;

INSERT INTO OPSD (ID, DETE, NRX, DOCTYP, DOCST, DOCNR, CLID, CLID2, DESCR, SUMM, PVN, OPT, ZNR, ZU, ZDT, DT2, NL, IDDOCM) VALUES (1, '2014-01-10', NULL, NULL, NULL, NULL, 'es pats', NULL, 'ieguldijums pamatkapitƒÅlƒÅ', 20000, 0, 0, 1, 'Admin', '2016-09-30 11:50:32', NULL, 0, NULL);
INSERT INTO OPSD (ID, DETE, NRX, DOCTYP, DOCST, DOCNR, CLID, CLID2, DESCR, SUMM, PVN, OPT, ZNR, ZU, ZDT, DT2, NL, IDDOCM) VALUES (17, '2014-01-29', NULL, 'PPRdi', 'XXX', '000003', 'pirc1', NULL, 'realizƒÅcija', 2000, 347.11, 0, 16, 'Admin', '2019-09-22 18:13:57', NULL, 0, NULL);
INSERT INTO OPSD (ID, DETE, NRX, DOCTYP, DOCST, DOCNR, CLID, CLID2, DESCR, SUMM, PVN, OPT, ZNR, ZU, ZDT, DT2, NL, IDDOCM) VALUES (2, '2014-01-10', NULL, NULL, NULL, NULL, NULL, 'es pats', 'iz≈Üemta nauda no bankas konta', 500, 0, 0, 2, 'Admin', '2014-11-22 20:09:21', NULL, 0, NULL);
INSERT INTO OPSD (ID, DETE, NRX, DOCTYP, DOCST, DOCNR, CLID, CLID2, DESCR, SUMM, PVN, OPT, ZNR, ZU, ZDT, DT2, NL, IDDOCM) VALUES (26, '2014-01-31', NULL, 'PPRkm', 'AA', '000119', 'pieg1', NULL, 'izejmater.', 200, 34.71, 0, 25, 'Admin', '2019-11-27 14:10:11', NULL, 0, NULL);
INSERT INTO OPSD (ID, DETE, NRX, DOCTYP, DOCST, DOCNR, CLID, CLID2, DESCR, SUMM, PVN, OPT, ZNR, ZU, ZDT, DT2, NL, IDDOCM) VALUES (3, '2014-01-10', NULL, NULL, NULL, NULL, NULL, 'es pats', 'avansa norƒìƒ∑iniem', 200, 0, 0, 3, 'Admin', '2016-09-30 12:01:42', NULL, 0, NULL);
INSERT INTO OPSD (ID, DETE, NRX, DOCTYP, DOCST, DOCNR, CLID, CLID2, DESCR, SUMM, PVN, OPT, ZNR, ZU, ZDT, DT2, NL, IDDOCM) VALUES (25, '2014-02-01', NULL, 'PPRdm', 'XXX', '000001', 'pirc1', NULL, 'realizƒÅcija', 200, 34.71, 0, 24, 'Admin', '2020-08-21 10:15:56', NULL, 0, NULL);
INSERT INTO OPSD (ID, DETE, NRX, DOCTYP, DOCST, DOCNR, CLID, CLID2, DESCR, SUMM, PVN, OPT, ZNR, ZU, ZDT, DT2, NL, IDDOCM) VALUES (4, '2014-01-10', NULL, 'EKA ƒç', NULL, '12311', 'benz', 'es pats', 'benzƒ´ns', 20, 3.47, 0, 4, 'Admin', '2014-11-22 20:19:39', NULL, 0, NULL);
INSERT INTO OPSD (ID, DETE, NRX, DOCTYP, DOCST, DOCNR, CLID, CLID2, DESCR, SUMM, PVN, OPT, ZNR, ZU, ZDT, DT2, NL, IDDOCM) VALUES (28, '2014-02-02', NULL, 'PPRks', 'SS', '123000', 'pieg2', NULL, 'izejmater.', 121, 21, 0, 27, 'Admin', '2019-09-25 09:15:43', NULL, 0, NULL);
INSERT INTO OPSD (ID, DETE, NRX, DOCTYP, DOCST, DOCNR, CLID, CLID2, DESCR, SUMM, PVN, OPT, ZNR, ZU, ZDT, DT2, NL, IDDOCM) VALUES (5, '2014-01-11', NULL, 'EKA ƒç', NULL, '12312', 'benz', 'es pats', 'benzƒ´ns', 25, 4.34, 0, 5, 'Admin', '2016-09-30 12:01:54', NULL, 0, NULL);
INSERT INTO OPSD (ID, DETE, NRX, DOCTYP, DOCST, DOCNR, CLID, CLID2, DESCR, SUMM, PVN, OPT, ZNR, ZU, ZDT, DT2, NL, IDDOCM) VALUES (29, '2014-02-02', NULL, 'PPRks', 'SS', '123002', 'pieg2', NULL, 'izejmater.', 60.5, 10.5, 0, 28, 'Admin', '2019-09-25 10:02:27', NULL, 0, NULL);
INSERT INTO OPSD (ID, DETE, NRX, DOCTYP, DOCST, DOCNR, CLID, CLID2, DESCR, SUMM, PVN, OPT, ZNR, ZU, ZDT, DT2, NL, IDDOCM) VALUES (6, '2014-01-11', NULL, 'PPRks', 'AA', '000111', 'pieg1', NULL, 'izejmater.', 500, 86.78, 0, 6, 'Admin', '2022-07-06 10:03:14', NULL, 0, NULL);
INSERT INTO OPSD (ID, DETE, NRX, DOCTYP, DOCST, DOCNR, CLID, CLID2, DESCR, SUMM, PVN, OPT, ZNR, ZU, ZDT, DT2, NL, IDDOCM) VALUES (30, '2014-02-02', NULL, 'PPRks', 'SS', '123001', 'pieg2', NULL, 'izejmater.', 171, 30, 0, 29, 'Admin', '2019-09-25 09:19:55', NULL, 0, NULL);
INSERT INTO OPSD (ID, DETE, NRX, DOCTYP, DOCST, DOCNR, CLID, CLID2, DESCR, SUMM, PVN, OPT, ZNR, ZU, ZDT, DT2, NL, IDDOCM) VALUES (7, '2014-01-12', NULL, 'PPRks', 'SS', '123000', 'pieg2', NULL, 'izejmater.', 491, 85.21, 0, 7, 'Admin', '2016-02-19 21:59:27', NULL, 0, NULL);
INSERT INTO OPSD (ID, DETE, NRX, DOCTYP, DOCST, DOCNR, CLID, CLID2, DESCR, SUMM, PVN, OPT, ZNR, ZU, ZDT, DT2, NL, IDDOCM) VALUES (9, '2014-01-25', NULL, 'PPRdi', 'XXX', '000001', 'pirc1', NULL, 'realizƒÅcija.', 150, 26.03, 0, 9, 'admin', '2016-11-01 17:15:38', NULL, 0, NULL);
INSERT INTO OPSD (ID, DETE, NRX, DOCTYP, DOCST, DOCNR, CLID, CLID2, DESCR, SUMM, PVN, OPT, ZNR, ZU, ZDT, DT2, NL, IDDOCM) VALUES (8, '2014-01-21', NULL, 'PPRkm', 'AA', '000111', 'pieg1', NULL, 'izejmater.', 200, 34.71, 0, 8, 'admin', '2016-11-01 17:13:26', NULL, 0, NULL);
INSERT INTO OPSD (ID, DETE, NRX, DOCTYP, DOCST, DOCNR, CLID, CLID2, DESCR, SUMM, PVN, OPT, ZNR, ZU, ZDT, DT2, NL, IDDOCM) VALUES (31, '2014-02-03', NULL, 'PPRdi', 'XXX', '000011', 'pirc1', NULL, 'realizƒÅcija', 200, 0, 0, 30, 'Admin', '2020-08-21 10:21:09', NULL, 0, NULL);
INSERT INTO OPSD (ID, DETE, NRX, DOCTYP, DOCST, DOCNR, CLID, CLID2, DESCR, SUMM, PVN, OPT, ZNR, ZU, ZDT, DT2, NL, IDDOCM) VALUES (33, '2014-02-04', NULL, 'EKA ƒç', NULL, '00001', 'pieg1', NULL, 'pirkums', 100, 0, 0, 32, 'Admin', '2021-03-13 12:08:44', NULL, 0, NULL);
INSERT INTO OPSD (ID, DETE, NRX, DOCTYP, DOCST, DOCNR, CLID, CLID2, DESCR, SUMM, PVN, OPT, ZNR, ZU, ZDT, DT2, NL, IDDOCM) VALUES (32, '2014-02-03', NULL, 'PPRks', 'FF', '110011', 'pieg1', NULL, 'pirkti graudi', 200, 42, 0, 31, 'Admin', '2020-08-21 10:35:26', NULL, 0, NULL);
INSERT INTO OPSD (ID, DETE, NRX, DOCTYP, DOCST, DOCNR, CLID, CLID2, DESCR, SUMM, PVN, OPT, ZNR, ZU, ZDT, DT2, NL, IDDOCM) VALUES (11, '2014-01-30', NULL, 'PPRdm', 'XXX', '000001', 'pirc1', NULL, 'realizƒÅcija.', 200, 34.71, 0, 11, 'Admin', '2017-06-21 13:03:14', NULL, 0, NULL);
INSERT INTO OPSD (ID, DETE, NRX, DOCTYP, DOCST, DOCNR, CLID, CLID2, DESCR, SUMM, PVN, OPT, ZNR, ZU, ZDT, DT2, NL, IDDOCM) VALUES (34, '2022-01-01', NULL, 'PPRks', 'FF', '110011', 'pieg1', NULL, 'pirkti graudi', 300, 63, 0, 1, 'Admin', '2022-06-29 11:54:15', NULL, 0, NULL);
INSERT INTO OPSD (ID, DETE, NRX, DOCTYP, DOCST, DOCNR, CLID, CLID2, DESCR, SUMM, PVN, OPT, ZNR, ZU, ZDT, DT2, NL, IDDOCM) VALUES (41, '2023-01-01', NULL, 'PPRks', NULL, '1', 'pieg1', NULL, 'preƒçu piegƒÅde', 350.9, 60.9, 0, 1, 'Admin', '2023-01-21 12:01:24', NULL, 0, NULL);
INSERT INTO OPSD (ID, DETE, NRX, DOCTYP, DOCST, DOCNR, CLID, CLID2, DESCR, SUMM, PVN, OPT, ZNR, ZU, ZDT, DT2, NL, IDDOCM) VALUES (42, '2023-01-02', NULL, 'PPRdi', NULL, NULL, 'pirc1', NULL, 'preƒçu piegƒÅde', 90.75, 15.75, 0, 2, 'Admin', '2023-01-21 12:02:11', NULL, 0, NULL);


COMMIT WORK;

INSERT INTO OPS (ID, DOCID, DESCR, AC11, AC12, AC13, AC14, AC15, AC21, AC22, AC23, AC24, AC25, SUMMC, CUR, SUMM, QV, NL, ZDT) VALUES (1, 1, 'd', '2620', '2620', 'BA', NULL, NULL, '3110', '3110', 'CIE', NULL, NULL, 20000, 'EUR', 20000, 0, 0, '2016-09-30 11:49:55');
INSERT INTO OPS (ID, DOCID, DESCR, AC11, AC12, AC13, AC14, AC15, AC21, AC22, AC23, AC24, AC25, SUMMC, CUR, SUMM, QV, NL, ZDT) VALUES (2, 2, NULL, '2610', '2610', 'KA', NULL, NULL, '2620', '2620', 'BA', NULL, NULL, 500, 'EUR', 500, 0, 0, '2014-11-22 20:09:21');
INSERT INTO OPS (ID, DOCID, DESCR, AC11, AC12, AC13, AC14, AC15, AC21, AC22, AC23, AC24, AC25, SUMMC, CUR, SUMM, QV, NL, ZDT) VALUES (3, 3, NULL, '2380', '2380', 'CN', NULL, NULL, '2620', '2620', 'BA', NULL, NULL, 200, 'EUR', 200, 0, 0, '2014-11-22 20:10:22');
INSERT INTO OPS (ID, DOCID, DESCR, AC11, AC12, AC13, AC14, AC15, AC21, AC22, AC23, AC24, AC25, SUMMC, CUR, SUMM, QV, NL, ZDT) VALUES (4, 4, NULL, '71151', '71151', 'NIZ', NULL, NULL, '2380', '2380', 'CN', NULL, NULL, 16.53, 'EUR', 16.53, 0, 0, '2014-11-22 20:11:11');
INSERT INTO OPS (ID, DOCID, DESCR, AC11, AC12, AC13, AC14, AC15, AC21, AC22, AC23, AC24, AC25, SUMMC, CUR, SUMM, QV, NL, ZDT) VALUES (5, 4, NULL, '5731', '5731', 'CIZ', NULL, '305', '2380', '2380', 'CN', NULL, NULL, 3.47, 'EUR', 3.47, 0, 0, '2014-11-22 20:11:11');
INSERT INTO OPS (ID, DOCID, DESCR, AC11, AC12, AC13, AC14, AC15, AC21, AC22, AC23, AC24, AC25, SUMMC, CUR, SUMM, QV, NL, ZDT) VALUES (46, 17, NULL, '2310', NULL, NULL, NULL, NULL, '6113', NULL, NULL, NULL, '104', 1652.89, 'EUR', 1652.89, 0, 0, '2016-11-01 17:16:41');
INSERT INTO OPS (ID, DOCID, DESCR, AC11, AC12, AC13, AC14, AC15, AC21, AC22, AC23, AC24, AC25, SUMMC, CUR, SUMM, QV, NL, ZDT) VALUES (67, 26, NULL, '5310', '7110', 'NIZ1', NULL, NULL, '2620', '2620', 'BA', NULL, NULL, 165.29, 'EUR', 165.29, 0, 0, '2019-11-27 14:10:11');
INSERT INTO OPS (ID, DOCID, DESCR, AC11, AC12, AC13, AC14, AC15, AC21, AC22, AC23, AC24, AC25, SUMMC, CUR, SUMM, QV, NL, ZDT) VALUES (6, 5, NULL, '71151', '71151', 'NIZ', NULL, NULL, '2380', '2380', 'CN', NULL, NULL, 20.66, 'EUR', 20.66, 0, 0, '2016-09-30 12:01:53');
INSERT INTO OPS (ID, DOCID, DESCR, AC11, AC12, AC13, AC14, AC15, AC21, AC22, AC23, AC24, AC25, SUMMC, CUR, SUMM, QV, NL, ZDT) VALUES (7, 5, NULL, '5731', '5731', 'CIZ', NULL, '305', '2380', '2380', 'CN', NULL, NULL, 4.34, 'EUR', 4.34, 0, 0, '2014-11-22 20:11:29');
INSERT INTO OPS (ID, DOCID, DESCR, AC11, AC12, AC13, AC14, AC15, AC21, AC22, AC23, AC24, AC25, SUMMC, CUR, SUMM, QV, NL, ZDT) VALUES (68, 26, NULL, '5310', '5731', 'CIZ', NULL, '505', '2620', '2620', 'BA', NULL, NULL, 34.71, 'EUR', 34.71, 0, 0, '2019-11-27 14:10:11');
INSERT INTO OPS (ID, DOCID, DESCR, AC11, AC12, AC13, AC14, AC15, AC21, AC22, AC23, AC24, AC25, SUMMC, CUR, SUMM, QV, NL, ZDT) VALUES (47, 17, NULL, '2310', NULL, NULL, NULL, NULL, '5731', NULL, NULL, NULL, '204', 347.11, 'EUR', 347.11, 0, 0, '2016-11-01 17:22:45');
INSERT INTO OPS (ID, DOCID, DESCR, AC11, AC12, AC13, AC14, AC15, AC21, AC22, AC23, AC24, AC25, SUMMC, CUR, SUMM, QV, NL, ZDT) VALUES (8, 6, NULL, '7110', NULL, NULL, NULL, NULL, '5310', NULL, NULL, NULL, NULL, 413.22, 'EUR', 413.22, 0, 0, '2022-07-06 10:03:14');
INSERT INTO OPS (ID, DOCID, DESCR, AC11, AC12, AC13, AC14, AC15, AC21, AC22, AC23, AC24, AC25, SUMMC, CUR, SUMM, QV, NL, ZDT) VALUES (9, 6, NULL, '5731', NULL, NULL, NULL, '305', '5310', NULL, NULL, NULL, NULL, 86.78, 'EUR', 86.78, 0, 0, '2014-11-22 20:12:09');
INSERT INTO OPS (ID, DOCID, DESCR, AC11, AC12, AC13, AC14, AC15, AC21, AC22, AC23, AC24, AC25, SUMMC, CUR, SUMM, QV, NL, ZDT) VALUES (72, 28, NULL, '7110', NULL, NULL, NULL, NULL, '5310', NULL, NULL, NULL, NULL, 100, 'EUR', 100, 0, 0, '2019-09-25 09:15:43');
INSERT INTO OPS (ID, DOCID, DESCR, AC11, AC12, AC13, AC14, AC15, AC21, AC22, AC23, AC24, AC25, SUMMC, CUR, SUMM, QV, NL, ZDT) VALUES (73, 28, NULL, '5731', NULL, NULL, NULL, '305', '5310', NULL, NULL, NULL, NULL, 21, 'EUR', 21, 0, 0, '2019-09-25 09:15:43');
INSERT INTO OPS (ID, DOCID, DESCR, AC11, AC12, AC13, AC14, AC15, AC21, AC22, AC23, AC24, AC25, SUMMC, CUR, SUMM, QV, NL, ZDT) VALUES (10, 7, NULL, '7110', NULL, NULL, NULL, NULL, '5310', NULL, NULL, NULL, NULL, 405.79, 'EUR', 405.79, 0, 0, '2014-11-22 20:12:56');
INSERT INTO OPS (ID, DOCID, DESCR, AC11, AC12, AC13, AC14, AC15, AC21, AC22, AC23, AC24, AC25, SUMMC, CUR, SUMM, QV, NL, ZDT) VALUES (11, 7, NULL, '5731', NULL, NULL, NULL, '305', '5310', NULL, NULL, NULL, NULL, 85.21, 'EUR', 85.21, 0, 0, '2014-11-22 20:12:56');
INSERT INTO OPS (ID, DOCID, DESCR, AC11, AC12, AC13, AC14, AC15, AC21, AC22, AC23, AC24, AC25, SUMMC, CUR, SUMM, QV, NL, ZDT) VALUES (65, 25, NULL, '2620', '2620', 'BA', NULL, NULL, '2310', '6112', 'NIE', NULL, NULL, 165.29, 'EUR', 165.29, 0, 0, '2019-11-27 14:15:48');
INSERT INTO OPS (ID, DOCID, DESCR, AC11, AC12, AC13, AC14, AC15, AC21, AC22, AC23, AC24, AC25, SUMMC, CUR, SUMM, QV, NL, ZDT) VALUES (66, 25, NULL, '2620', '2620', 'BA', NULL, NULL, '2310', '5731', 'CIE', NULL, '505', 34.71, 'EUR', 34.71, 0, 0, '2019-11-27 14:15:48');
INSERT INTO OPS (ID, DOCID, DESCR, AC11, AC12, AC13, AC14, AC15, AC21, AC22, AC23, AC24, AC25, SUMMC, CUR, SUMM, QV, NL, ZDT) VALUES (12, 8, NULL, '5310', '7110', 'NIZ', NULL, NULL, '2620', '2620', 'BA', NULL, NULL, 165.29, 'EUR', 165.29, 0, 0, '2016-11-01 17:13:23');
INSERT INTO OPS (ID, DOCID, DESCR, AC11, AC12, AC13, AC14, AC15, AC21, AC22, AC23, AC24, AC25, SUMMC, CUR, SUMM, QV, NL, ZDT) VALUES (13, 8, NULL, '5310', '5731', 'CIZ', NULL, '505', '2620', '2620', 'BA', NULL, NULL, 34.71, 'EUR', 34.71, 0, 0, '2016-11-01 17:13:23');
INSERT INTO OPS (ID, DOCID, DESCR, AC11, AC12, AC13, AC14, AC15, AC21, AC22, AC23, AC24, AC25, SUMMC, CUR, SUMM, QV, NL, ZDT) VALUES (14, 9, NULL, '2310', NULL, NULL, NULL, NULL, '6112', NULL, NULL, NULL, '104', 123.97, 'EUR', 123.97, 0, 0, '2016-11-01 17:15:37');
INSERT INTO OPS (ID, DOCID, DESCR, AC11, AC12, AC13, AC14, AC15, AC21, AC22, AC23, AC24, AC25, SUMMC, CUR, SUMM, QV, NL, ZDT) VALUES (15, 9, NULL, '2310', NULL, NULL, NULL, NULL, '5731', NULL, NULL, NULL, '204', 26.03, 'EUR', 26.03, 0, 0, '2016-11-01 17:15:37');
INSERT INTO OPS (ID, DOCID, DESCR, AC11, AC12, AC13, AC14, AC15, AC21, AC22, AC23, AC24, AC25, SUMMC, CUR, SUMM, QV, NL, ZDT) VALUES (74, 29, NULL, '7110', NULL, NULL, NULL, NULL, '5310', NULL, NULL, NULL, NULL, 50, 'EUR', 50, 0, 0, '2019-09-25 10:01:18');
INSERT INTO OPS (ID, DOCID, DESCR, AC11, AC12, AC13, AC14, AC15, AC21, AC22, AC23, AC24, AC25, SUMMC, CUR, SUMM, QV, NL, ZDT) VALUES (75, 29, NULL, '5731', NULL, NULL, NULL, '305', '5310', NULL, NULL, NULL, NULL, 10.5, 'EUR', 10.5, 0, 0, '2019-09-25 10:01:18');
INSERT INTO OPS (ID, DOCID, DESCR, AC11, AC12, AC13, AC14, AC15, AC21, AC22, AC23, AC24, AC25, SUMMC, CUR, SUMM, QV, NL, ZDT) VALUES (76, 30, NULL, '7110', NULL, NULL, NULL, NULL, '5310', NULL, NULL, NULL, NULL, 100, 'EUR', 100, 0, 0, '2019-09-25 09:18:04');
INSERT INTO OPS (ID, DOCID, DESCR, AC11, AC12, AC13, AC14, AC15, AC21, AC22, AC23, AC24, AC25, SUMMC, CUR, SUMM, QV, NL, ZDT) VALUES (77, 30, NULL, '5731', NULL, NULL, NULL, '305', '5310', NULL, NULL, NULL, NULL, 21, 'EUR', 21, 0, 0, '2019-09-25 09:18:04');
INSERT INTO OPS (ID, DOCID, DESCR, AC11, AC12, AC13, AC14, AC15, AC21, AC22, AC23, AC24, AC25, SUMMC, CUR, SUMM, QV, NL, ZDT) VALUES (78, 30, NULL, '7110', NULL, NULL, NULL, 'D02', '5310', NULL, NULL, NULL, NULL, 50, 'EUR', 50, 0, 0, '2019-09-25 09:19:55');
INSERT INTO OPS (ID, DOCID, DESCR, AC11, AC12, AC13, AC14, AC15, AC21, AC22, AC23, AC24, AC25, SUMMC, CUR, SUMM, QV, NL, ZDT) VALUES (79, 30, NULL, '5731', NULL, NULL, NULL, 'D12', '5731', NULL, NULL, NULL, '0', 9, 'EUR', 9, 0, 0, '2019-09-25 09:19:55');
INSERT INTO OPS (ID, DOCID, DESCR, AC11, AC12, AC13, AC14, AC15, AC21, AC22, AC23, AC24, AC25, SUMMC, CUR, SUMM, QV, NL, ZDT) VALUES (18, 11, NULL, '2620', '2620', 'BA', NULL, NULL, '2310', '6112', 'NIE', NULL, NULL, 165.29, 'EUR', 165.29, 0, 0, '2017-06-21 13:03:13');
INSERT INTO OPS (ID, DOCID, DESCR, AC11, AC12, AC13, AC14, AC15, AC21, AC22, AC23, AC24, AC25, SUMMC, CUR, SUMM, QV, NL, ZDT) VALUES (19, 11, NULL, '2620', '2620', 'BA', NULL, NULL, '2310', '5731', 'CIE', NULL, '505', 34.71, 'EUR', 34.71, 0, 0, '2017-06-21 13:03:13');
INSERT INTO OPS (ID, DOCID, DESCR, AC11, AC12, AC13, AC14, AC15, AC21, AC22, AC23, AC24, AC25, SUMMC, CUR, SUMM, QV, NL, ZDT) VALUES (80, 31, NULL, '2310', NULL, NULL, NULL, NULL, '6111', NULL, NULL, NULL, 'G01', 200, 'EUR', 200, 0, 0, '2020-08-21 10:17:49');
INSERT INTO OPS (ID, DOCID, DESCR, AC11, AC12, AC13, AC14, AC15, AC21, AC22, AC23, AC24, AC25, SUMMC, CUR, SUMM, QV, NL, ZDT) VALUES (82, 32, NULL, '7110', NULL, NULL, NULL, 'G02', '5310', NULL, NULL, NULL, NULL, 200, 'EUR', 200, 0, 0, '2020-08-21 10:35:26');
INSERT INTO OPS (ID, DOCID, DESCR, AC11, AC12, AC13, AC14, AC15, AC21, AC22, AC23, AC24, AC25, SUMMC, CUR, SUMM, QV, NL, ZDT) VALUES (84, 33, NULL, '71152', '71152', 'NIZ', NULL, NULL, '2380', '2380', 'CN', NULL, NULL, 50, 'EUR', 50, 0, 0, '2021-03-13 12:08:43');
INSERT INTO OPS (ID, DOCID, DESCR, AC11, AC12, AC13, AC14, AC15, AC21, AC22, AC23, AC24, AC25, SUMMC, CUR, SUMM, QV, NL, ZDT) VALUES (83, 32, NULL, '5731', NULL, NULL, NULL, 'G12', '5731', NULL, NULL, NULL, '0', 42, 'EUR', 42, 0, 0, '2020-08-21 10:24:51');
INSERT INTO OPS (ID, DOCID, DESCR, AC11, AC12, AC13, AC14, AC15, AC21, AC22, AC23, AC24, AC25, SUMMC, CUR, SUMM, QV, NL, ZDT) VALUES (85, 33, NULL, '71152', '71152', 'ZIZ', NULL, NULL, '2380', '2380', 'CN', NULL, NULL, 50, 'EUR', 50, 0, 0, '2021-03-13 12:08:43');
INSERT INTO OPS (ID, DOCID, DESCR, AC11, AC12, AC13, AC14, AC15, AC21, AC22, AC23, AC24, AC25, SUMMC, CUR, SUMM, QV, NL, ZDT) VALUES (86, 34, NULL, '7110', NULL, NULL, NULL, 'G02', '5310', NULL, NULL, NULL, NULL, 300, 'EUR', 300, 0, 0, '2022-06-29 11:54:15');
INSERT INTO OPS (ID, DOCID, DESCR, AC11, AC12, AC13, AC14, AC15, AC21, AC22, AC23, AC24, AC25, SUMMC, CUR, SUMM, QV, NL, ZDT) VALUES (87, 34, NULL, '5731', NULL, NULL, NULL, 'G12', '5731', NULL, NULL, NULL, '0', 63, 'EUR', 63, 0, 0, '2022-06-29 11:54:15');
INSERT INTO OPS (ID, DOCID, DESCR, AC11, AC12, AC13, AC14, AC15, AC21, AC22, AC23, AC24, AC25, SUMMC, CUR, SUMM, QV, NL, ZDT) VALUES (96, 41, NULL, '2131', NULL, NULL, NULL, '401', '5310', NULL, NULL, NULL, NULL, 290, 'EUR', 290, 0, 0, '2023-01-21 12:01:24');
INSERT INTO OPS (ID, DOCID, DESCR, AC11, AC12, AC13, AC14, AC15, AC21, AC22, AC23, AC24, AC25, SUMMC, CUR, SUMM, QV, NL, ZDT) VALUES (97, 41, NULL, '5731', NULL, NULL, NULL, '305', '5310', NULL, NULL, NULL, NULL, 60.9, 'EUR', 60.9, 0, 0, '2023-01-21 12:01:24');
INSERT INTO OPS (ID, DOCID, DESCR, AC11, AC12, AC13, AC14, AC15, AC21, AC22, AC23, AC24, AC25, SUMMC, CUR, SUMM, QV, NL, ZDT) VALUES (98, 42, NULL, '2310', NULL, NULL, NULL, NULL, '6111', NULL, NULL, NULL, '104', 75, 'EUR', 75, 0, 0, '2023-01-21 12:02:11');
INSERT INTO OPS (ID, DOCID, DESCR, AC11, AC12, AC13, AC14, AC15, AC21, AC22, AC23, AC24, AC25, SUMMC, CUR, SUMM, QV, NL, ZDT) VALUES (99, 42, NULL, '2310', NULL, NULL, NULL, NULL, '5731', NULL, NULL, NULL, '204', 15.75, 'EUR', 15.75, 0, 0, '2023-01-21 12:02:11');


COMMIT WORK;

INSERT INTO TUSERS (NM, PSW, TP, NR) VALUES ('Admin', NULL, 'A   ', 0);
INSERT INTO TUSERS (NM, PSW, TP, NR) VALUES ('SYSTEM', NULL, 'A   ', 0);
INSERT INTO TUSERS (NM, PSW, TP, NR) VALUES ('aivars', NULL, NULL, 0);


COMMIT WORK;

INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (90, 'CompName', 'SIA Pia', 'SYSTEM');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (91, 'CompRegNr', '40000000000', 'SYSTEM');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (92, 'CompMName', 'Es Pats', 'SYSTEM');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (93, 'CompPhone', '26123456', 'SYSTEM');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (94, 'CompAddr', 'Graustu 1, S≈´nu ciems, LatvƒÅ≈Üu nov.', 'SYSTEM');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (95, 'CompAddrInd', 'LV1000', 'SYSTEM');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (97, 'CompRegNrPVN', 'LV40000000000', 'SYSTEM');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (98, 'CompMpk', '010101-10000', 'SYSTEM');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (124, 'CompYear', '', 'SYSTEM');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (137, 'USRNM', 'Admin', 'SYSTEM');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (150, 'LOGCHDT', '', 'SYSTEM');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (162, 'MSGONDEL', 'true', 'Admin');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (163, 'MSGONCOPY', '0', 'Admin');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (164, '44CHCOL', '0010', 'Admin');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (165, 'LOGIT', '1', 'Admin');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (166, 'LOGITA', '1', 'Admin');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (167, 'LOGTM', '300', 'Admin');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (174, 'RSD', '01.01.2023', 'Admin');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (175, 'RED', '31.01.2023', 'Admin');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (176, 'RpvnD', NULL, 'Admin');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (177, 'BALID', 'B1', 'Admin');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (194, 'AVRAC', '2380', 'Admin');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (195, 'AVNorSD', '', 'Admin');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (196, 'AVNorED', '', 'Admin');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (197, 'NorPers', 'es pats', 'Admin');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (198, 'NorPersPK', NULL, 'Admin');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (199, 'AVNorNR', '1', 'Admin');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (200, 'version', '001', 'SYSTEM');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (201, 'CompVID', '', 'Admin');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (202, 'ACCPH', NULL, 'Admin');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (9728, 'RAC', '2610', 'Admin');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (9729, 'RPER', '', 'Admin');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (9730, 'RACX', '*', 'Admin');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (9731, 'RACNM', '', 'Admin');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (9732, 'DLTYP', NULL, 'Admin');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (9733, 'RAP1', '*', 'Admin');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (9734, 'RAP2', '*', 'Admin');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (9735, 'RAP3', '*', 'Admin');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (9736, 'RAP4', '*', 'Admin');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (9737, 'RAP5', '*', 'Admin');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (9738, 'RAP6', '*', 'Admin');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (9739, 'CSD', '', 'Admin');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (9740, 'CED', '', 'Admin');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (9837, 'RpvAmats', 'gramatvedis', 'Admin');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (9838, 'RpvVards', 'Es', 'Admin');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (9839, 'RpvUzvards', 'Pats', 'Admin');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (10228, 'UPRNP', 'true', 'Admin');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (10229, 'UPRIIN', 'true', 'Admin');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (10230, 'UPRIINIEN', 'true', 'Admin');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (10231, 'UPRIINIZD', 'true', 'Admin');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (10232, 'UPRIINIENV', 'NIE', 'Admin');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (10233, 'UPRIINIZDV', 'NIZ', 'Admin');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (10234, 'UPRPVN', 'true', 'Admin');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (10235, 'UPRPVNIEN', 'true', 'Admin');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (10236, 'UPRPVNIZD', 'false', 'Admin');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (10237, 'UPRPVNIENV', '104', 'Admin');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (10238, 'UPRPVNIZDV', '', 'Admin');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (10239, 'UPRPVNDEB', 'true', 'Admin');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (10240, 'UPRPVNKRED', 'false', 'Admin');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (10241, 'UPRPVN5', 'true', 'Admin');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (10242, 'UPRPVNDEBV', '305', 'Admin');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (10243, 'UPRPVNKREDV', '204', 'Admin');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (10244, 'UPRPVNREQPVN', 'true', 'Admin');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (10245, 'UPRPVNREQIEN', 'true', 'Admin');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (10246, 'UPRPVN5V', '505', 'Admin');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (10247, 'OSD', '', 'Admin');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (10248, 'OED', '', 'Admin');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (10249, 'OCL', '', 'Admin');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (10250, 'OAC11', '', 'Admin');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (10251, 'OAC12', '', 'Admin');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (10252, 'OAC13', '', 'Admin');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (10253, 'OAC14', '', 'Admin');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (10254, 'OAC15', '', 'Admin');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (10255, 'OAC21', '', 'Admin');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (10256, 'OAC22', '', 'Admin');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (10257, 'OAC23', '', 'Admin');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (10258, 'OAC24', '', 'Admin');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (10259, 'OAC25', '', 'Admin');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (10260, 'OOR', 'true', 'Admin');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (10261, 'CompAddr1', 'Graustu 1', 'SYSTEM');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (10262, 'CompAddr2', 'S≈´nu ciems', 'SYSTEM');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (10263, 'CompAddr3', 'LatvƒÅ≈Üu nov.', 'SYSTEM');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (10264, 'CompAddr4', 'LV1000', 'SYSTEM');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (10265, 'CompAccName', 'Es Pats', 'SYSTEM');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (10266, 'CompAccPh', '26123456', 'SYSTEM');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (10267, 'BankId', '', 'SYSTEM');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (10268, 'BankName', '', 'SYSTEM');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (10269, 'BankAcc', '', 'SYSTEM');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (10270, 'CompVID', '', 'SYSTEM');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (10271, 'CHCOL', '1101', 'Admin');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (10272, 'RpvnRG1', '100', 'Admin');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (10273, 'LinkDocsYR', '3', 'Admin');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (10274, 'RekinaIzr', '', 'Admin');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (10329, 'CompAddrG', 'Graustu 1, S≈´nu ciems, LatvƒÅ≈Üu nov.', 'Admin');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (10330, 'CHCOLCURR', 'true', 'Admin');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (10331, 'ODOCGR', '', 'Admin');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (10332, 'PZPARV', '', 'Admin');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (10333, 'MFILTERDOCSDT1', '01.01.2023', 'Admin');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (10334, 'MFILTERDOCSDT2', '', 'Admin');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (10335, 'MFILTERDOCSTP', '', 'Admin');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (10336, 'MFILTERDOCSSTATE', '', 'Admin');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (10337, 'MFILTERDOCSOUT', '', 'Admin');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (10338, 'MFILTERDOCSIN', '', 'Admin');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (10339, 'MAINSTORE', 'N1', 'SYSTEM');
INSERT INTO PARAMS (ID, PNAME, PVALUE, USR) VALUES (10340, 'MFILTERDOCSINOROUT', '', 'Admin');


COMMIT WORK;

INSERT INTO PERSONTYP (ID, IDX, NAME) VALUES (1, 'DB', 'Debitors');
INSERT INTO PERSONTYP (ID, IDX, NAME) VALUES (2, 'KR', 'Kreditors');


COMMIT WORK;



/******************************************************************************/
/***                              Primary keys                              ***/
/******************************************************************************/

ALTER TABLE ACP1 ADD CONSTRAINT PK__ACP1__9DA8D5A804C0D954 PRIMARY KEY (ACPID);
ALTER TABLE ACP21 ADD CONSTRAINT PK__ACP21__3214AD20A272DC48 PRIMARY KEY (AC);
ALTER TABLE ACP211 ADD CONSTRAINT PK__ACP211__DC501A788C26AD0D PRIMARY KEY (IDX);
ALTER TABLE ACP22 ADD CONSTRAINT PK__ACP22__DC501A78F7BF300D PRIMARY KEY (IDX);
ALTER TABLE ACP23 ADD CONSTRAINT PK__ACP23__DC501A78EE827AF9 PRIMARY KEY (IDX);
ALTER TABLE ACP24 ADD CONSTRAINT PK__ACP24__DC501A7845A901A3 PRIMARY KEY (IDX);
ALTER TABLE ACP25 ADD CONSTRAINT PK__ACP25__DC501A78A6EFECC1 PRIMARY KEY (IDX);
ALTER TABLE ACP25A ADD CONSTRAINT PK__ACP25A__DC501A78E7485270 PRIMARY KEY (IDX);
ALTER TABLE ACP6 ADD CONSTRAINT PK__ACP6__DC501A78BE69FCD0 PRIMARY KEY (IDX);
ALTER TABLE ACPLAN ADD CONSTRAINT PK__ACPLAN__3214AD00B0FE5810 PRIMARY KEY (AC);
ALTER TABLE ACPVN ADD CONSTRAINT PK__ACPVN__3213E83F137BDD28 PRIMARY KEY (ID);
ALTER TABLE BAL0 ADD CONSTRAINT PK__TMP_MS_X__3213E83F6A868532 PRIMARY KEY (ID);
ALTER TABLE BALA1 ADD CONSTRAINT PK__BALA1__842EDA9299261787 PRIMARY KEY (BALID);
ALTER TABLE BALA2 ADD CONSTRAINT PK__BALA2__3213E83FCB256326 PRIMARY KEY (ID);
ALTER TABLE BALA21 ADD CONSTRAINT PK__BALA21__3213E83FBD50FDE0 PRIMARY KEY (ID);
ALTER TABLE BALA3 ADD CONSTRAINT PK__BALA3__3213E83FBD70B60A PRIMARY KEY (ID);
ALTER TABLE BANKS ADD CONSTRAINT PK__BANKS__3214EC0765D78C54 PRIMARY KEY (ID);
ALTER TABLE CURRENCY ADD CONSTRAINT PK__CURRENCY__EF8E0A20FA6E56A5 PRIMARY KEY (ID, DETE);
ALTER TABLE DOCS0 ADD CONSTRAINT PK_DOCS0_ID PRIMARY KEY (ID);
ALTER TABLE DOCTYP ADD CONSTRAINT PK__DOCTYP__3213E83F9886F2DE PRIMARY KEY (ID);
ALTER TABLE DOCTYPA ADD CONSTRAINT PK__DOCTYPA__3213E83F1DA1D4A8 PRIMARY KEY (ID);
ALTER TABLE DOCTYPB ADD CONSTRAINT PK__DOCTYPB__CONSTR PRIMARY KEY (IDA, ID);
ALTER TABLE LOGX ADD CONSTRAINT PK__LOGX__3213E83F5C7469B5 PRIMARY KEY (ID);
ALTER TABLE LOPS ADD CONSTRAINT PK__TMP_MS_X__DC501A0429A72C80 PRIMARY KEY (IDL);
ALTER TABLE LOPSD ADD CONSTRAINT PK__LOPSD__DC501A044B87E3D6 PRIMARY KEY (IDL);
ALTER TABLE LXOP ADD CONSTRAINT PK__LXOP__3213E83F225DF5A5 PRIMARY KEY (ID);
ALTER TABLE M_ACCOUNTS ADD CONSTRAINT PK_M_ACCOUNTS PRIMARY KEY (ID);
ALTER TABLE M_ACCOUNTTYPE ADD CONSTRAINT PK_M_ACCOUNTTYPE PRIMARY KEY (ID);
ALTER TABLE M_ADDRESSSES ADD CONSTRAINT PK_M_ADDRESSSES PRIMARY KEY (ID);
ALTER TABLE M_BANKACCOUNTS ADD CONSTRAINT PK_M_BANKACCOUNTS PRIMARY KEY (ID);
ALTER TABLE M_BANKS ADD CONSTRAINT PK_M_BANKS PRIMARY KEY (ID);
ALTER TABLE M_CONTACTS ADD CONSTRAINT PK_M_CONTACTS PRIMARY KEY (ID);
ALTER TABLE M_COUNTRIES ADD CONSTRAINT PK_M_COUNTRIES PRIMARY KEY (ID);
ALTER TABLE M_DOCS ADD CONSTRAINT PK_M_DOCS PRIMARY KEY (ID);
ALTER TABLE M_DOCTYPES ADD CONSTRAINT PK_M_DOCTYPES PRIMARY KEY (ID);
ALTER TABLE M_ITEMS ADD CONSTRAINT PK_M_ITEMS PRIMARY KEY (ID);
ALTER TABLE M_ITEMS_CAT ADD CONSTRAINT PK_M_ITEMS_CAT PRIMARY KEY (ID);
ALTER TABLE M_ITEMS_PER_STORE ADD CONSTRAINT PK_M_ITEMS_PER_STORE PRIMARY KEY (IDITEM, IDSTORE);
ALTER TABLE M_LINKS ADD CONSTRAINT PK_M_LINKS PRIMARY KEY (ID1, ID2);
ALTER TABLE M_PAYMENTTYPE ADD CONSTRAINT PK_M_PAYMENTTYPE PRIMARY KEY (ID);
ALTER TABLE M_PVNRATES ADD CONSTRAINT PK_M_PVNRATES PRIMARY KEY (ID);
ALTER TABLE M_PVNRATES2 ADD CONSTRAINT PK_M_PVNRATES2 PRIMARY KEY (ID);
ALTER TABLE M_PVNTEXTS ADD CONSTRAINT PK_M_PVNTEXTS PRIMARY KEY (ID);
ALTER TABLE M_PVNTYPE ADD CONSTRAINT PK_M_PVNTYPE PRIMARY KEY (ID);
ALTER TABLE M_ROWS ADD CONSTRAINT PK_M_ROWS PRIMARY KEY (ID);
ALTER TABLE M_STORES ADD CONSTRAINT PK_M_STORES PRIMARY KEY (ID);
ALTER TABLE M_STORETYPE ADD CONSTRAINT PK_M_STORETYPE PRIMARY KEY (ID);
ALTER TABLE M_TRANSACTIONTYPE ADD CONSTRAINT PK_M_TRANSACTIONTYPE PRIMARY KEY (ID);
ALTER TABLE M_UNITS ADD CONSTRAINT PK_M_UNITS PRIMARY KEY (ID);
ALTER TABLE M_VEHICLES ADD CONSTRAINT PK_M_VEHICLES PRIMARY KEY (ID);
ALTER TABLE OPS ADD CONSTRAINT PK__TMP_MS_X__3213E83FA150CF75 PRIMARY KEY (ID);
ALTER TABLE OPSD ADD CONSTRAINT PK__OPSD__3213E83FF730A5A4 PRIMARY KEY (ID);
ALTER TABLE OPSD_YEAR_SEQ ADD CONSTRAINT PK__OPSD_YEA__3216622D85DDD79F PRIMARY KEY (YR);
ALTER TABLE PARAMS ADD CONSTRAINT PK__PARAMS__3213E83F3D519D8A PRIMARY KEY (ID);
ALTER TABLE PERSONS ADD CONSTRAINT PK__PERSONS__B1FCF8F5576F5ADD PRIMARY KEY (CLID);
ALTER TABLE PERSONTYP ADD CONSTRAINT PK__PERSONTY__3213E83F944BE0AD PRIMARY KEY (ID);
ALTER TABLE ROPS1A ADD CONSTRAINT PK__TMP_MS_X__3213E83FD68D33C6 PRIMARY KEY (ID);
ALTER TABLE ROPS2A ADD CONSTRAINT PK__ROPS2A__3213E83F25E04BE2 PRIMARY KEY (ID);
ALTER TABLE ROPS2B ADD CONSTRAINT PK__ROPS2B__3213E83F5AB28FC2 PRIMARY KEY (ID);
ALTER TABLE ROPS3A ADD CONSTRAINT PK__ROPS3A__3213E83FC0E2AA1D PRIMARY KEY (ID);
ALTER TABLE TABLE1 ADD CONSTRAINT PK__TABLE1__3214EC2714CF7944 PRIMARY KEY (ID);
ALTER TABLE TREM ADD CONSTRAINT PK__TREM__3213E83F9C5D0DB7 PRIMARY KEY (ID);
ALTER TABLE TREPA1 ADD CONSTRAINT PK__TREPA1__3213E83F483D1625 PRIMARY KEY (ID);
ALTER TABLE TREPAPAN ADD CONSTRAINT PK__TREPAPAN__3213E83F7A98EC00 PRIMARY KEY (ID);
ALTER TABLE TREPDARZ1 ADD CONSTRAINT PK__TREPDARZ__3213E83F432034DF PRIMARY KEY (ID);
ALTER TABLE TREPDARZ2 ADD CONSTRAINT PK__TREPDARZ__3213E83F3C691ACE PRIMARY KEY (ID);
ALTER TABLE TREPDOCS1 ADD CONSTRAINT PK__TREPDOCS__3213E83FA3E8A875 PRIMARY KEY (ID);
ALTER TABLE TREPDOCS2 ADD CONSTRAINT PK__TREPDOCS__3213E83F4EE9060F PRIMARY KEY (ID);
ALTER TABLE TREPDOCSS ADD CONSTRAINT PK__TREPDOCS__3213E83F6349CEC7 PRIMARY KEY (ID);
ALTER TABLE TREPMT ADD CONSTRAINT PK__TREPMT__3213E83FC895F2B2 PRIMARY KEY (ID);
ALTER TABLE TREPOPS ADD CONSTRAINT PK__TMP_MS_X__3213E83FA831B122 PRIMARY KEY (ID);
ALTER TABLE TREPOPSD ADD CONSTRAINT PK_TREPOPSD PRIMARY KEY (ID);
ALTER TABLE TREPPVNZ1 ADD CONSTRAINT PK__TREPPVNZ1 PRIMARY KEY (ID);
ALTER TABLE TREPUDOCS ADD CONSTRAINT PK__TREPUDOC__3213E83FF7D73D89 PRIMARY KEY (ID);
ALTER TABLE TTEMP_BALA21 ADD CONSTRAINT PK_TTEMP_BALA21 PRIMARY KEY (ID);
ALTER TABLE TTEMP_BALAC ADD CONSTRAINT PK_TTEMP_BALAC PRIMARY KEY (ID);
ALTER TABLE TTEMP_BALMT1 ADD CONSTRAINT PK_TTEMP_BALMT1 PRIMARY KEY (ID);
ALTER TABLE TTEMP_BALMT2 ADD CONSTRAINT PK_TTEMP_BALMT2 PRIMARY KEY (ID);
ALTER TABLE TTEMP_PVN1 ADD CONSTRAINT PK_TTEMP_PVN1 PRIMARY KEY (ID)
USING INDEX PK_TTEMP_PVN1_ID;
ALTER TABLE TTEMP_PVN2 ADD CONSTRAINT PK_TTEMP_PVN2 PRIMARY KEY (CLID);
ALTER TABLE TUDOCLISTS ADD CONSTRAINT PK__TUDOCLIS__3213E83F9C7066D9 PRIMARY KEY (ID);
ALTER TABLE TUDOCS ADD CONSTRAINT PK__TUDOCS__3213E83F8EA39304 PRIMARY KEY (ID);
ALTER TABLE TUPDFIELDS ADD CONSTRAINT PK__TUPDFIEL__3213E83FF88B6F55 PRIMARY KEY (ID);
ALTER TABLE TUPVN1 ADD CONSTRAINT PK__TUPVN1__3213E83F73B41AD6 PRIMARY KEY (ID);
ALTER TABLE TUSERS ADD CONSTRAINT PK__TUSERS__3213D0821884B502 PRIMARY KEY (NM);


/******************************************************************************/
/***                              Foreign keys                              ***/
/******************************************************************************/

ALTER TABLE BAL0 ADD CONSTRAINT FK_BAL0_AC1_ACP21_AC FOREIGN KEY (AC11) REFERENCES ACP21 (AC);
ALTER TABLE BAL0 ADD CONSTRAINT FK_BAL0_AC4_ACP24_IDX FOREIGN KEY (AC24) REFERENCES ACP24 (IDX);
ALTER TABLE BAL0 ADD CONSTRAINT FK_BAL0_CLID_PERSONS_CLID FOREIGN KEY (CLID) REFERENCES PERSONS (CLID);
ALTER TABLE BALA2 ADD CONSTRAINT FK_BALA2_BALID_BALA1_BALID FOREIGN KEY (BALID) REFERENCES BALA1 (BALID) ON DELETE CASCADE ON UPDATE CASCADE;
ALTER TABLE BALA3 ADD CONSTRAINT FK_BALA3_ID2_BALA2_ID FOREIGN KEY (ID2) REFERENCES BALA2 (ID) ON DELETE CASCADE;
ALTER TABLE DOCS0 ADD CONSTRAINT FK_DOCS0_AC_ACP21_AC FOREIGN KEY (AC) REFERENCES ACP21 (AC);
ALTER TABLE DOCS0 ADD CONSTRAINT FK_DOCS0_CLID_PERSONS_CLID FOREIGN KEY (CLID) REFERENCES PERSONS (CLID);
ALTER TABLE DOCS0 ADD CONSTRAINT FK_DOCS0_DOCTYP_DOCTYP_ID FOREIGN KEY (DOCTYP) REFERENCES DOCTYP (ID);
ALTER TABLE DOCTYPB ADD CONSTRAINT FK_DOCTYPB_IDA_DOCTYPA_ID FOREIGN KEY (IDA) REFERENCES DOCTYPA (ID) ON UPDATE CASCADE;
ALTER TABLE DOCTYPB ADD CONSTRAINT FK_DOCTYPB_ID_DOCTYP_ID FOREIGN KEY (ID) REFERENCES DOCTYP (ID) ON UPDATE CASCADE;
ALTER TABLE M_ACCOUNTS ADD CONSTRAINT FK_M_ACCOUNTS_TP FOREIGN KEY (TP) REFERENCES M_ACCOUNTTYPE (ID);
ALTER TABLE M_ADDRESSSES ADD CONSTRAINT FK_M_ADDRESSSES_IDCOUNTRY FOREIGN KEY (IDCOUNTRY) REFERENCES M_COUNTRIES (ID);
ALTER TABLE M_ADDRESSSES ADD CONSTRAINT FK_M_ADDRESSSES_IDSTORE FOREIGN KEY (IDSTORE) REFERENCES M_STORES (ID);
ALTER TABLE M_BANKACCOUNTS ADD CONSTRAINT FK_M_BANKACCOUNTS_IDBANK FOREIGN KEY (IDBANK) REFERENCES M_BANKS (ID);
ALTER TABLE M_BANKACCOUNTS ADD CONSTRAINT FK_M_BANKACCOUNTS_IDSTORE FOREIGN KEY (IDSTORE) REFERENCES M_STORES (ID);
ALTER TABLE M_CONTACTS ADD CONSTRAINT FK_M_CONTACTS_IDSTORE FOREIGN KEY (IDSTORE) REFERENCES M_STORES (ID);
ALTER TABLE M_DOCS ADD CONSTRAINT FK_M_DOCS_IDADDRESSIN FOREIGN KEY (IDADDRESSIN) REFERENCES M_ADDRESSSES (ID);
ALTER TABLE M_DOCS ADD CONSTRAINT FK_M_DOCS_IDADDRESSOUT FOREIGN KEY (IDADDRESSOUT) REFERENCES M_ADDRESSSES (ID);
ALTER TABLE M_DOCS ADD CONSTRAINT FK_M_DOCS_IDCARRIER FOREIGN KEY (IDCARRIER) REFERENCES M_STORES (ID);
ALTER TABLE M_DOCS ADD CONSTRAINT FK_M_DOCS_IDDRIVER FOREIGN KEY (IDDRIVER) REFERENCES M_CONTACTS (ID);
ALTER TABLE M_DOCS ADD CONSTRAINT FK_M_DOCS_IDPAYMENTTYPE FOREIGN KEY (IDPAYMENTTYPE) REFERENCES M_PAYMENTTYPE (ID);
ALTER TABLE M_DOCS ADD CONSTRAINT FK_M_DOCS_IDSTOREIN FOREIGN KEY (IDSTOREIN) REFERENCES M_STORES (ID);
ALTER TABLE M_DOCS ADD CONSTRAINT FK_M_DOCS_IDSTOREOUT FOREIGN KEY (IDSTOREOUT) REFERENCES M_STORES (ID);
ALTER TABLE M_DOCS ADD CONSTRAINT FK_M_DOCS_IDTRANSACTIONTYPE FOREIGN KEY (IDTRANSACTIONTYPE) REFERENCES M_TRANSACTIONTYPE (ID);
ALTER TABLE M_DOCS ADD CONSTRAINT FK_M_DOCS_IDVEHICLE FOREIGN KEY (IDVEHICLE) REFERENCES M_VEHICLES (ID);
ALTER TABLE M_DOCS ADD CONSTRAINT FK_M_DOCS_TP FOREIGN KEY (TP) REFERENCES M_DOCTYPES (ID);
ALTER TABLE M_ITEMS ADD CONSTRAINT FK_M_ITEMS_CAT FOREIGN KEY (CAT) REFERENCES M_ITEMS_CAT (ID);
ALTER TABLE M_ITEMS ADD CONSTRAINT FK_M_ITEMS_PVNRATE FOREIGN KEY (PVNRATE) REFERENCES M_PVNRATES (ID);
ALTER TABLE M_ITEMS ADD CONSTRAINT FK_M_ITEMS_STORE1 FOREIGN KEY (STORE1) REFERENCES M_STORES (ID);
ALTER TABLE M_ITEMS ADD CONSTRAINT FK_M_ITEMS_UNITS FOREIGN KEY (UNITS) REFERENCES M_UNITS (ID);
ALTER TABLE M_ITEMS_PER_STORE ADD CONSTRAINT FK_M_ITEMS_PER_STORE_IDITEM FOREIGN KEY (IDITEM) REFERENCES M_ITEMS (ID);
ALTER TABLE M_ITEMS_PER_STORE ADD CONSTRAINT FK_M_ITEMS_PER_STORE_IDSTORE FOREIGN KEY (IDSTORE) REFERENCES M_STORES (ID);
ALTER TABLE M_LINKS ADD CONSTRAINT FK_M_LINKS_ID1 FOREIGN KEY (ID1) REFERENCES M_ROWS (ID);
ALTER TABLE M_LINKS ADD CONSTRAINT FK_M_LINKS_ID2 FOREIGN KEY (ID2) REFERENCES M_ROWS (ID);
ALTER TABLE M_PVNRATES2 ADD CONSTRAINT FK_M_PVNRATES2_IDRATE FOREIGN KEY (IDRATE) REFERENCES M_PVNRATES (ID);
ALTER TABLE M_PVNRATES2 ADD CONSTRAINT FK_M_PVNRATES2_IDTP FOREIGN KEY (IDTP) REFERENCES M_PVNTYPE (ID);
ALTER TABLE M_ROWS ADD CONSTRAINT FK_M_ROWS_IDDOC FOREIGN KEY (IDDOC) REFERENCES M_DOCS (ID);
ALTER TABLE M_ROWS ADD CONSTRAINT FK_M_ROWS_IDITEM FOREIGN KEY (IDITEM) REFERENCES M_ITEMS (ID);
ALTER TABLE M_ROWS ADD CONSTRAINT FK_M_ROWS_IDPVNRATE FOREIGN KEY (IDPVNRATE) REFERENCES M_PVNRATES (ID);
ALTER TABLE M_ROWS ADD CONSTRAINT FK_M_ROWS_UNITS FOREIGN KEY (UNITS) REFERENCES M_UNITS (ID);
ALTER TABLE M_STORES ADD CONSTRAINT FK_M_STORES_PVNTP FOREIGN KEY (PVNTP) REFERENCES M_PVNTYPE (ID);
ALTER TABLE M_STORES ADD CONSTRAINT FK_M_STORES_TP FOREIGN KEY (TP) REFERENCES M_STORETYPE (ID);
ALTER TABLE M_VEHICLES ADD CONSTRAINT FK_M_VEHICLES_IDSTORE FOREIGN KEY (IDSTORE) REFERENCES M_STORES (ID);
ALTER TABLE OPS ADD CONSTRAINT FK_OPS_AC11_ACP21_AC FOREIGN KEY (AC11) REFERENCES ACP21 (AC);
ALTER TABLE OPS ADD CONSTRAINT FK_OPS_AC12_ACP21_AC FOREIGN KEY (AC12) REFERENCES ACP21 (AC);
ALTER TABLE OPS ADD CONSTRAINT FK_OPS_AC13_ACP23_IDX FOREIGN KEY (AC13) REFERENCES ACP23 (IDX);
ALTER TABLE OPS ADD CONSTRAINT FK_OPS_AC14_ACP24_IDX FOREIGN KEY (AC14) REFERENCES ACP24 (IDX);
ALTER TABLE OPS ADD CONSTRAINT FK_OPS_AC15_ACP25_IDX FOREIGN KEY (AC15) REFERENCES ACP25 (IDX);
ALTER TABLE OPS ADD CONSTRAINT FK_OPS_AC21_ACP21_AC FOREIGN KEY (AC21) REFERENCES ACP21 (AC);
ALTER TABLE OPS ADD CONSTRAINT FK_OPS_AC22_ACP21_AC FOREIGN KEY (AC22) REFERENCES ACP21 (AC);
ALTER TABLE OPS ADD CONSTRAINT FK_OPS_AC23_ACP23_IDX FOREIGN KEY (AC23) REFERENCES ACP23 (IDX);
ALTER TABLE OPS ADD CONSTRAINT FK_OPS_AC24_ACP24_IDX FOREIGN KEY (AC24) REFERENCES ACP24 (IDX);
ALTER TABLE OPS ADD CONSTRAINT FK_OPS_AC25_ACP25_IDX FOREIGN KEY (AC25) REFERENCES ACP25 (IDX);
ALTER TABLE OPS ADD CONSTRAINT FK_OPS_DOCID_OPSD_ID FOREIGN KEY (DOCID) REFERENCES OPSD (ID) ON DELETE CASCADE;
ALTER TABLE OPSD ADD CONSTRAINT FK_OPSD_CLID2_PERSONS_CLID FOREIGN KEY (CLID2) REFERENCES PERSONS (CLID);
ALTER TABLE OPSD ADD CONSTRAINT FK_OPSD_CLID_PERSONS_CLID FOREIGN KEY (CLID) REFERENCES PERSONS (CLID);
ALTER TABLE OPSD ADD CONSTRAINT FK_OPSD_DOCTYP_DOCTYP_ID FOREIGN KEY (DOCTYP) REFERENCES DOCTYP (ID);
ALTER TABLE PARAMS ADD CONSTRAINT FK_PARAMS_USR_TUSERS_NM FOREIGN KEY (USR) REFERENCES TUSERS (NM) ON DELETE CASCADE ON UPDATE CASCADE;


/******************************************************************************/
/***                                Indices                                 ***/
/******************************************************************************/

CREATE INDEX ACP1_ACPID ON ACP1 (ACPID);
CREATE INDEX ACP21_ID1 ON ACP21 (ID1);
CREATE INDEX ACP21_ID2 ON ACP21 (ID2);
CREATE UNIQUE INDEX ACP21_IDX ON ACP21 (AC);
CREATE INDEX ACP211_IDN ON ACP211 (ID1);
CREATE UNIQUE INDEX ACP211_IDX ON ACP211 (IDX);
CREATE UNIQUE INDEX ACP22_IDX ON ACP22 (IDX);
CREATE INDEX ACP23_IDN ON ACP23 (ID1);
CREATE UNIQUE INDEX ACP23_IDX ON ACP23 (IDX);
CREATE UNIQUE INDEX ACP24_IDX ON ACP24 (IDX);
CREATE INDEX ACP25_ID1 ON ACP25 (ID1);
CREATE UNIQUE INDEX ACP25_IDX ON ACP25 (IDX);
CREATE UNIQUE INDEX ACP25A_IDX ON ACP25A (IDX);
CREATE UNIQUE INDEX ACP6_IDX ON ACP6 (IDX);
CREATE INDEX ACPVN_ID ON ACPVN (ID);
CREATE INDEX IND_BAL0_AC11 ON BAL0 (AC11);
CREATE INDEX IND_BAL0_AC24 ON BAL0 (AC24);
CREATE INDEX IND_BAL0_CLID ON BAL0 (CLID);
CREATE INDEX BALA1_ID ON BALA1 (BALID);
CREATE INDEX BALA2_BALID ON BALA2 (BALID);
CREATE INDEX BALA2_ID ON BALA2 (ID);
CREATE INDEX BALA21_BID ON BALA21 (BID);
CREATE INDEX BALA21_ID ON BALA21 (ID);
CREATE INDEX BALA3_ID ON BALA3 (ID);
CREATE INDEX BALA3_ID2 ON BALA3 (ID2);
CREATE INDEX FK_DOCS0_AC ON DOCS0 (AC);
CREATE INDEX DOCTYP_ID ON DOCTYP (ID);
CREATE INDEX DOCTYP_ID1 ON DOCTYP (ID1);
CREATE INDEX DOCTYPA_ID ON DOCTYPA (ID);
CREATE INDEX DOCTYPB_ID ON DOCTYPB (ID);
CREATE INDEX DOCTYPB_IDA ON DOCTYPB (IDA);
CREATE INDEX LOGX_ID ON LOGX (ID);
CREATE INDEX LOGX_LID ON LOGX (LID);
CREATE INDEX LOPS_DOCID ON LOPS (DOCID);
CREATE INDEX LOPS_DTL ON LOPS (DTL);
CREATE INDEX LOPS_DTLD ON LOPS (DTLD);
CREATE INDEX LOPS_ID ON LOPS (ID);
CREATE UNIQUE INDEX LOPS_IDL ON LOPS (IDL);
CREATE INDEX LOPSD_CLID ON LOPSD (CLID);
CREATE INDEX LOPSD_CLID2 ON LOPSD (CLID2);
CREATE INDEX LOPSD_DATE ON LOPSD (DETE);
CREATE INDEX LOPSD_ID ON LOPSD (ID);
CREATE UNIQUE INDEX LOPSD_IDL ON LOPSD (IDL);
CREATE INDEX LOPSD_ZDT ON LOPSD (ZDT);
CREATE INDEX LOPSD_ZNR ON LOPSD (ZNR);
CREATE INDEX LXOP_AD ON LXOP (AD);
CREATE INDEX LXOP_AR ON LXOP (AR);
CREATE INDEX LXOP_ID ON LXOP (ID);
CREATE INDEX M_DOCS_DT ON M_DOCS (DT);
CREATE INDEX M_DOCS_IDSEQ ON M_DOCS (IDSEQ);
CREATE INDEX M_DOCS_STATE ON M_DOCS (STATE);
CREATE INDEX IDX_M_DOCTYPES_OPTYPE ON M_DOCTYPES (OPTYPE);
CREATE INDEX M_ITEMS_ISSERVICE ON M_ITEMS (ISSERVICE);
CREATE INDEX M_LINKS_IDITEM ON M_LINKS (IDITEM);
CREATE INDEX IDX_M_ROWS_IDSEQ ON M_ROWS (IDSEQ);
CREATE INDEX M_ROWS_ISGONE ON M_ROWS (ISGONE);
CREATE UNIQUE INDEX M_STORES_CODE ON M_STORES (CODE);
CREATE INDEX IND_OPS_AC11 ON OPS (AC11);
CREATE INDEX IND_OPS_AC12 ON OPS (AC12);
CREATE INDEX IND_OPS_AC13 ON OPS (AC13);
CREATE INDEX IND_OPS_AC14 ON OPS (AC14);
CREATE INDEX IND_OPS_AC15 ON OPS (AC15);
CREATE INDEX IND_OPS_AC21 ON OPS (AC21);
CREATE INDEX IND_OPS_AC22 ON OPS (AC22);
CREATE INDEX IND_OPS_AC23 ON OPS (AC23);
CREATE INDEX IND_OPS_AC24 ON OPS (AC24);
CREATE INDEX IND_OPS_AC25 ON OPS (AC25);
CREATE INDEX IND_OPS_DOCID ON OPS (DOCID);
CREATE INDEX DOCS0_CLID ON OPSD (CLID);
CREATE INDEX DOCS0_DOCTYP ON OPSD (DOCTYP);
CREATE INDEX OPSD_CLID ON OPSD (CLID);
CREATE INDEX OPSD_CLID1 ON OPSD (CLID2);
CREATE INDEX OPSD_DOCTYP ON OPSD (DOCTYP);
CREATE INDEX OPSD_ZNR ON OPSD (ZNR);
CREATE INDEX PARAMS_ID ON PARAMS (ID);
CREATE INDEX PARAMS_PNAME ON PARAMS (PNAME);
CREATE INDEX TUSERSPARAMS ON PARAMS (USR);
CREATE INDEX PERSONS_CLID ON PERSONS (CLID);
CREATE INDEX PERSONTYP_ID ON PERSONTYP (ID);
CREATE INDEX PERSONTYP_IDX ON PERSONTYP (IDX);
CREATE INDEX ROPS1A_CLID ON ROPS1A (CLID);
CREATE INDEX ROPS1A_CLID1 ON ROPS1A (CLID2);
CREATE INDEX ROPS1A_DID ON ROPS1A (DID);
CREATE INDEX ROPS1A_SPID ON ROPS1A (SPID);
CREATE INDEX ROPS2A_AC ON ROPS2A (AC);
CREATE INDEX ROPS2A_ID ON ROPS2A (ID);
CREATE INDEX ROPS2A_SPID ON ROPS2A (SPID);
CREATE INDEX ROPS2B_AC ON ROPS2B (AC);
CREATE INDEX ROPS2B_ID ON ROPS2B (ID);
CREATE INDEX ROPS2B_SPID ON ROPS2B (SPID);
CREATE INDEX ROPS3A_ID ON ROPS3A (ID);
CREATE INDEX TREM_ID ON TREM (ID);
CREATE INDEX TREM_IDA ON TREM (AID);
CREATE INDEX TREPA1_ID ON TREPA1 (ID);
CREATE INDEX TREPA1_SPID ON TREPA1 (SPID);
CREATE INDEX TREPAPAN_ID ON TREPAPAN (ID);
CREATE INDEX TREPAPAN_SPID ON TREPAPAN (SPID);
CREATE INDEX TREPDARZ1_AC1 ON TREPDARZ1 (AC1);
CREATE INDEX TREPDARZ1_AC2 ON TREPDARZ1 (AC2);
CREATE INDEX TREPDARZ1_CLID ON TREPDARZ1 (CLID);
CREATE INDEX TREPDARZ1_DID ON TREPDARZ1 (DID);
CREATE INDEX TREPDARZ1_ID ON TREPDARZ1 (ID);
CREATE INDEX TREPDARZ1_RID ON TREPDARZ1 (RID);
CREATE INDEX TREPDARZ1_SPID ON TREPDARZ1 (SPID);
CREATE INDEX TREPDARZ2_ID ON TREPDARZ2 (ID);
CREATE INDEX TREPDARZ2_SPID ON TREPDARZ2 (SPID);
CREATE INDEX TREPDOCS1_ID ON TREPDOCS1 (ID);
CREATE INDEX TREPDOCS1_SPID ON TREPDOCS1 (SPID);
CREATE INDEX TREPDOCS2_ID ON TREPDOCS2 (ID);
CREATE INDEX TREPDOCS2_SPID ON TREPDOCS2 (SPID);
CREATE INDEX TREPDOCSS_DID ON TREPDOCSS (DID);
CREATE INDEX TREPDOCSS_ID ON TREPDOCSS (ID);
CREATE INDEX TREPDOCSS_SPID ON TREPDOCSS (SPID);
CREATE INDEX TREPMT_ID ON TREPMT (ID);
CREATE INDEX TREPMT_SPID ON TREPMT (SPID);
CREATE INDEX TREPPVNZ1_CLID ON TREPPVNZ1 (CLID);
CREATE INDEX TREPPVNZ1_DID ON TREPPVNZ1 (DID);
CREATE INDEX TREPPVNZ1_ID ON TREPPVNZ1 (ID);
CREATE INDEX TREPPVNZ1_SPID ON TREPPVNZ1 (SPID);
CREATE INDEX TREPUDOCS_ID ON TREPUDOCS (ID);
CREATE INDEX TREPUDOCS_SPID ON TREPUDOCS (SPID);
CREATE INDEX TTEMP_PVN1_IDX_DID ON TTEMP_PVN1 (DID);
CREATE INDEX TUDOCLISTS_ID ON TUDOCLISTS (ID);
CREATE INDEX TUDOCLISTSTUDOCS ON TUDOCS (LD);
CREATE INDEX TUDOCS_ID ON TUDOCS (ID);
CREATE INDEX TUPDFIELDS_ID ON TUPDFIELDS (ID);
CREATE INDEX TUPVN1_DID ON TUPVN1 (DID);
CREATE INDEX TUPVN1_ID ON TUPVN1 (ID);


/******************************************************************************/
/***                                Triggers                                ***/
/******************************************************************************/



SET TERM ^ ;



/******************************************************************************/
/***                          Triggers for tables                           ***/
/******************************************************************************/



/* Trigger: M_ADDRESSSES_BI */
CREATE TRIGGER M_ADDRESSSES_BI FOR M_ADDRESSSES
ACTIVE BEFORE INSERT POSITION 0
as
begin
  if ((new.id is null) or (new.id < 0))  then
    new.id = gen_id(gen_m_addressses_id,1);
end
^

/* Trigger: M_BANKACCOUNTS_BI */
CREATE TRIGGER M_BANKACCOUNTS_BI FOR M_BANKACCOUNTS
ACTIVE BEFORE INSERT POSITION 0
as
begin
  if ((new.id is null) or (new.id < 0))  then
    new.id = gen_id(gen_m_banks_id,1);
end
^

/* Trigger: M_BANKS_BI */
CREATE TRIGGER M_BANKS_BI FOR M_BANKS
ACTIVE BEFORE INSERT POSITION 0
as
begin
  if ((new.id is null) or (new.id < 0))  then
    new.id = gen_id(gen_m_banks_id,1);
end
^

/* Trigger: M_CONTACTS_BI */
CREATE TRIGGER M_CONTACTS_BI FOR M_CONTACTS
ACTIVE BEFORE INSERT POSITION 0
as
begin
  if ((new.id is null) or (new.id < 0))  then
    new.id = gen_id(gen_m_contacts_id,1);
end
^

/* Trigger: M_COUNTRIES_BI */
CREATE TRIGGER M_COUNTRIES_BI FOR M_COUNTRIES
ACTIVE BEFORE INSERT POSITION 0
as
begin
  if ((new.id is null) or (new.id < 0))  then
    new.id = gen_id(gen_m_countries_id,1);
end
^

/* Trigger: M_DOCS_BI */
CREATE TRIGGER M_DOCS_BI FOR M_DOCS
ACTIVE BEFORE INSERT POSITION 0
as
begin
  if ((new.id is null) or (new.id < 0))  then
    new.id = gen_id(gen_m_docs_id,1);
end
^

/* Trigger: M_DOCTYPES_BI */
CREATE TRIGGER M_DOCTYPES_BI FOR M_DOCTYPES
ACTIVE BEFORE INSERT POSITION 0
as
begin
  if ((new.id is null) or (new.id < 0))  then
    new.id = gen_id(gen_m_doctypes_id,1);
end
^

/* Trigger: M_ITEMS_BI */
CREATE TRIGGER M_ITEMS_BI FOR M_ITEMS
ACTIVE BEFORE INSERT POSITION 0
as
begin
  if ((new.id is null) or (new.id < 0))  then
    new.id = gen_id(gen_m_items_id,1);
end
^

/* Trigger: M_ITEMS_CAT_BI */
CREATE TRIGGER M_ITEMS_CAT_BI FOR M_ITEMS_CAT
ACTIVE BEFORE INSERT POSITION 0
as
begin
  if ((new.id is null) or (new.id < 0))  then
    new.id = gen_id(gen_m_items_cat_id,1);
end
^

/* Trigger: M_PAYMENTTYPE_BI */
CREATE TRIGGER M_PAYMENTTYPE_BI FOR M_PAYMENTTYPE
ACTIVE BEFORE INSERT POSITION 0
as
begin
  if ((new.id is null) or (new.id < 0))  then
    new.id = gen_id(gen_m_paymenttype_id,1);
end
^

/* Trigger: M_PVNRATES2_BI */
CREATE TRIGGER M_PVNRATES2_BI FOR M_PVNRATES2
ACTIVE BEFORE INSERT POSITION 0
as
begin
  if ((new.id is null) or (new.id < 0))  then
    new.id = gen_id(gen_m_pvnrates2_id,1);
end
^

/* Trigger: M_PVNRATES_BI */
CREATE TRIGGER M_PVNRATES_BI FOR M_PVNRATES
ACTIVE BEFORE INSERT POSITION 0
as
begin
  if ((new.id is null) or (new.id < 0))  then
    new.id = gen_id(gen_m_pvnrates_id,1);
end
^

/* Trigger: M_PVNTEXTS_BI */
CREATE TRIGGER M_PVNTEXTS_BI FOR M_PVNTEXTS
ACTIVE BEFORE INSERT POSITION 0
as
begin
  if ((new.id is null) or (new.id < 0))  then
    new.id = gen_id(gen_m_pvntexts_id,1);
end
^

/* Trigger: M_ROWS_BI */
CREATE TRIGGER M_ROWS_BI FOR M_ROWS
ACTIVE BEFORE INSERT POSITION 0
as
begin
  if ((new.id is null) or (new.id < 0))  then
    new.id = gen_id(gen_m_rows_id,1);
end
^

/* Trigger: M_STORES_BI */
CREATE TRIGGER M_STORES_BI FOR M_STORES
ACTIVE BEFORE INSERT POSITION 0
as
begin
  if ((new.id is null) or (new.id < 0))  then
    new.id = gen_id(gen_m_stores_id,1);
end
^

/* Trigger: M_STORETYPE_BI */
CREATE TRIGGER M_STORETYPE_BI FOR M_STORETYPE
ACTIVE BEFORE INSERT POSITION 0
as
begin
  if ((new.id is null) or (new.id < 0))  then
    new.id = gen_id(gen_m_storetype_id,1);
end
^

/* Trigger: M_TRANSACTIONTYPE_BI */
CREATE TRIGGER M_TRANSACTIONTYPE_BI FOR M_TRANSACTIONTYPE
ACTIVE BEFORE INSERT POSITION 0
as
begin
  if ((new.id is null) or (new.id < 0))  then
    new.id = gen_id(gen_m_transactiontype_id,1);
end
^

/* Trigger: M_UNITS_BI */
CREATE TRIGGER M_UNITS_BI FOR M_UNITS
ACTIVE BEFORE INSERT POSITION 0
as
begin
  if ((new.id is null) or (new.id < 0))  then
    new.id = gen_id(gen_m_units_id,1);
end
^

/* Trigger: M_VEHICLES_BI */
CREATE TRIGGER M_VEHICLES_BI FOR M_VEHICLES
ACTIVE BEFORE INSERT POSITION 0
as
begin
  if ((new.id is null) or (new.id < 0))  then
    new.id = gen_id(gen_m_vehicles_id,1);
end
^

/* Trigger: TRIG_BAL0_BI */
CREATE TRIGGER TRIG_BAL0_BI FOR BAL0
ACTIVE BEFORE INSERT POSITION 0
AS BEGIN
      IF(NEW."ID" IS NULL) THEN NEW."ID" = GEN_ID("GEN_BAL0_ID",1);
    END
^

/* Trigger: TRIG_BALA21_BI */
CREATE TRIGGER TRIG_BALA21_BI FOR BALA21
ACTIVE BEFORE INSERT POSITION 0
AS BEGIN
      IF(NEW."ID" IS NULL) THEN NEW."ID" = GEN_ID("GEN_BALA21_ID",1);
    END
^

/* Trigger: TRIG_BALA2_BI */
CREATE TRIGGER TRIG_BALA2_BI FOR BALA2
ACTIVE BEFORE INSERT POSITION 0
AS BEGIN
      IF(NEW."ID" IS NULL) THEN NEW."ID" = GEN_ID("GEN_BALA2_ID",1);
    END
^

/* Trigger: TRIG_BALA3_BI */
CREATE TRIGGER TRIG_BALA3_BI FOR BALA3
ACTIVE BEFORE INSERT POSITION 0
AS BEGIN
      IF(NEW."ID" IS NULL) THEN NEW."ID" = GEN_ID("GEN_BALA3_ID",1);
    END
^

/* Trigger: TRIG_DOCS0_BI */
CREATE TRIGGER TRIG_DOCS0_BI FOR DOCS0
ACTIVE BEFORE INSERT POSITION 0
AS BEGIN
      IF(NEW."ID" IS NULL) THEN NEW."ID" = GEN_ID("GEN_DOCS0_ID",1);
    END
^

/* Trigger: TRIG_LOGX_BI */
CREATE TRIGGER TRIG_LOGX_BI FOR LOGX
ACTIVE BEFORE INSERT POSITION 0
AS BEGIN
      IF(NEW."ID" IS NULL) THEN NEW."ID" = GEN_ID("GEN_LOGX_ID",1);
    END
^

/* Trigger: TRIG_LOPSD_BI */
CREATE TRIGGER TRIG_LOPSD_BI FOR LOPSD
ACTIVE BEFORE INSERT POSITION 0
AS BEGIN
      IF(NEW."IDL" IS NULL) THEN NEW."IDL" = GEN_ID("GEN_LOPSD_IDL",1);
    END
^

/* Trigger: TRIG_LOPS_BI */
CREATE TRIGGER TRIG_LOPS_BI FOR LOPS
ACTIVE BEFORE INSERT POSITION 0
AS BEGIN
      IF(NEW."IDL" IS NULL) THEN NEW."IDL" = GEN_ID("GEN_LOPS_IDL",1);
    END
^

/* Trigger: TRIG_LXOP_BI */
CREATE TRIGGER TRIG_LXOP_BI FOR LXOP
ACTIVE BEFORE INSERT POSITION 0
AS BEGIN
      IF(NEW."ID" IS NULL) THEN NEW."ID" = GEN_ID("GEN_LXOP_ID",1);
    END
^

/* Trigger: TRIG_OPSD_BI */
CREATE TRIGGER TRIG_OPSD_BI FOR OPSD
ACTIVE BEFORE INSERT POSITION 0
AS BEGIN
      IF(NEW."ID" IS NULL) THEN NEW."ID" = GEN_ID("GEN_OPSD_ID",1);
    END
^

/* Trigger: TRIG_OPS_BI */
CREATE TRIGGER TRIG_OPS_BI FOR OPS
ACTIVE BEFORE INSERT POSITION 0
AS BEGIN
      IF(NEW."ID" IS NULL) THEN NEW."ID" = GEN_ID("GEN_OPS_ID",1);
    END
^

/* Trigger: TRIG_PARAMS_BI */
CREATE TRIGGER TRIG_PARAMS_BI FOR PARAMS
ACTIVE BEFORE INSERT POSITION 0
AS BEGIN
      IF(NEW."ID" IS NULL) THEN NEW."ID" = GEN_ID("GEN_PARAMS_ID",1);
    END
^

/* Trigger: TRIG_PERSONTYP_BI */
CREATE TRIGGER TRIG_PERSONTYP_BI FOR PERSONTYP
ACTIVE BEFORE INSERT POSITION 0
AS BEGIN
      IF(NEW."ID" IS NULL) THEN NEW."ID" = GEN_ID("GEN_PERSONTYP_ID",1);
    END
^

/* Trigger: TRIG_ROPS1A_BI */
CREATE TRIGGER TRIG_ROPS1A_BI FOR ROPS1A
ACTIVE BEFORE INSERT POSITION 0
AS BEGIN
      IF(NEW."ID" IS NULL) THEN NEW."ID" = GEN_ID("GEN_ROPS1A_ID",1);
    END
^

/* Trigger: TRIG_ROPS2A_BI */
CREATE TRIGGER TRIG_ROPS2A_BI FOR ROPS2A
ACTIVE BEFORE INSERT POSITION 0
AS BEGIN
      IF(NEW."ID" IS NULL) THEN NEW."ID" = GEN_ID("GEN_ROPS2A_ID",1);
    END
^

/* Trigger: TRIG_ROPS2B_BI */
CREATE TRIGGER TRIG_ROPS2B_BI FOR ROPS2B
ACTIVE BEFORE INSERT POSITION 0
AS BEGIN
      IF(NEW."ID" IS NULL) THEN NEW."ID" = GEN_ID("GEN_ROPS2B_ID",1);
    END
^

/* Trigger: TRIG_ROPS3A_BI */
CREATE TRIGGER TRIG_ROPS3A_BI FOR ROPS3A
ACTIVE BEFORE INSERT POSITION 0
AS BEGIN
      IF(NEW."ID" IS NULL) THEN NEW."ID" = GEN_ID("GEN_ROPS3A_ID",1);
    END
^

/* Trigger: TRIG_TABLE1_BI */
CREATE TRIGGER TRIG_TABLE1_BI FOR TABLE1
ACTIVE BEFORE INSERT POSITION 0
AS BEGIN
      IF(NEW."ID" IS NULL) THEN NEW."ID" = GEN_ID("GEN_TABLE1_ID",1);
    END
^

/* Trigger: TRIG_TREM_BI */
CREATE TRIGGER TRIG_TREM_BI FOR TREM
ACTIVE BEFORE INSERT POSITION 0
AS BEGIN
      IF(NEW."ID" IS NULL) THEN NEW."ID" = GEN_ID("GEN_TREM_ID",1);
    END
^

/* Trigger: TRIG_TREPA1_BI */
CREATE TRIGGER TRIG_TREPA1_BI FOR TREPA1
ACTIVE BEFORE INSERT POSITION 0
AS BEGIN
      IF(NEW."ID" IS NULL) THEN NEW."ID" = GEN_ID("GEN_TREPA1_ID",1);
    END
^

/* Trigger: TRIG_TREPAPAN_BI */
CREATE TRIGGER TRIG_TREPAPAN_BI FOR TREPAPAN
ACTIVE BEFORE INSERT POSITION 0
AS BEGIN
      IF(NEW."ID" IS NULL) THEN NEW."ID" = GEN_ID("GEN_TREPAPAN_ID",1);
    END
^

/* Trigger: TRIG_TREPDARZ1_BI */
CREATE TRIGGER TRIG_TREPDARZ1_BI FOR TREPDARZ1
ACTIVE BEFORE INSERT POSITION 0
AS BEGIN
      IF(NEW."ID" IS NULL) THEN NEW."ID" = GEN_ID("GEN_TREPDARZ1_ID",1);
    END
^

/* Trigger: TRIG_TREPDARZ2_BI */
CREATE TRIGGER TRIG_TREPDARZ2_BI FOR TREPDARZ2
ACTIVE BEFORE INSERT POSITION 0
AS BEGIN
      IF(NEW."ID" IS NULL) THEN NEW."ID" = GEN_ID("GEN_TREPDARZ2_ID",1);
    END
^

/* Trigger: TRIG_TREPDOCS1_BI */
CREATE TRIGGER TRIG_TREPDOCS1_BI FOR TREPDOCS1
ACTIVE BEFORE INSERT POSITION 0
AS BEGIN
      IF(NEW."ID" IS NULL) THEN NEW."ID" = GEN_ID("GEN_TREPDOCS1_ID",1);
    END
^

/* Trigger: TRIG_TREPDOCS2_BI */
CREATE TRIGGER TRIG_TREPDOCS2_BI FOR TREPDOCS2
ACTIVE BEFORE INSERT POSITION 0
AS BEGIN
      IF(NEW."ID" IS NULL) THEN NEW."ID" = GEN_ID("GEN_TREPDOCS2_ID",1);
    END
^

/* Trigger: TRIG_TREPDOCSS_BI */
CREATE TRIGGER TRIG_TREPDOCSS_BI FOR TREPDOCSS
ACTIVE BEFORE INSERT POSITION 0
AS BEGIN
      IF(NEW."ID" IS NULL) THEN NEW."ID" = GEN_ID("GEN_TREPDOCSS_ID",1);
    END
^

/* Trigger: TRIG_TREPMT_BI */
CREATE TRIGGER TRIG_TREPMT_BI FOR TREPMT
ACTIVE BEFORE INSERT POSITION 0
AS BEGIN
      IF(NEW."ID" IS NULL) THEN NEW."ID" = GEN_ID("GEN_TREPMT_ID",1);
    END
^

/* Trigger: TRIG_TREPPVNZ1_BI */
CREATE TRIGGER TRIG_TREPPVNZ1_BI FOR TREPPVNZ1
ACTIVE BEFORE INSERT POSITION 0
AS BEGIN
      IF(NEW."ID" IS NULL) THEN NEW."ID" = GEN_ID("GEN_TREPPVNZ1_ID",1);
    END
^

/* Trigger: TRIG_TREPUDOCS_BI */
CREATE TRIGGER TRIG_TREPUDOCS_BI FOR TREPUDOCS
ACTIVE BEFORE INSERT POSITION 0
AS BEGIN
      IF(NEW."ID" IS NULL) THEN NEW."ID" = GEN_ID("GEN_TREPUDOCS_ID",1);
    END
^

/* Trigger: TRIG_TUDOCLISTS_BI */
CREATE TRIGGER TRIG_TUDOCLISTS_BI FOR TUDOCLISTS
ACTIVE BEFORE INSERT POSITION 0
AS BEGIN
      IF(NEW."ID" IS NULL) THEN NEW."ID" = GEN_ID("GEN_TUDOCLISTS_ID",1);
    END
^

/* Trigger: TRIG_TUDOCS_BI */
CREATE TRIGGER TRIG_TUDOCS_BI FOR TUDOCS
ACTIVE BEFORE INSERT POSITION 0
AS BEGIN
      IF(NEW."ID" IS NULL) THEN NEW."ID" = GEN_ID("GEN_TUDOCS_ID",1);
    END
^

/* Trigger: TRIG_TUPVN1_BI */
CREATE TRIGGER TRIG_TUPVN1_BI FOR TUPVN1
ACTIVE BEFORE INSERT POSITION 0
AS BEGIN
      IF(NEW."ID" IS NULL) THEN NEW."ID" = GEN_ID("GEN_TUPVN1_ID",1);
    END
^

/* Trigger: TTEMP_BALA21_BI0 */
CREATE TRIGGER TTEMP_BALA21_BI0 FOR TTEMP_BALA21
ACTIVE BEFORE INSERT POSITION 0
AS
BEGIN
      IF(NEW."ID" IS NULL) THEN NEW."ID" = GEN_ID("GEN_TTEMP_BALA21_ID",1);
END
^

/* Trigger: TTEMP_BALAC_BI0 */
CREATE TRIGGER TTEMP_BALAC_BI0 FOR TTEMP_BALAC
ACTIVE BEFORE INSERT POSITION 0
AS
BEGIN
      IF(NEW."ID" IS NULL) THEN NEW."ID" = GEN_ID("GEN_TTEMP_BALAC_ID",1);
END
^

/* Trigger: TTEMP_BALMT1_BI */
CREATE TRIGGER TTEMP_BALMT1_BI FOR TTEMP_BALMT1
ACTIVE BEFORE INSERT POSITION 0
as
begin
  if (new.id is null) then
    new.id = gen_id(gen_ttemp_balmt1_id,1);
end
^

/* Trigger: TTEMP_BALMT2_BI */
CREATE TRIGGER TTEMP_BALMT2_BI FOR TTEMP_BALMT2
ACTIVE BEFORE INSERT POSITION 0
as
begin
  if (new.id is null) then
    new.id = gen_id(gen_ttemp_balmt1_id,1);
end
^

/* Trigger: TTEMP_PVN1_BI */
CREATE TRIGGER TTEMP_PVN1_BI FOR TTEMP_PVN1
ACTIVE BEFORE INSERT POSITION 0
as
begin
  if (new.id is null) then
    new.id = gen_id(gen_ttemp_pvn1_id,1);
end
^
SET TERM ; ^



/******************************************************************************/
/***                           Stored procedures                            ***/
/******************************************************************************/



SET TERM ^ ;

ALTER PROCEDURE SP_BAL0_ID
RETURNS (
    NEXTID INTEGER)
AS
begin
    nextid = GEN_ID("GEN_BAL0_ID",1);
end^


ALTER PROCEDURE SP_BAL0_IDA
RETURNS (
    NEXTID INTEGER)
AS
begin
    nextid = GEN_ID("GEN_BAL0_ID",1);
    suspend;
end^


ALTER PROCEDURE SP_BALA2_ID
RETURNS (
    NEXTID INTEGER)
AS
begin
    nextid = GEN_ID("GEN_BALA2_ID",1);
    suspend;
end^


ALTER PROCEDURE SP_BALA3_ID
RETURNS (
    NEXTID INTEGER)
AS
begin
    nextid = GEN_ID("GEN_BALA3_ID",1);
    suspend;
end^


ALTER PROCEDURE SP_CURRCHECK_01 (
    SDT DATE,
    EDT DATE,
    PAC VARCHAR(8),
    PCLID VARCHAR(15),
    PCUR VARCHAR(3))
RETURNS (
    ID TYPE OF COLUMN ROPS1A.ID,
    SPID TYPE OF COLUMN ROPS1A.SPID,
    DID TYPE OF COLUMN ROPS1A.DID,
    DETE TYPE OF COLUMN ROPS1A.DETE,
    NRX TYPE OF COLUMN ROPS1A.NRX,
    DOCTYP TYPE OF COLUMN ROPS1A.DOCTYP,
    DOCTYP1 TYPE OF COLUMN ROPS1A.DOCTYP1,
    DOCTYP2 TYPE OF COLUMN ROPS1A.DOCTYP2,
    DOCST TYPE OF COLUMN ROPS1A.DOCST,
    DOCNR TYPE OF COLUMN ROPS1A.DOCNR,
    CLID TYPE OF COLUMN ROPS1A.CLID,
    CLID2 TYPE OF COLUMN ROPS1A.CLID2,
    NAME TYPE OF COLUMN ROPS1A.NAME,
    NAME2 TYPE OF COLUMN ROPS1A.NAME2,
    REGNR TYPE OF COLUMN ROPS1A.REGNR,
    REGNR2 TYPE OF COLUMN ROPS1A.REGNR2,
    B0 TYPE OF COLUMN ROPS1A.B0,
    DESCR TYPE OF COLUMN ROPS1A.DESCR,
    DESCR2 TYPE OF COLUMN ROPS1A.DESCR2,
    AC1 TYPE OF COLUMN ROPS1A.AC1,
    AC2 TYPE OF COLUMN ROPS1A.AC2,
    SAC1 TYPE OF COLUMN ROPS1A.SAC1,
    SAC2 TYPE OF COLUMN ROPS1A.SAC2,
    SUMMC TYPE OF COLUMN ROPS1A.SUMMC,
    CUR TYPE OF COLUMN ROPS1A.CUR,
    SUMM TYPE OF COLUMN ROPS1A.SUMM,
    PVN TYPE OF COLUMN ROPS1A.PVN,
    RAC TYPE OF COLUMN ROPS1A.RAC,
    SDB TYPE OF COLUMN ROPS1A.SDB,
    SCR TYPE OF COLUMN ROPS1A.SCR,
    RAC2 TYPE OF COLUMN ROPS1A.RAC2,
    RAC3 TYPE OF COLUMN ROPS1A.RAC3,
    RAC4 TYPE OF COLUMN ROPS1A.RAC4,
    RAC5 TYPE OF COLUMN ROPS1A.RAC5,
    QV TYPE OF COLUMN ROPS1A.QV,
    ZNR TYPE OF COLUMN ROPS1A.ZNR)
AS
begin
    FOR SELECT DISTINCT
        gen_id(GEN_ROPS2A_ID, 1) as id,
        current_connection as spid,
        OPSd.id AS did, 
        OPSd.Dete AS Dete,
        OPSd.NrX AS NrX,
        OPSd.DocTyp AS DocTyp,
        DocTyp.id1 AS DocTyp1, 
        null as DocTyp2,
        OPSd.DocSt AS DocSt,
        OPSd.DocNr AS DocNr,
        OPSd.ClId AS Clid,
        OPSd.ClId2 AS Clid2,
        Persons.Name AS Name, 
        Persons2.Name AS Name2, 
        Persons.RegNr AS RegNr,
        Persons2.RegNr AS RegNr2,
        0 AS b0, 
        OPSd.Descr AS Descr,
        null AS Descr2,
        null AS AC1,
        null AS AC2,
        null AS SAC1,
        null AS SAC2,
        0 AS SummC,
        null AS Cur,
        OPSd.Summ AS Summ,
        OPSd.PVN AS PVN,
        null AS Rac,
        0 AS Sdb,
        0 AS SCr,
        null AS Rac2,
        null AS Rac3,
        null AS Rac4,
        null AS Rac5,
        0 AS qv,
        OPSd.ZNR AS ZNR

    FROM OPSd
        JOIN OPS ON OPSd.id = OPS.DocId
        LEFT JOIN DocTyp ON OPSd.DocTyp = DocTyp.id
        LEFT JOIN Persons ON OPSd.ClId = Persons.ClId
        LEFT JOIN Persons AS Persons2 ON OPSd.ClId2 = Persons2.ClId        
        LEFT JOIN Currency ON Currency.id = OPS.cur AND Currency.dete = OPSd.Dete
    WHERE 
        OPSd.Dete BETWEEN :sdt AND :edt AND
        OPS.Cur <> 'EUR' AND
        (OPS.AC11 LIKE :pac OR OPS.AC21 LIKE :pac) AND
        (
            Currency.id IS NULL OR
            ROUND(OPS.SummC*Currency.rate,2) <> OPS.Summ
        )
    ORDER BY Dete, DocId


    into
        :id, :spid, :did, :DETE, :nrx,
        :doctyp, :doctyp1, :doctyp2, :docst, :docnr,
        :clid, :clid2, :name, :name2, :regnr, :regnr2,
        :b0, :descr, :descr2, :ac1, :ac2, :sac1,:sac2,
        :summc, :cur, :summ, :pvn, :rac, :sdb, :scr,
        :rac2, :rac3, :rac4, :rac5, :qv, :znr
    do
    begin
        suspend;
    end
end^


ALTER PROCEDURE SP_DIFF_01 (
    PDOCID INTEGER)
RETURNS (
    IDL TYPE OF COLUMN LOPSD.IDL,
    ID TYPE OF COLUMN LOPSD.ID,
    ZDT TYPE OF COLUMN LOPSD.ZDT,
    DTLD TYPE OF COLUMN LOPSD.DTLD,
    ODT TYPE OF COLUMN LOPSD.ODT,
    USL TYPE OF COLUMN LOPSD.USL,
    DETE TYPE OF COLUMN LOPSD.DETE,
    NRX TYPE OF COLUMN LOPSD.NRX,
    ZNR TYPE OF COLUMN LOPSD.ZNR,
    DOCTYP TYPE OF COLUMN LOPSD.DOCTYP,
    DOCST TYPE OF COLUMN LOPSD.DOCST,
    DOCNR TYPE OF COLUMN LOPSD.DOCNR,
    CLID TYPE OF COLUMN LOPSD.CLID,
    CLID2 TYPE OF COLUMN LOPSD.CLID2,
    DESCR TYPE OF COLUMN LOPSD.DESCR,
    SUMM TYPE OF COLUMN LOPSD.SUMM,
    PVN TYPE OF COLUMN LOPSD.PVN,
    ZU TYPE OF COLUMN LOPSD.ZU,
    TPL INTEGER)
AS
begin
  for select *
  from
  (
    select
        idl, id, zdt, dtld, odt, usl, dete, nrx, znr,
        doctyp, docst, docnr, clid, clid2, descr,
        summ, pvn, zu, 1 as tpl
    from lopsd
    where id = :pdocid

    union all

    select
        -9999999 as idl, id, null as zdt, null as dtld,
        zdt as odt, null as usl, dete, nrx, znr,
        doctyp, docst, docnr, clid, clid2, descr,
        summ, pvn, zu, 2 as tpl
    from opsd
    where id = :pdocid

  )
  into
    :idl, :id, :zdt, :dtld, :odt, :usl, :dete, :nrx, :znr,
    :doctyp, :docst, :docnr, :clid, :clid2, :descr,
    :summ, :pvn, :zu, :tpl
  do
    suspend;
end^


ALTER PROCEDURE SP_DIFF_02 (
    PDOCID INTEGER)
RETURNS (
    IDL TYPE OF COLUMN LOPS.IDL,
    DOCID TYPE OF COLUMN LOPS.DOCID,
    ID TYPE OF COLUMN LOPS.ID,
    DTL TYPE OF COLUMN LOPS.DTL,
    DTLD TYPE OF COLUMN LOPS.DTLD,
    ODT TYPE OF COLUMN LOPS.ODT,
    USL TYPE OF COLUMN LOPS.USL,
    AC11 TYPE OF COLUMN LOPS.AC11,
    AC12 TYPE OF COLUMN LOPS.AC12,
    AC13 TYPE OF COLUMN LOPS.AC13,
    AC14 TYPE OF COLUMN LOPS.AC14,
    AC15 TYPE OF COLUMN LOPS.AC15,
    AC21 TYPE OF COLUMN LOPS.AC21,
    AC22 TYPE OF COLUMN LOPS.AC22,
    AC23 TYPE OF COLUMN LOPS.AC23,
    AC24 TYPE OF COLUMN LOPS.AC24,
    AC25 TYPE OF COLUMN LOPS.AC25,
    SUMMC TYPE OF COLUMN LOPS.SUMMC,
    CUR TYPE OF COLUMN LOPS.CUR,
    SUMM TYPE OF COLUMN LOPS.SUMM,
    QV TYPE OF COLUMN LOPS.QV,
    TPL INTEGER)
AS
begin
  for select *
  from
  (
    select
        idl, docid, id, dtl, dtld, odt, usl,
        ac11, ac12, ac13, ac14, ac15,
        ac21, ac22, ac23, ac24, ac25,
        summc, cur, summ, qv, 1 as tpl
    from lops
    where docid = :pdocid

    union all

    select
        -9999999 + id as idl, docid, id, null as dtl,
        null as dtld, zdt as odt, null as usl,
        ac11, ac12, ac13, ac14, ac15,
        ac21, ac22, ac23, ac24, ac25,
        summc, cur, summ, qv, 2 as tpl
    from ops
    where docid = :pdocid

  )
  into
    :idl, :docid, :id, :dtl, :dtld, :odt, :usl,
    :ac11, :ac12, :ac13, :ac14, :ac15,
    :ac21, :ac22, :ac23, :ac24, :ac25,
    :summc, :cur, :summ, :qv, :tpl
  do
    suspend;
end^


ALTER PROCEDURE SP_DIFF_11 (
    PDATE1 DATE,
    PDATE2 DATE,
    PDATE3 DATE)
RETURNS (
    IDL1 TYPE OF COLUMN LOPSD.IDL,
    IDL2 TYPE OF COLUMN LOPS.IDL,
    DOCID TYPE OF COLUMN LOPSD.ID,
    ROWID TYPE OF COLUMN LOPS.ID)
AS
begin
    for select distinct
        idl1, idl2, docid, rowid
    from
    (
        select
            T3.idl as idl1,
            T4.idl as idl2,
            T3.id as docid,
            T4.id as rowid
        from
        (
            select T1.idl, T1.id
            from lopsd as T1
            where
                T1.dete between :pdate1 and :pdate2 and
                T1.odt < :pdate3 and
                not exists (
                    select idl
                    from lopsd as T2
                    where
                        T2.id = T1.id and
                        T2.odt < :pdate3 and
                        (T2.odt > T1.odt or
                        T2.odt = T1.odt and
                        T2.idl > T1.idl)
                )
        ) as T3
        join lops as T4
        on T3.id = T4.docid and
            T4.odt < :pdate3 and
            not exists (
                select idl
                from lops as T5
                where
                    T5.id = T4.id and
                    T5.odt < :pdate3 and
                    (T5.odt > T4.odt or
                    T5.odt = T4.odt and
                    T5.idl > T4.idl)
                    
            )

        union all

        select
            T4.idl as idl1,
            null as idl2,
            T4.id as docid,
            T5.id as rowid
        from
        (
            select T1.idl, T1.id
            from lopsd as T1
            where
                T1.dete between :pdate1 and :pdate2 and
                T1.odt < :pdate3 and
                not exists (
                    select idl
                    from lopsd as T2
                    where
                        T2.id = T1.id and
                        T2.odt < :pdate3 and
                        (T2.odt > T1.odt or
                        T2.odt = T1.odt and
                        T2.idl > T1.idl)
                )
                and not exists (
                    select idl
                    from lops as T3
                    where T3.docid = T1.id
                )
        ) as T4
        join ops as T5
        on T5.id = T4.id and
            T5.zdt < :pdate3
    )
    into
        :idl1, :idl2, :docid, :rowid
    do
    suspend;
end^


ALTER PROCEDURE SP_DIFF_12 (
    PDATE1 DATE,
    PDATE2 DATE,
    PDATE3 DATE,
    PCLID VARCHAR(15),
    PAC1 VARCHAR(8),
    PAC2 VARCHAR(8),
    PAC3 VARCHAR(5),
    PAC4 VARCHAR(8),
    PAC5 VARCHAR(5))
RETURNS (
    TP INTEGER,
    DOCID TYPE OF COLUMN OPS.DOCID,
    ROWID TYPE OF COLUMN OPS.ID,
    DOCDTL TIMESTAMP,
    DOCDTLD TIMESTAMP,
    DOCODT TIMESTAMP,
    ROWDTL TIMESTAMP,
    ROWDTLD TIMESTAMP,
    ROWODT TIMESTAMP,
    DETE TYPE OF COLUMN OPSD.DETE,
    ZNR TYPE OF COLUMN OPSD.ZNR,
    NRX TYPE OF COLUMN OPSD.NRX,
    DOCTYP TYPE OF COLUMN OPSD.DOCTYP,
    DOCST TYPE OF COLUMN OPSD.DOCST,
    DOCNR TYPE OF COLUMN OPSD.DOCNR,
    DOCTYP2 TYPE OF COLUMN DOCTYP.ID1,
    CLID TYPE OF COLUMN OPSD.CLID,
    CLID2 TYPE OF COLUMN OPSD.CLID2,
    DESCR TYPE OF COLUMN OPSD.DESCR,
    DOCSUMM TYPE OF COLUMN OPSD.SUMM,
    DOCPVN TYPE OF COLUMN OPSD.PVN,
    AC11 TYPE OF COLUMN OPS.AC11,
    AC12 TYPE OF COLUMN OPS.AC12,
    AC13 TYPE OF COLUMN OPS.AC13,
    AC14 TYPE OF COLUMN OPS.AC14,
    AC15 TYPE OF COLUMN OPS.AC15,
    AC21 TYPE OF COLUMN OPS.AC21,
    AC22 TYPE OF COLUMN OPS.AC22,
    AC23 TYPE OF COLUMN OPS.AC23,
    AC24 TYPE OF COLUMN OPS.AC24,
    AC25 TYPE OF COLUMN OPS.AC25,
    SUMMC TYPE OF COLUMN OPS.SUMMC,
    CUR TYPE OF COLUMN OPS.CUR,
    SUMM TYPE OF COLUMN OPS.SUMM,
    QV TYPE OF COLUMN OPS.QV,
    DESCR2 TYPE OF COLUMN OPS.DESCR)
AS
begin

    insert into
    ttemp_diff2(idl1, idl2, docid, rowid)
    select distinct idl1, idl2, docid, rowid
    from sp_diff_11(:pdate1, :pdate2, :pdate3) as T1
    where exists (
        select idl
        from lopsd
        where
            T1.docid = lopsd.id and
            lopsd.dtld > :pdate3

        union all

        select idl
        from lops
        where
            T1.rowid = lops.id and
            lops.dtld > :pdate3

        union all

        select id
        from opsd
        where
            T1.docid = opsd.id and
            opsd.zdt > :pdate3

        union all

        select id
        from ops
        where
            T1.rowid = ops.id and
            ops.zdt > :pdate3
    );

    for select distinct *
    from
    (
        select
            1 as tp,
            lops.docid, lops.id as rowid,
            lopsd.zdt as docdtl, lopsd.dtld as docdtld, lopsd.odt as docodt,
            lops.dtl as rowdtl, lops.dtld as rowdtld, lops.odt as rowodt,
            lopsd.dete, lopsd.znr, lopsd.nrx,
            lopsd.doctyp, lopsd.docst, lopsd.docnr,
            lopsd.clid, lopsd.clid2, lopsd.descr, 
            lopsd.summ as docsumm, lopsd.pvn as docpvn, 
            lops.ac11,  lops.ac12, lops.ac13, lops.ac14, lops.ac15,
            lops.ac21,  lops.ac22, lops.ac23, lops.ac24, lops.ac25,
            lops.summc, lops.cur, lops.summ, lops.qv, null as descr2
    
        from ttemp_diff2 as T1
        join lopsd on T1.idl1 = lopsd.idl
        join lops on T1.idl2 = lops.idl
        where
            (:pclid is null or :pclid = lopsd.clid) and
            (:pac1 is null or :pac1 = lops.ac11 or :pac1 = lops.ac21) and
            (:pac2 is null or :pac2 = lops.ac12 or :pac2 = lops.ac22) and
            (:pac3 is null or :pac3 = lops.ac13 or :pac3 = lops.ac23) and
            (:pac4 is null or :pac4 = lops.ac14 or :pac4 = lops.ac24) and
            (:pac5 is null or :pac5 = lops.ac15 or :pac5 = lops.ac25)

    union all

        select
            1 as tp,
            lops.docid, lops.id as rowid,
            lopsd.zdt as docdtl, lopsd.dtld as docdtld, lopsd.odt as docodt,
            lops.dtl as rowdtl, lops.dtld as rowdtld, lops.odt as rowodt,
            lopsd.dete, lopsd.znr, lopsd.nrx,
            lopsd.doctyp, lopsd.docst, lopsd.docnr,
            lopsd.clid, lopsd.clid2, lopsd.descr, 
            lopsd.summ as docsumm, lopsd.pvn as docpvn, 
            lops.ac11,  lops.ac12, lops.ac13, lops.ac14, lops.ac15,
            lops.ac21,  lops.ac22, lops.ac23, lops.ac24, lops.ac25,
            lops.summc, lops.cur, lops.summ, lops.qv, null as descr2

        from ttemp_diff2 as T1
        join lopsd on T1.idl1 = lopsd.idl
        join lops on T1.idl2 = lops.idl
        join ops on T1.rowid = ops.id
        join opsd on ops.docid = opsd.id
        where
            (not (
                (:pclid is null or :pclid = lopsd.clid) and
                (:pac1 is null or :pac1 = lops.ac11 or :pac1 = lops.ac21) and
                (:pac2 is null or :pac2 = lops.ac12 or :pac2 = lops.ac22) and
                (:pac3 is null or :pac3 = lops.ac13 or :pac3 = lops.ac23) and
                (:pac4 is null or :pac4 = lops.ac14 or :pac4 = lops.ac24) and
                (:pac5 is null or :pac5 = lops.ac15 or :pac5 = lops.ac25)
            )) and (
                (:pclid is null or :pclid = opsd.clid) and
                (:pac1 is null or :pac1 = ops.ac11 or :pac1 = ops.ac21) and
                (:pac2 is null or :pac2 = ops.ac12 or :pac2 = ops.ac22) and
                (:pac3 is null or :pac3 = ops.ac13 or :pac3 = ops.ac23) and
                (:pac4 is null or :pac4 = ops.ac14 or :pac4 = ops.ac24) and
                (:pac5 is null or :pac5 = ops.ac15 or :pac5 = ops.ac25)
            )

    union all

        select
            2 as tp,
            ops.docid, ops.id as rowid,
            null as docdtl, null as docdtld, opsd.zdt as docodt,
            null as rowdtl, null as rowdtld, ops.zdt as rowodt,
            opsd.dete, opsd.znr, opsd.nrx,
            opsd.doctyp, opsd.docst, opsd.docnr,
            opsd.clid, opsd.clid2, opsd.descr,
            opsd.summ as docsumm, opsd.pvn as docpvn,
            ops.ac11,  ops.ac12, ops.ac13, ops.ac14, ops.ac15,
            ops.ac21,  ops.ac22, ops.ac23, ops.ac24, ops.ac25,
            ops.summc, ops.cur, ops.summ, ops.qv, ops.descr as descr2
    
        from ttemp_diff2 as T1
        join lopsd on T1.idl1 = lopsd.idl
        join lops on T1.idl2 = lops.idl
        join ops on T1.rowid = ops.id
        join opsd on ops.docid = opsd.id
        where
            (
                (:pclid is null or :pclid = lopsd.clid) and
                (:pac1 is null or :pac1 = lops.ac11 or :pac1 = lops.ac21) and
                (:pac2 is null or :pac2 = lops.ac12 or :pac2 = lops.ac22) and
                (:pac3 is null or :pac3 = lops.ac13 or :pac3 = lops.ac23) and
                (:pac4 is null or :pac4 = lops.ac14 or :pac4 = lops.ac24) and
                (:pac5 is null or :pac5 = lops.ac15 or :pac5 = lops.ac25)
            ) or (
                (:pclid is null or :pclid = opsd.clid) and
                (:pac1 is null or :pac1 = ops.ac11 or :pac1 = ops.ac21) and
                (:pac2 is null or :pac2 = ops.ac12 or :pac2 = ops.ac22) and
                (:pac3 is null or :pac3 = ops.ac13 or :pac3 = ops.ac23) and
                (:pac4 is null or :pac4 = ops.ac14 or :pac4 = ops.ac24) and
                (:pac5 is null or :pac5 = ops.ac15 or :pac5 = ops.ac25)
            )     

    union all

        select
            3 as tp,
            lops.docid, lops.id as rowid,
            lopsd.zdt as docdtl, lopsd.dtld as docdtld, lopsd.odt as docodt,
            lops.dtl as rowdtl, lops.dtld as rowdtld, lops.odt as rowodt,
            lopsd.dete, lopsd.znr, lopsd.nrx,
            lopsd.doctyp, lopsd.docst, lopsd.docnr,
            lopsd.clid, lopsd.clid2, lopsd.descr, 
            lopsd.summ as docsumm, lopsd.pvn as docpvn, 
            lops.ac11,  lops.ac12, lops.ac13, lops.ac14, lops.ac15,
            lops.ac21,  lops.ac22, lops.ac23, lops.ac24, lops.ac25,
            lops.summc, lops.cur, lops.summ, lops.qv, null as descr2

        from ttemp_diff2 as T1
        join lopsd on T1.idl1 = lopsd.idl
        join lops on T1.idl2 = lops.idl
        join lops as lops2 on T1.rowid = lops2.id and lops2.dtld > :pdate3
        join lopsd as lopsd2 on lopsd2.id = lops2.docid and
            not exists(
                select idl
                from lopsd as lopsd3
                where lopsd2.id = lopsd3.id and lopsd3.zdt > lopsd2.dtld
            )
        where
            (
                (:pclid is null or :pclid = lopsd.clid) and
                (:pac1 is null or :pac1 = lops.ac11 or :pac1 = lops.ac21) and
                (:pac2 is null or :pac2 = lops.ac12 or :pac2 = lops.ac22) and
                (:pac3 is null or :pac3 = lops.ac13 or :pac3 = lops.ac23) and
                (:pac4 is null or :pac4 = lops.ac14 or :pac4 = lops.ac24) and
                (:pac5 is null or :pac5 = lops.ac15 or :pac5 = lops.ac25)
            ) or (
                (:pclid is null or :pclid = lopsd2.clid) and
                (:pac1 is null or :pac1 = lops2.ac11 or :pac1 = lops2.ac21) and
                (:pac2 is null or :pac2 = lops2.ac12 or :pac2 = lops2.ac22) and
                (:pac3 is null or :pac3 = lops2.ac13 or :pac3 = lops2.ac23) and
                (:pac4 is null or :pac4 = lops2.ac14 or :pac4 = lops2.ac24) and
                (:pac5 is null or :pac5 = lops2.ac15 or :pac5 = lops2.ac25)
            )

    union all

        select
            4 as tp,
            ops.docid, ops.id as rowid,
            null as docdtl, null as docdtld, opsd.zdt as docodt,
            null as rowdtl, null as rowdtld, ops.zdt as rowodt,
            opsd.dete, opsd.znr, opsd.nrx,
            opsd.doctyp, opsd.docst, opsd.docnr,
            opsd.clid, opsd.clid2, opsd.descr,
            opsd.summ as docsumm, opsd.pvn as docpvn,
            ops.ac11,  ops.ac12, ops.ac13, ops.ac14, ops.ac15,
            ops.ac21,  ops.ac22, ops.ac23, ops.ac24, ops.ac25,
            ops.summc, ops.cur, ops.summ, ops.qv, ops.descr as descr2
    
        from
            opsd join ops
            on
                ops.docid = opsd.id and
                opsd.dete between :pdate1 and :pdate2 and
                opsd.zdt > :pdate3
            left join ttemp_diff2 as T1
            on ops.id = T1.rowid
        where
            T1.idl1 is null and
            (:pclid is null or :pclid = opsd.clid) and
            (:pac1 is null or :pac1 = ops.ac11 or :pac1 = ops.ac21) and
            (:pac2 is null or :pac2 = ops.ac12 or :pac2 = ops.ac22) and
            (:pac3 is null or :pac3 = ops.ac13 or :pac3 = ops.ac23) and
            (:pac4 is null or :pac4 = ops.ac14 or :pac4 = ops.ac24) and
            (:pac5 is null or :pac5 = ops.ac15 or :pac5 = ops.ac25)

    union all

        select
            5 as tp,
            ops.docid, ops.id as rowid,
            lopsd.zdt as docdtl, lopsd.dtld as docdtld, lopsd.odt as docodt,
            null as rowdtl, null as rowdtld, ops.zdt as rowodt,
            lopsd.dete, lopsd.znr, lopsd.nrx,
            lopsd.doctyp, lopsd.docst, lopsd.docnr,
            lopsd.clid, lopsd.clid2, lopsd.descr, 
            lopsd.summ as docsumm, lopsd.pvn as docpvn, 
            ops.ac11,  ops.ac12, ops.ac13, ops.ac14, ops.ac15,
            ops.ac21,  ops.ac22, ops.ac23, ops.ac24, ops.ac25,
            ops.summc, ops.cur, ops.summ, ops.qv, ops.descr as descr2

        from ttemp_diff2 as T1
        join lopsd on T1.idl1 = lopsd.idl and T1.idl2 = null
        join ops on T1.rowid = ops.id
        join opsd on ops.docid = opsd.id
        where
            (
                (:pclid is null or :pclid = lopsd.clid)
            ) or (
                (:pclid is null or :pclid = opsd.clid) and
                (:pac1 is null or :pac1 = ops.ac11 or :pac1 = ops.ac21) and
                (:pac2 is null or :pac2 = ops.ac12 or :pac2 = ops.ac22) and
                (:pac3 is null or :pac3 = ops.ac13 or :pac3 = ops.ac23) and
                (:pac4 is null or :pac4 = ops.ac14 or :pac4 = ops.ac24) and
                (:pac5 is null or :pac5 = ops.ac15 or :pac5 = ops.ac25)
            )


    )
    order by docid, rowid, tp, iif(rowodt > docodt, docodt, rowodt)
    into
        :tp, :docid, :rowid,
        :docdtl, :docdtld, :docodt,
        :rowdtl, :rowdtld, :rowodt,
        :dete, :znr, :nrx, 
        :doctyp, :docst, :docnr,
        :clid, :clid2, :descr, 
        :docsumm, :docpvn,
        :ac11, :ac12, :ac13, :ac14, :ac15, 
        :ac21, :ac22, :ac23, :ac24, :ac25,
        :summc, :cur, :summ, :qv, :descr2

    do
    suspend;
end^


ALTER PROCEDURE SP_DOCS0_ID
RETURNS (
    NEXTID INTEGER)
AS
begin
    nextid = GEN_ID("GEN_DOCS0_ID",1);
    suspend;
end^


ALTER PROCEDURE SP_FIXLOPSODT
AS
declare variable vidl integer;
declare variable viddoc integer;
declare variable vidrow integer;
declare variable vpid integer;
declare variable vdt timestamp;
declare variable vdt2 timestamp;
declare variable vpdt timestamp;
declare variable vodt timestamp;
begin
    vpid = null;
    vpdt = null;

    for select idl, id, docid, adt, odt
    from
    (
        select idl, id, docid, iif(dtld is null, dtl, dtld) as adt, odt
        from lops
    ) as T1
    order by id, adt
    into :vidl, :vidrow, :viddoc, :vdt, :vodt
    do
    begin
        if (vpid is null or vpid <> vidrow) then begin

            vpid = vidrow;
            vpdt = vdt;

            if (vodt is null) then begin

                vdt2 = null;

                select min(iif(dtld is null, zdt, dtld))
                from lopsd
                where id = :viddoc
                into :vdt2;

                if (vdt2 is not null) then begin

                    select first 1 dete
                    from lopsd
                    where id = :viddoc and :vdt2 = (iif(dtld is null, zdt, dtld))
                    order by idl
                    into :vdt2;

               end else begin

                    select dete
                    from opsd
                    where opsd.id = :viddoc
                    into :vdt2;

               end

               update lops set odt = :vdt2 where idl = :vidl;

            end
        end else begin

            if (:vpdt is not null) then begin
               update lops set odt = :vpdt where idl = :vidl;
            end

            vpdt = vdt;

        end
    end

    vpid = null;
    vpdt = null;

    for select idl, id, adt, dete, odt
    from
    (
        select idl, id, iif(dtld is null, zdt, dtld) as adt, dete, odt
        from lopsd
    ) as T1
    order by id, adt
    into :vidl, :viddoc, :vdt, :vdt2, :vodt
    do
    begin
        if (vpid is null or vpid <> viddoc) then begin

            vpid = viddoc;
            vpdt = vdt;

            if (vodt is null) then begin

               vdt = vdt2;
               update lopsd set odt = :vdt2 where idl = :vidl;

            end

        end else begin

            if (:vpdt is not null) then begin
               update lopsd set odt = :vpdt where idl = :vidl;
            end

            vpdt = vdt;

        end
    end


end^


ALTER PROCEDURE SP_FIXOPSDATES
AS
declare variable vid integer;
declare variable vzdt timestamp;
begin
    for select ops.id, opsd.zdt
    from ops join opsd
    on ops.docid = opsd.id and ops.zdt is null
    into :vid, :vzdt
    do
    begin
        update ops
        set ops.zdt = :vzdt
        where ops.id = :vid and ops.zdt is null;
    end
end^


ALTER PROCEDURE SP_GEN_M_ADDRESSSES_ID
RETURNS (
    ID INTEGER)
AS
begin
  id = gen_id(gen_m_addressses_id, 1);
  suspend;
end^


ALTER PROCEDURE SP_GEN_M_AUX_ID
RETURNS (
    ID INTEGER)
AS
begin
  id = gen_id(gen_m_aux_id, 1);
  suspend;
end^


ALTER PROCEDURE SP_GEN_M_BANKACCOUNTS_ID
RETURNS (
    ID INTEGER)
AS
begin
  id = gen_id(gen_m_banks_id, 1);
  suspend;
end^


ALTER PROCEDURE SP_GEN_M_BANKS_ID
RETURNS (
    ID INTEGER)
AS
begin
  id = gen_id(gen_m_banks_id, 1);
  suspend;
end^


ALTER PROCEDURE SP_GEN_M_CONTACTS_ID
RETURNS (
    ID INTEGER)
AS
begin
  id = gen_id(gen_m_contacts_id, 1);
  suspend;
end^


ALTER PROCEDURE SP_GEN_M_COUNTRIES_ID
RETURNS (
    ID INTEGER)
AS
begin
  id = gen_id(gen_m_countries_id, 1);
  suspend;
end^


ALTER PROCEDURE SP_GEN_M_DOCS_ID
RETURNS (
    ID INTEGER)
AS
begin
  id = gen_id(gen_m_docs_id, 1);
  suspend;
end^


ALTER PROCEDURE SP_GEN_M_DOCSEQ
RETURNS (
    ID INTEGER)
AS
begin
  id = gen_id(gen_m_docseq, 1);
  suspend;
end^


ALTER PROCEDURE SP_GEN_M_DOCTYPES_ID
RETURNS (
    ID INTEGER)
AS
begin
  id = gen_id(gen_m_doctypes_id, 1);
  suspend;
end^


ALTER PROCEDURE SP_GEN_M_ITEMS_CAT_ID
RETURNS (
    ID INTEGER)
AS
begin
  id = gen_id(gen_m_items_cat_id, 1);
  suspend;
end^


ALTER PROCEDURE SP_GEN_M_ITEMS_ID
RETURNS (
    ID INTEGER)
AS
begin
  id = gen_id(gen_m_items_id, 1);
  suspend;
end^


ALTER PROCEDURE SP_GEN_M_PAYMENTTYPE_ID
RETURNS (
    ID INTEGER)
AS
begin
  id = gen_id(gen_m_paymenttype_id, 1);
  suspend;
end^


ALTER PROCEDURE SP_GEN_M_PVNRATES_ID
RETURNS (
    ID INTEGER)
AS
begin
  id = gen_id(gen_m_pvnrates_id, 1);
  suspend;
end^


ALTER PROCEDURE SP_GEN_M_PVNRATES2_ID
RETURNS (
    ID INTEGER)
AS
begin
  id = gen_id(gen_m_pvnrates2_id, 1);
  suspend;
end^


ALTER PROCEDURE SP_GEN_M_PVNTEXTS_ID
RETURNS (
    ID INTEGER)
AS
begin
  id = gen_id(gen_m_pvntexts_id, 1);
  suspend;
end^


ALTER PROCEDURE SP_GEN_M_ROWS_ID
RETURNS (
    ID INTEGER)
AS
begin
  id = gen_id(gen_m_rows_id, 1);
  suspend;
end^


ALTER PROCEDURE SP_GEN_M_STORES_ID
RETURNS (
    ID INTEGER)
AS
begin
  id = gen_id(gen_m_stores_id, 1);
  suspend;
end^


ALTER PROCEDURE SP_GEN_M_STORETYPE_ID
RETURNS (
    ID INTEGER)
AS
begin
  id = gen_id(gen_m_storetype_id, 1);
  suspend;
end^


ALTER PROCEDURE SP_GEN_M_TRANSACTIONTYPE_ID
RETURNS (
    ID INTEGER)
AS
begin
  id = gen_id(gen_m_transactiontype_id, 1);
  suspend;
end^


ALTER PROCEDURE SP_GEN_M_UNITS_ID
RETURNS (
    ID INTEGER)
AS
begin
  id = gen_id(gen_m_units_id, 1);
  suspend;
end^


ALTER PROCEDURE SP_GEN_M_VEHICLES_ID
RETURNS (
    ID INTEGER)
AS
begin
  id = gen_id(gen_m_vehicles_id, 1);
  suspend;
end^


ALTER PROCEDURE SP_LINKEDDOCS_1 (
    PSD DATE,
    PED DATE,
    PCLID VARCHAR(15),
    PDOCNR VARCHAR(15))
RETURNS (
    ID INTEGER,
    DETE DATE,
    CLID VARCHAR(15),
    DOCTYP VARCHAR(10),
    DOCST VARCHAR(6),
    DOCNR VARCHAR(15),
    DESCR VARCHAR(80),
    SUMM NUMERIC(15,4),
    PVN NUMERIC(15,4))
AS
declare variable k integer;
begin
    k = GEN_ID("GEN_OPSD_ID",0) + 1;

    FOR SELECT
        ID,
        DETE,
        clid,
        (DocTyp),
        DocSt,
        DocNr,
        Descr,
        Summ,
        PVN
    FROM
    (
        SELECT
            NULL AS ID,
            DETE,
            DOCS0.clid,
            DOCS0.DocTyp,
            DOCS0.DocSt,
            DOCS0.DocNr,
            DOCS0.Descr,
            CASE WHEN DOCS0.ac STARTING WITH '2'
                THEN summ
                ELSE -summ
            END AS Summ,
            CASE WHEN DOCS0.ac STARTING WITH '2'
                THEN pvn
                ELSE -pvn
            END AS PVN
        FROM DOCS0
        WHERE
            DOCS0.ClId = :PCLID AND
            (:PDOCNR is null OR DOCS0.DocNr = :PDOCNR)

        UNION ALL
    
        SELECT
            opsd.id,
            opsd.DETE,
            opsd.clid,
            opsd.DocTyp,
            opsd.DocSt,
            opsd.DocNr,
            opsd.Descr,
            CASE WHEN AP1 = 1 OR AP2 = 1
                THEN -OPSd.Summ
                ELSE OPSd.Summ
            END AS Summ,
            CASE WHEN AP1 = 1 OR AP2 = 1
                THEN -OPSd.PVN
                ELSE OPSd.PVN
            END AS PVN
        FROM
        (
            SELECT 
                OPSd.id, 
                MAX(CASE WHEN AcP21_1.AC IS NULL THEN 0 ELSE 1 END) AS AP1,
                MAX(CASE WHEN AcP21_2.AC IS NULL THEN 0 ELSE 1 END) AS AP2
            FROM
                OPS INNER JOIN OPSd ON OPSd.id = OPS.DocId
                LEFT JOIN AcP21 AS AcP21_1 ON OPS.AC11 = AcP21_1.AC AND AcP21_1.id1 IN ('KA','BA','CN')
                LEFT JOIN AcP21 AS AcP21_2 ON OPS.AC21 = AcP21_2.AC AND AcP21_2.id1 IN ('KA','BA','CN')
            WHERE
                OPSd.DETE BETWEEN :PSD AND :PED AND
                opsd.ClId = :PCLID AND
                (:PDOCNR is null OR opsd.DocNr = :PDOCNR)
            GROUP BY OPSd.id
        ) AS T1 
        INNER JOIN OPSd ON T1.id = OPSd.id

    )
    order by DETE

    INTO :ID, :DETE, :clid, :doctyp, :docst, :docnr, :descr, :summ, :pvn
    do
    begin
        if (ID is null) then
        begin
            ID = k;
            k = k + 1;
        end
        suspend;
    end
end^


ALTER PROCEDURE SP_LINKEDDOCS_2 (
    PSD DATE,
    PED DATE,
    PCLID VARCHAR(15),
    PDOCNR VARCHAR(15))
RETURNS (
    ID TYPE OF COLUMN OPS.ID,
    DOCID TYPE OF COLUMN OPS.DOCID,
    DESCR TYPE OF COLUMN OPS.DESCR,
    AC11 TYPE OF COLUMN OPS.AC11,
    AC12 TYPE OF COLUMN OPS.AC12,
    AC13 TYPE OF COLUMN OPS.AC13,
    AC14 TYPE OF COLUMN OPS.AC14,
    AC15 TYPE OF COLUMN OPS.AC15,
    AC21 TYPE OF COLUMN OPS.AC21,
    AC22 TYPE OF COLUMN OPS.AC22,
    AC23 TYPE OF COLUMN OPS.AC23,
    AC24 TYPE OF COLUMN OPS.AC24,
    AC25 TYPE OF COLUMN OPS.AC25,
    SUMMC TYPE OF COLUMN OPS.SUMMC,
    CUR TYPE OF COLUMN OPS.CUR,
    SUMM TYPE OF COLUMN OPS.SUMM,
    QV TYPE OF COLUMN OPS.QV,
    NL TYPE OF COLUMN OPS.NL,
    ZDT TYPE OF COLUMN OPS.ZDT)
AS
begin
  for select ops.id,
             ops.docid,
             ops.descr,
             ops.ac11,
             ops.ac12,
             ops.ac13,
             ops.ac14,
             ops.ac15,
             ops.ac21,
             ops.ac22,
             ops.ac23,
             ops.ac24,
             ops.ac25,
             ops.summc,
             ops.cur,
             ops.summ,
             ops.qv,
             ops.nl,
             ops.zdt

      FROM OPSd INNER JOIN OPS ON OPSd.id = OPS.DocId
      WHERE
        opsd.DETE BETWEEN :PSD AND :PED AND
        ClId = :PCLID AND
        (:PDOCNR is null OR opsd.DocNr = :PDOCNR)
      ORDER BY OPSd.DETE, OPS.id
      into :id,
           :docid,
           :descr,
           :ac11,
           :ac12,
           :ac13,
           :ac14,
           :ac15,
           :ac21,
           :ac22,
           :ac23,
           :ac24,
           :ac25,
           :summc,
           :cur,
           :summ,
           :qv,
           :nl,
           :zdt
  do
  begin
    suspend;
  end
end^


ALTER PROCEDURE SP_M_CALC_DOC_AMOUNTS (
    PIDDOC INTEGER,
    PISREVERSED INTEGER)
AS
    declare vtrackstockout integer;
    declare vtrackstockin integer;
    declare vamountindoc damount;
    declare vamountinstore damount;
    declare viditem integer;
    declare vidrow integer;
    declare vidstoreout integer;
    declare vidstorein integer;
    declare vtemp integer;
    declare vdoctp integer;
    declare vdt date;
    declare vtp integer;
    declare vlastsaledate date;
begin
    select
        D1.dt, 
        D1.tp,
        D1.idstoreout,
        D1.idstorein,
        STPout.trackstock as trout,
        STPin.trackstock as trin
    from m_docs as D1
    join m_stores as STout on D1.id = :piddoc and
        STout.id = D1.idstoreout
    join m_stores as STin on STin.id = D1.idstorein
    join m_storetype as STPout on STPout.id = STout.tp
    join m_storetype as STPin on STPin.id = STin.tp
    into :vdt, :vdoctp, :vidstoreout, :vidstorein,
        :vtrackstockout, :vtrackstockin;
    
    if ((vtrackstockout = 0) and (vtrackstockin = 0)) then exit;

    if (pisreversed = 1) then
    begin
        vtemp = vidstoreout;
        vidstoreout = vidstorein;
        vidstorein = vtemp;

        vtemp = vtrackstockout;
        vtrackstockout = vtrackstockin;
        vtrackstockin = vtemp;
    end

    for select
        R1.id, R1.iditem, R1.amount, D1.tp
    from m_docs as D1
    join m_rows as R1 on D1.id = :piddoc and
        D1.id = R1.iddoc
    join m_items as IT1 on IT1.id = R1.iditem and
        IT1.isservice = 0
    into :vidrow, :viditem, :vamountindoc, :vtp
    do
    begin
        if (vtp in (5, 7)) then
        begin
            if (vamountindoc >= 0) then
                exception ex_failure 'Amount must be negative for ' || :vidrow;
        end else
        begin
            if (vamountindoc <= 0) then
                exception ex_failure 'Amount cant be < 0 for ' || :vidrow;
        end

        select amountinstore, lastsaledate
        from m_items
        where id = :viditem
        into :vamountinstore, :vlastsaledate;

        if (vtrackstockout = 1) then
        begin
            if (vtrackstockin = 0) then
            begin
                if (vamountinstore < vamountindoc) then
                    exception ex_failure 'Not enough amount in stock '
                        || 'item:[' || :viditem || ']';

                if (vdoctp = 3) then
                    if ((vlastsaledate is null) or (vlastsaledate < vdt))
                    then vlastsaledate = vdt;

                update m_items
                set amountinstore = amountinstore - :vamountindoc
                where id = :viditem;
            end

            select amount
            from m_items_per_store
            where iditem = :viditem and idstore = :vidstoreout
            into :vamountinstore;

            vamountinstore = coalesce(vamountinstore, 0) - vamountindoc;

            if (vamountinstore < 0) then
                exception ex_failure 'Not enough amount in stock '
                    || 'item:[' || :viditem || ']'
                    || 'store:[' || :vidstoreout || ']';
        
            update or insert into m_items_per_store
            values (:viditem, :vidstoreout, :vamountinstore);
        end

        if (vtrackstockin = 1) then
        begin
            if (vtrackstockout = 0) then
            begin
                update m_items
                set amountinstore = amountinstore + :vamountindoc
                where id = :viditem;
            end

            select amount
            from m_items_per_store
            where iditem = :viditem and idstore = :vidstorein
            into :vamountinstore;

            vamountinstore = coalesce(vamountinstore, 0) + vamountindoc;

            update or insert into m_items_per_store
            values (:viditem, :vidstorein, :vamountinstore);
        end

    end

end^


ALTER PROCEDURE SP_M_CLEARDATA
AS
begin
    delete from m_links;
    delete from m_items_per_store;
    update m_rows set idcredrow = null;
    update m_docs set idcreddoc = null;
    delete from m_rows;
    delete from m_docs;
    update m_items set
        m_items.lastbuyprice = 0,
        m_items.amountinstore = 0,
        m_items.lastsaledate = null,
        m_items.lastbuydate = null;
end^


ALTER PROCEDURE SP_M_CURRENTSTOCK_01 (
    PIDITEM INTEGER)
RETURNS (
    IDITEM INTEGER,
    IDSTORE INTEGER,
    AMOUNT DAMOUNT)
AS
begin
    for select iditem, idstore, amount
    from m_items_per_store
    where iditem = :piditem and amount > 0
    into :iditem, :idstore, :amount
    do
      suspend;
end^


ALTER PROCEDURE SP_M_CURRENTSTOCK_02 (
    PIDSTORE INTEGER)
RETURNS (
    IDITEM INTEGER,
    IDSTORE INTEGER,
    AMOUNT DAMOUNT)
AS
begin
    for select iditem, idstore, amount
    from m_items_per_store
    where idstore = :pidstore and amount > 0
    into :iditem, :idstore, :amount
    do
      suspend;
end^


ALTER PROCEDURE SP_M_DEL_FINDOC (
    PIDDOCM INTEGER)
AS
begin
    delete from opsd
    where iddocm = :piddocm;
end^


ALTER PROCEDURE SP_M_FILTER_DOCS_01 (
    PDT1 DATE,
    PDT2 DATE,
    PTP INTEGER,
    PSTATE INTEGER,
    PIDSTOREOUT INTEGER,
    PIDSTOREIN INTEGER,
    PIDSTOREOUTORIN INTEGER)
RETURNS (
    ID TYPE OF COLUMN M_DOCS.ID,
    DT TYPE OF COLUMN M_DOCS.DT,
    SR TYPE OF COLUMN M_DOCS.SR,
    NR TYPE OF COLUMN M_DOCS.NR,
    TP TYPE OF COLUMN M_DOCS.TP,
    PVNTYPE TYPE OF COLUMN M_DOCS.PVNTYPE,
    STATE TYPE OF COLUMN M_DOCS.STATE,
    IDSTOREIN TYPE OF COLUMN M_DOCS.IDSTOREIN,
    IDSTOREOUT TYPE OF COLUMN M_DOCS.IDSTOREOUT,
    IDCREDDOC TYPE OF COLUMN M_DOCS.IDCREDDOC,
    CREDDOCDT TYPE OF COLUMN M_DOCS.CREDDOCDT,
    SUMM TYPE OF COLUMN M_DOCS.SUMM,
    IDSEQ TYPE OF COLUMN M_DOCS.IDSEQ,
    ACCIN TYPE OF COLUMN M_DOCS.ACCIN,
    ACCOUT TYPE OF COLUMN M_DOCS.ACCOUT,
    CREDDOCSR TYPE OF COLUMN M_DOCS.CREDDOCSR,
    CREDDOCNR TYPE OF COLUMN M_DOCS.CREDDOCNR,
    IDCARRIER TYPE OF COLUMN M_DOCS.IDCARRIER,
    IDADDRESSOUT TYPE OF COLUMN M_DOCS.IDADDRESSOUT,
    IDADDRESSIN TYPE OF COLUMN M_DOCS.IDADDRESSIN,
    IDVEHICLE TYPE OF COLUMN M_DOCS.IDVEHICLE,
    IDTRANSACTIONTYPE TYPE OF COLUMN M_DOCS.IDTRANSACTIONTYPE,
    IDPAYMENTTYPE TYPE OF COLUMN M_DOCS.IDPAYMENTTYPE,
    IDDRIVER TYPE OF COLUMN M_DOCS.IDDRIVER,
    ACCOUNTINGTP TYPE OF COLUMN M_DOCS.ACCOUNTINGTP,
    ACCTP1 TYPE OF COLUMN M_DOCS.ACCTP1,
    ACCTP2 TYPE OF COLUMN M_DOCS.ACCTP2,
    DUEDATE TYPE OF COLUMN M_DOCS.DUEDATE)
AS
begin
    for select
         id,
         dt,
         sr,
         nr,
         tp,
         pvntype,
         state,
         idstorein,
         idstoreout,
         idcreddoc,
         creddocdt,
         summ,
         idseq,
         accin,
         accout,
         creddocsr,
         creddocnr,
         idcarrier,
         idaddressout,
         idaddressin,
         idvehicle,
         idtransactiontype,
         idpaymenttype,
         iddriver,
         accountingtp,
         acctp1,
         acctp2,
         duedate
      from m_docs
      where (:pdt1 is null or dt >= :pdt1) and
          (:pdt2 is null or dt <= :pdt2) and
          (:ptp is null or tp = :ptp) and
          (:pstate is null or state = :pstate) and
          (
            (:pidstoreoutorin is null and
                (:pidstoreout is null or idstoreout = :pidstoreout) and
                (:pidstorein is null or idstorein = :pidstorein)
            ) or
            (:pidstoreoutorin is not null and
                (idstoreout = :pidstoreoutorin or
                idstorein = :pidstoreoutorin)
            )
          )
      order by dt, idseq, id
      into :id,
           :dt,
           :sr,
           :nr,
           :tp,
           :pvntype,
           :state,
           :idstorein,
           :idstoreout,
           :idcreddoc,
           :creddocdt,
           :summ,
           :idseq,
           :accin,
           :accout,
           :creddocsr,
           :creddocnr,
           :idcarrier,
           :idaddressout,
           :idaddressin,
           :idvehicle,
           :idtransactiontype,
           :idpaymenttype,
           :iddriver,
           :accountingtp,
           :acctp1,
           :acctp2,
           :duedate
  do
  begin
    suspend;
  end
end^


ALTER PROCEDURE SP_M_FILTER_DOCS_02 (
    PIDDOC INTEGER)
RETURNS (
    ID TYPE OF COLUMN M_DOCS.ID,
    DT TYPE OF COLUMN M_DOCS.DT,
    SR TYPE OF COLUMN M_DOCS.SR,
    NR TYPE OF COLUMN M_DOCS.NR,
    TP TYPE OF COLUMN M_DOCS.TP,
    PVNTYPE TYPE OF COLUMN M_DOCS.PVNTYPE,
    STATE TYPE OF COLUMN M_DOCS.STATE,
    IDSTOREIN TYPE OF COLUMN M_DOCS.IDSTOREIN,
    IDSTOREOUT TYPE OF COLUMN M_DOCS.IDSTOREOUT,
    IDCREDDOC TYPE OF COLUMN M_DOCS.IDCREDDOC,
    CREDDOCDT TYPE OF COLUMN M_DOCS.CREDDOCDT,
    SUMM TYPE OF COLUMN M_DOCS.SUMM,
    IDSEQ TYPE OF COLUMN M_DOCS.IDSEQ,
    ACCIN TYPE OF COLUMN M_DOCS.ACCIN,
    ACCOUT TYPE OF COLUMN M_DOCS.ACCOUT,
    CREDDOCSR TYPE OF COLUMN M_DOCS.CREDDOCSR,
    CREDDOCNR TYPE OF COLUMN M_DOCS.CREDDOCNR,
    IDCARRIER TYPE OF COLUMN M_DOCS.IDCARRIER,
    IDADDRESSOUT TYPE OF COLUMN M_DOCS.IDADDRESSOUT,
    IDADDRESSIN TYPE OF COLUMN M_DOCS.IDADDRESSIN,
    IDVEHICLE TYPE OF COLUMN M_DOCS.IDVEHICLE,
    IDTRANSACTIONTYPE TYPE OF COLUMN M_DOCS.IDTRANSACTIONTYPE,
    IDPAYMENTTYPE TYPE OF COLUMN M_DOCS.IDPAYMENTTYPE,
    IDDRIVER TYPE OF COLUMN M_DOCS.IDDRIVER,
    ACCOUNTINGTP TYPE OF COLUMN M_DOCS.ACCOUNTINGTP,
    ACCTP1 TYPE OF COLUMN M_DOCS.ACCTP1,
    ACCTP2 TYPE OF COLUMN M_DOCS.ACCTP2,
    DUEDATE TYPE OF COLUMN M_DOCS.DUEDATE)
AS
begin
    for select
         id,
         dt,
         sr,
         nr,
         tp,
         pvntype,
         state,
         idstorein,
         idstoreout,
         idcreddoc,
         creddocdt,
         summ,
         idseq,
         accin,
         accout,
         creddocsr,
         creddocnr,
         idcarrier,
         idaddressout,
         idaddressin,
         idvehicle,
         idtransactiontype,
         idpaymenttype,
         iddriver,
         accountingtp,
         acctp1,
         acctp2,
         duedate
      from m_docs
      where id = :piddoc
      order by dt, idseq, id
      into :id,
           :dt,
           :sr,
           :nr,
           :tp,
           :pvntype,
           :state,
           :idstorein,
           :idstoreout,
           :idcreddoc,
           :creddocdt,
           :summ,
           :idseq,
           :accin,
           :accout,
           :creddocsr,
           :creddocnr,
           :idcarrier,
           :idaddressout,
           :idaddressin,
           :idvehicle,
           :idtransactiontype,
           :idpaymenttype,
           :iddriver,
           :accountingtp,
           :acctp1,
           :acctp2,
           :duedate
  do
  begin
    suspend;
  end
end^


ALTER PROCEDURE SP_M_FILTER_ITEMS_01 (
    PIDDOC INTEGER)
RETURNS (
    ID TYPE OF COLUMN M_ITEMS.ID,
    BARCODE TYPE OF COLUMN M_ITEMS.BARCODE,
    NAME TYPE OF COLUMN M_ITEMS.NAME,
    CAT TYPE OF COLUMN M_ITEMS.CAT,
    UNITS TYPE OF COLUMN M_ITEMS.UNITS,
    STORE1 TYPE OF COLUMN M_ITEMS.STORE1,
    PVNRATE TYPE OF COLUMN M_ITEMS.PVNRATE,
    ISSERVICE TYPE OF COLUMN M_ITEMS.ISSERVICE,
    SELLPRICE TYPE OF COLUMN M_ITEMS.SELLPRICE,
    BUYPRICE TYPE OF COLUMN M_ITEMS.BUYPRICE,
    LASTBUYPRICE TYPE OF COLUMN M_ITEMS.LASTBUYPRICE,
    AMOUNTINSTORE TYPE OF COLUMN M_ITEMS.AMOUNTINSTORE,
    LASTSALEDATE TYPE OF COLUMN M_ITEMS.LASTSALEDATE,
    LASTBUYDATE TYPE OF COLUMN M_ITEMS.LASTBUYDATE)
AS
begin
    for select
        m_items.id,
        m_items.barcode,
        m_items.name,
        m_items.cat,
        m_items.units,
        m_items.store1,
        m_items.pvnrate,
        m_items.isservice,
        m_items.sellprice,
        m_items.buyprice,
        m_items.lastbuyprice,
        m_items.amountinstore,
        m_items.lastsaledate,
        m_items.lastbuydate
    from m_items
    join m_rows on m_rows.iddoc = :piddoc
    into
        :id,
        :barcode,
        :name,
        :cat,
        :units,
        :store1,
        :pvnrate,
        :isservice,
        :sellprice,
        :buyprice,
        :lastbuyprice,
        :amountinstore,
        :lastsaledate,
        :lastbuydate
    do
        begin
    suspend;
end
end^


ALTER PROCEDURE SP_M_FILTER_ITEMS_PER_STORE_01 (
    PIDDOC INTEGER)
RETURNS (
    IDITEM TYPE OF COLUMN M_ITEMS_PER_STORE.IDITEM,
    IDSTORE TYPE OF COLUMN M_ITEMS_PER_STORE.IDSTORE,
    AMOUNT TYPE OF COLUMN M_ITEMS_PER_STORE.AMOUNT)
AS
begin
    for select
        m_items_per_store.iditem,
        m_items_per_store.idstore,
        m_items_per_store.amount
    from m_items_per_store
    join m_rows on m_rows.iddoc = :piddoc and
        m_rows.iditem = m_items_per_store.iditem
    into
        :iditem,
        :idstore,
        :amount
    do
    begin
        suspend;
    end
end^


ALTER PROCEDURE SP_M_FILTER_ROWS_01 (
    PIDDOC INTEGER)
RETURNS (
    ID TYPE OF COLUMN M_ROWS.ID,
    IDDOC TYPE OF COLUMN M_ROWS.IDDOC,
    IDITEM TYPE OF COLUMN M_ROWS.IDITEM,
    IDPVNRATE TYPE OF COLUMN M_ROWS.IDPVNRATE,
    UNITS TYPE OF COLUMN M_ROWS.UNITS,
    IDCREDROW TYPE OF COLUMN M_ROWS.IDCREDROW,
    AMOUNT TYPE OF COLUMN M_ROWS.AMOUNT,
    DISCOUNT TYPE OF COLUMN M_ROWS.DISCOUNT,
    PRICE0 TYPE OF COLUMN M_ROWS.PRICE0,
    PRICE TYPE OF COLUMN M_ROWS.PRICE,
    BUYPRICE TYPE OF COLUMN M_ROWS.BUYPRICE,
    OLDPRICE TYPE OF COLUMN M_ROWS.OLDPRICE,
    TOLDPRICE TYPE OF COLUMN M_ROWS.TOLDPRICE,
    TPRICE TYPE OF COLUMN M_ROWS.TPRICE,
    TBUYPRICE TYPE OF COLUMN M_ROWS.TBUYPRICE,
    IDSEQ TYPE OF COLUMN M_ROWS.IDSEQ,
    ACC6 TYPE OF COLUMN M_ROWS.ACC6,
    ACC7 TYPE OF COLUMN M_ROWS.ACC7)
AS
begin
    for select
        id,
        iddoc,
        iditem,
        idpvnrate,
        units,
        idcredrow,
        amount,
        discount,
        price0,
        price,
        buyprice,
        oldprice,
        toldprice,
        tprice,
        tbuyprice,
        idseq,
        acc6,
        acc7
    from m_rows
    where iddoc = :piddoc
    order by idseq, id
    into
        :id,
        :iddoc,
        :iditem,
        :idpvnrate,
        :units,
        :idcredrow,
        :amount,
        :discount,
        :price0,
        :price,
        :buyprice,
        :oldprice,
        :toldprice,
        :tprice,
        :tbuyprice,
        :idseq,
        :acc6,
        :acc7
  do
  begin
    suspend;
  end
end^


ALTER PROCEDURE SP_M_GETCOUNTSFOREVENTS (
    PTP INTEGER,
    PID INTEGER)
RETURNS (
    RCOUNT INTEGER)
AS
begin
    /*PTP
        1 - fullrecalc
        2 - full doc recalc
    */
    if (ptp = 1) then
    begin
        for select count(id)
        from m_rows
        into :rcount
        do
        begin
            suspend;
            exit;
        end
    end

    if (ptp = 2) then
    begin
        for select count(id)
        from m_rows
        join (
            select distinct iditem
            from m_rows
            where iddoc = :pid
        ) as T1 on T1.iditem = m_rows.iditem
        into :rcount
        do
        begin
            suspend;
            exit;
        end
    end

    rcount = 0;
    suspend;
end^


ALTER PROCEDURE SP_M_ITEMMOVEMENT_01 (
    PIDITEM INTEGER,
    PDATE1 DATE,
    PDATE2 DATE)
RETURNS (
    GTP INTEGER,
    DT DATE,
    SR TYPE OF COLUMN M_DOCS.SR,
    NR TYPE OF COLUMN M_DOCS.NR,
    TP TYPE OF COLUMN M_DOCS.TP,
    IDSTOREOUT INTEGER,
    IDSTOREIN INTEGER,
    AMOUNT DAMOUNT)
AS
begin
    gtp = 0;
    for select * from
    (
        with tracked_stores as (
            select m_stores.id
            from m_stores
            join m_storetype on m_storetype.id = m_stores.tp and
                m_storetype.trackstock = 1)
        select
            T2.idstore as idstorein,
            T2.amount as amount
        from
        (
            select idstore, sum(amount) as amount
            from
            (
                select
                    m_docs.idstorein as idstore, m_rows.amount
                from m_docs
                join m_rows on m_docs.id = m_rows.iddoc and
                    m_rows.iditem = :piditem and
                    m_docs.dt < :pdate1
                join tracked_stores on tracked_stores.id = m_docs.idstorein
            
                union all
            
                select
                    m_docs.idstoreout as idstore, -m_rows.amount as amount
                from m_docs
                join m_rows on m_docs.id = m_rows.iddoc and
                    m_rows.iditem = :piditem and
                    m_docs.dt < :pdate1
                join tracked_stores on tracked_stores.id = m_docs.idstoreout
            ) as T1
            group by T1.idstore
        ) as T2
        join m_stores on m_stores.id = T2.idstore
        where amount <> 0
        order by m_stores.code
    )
    into :idstorein, :amount
    do
    begin
        tp = -1;
        suspend;
    end
    gtp = 1;
    for select
        m_docs.dt, m_docs.sr, m_docs.nr, m_docs.tp,
        m_docs.idstoreout, m_docs.idstorein,
        m_rows.amount
    from m_docs
    join m_rows on m_docs.id = m_rows.iddoc and m_rows.iditem = :piditem
    where dt between :pdate1 and :pdate2
    order by m_docs.dt, m_rows.idseq, m_rows.id
    into :dt, :sr, :nr, :tp, :idstoreout, :idstorein, :amount
    do
      suspend;

end^


ALTER PROCEDURE SP_M_MAKELINKS_01A (
    PIDROW INTEGER,
    PSTARTDATE DATE)
RETURNS (
    RESULT VARCHAR(300))
AS
    declare variable viditem integer;
    declare variable vamounttolink damount;
    declare variable vamountlinked damount;
    declare variable vdt date;
    declare variable vidrow integer;
    declare variable vamounttotal damount;
    declare variable vamountused damount;
    declare variable vgotamount damount;
    declare variable vbuyprice dpricex;
    declare variable vtotalbuyprice dpricex;
begin
    -- realizacija pircejam
    select m_rows.iditem, m_docs.dt, m_rows.amount
    from m_rows
    join m_docs on m_rows.id = :pidrow and m_docs.id = m_rows.iddoc
    into :viditem, :vdt, :vamounttolink;

    /* shouldnt be necessary
    delete
    from m_links
    where id2 = :pidrow;*/

    vgotamount = 0;
    vtotalbuyprice = 0;

    for select
        R1.id,
        R1.amount as amountotal,
        R1.buyprice
    from m_rows as R1
    join m_docs as D1 on
        R1.iditem = :viditem and
        R1.isgone = 0 and
        D1.id = R1.iddoc and
        D1.state in (2, 3) and
        D1.dt <= :vdt
    join m_doctypes on D1.tp = m_doctypes.id and
        m_doctypes.optype = 1
    order by D1.dt, R1.idseq
    into :vidrow, :vamounttotal, :vbuyprice
    do
    begin
        select sum(m_links.amount) as amountused
        from m_links
        where id1 = :vidrow
        into :vamountused;

        vamountused = coalesce(vamountused, 0);
        vamountlinked = minvalue(vamounttolink - vgotamount, vamounttotal - vamountused);

        if (vamountlinked > 0) then
        begin
            vgotamount = vgotamount + vamountlinked;

            insert into m_links (id1, id2, iditem, amount)
            values (:vidrow, :pidrow, :viditem, :vamountlinked);
            
            vbuyprice = vbuyprice * vamountlinked;
            vtotalbuyprice = vtotalbuyprice + vbuyprice;
    
            if (vgotamount >= vamounttolink) then leave;
        end
    end

    if (vgotamount < vamounttolink) then
    begin
        result = 'FAILURE';
        exception ex_failure 'Not enough amount in stock '
            || 'item:[' || :viditem || ']';
    end

    vtotalbuyprice = round(vtotalbuyprice, 2);
    vbuyprice = round(vtotalbuyprice / vamounttolink, 4);

    update m_rows
    set buyprice = :vbuyprice,
        tbuyprice = :vtotalbuyprice
    where id = :pidrow and
        (buyprice <> :vbuyprice or
        tbuyprice <> :vtotalbuyprice);

    result = 'OK';
    suspend;
end^


ALTER PROCEDURE SP_M_MAKELINKS_01B (
    PIDDOC INTEGER,
    PNEWDOCSTATE INTEGER)
RETURNS (
    RESULT VARCHAR(300))
AS
    declare variable vidrow integer;
begin
    execute procedure SP_M_CALC_DOC_AMOUNTS(PIDDOC, 0);

    for select m_rows.id
    from m_docs
    join m_rows on m_docs.id = :piddoc and m_docs.id = m_rows.iddoc
    join m_items on m_items.id = m_rows.iditem and
        m_items.isservice = 0
    order by m_rows.idseq, m_rows.id
    into :vidrow
    do
    begin
        execute procedure SP_M_MAKELINKS_01A (:vidrow, null)
        returning_values :result;
    end

    update m_rows
    set idseq = gen_id(gen_m_docseq, 1)
    where iddoc = :piddoc
    order by idseq, id;


    update m_docs
    set
        idseq = gen_id(gen_m_docseq, 1),
        state = :pnewdocstate
    where id = :piddoc;

    result = 'OK';
    suspend;
end^


ALTER PROCEDURE SP_M_MAKELINKS_02A (
    PIDROW INTEGER)
RETURNS (
    BUYPRICE DPRICEX,
    TBUYPRICE DPRICEX,
    RESULT VARCHAR(300))
AS
    declare variable viditem integer;
    declare variable vidstore integer;
    declare variable vamounttolink damount;
    declare variable vamountinstore damount;
    declare variable vamountlinked damount;
    declare variable vdt date;
    declare variable vidrow integer;
    declare variable vamounttotal damount;
    declare variable vamountused damount;
    declare variable vgotamount damount;
    declare variable vbuyprice dpricex;
    declare variable vtotalbuyprice dpricex;
begin
    -- realizacija pircejam - testi un cenas
    select m_rows.iditem, m_docs.dt, m_rows.amount, m_docs.idstoreout
    from m_rows
    join m_docs on m_rows.id = :pidrow and m_docs.id = m_rows.iddoc
    into :viditem, :vdt, :vamounttolink, :vidstore;

    buyprice = 0;
    tbuyprice = 0;

    if (vamounttolink <= 0) then
    begin
        result = 'Amount cant be < 0 for ' || :pidrow;
        suspend;
        exit;
    end

    select amountinstore
    from m_items
    where id = :viditem
    into :vamountinstore;

    if (vamountinstore < vamounttolink) then
    begin
        result = 'Not enough amount in stock item:[' || :viditem || ']';
        suspend;
        exit;
    end

    select amount
    from m_items_per_store
    where iditem = :viditem and idstore = :vidstore
    into :vamountinstore;

    vamountinstore = coalesce(:vamountinstore, 0) - :vamounttolink;

    if (vamountinstore < 0) then
    begin
        result = 'Not enough amount in stock '
            || 'item:[' || :viditem || ']'
            || 'store:[' || :vidstore || ']';
        suspend;
        exit;
    end

    vgotamount = 0;
    vtotalbuyprice = 0;

    for select
        R1.id,
        R1.amount as amountotal,
        R1.buyprice
    from m_rows as R1
    join m_docs as D1 on
        R1.iditem = :viditem and
        R1.isgone = 0 and
        D1.id = R1.iddoc and
        D1.state in (2, 3) and
        D1.dt <= :vdt
    join m_doctypes on D1.tp = m_doctypes.id and
        m_doctypes.optype = 1
    order by D1.dt, R1.idseq
    into :vidrow, :vamounttotal, :vbuyprice
    do
    begin
        select sum(m_links.amount) as amountused
        from m_links
        where id1 = :vidrow
        into :vamountused;

        vamountused = coalesce(vamountused, 0);
        vamountlinked = minvalue(vamounttolink - vgotamount, vamounttotal - vamountused);

        if (vamountlinked > 0) then
        begin
            vgotamount = vgotamount + vamountlinked;

            vbuyprice = vbuyprice * vamountlinked;
            vtotalbuyprice = vtotalbuyprice + vbuyprice;
    
            if (vgotamount >= vamounttolink) then leave;
        end
    end

    if (vgotamount < vamounttolink) then
    begin
        result = 'Not enough amount in stock item:[' || :viditem || ']';
        suspend;
        exit;
    end

    tbuyprice = round(vtotalbuyprice, 2);
    buyprice = round(tbuyprice / vamounttolink, 4);
    result = 'OK';

    suspend;
end^


ALTER PROCEDURE SP_M_MAKELINKS_02B (
    PIDDOC INTEGER)
RETURNS (
    IDROW INTEGER,
    BUYPRICE DPRICEX,
    TBUYPRICE DPRICEX,
    RESULT VARCHAR(300))
AS
begin
    -- realizacija pircejam - testi un cenas
    for select m_rows.id
    from m_docs
    join m_rows on m_docs.id = :piddoc and m_docs.id = m_rows.iddoc
    join m_items on m_items.id = m_rows.iditem and
        m_items.isservice = 0
    order by m_rows.idseq, m_rows.id
    into :idrow
    do
    begin
        execute procedure SP_M_MAKELINKS_02a (:idrow)
        returning_values :buyprice, :tbuyprice, :result;

        suspend;
    end
end^


ALTER PROCEDURE SP_M_MAKELINKS_11 (
    PIDDOC INTEGER,
    PNEWDOCSTATE INTEGER)
RETURNS (
    RESULT VARCHAR(300))
AS
    declare variable vidrow integer;
begin
    -- sanemts no piegadataja
    execute procedure SP_M_CALC_DOC_AMOUNTS(piddoc, 0);

    update m_rows
    set
        idseq = gen_id(gen_m_docseq, 1),
        buyprice = price,
        tbuyprice = tprice
    where iddoc = :piddoc
    order by idseq, id;

    update m_docs
    set
        idseq = gen_id(gen_m_docseq, 1),
        state = :pnewdocstate
    where id = :piddoc;

    result = 'OK';
    suspend;
end^


ALTER PROCEDURE SP_M_MAKELINKS_21A (
    PIDROW INTEGER)
RETURNS (
    RESULT VARCHAR(300))
AS
    declare variable viditem integer;
    declare variable vidstorein integer;
    declare variable vamounttolink damount;
    declare variable vamountlinked damount;
    declare variable vdt date;
    declare variable vidrow integer;
    declare variable vamounttotal damount;
    declare variable vamountused damount;
    declare variable vgotamount damount;
    declare variable vbuyprice dpricex;
    declare variable vtotalbuyprice dpricex;
begin
    -- atgriezts piegadatajam
    select
        m_rows.iditem, m_docs.dt, m_rows.amount,
        m_docs.idstorein
    from m_rows
    join m_docs on m_rows.id = :pidrow and m_docs.id = m_rows.iddoc
    into :viditem, :vdt, :vamounttolink, :vidstorein;

    /*
    delete
    from m_links
    where id2 = :pidrow;*/

    vgotamount = 0;
    vtotalbuyprice = 0;

    for select
        R1.id,
        R1.buyprice,
        R1.amount as amountotal
    from m_rows as R1
    join m_docs as D1 on
        R1.iditem = :viditem and
        R1.isgone = 0 and
        D1.idstoreout = :vidstorein and
        D1.id = R1.iddoc and
        D1.dt <= :vdt and
        D1.state in (2, 3) and
        D1.tp = 2
    order by D1.dt desc, R1.idseq desc, R1.id desc
    into :vidrow, :vbuyprice, :vamounttotal
    do
    begin
        select sum(m_links.amount) as amountused
        from m_links
        where id1 = :vidrow
        into :vamountused;

        vamountused = coalesce(vamountused, 0);
        vamountlinked = minvalue(vamounttolink - vgotamount, vamounttotal - vamountused);

        if (vamountlinked > 0) then
        begin
            vgotamount = vgotamount + vamountlinked;

            insert into m_links (id1, id2, iditem, amount)
            values (:vidrow, :pidrow, :viditem, :vamountlinked);
            
            vtotalbuyprice = vtotalbuyprice + vbuyprice * vamountlinked;
    
            if (vgotamount >= vamounttolink) then leave;
        end
    end

    if (vgotamount < vamounttolink) then
    begin
        result = 'FAILURE';
        exception ex_failure
            'Not enough amount recieved from supplier to return for '
            || 'item:[' || :viditem || ']';
    end

    vtotalbuyprice = round(vtotalbuyprice, 2);

    update m_rows
    set
        buyprice = round(:vtotalbuyprice / :vamounttolink, 4),
        tbuyprice = :vtotalbuyprice
    where id = :pidrow;

    result = 'OK';
    suspend;
end^


ALTER PROCEDURE SP_M_MAKELINKS_21B (
    PIDDOC INTEGER,
    PNEWDOCSTATE INTEGER)
RETURNS (
    RESULT VARCHAR(300))
AS
    declare variable vidrow integer;
begin
    -- atgriezts piegadatajam
    execute procedure SP_M_CALC_DOC_AMOUNTS(PIDDOC, 0);

    for select m_rows.id
    from m_docs
    join m_rows on m_docs.id = :piddoc and m_docs.id = m_rows.iddoc
    join m_items on m_items.id = m_rows.iditem and
        m_items.isservice = 0
    order by m_rows.idseq, m_rows.id
    into :vidrow
    do
    begin
        execute procedure SP_M_MAKELINKS_21A (:vidrow)
        returning_values :result;
    end

    update m_rows
    set idseq = gen_id(gen_m_docseq, 1)
    where iddoc = :piddoc
    order by idseq, id;

    update m_docs
    set
        idseq = gen_id(gen_m_docseq, 1),
        state = :pnewdocstate
    where id = :piddoc;

    result = 'OK';
    suspend;
end^


ALTER PROCEDURE SP_M_MAKELINKS_22A (
    PIDROW INTEGER)
RETURNS (
    BUYPRICE DPRICEX,
    TBUYPRICE MONEY,
    RESULT VARCHAR(300))
AS
    declare variable viditem integer;
    declare variable vidstorein integer;
    declare variable vidstoreout integer;
    declare variable vamounttolink damount;
    declare variable vamountinstore damount;
    declare variable vdt date;
    declare variable vidrow integer;
    declare variable vamounttotal damount;
    declare variable vamountused damount;
    declare variable vgotamount damount;
    declare variable vamountlinked damount;
    declare variable vbuyprice dpricex;
    declare variable vtotalbuyprice dpricex;
begin
    -- atgriezts piegadatajam - testi un cenas
    select
        m_rows.iditem, m_docs.dt, m_rows.amount,
        m_docs.idstorein, m_docs.idstoreout
    from m_rows
    join m_docs on m_rows.id = :pidrow and m_docs.id = m_rows.iddoc
    into :viditem, :vdt, :vamounttolink, :vidstorein, :vidstoreout;

    if (vamounttolink <= 0) then
    begin
        result = 'Amount cant be < 0 for ' || :pidrow;
        suspend;
        exit;
    end

    buyprice = 0;
    tbuyprice = 0;

    select t1.amountinstore
    from m_items as t1
    where t1.id = :viditem
    into :vamountinstore;

    if (vamountinstore < vamounttolink) then
    begin
        result = 'Not enough amount recieved from supplier to return for '
            || 'item:[' || :viditem || ']';
        suspend;
        exit;
    end

    select t1.amount
    from m_items_per_store as t1
    where t1.iditem = :viditem and t1.idstore = :vidstoreout
    into :vamountinstore;

    vamountinstore = coalesce(:vamountinstore, 0) - :vamounttolink;

    if (vamountinstore < 0) then
    begin
        result = 'Not enough amount recieved from supplier to return for '
            || 'item:[' || :viditem || '] '
            || 'store:[' || :vidstoreout || ']';
        suspend;
        exit;
    end

    vgotamount = 0;
    vtotalbuyprice = 0;

    for select
        R1.id,
        R1.buyprice,
        R1.amount as amountotal
    from m_rows as R1
    join m_docs as D1 on
        R1.iditem = :viditem and
        R1.isgone = 0 and
        D1.idstoreout = :vidstorein and
        D1.id = R1.iddoc and
        D1.dt <= :vdt and
        D1.state in (2, 3) and
        D1.tp = 2
    order by D1.dt desc, R1.idseq desc, R1.id desc
    into :vidrow, :vbuyprice, :vamounttotal
    do
    begin
        select sum(m_links.amount) as amountused
        from m_links
        where id1 = :vidrow
        into :vamountused;

        vamountused = coalesce(vamountused, 0);
        vamountlinked = minvalue(vamounttolink - vgotamount, vamounttotal - vamountused);

        if (vamountlinked > 0) then
        begin
            vgotamount = vgotamount + vamountlinked;
            vtotalbuyprice = vtotalbuyprice + vbuyprice * vamountlinked;
            if (vgotamount >= vamounttolink) then leave;
        end
    end

    if (vgotamount < vamounttolink) then
    begin
        result = 'Not enough amount recieved from supplier to return for '
            || 'item:[' || :viditem || ']';
        suspend;
        exit;
    end

    tbuyprice = round(vtotalbuyprice, 2);
    buyprice = round(tbuyprice / vamounttolink, 4);
    result = 'OK';

    suspend;
end^


ALTER PROCEDURE SP_M_MAKELINKS_22B (
    PIDDOC INTEGER)
RETURNS (
    IDROW INTEGER,
    BUYPRICE DPRICEX,
    TBUYPRICE MONEY,
    RESULT VARCHAR(300))
AS
begin
    -- atgriezts piegadatajam - testi un cenas
    for select m_rows.id
    from m_docs
    join m_rows on m_docs.id = :piddoc and m_docs.id = m_rows.iddoc
    join m_items on m_items.id = m_rows.iditem and
        m_items.isservice = 0
    order by m_rows.idseq, m_rows.id
    into :idrow
    do
    begin
        execute procedure SP_M_MAKELINKS_22a (:idrow)
        returning_values :buyprice, :tbuyprice, :result;

        suspend;
    end
end^


ALTER PROCEDURE SP_M_MAKELINKS_23A (
    PIDROW INTEGER)
RETURNS (
    CREDDOCID INTEGER,
    CREDROWID INTEGER,
    IDITEM INTEGER,
    AMOUNT DAMOUNT,
    BUYPRICE DPRICEX,
    TBUYPRICE MONEY)
AS
    declare variable vidstorein integer;
    declare variable vidstoreout integer;
    declare variable vamounttolink damount;
    declare variable vamountinstore damount;
    declare variable vamountlinked damount;
    declare variable vdt date;
    declare variable vidrow integer;
    declare variable vamounttotal damount;
    declare variable vamountused damount;
    declare variable vgotamount damount;
    declare variable visservices integer;
begin
    -- atgriezts piegadatajam - atlasam linkus
    select
        m_rows.iditem, m_docs.dt, m_rows.amount,
        m_docs.idstorein, m_docs.idstoreout, m_items.isservice
    from m_rows
    join m_docs on m_rows.id = :pidrow and m_docs.id = m_rows.iddoc
    join m_items on m_items.id = m_rows.iditem
    into :iditem, :vdt, :vamounttolink, :vidstorein, :vidstoreout, :visservices;

    if (visservices = 1) then exit;

    vgotamount = 0;

    for select
        D1.id as iddoc,
        R1.id as idrow,
        R1.buyprice,
        R1.amount as amountotal
    from m_rows as R1
    join m_docs as D1 on
        R1.iditem = :iditem and
        R1.isgone = 0 and
        D1.idstoreout = :vidstorein and
        D1.id = R1.iddoc and
        D1.dt <= :vdt and
        D1.state in (2, 3) and
        D1.tp = 2
    order by D1.dt desc, R1.idseq desc, R1.id desc
    into :creddocid, :credrowid, :buyprice, :vamounttotal
    do
    begin
        select sum(m_links.amount) as amountused
        from m_links
        where id1 = :vidrow
        into :vamountused;

        vamountused = coalesce(vamountused, 0);
        vamountlinked = minvalue(vamounttolink - vgotamount, vamounttotal - vamountused);

        if (vamountlinked > 0) then
        begin
            vgotamount = vgotamount + vamountlinked;

            amount = vamountlinked;
            tbuyprice = round(buyprice * vamountlinked, 2);
            
            suspend;
            if (vgotamount >= vamounttolink) then exit;
        end
    end

end^


ALTER PROCEDURE SP_M_MAKELINKS_23B (
    PIDDOC INTEGER)
RETURNS (
    IDROW INTEGER,
    CREDDOCID INTEGER,
    CREDROWID INTEGER,
    IDITEM INTEGER,
    AMOUNT DAMOUNT,
    BUYPRICE DPRICEX,
    TBUYPRICE MONEY,
    CREDDOCDT DATE,
    CREDDOCSR TYPE OF COLUMN M_DOCS.SR,
    CREDDOCNR TYPE OF COLUMN M_DOCS.NR)
AS
begin
    -- atgriezts piegadatajam - atlasam linkus
    for select m_rows.id
    from m_docs
    join m_rows on m_docs.id = :piddoc and m_docs.id = m_rows.iddoc
    join m_items on m_items.id = m_rows.iditem and
        m_items.isservice = 0
    order by m_rows.idseq, m_rows.id
    into :idrow
    do
    begin
        for select
            t1.creddocid, t1.credrowid, t1.iditem,
            t1.amount, t1.buyprice, t1.tbuyprice,
            m_docs.dt, m_docs.sr, m_docs.nr
        from SP_M_MAKELINKS_23A(:idrow) as t1
        join m_docs on m_docs.id = t1.creddocid
        into
            :creddocid, :credrowid, :iditem,
            :amount, :buyprice, :tbuyprice,
            :creddocdt, :creddocsr, :creddocnr

        do suspend;
    end
end^


ALTER PROCEDURE SP_M_MAKELINKS_31A (
    PIDROW INTEGER)
RETURNS (
    RESULT VARCHAR(300))
AS
    declare variable viditem integer;
    declare variable vidstoreout integer;
    declare variable vidstorein integer;
    declare variable vamounttolink damount;
    declare variable vamountlinked damount;
    declare variable vamountlinked2 damount;
    declare variable vdt date;
    declare variable vidrow integer;
    declare variable vidrow2 integer;
    declare variable vamounttotal integer;
    declare variable vamountused integer;
    declare variable vgotamount damount;
    declare variable vsellprice dpricex;
    declare variable vselltotalprice dpricex;
    declare variable vbuyprice dpricex;
    declare variable vbuytotalprice dpricex;
begin
    -- atgriezts no pirceja
    select
        m_rows.iditem, m_docs.dt, m_rows.amount,
        m_docs.idstoreout, m_docs.idstorein
    from m_rows
    join m_docs on m_rows.id = :pidrow and m_docs.id = m_rows.iddoc
    into :viditem, :vdt, :vamounttolink, :vidstoreout, :vidstorein;

    if (vamounttolink >= 0) then
        exception ex_failure 'Amount must be negative '
                || 'item:[' || :viditem || ']';

    vamounttolink = -vamounttolink;

    /*delete
    from m_links
    where id2 = :pidrow;*/


    vgotamount = 0;
    vselltotalprice = 0;
    vbuytotalprice = 0;

    for select
        R1.id,
        R1.price,
        R1.buyprice,
        R1.amount as amountotal
    from m_rows as R1
    join m_docs as D1 on
        R1.iditem = :viditem and
        D1.idstorein = :vidstorein and
        D1.id = R1.iddoc and
        D1.dt <= :vdt and
        D1.state in (2, 3) and
        D1.tp = 3
    order by D1.dt desc, R1.idseq desc
    into :vidrow, :vsellprice, :vbuyprice, :vamounttotal
    do
    begin
        vamountlinked2 = 0;

        for select id1, sum(amount)
        from m_links
        where id2 = :vidrow
        group by id1
        order by id1
        into :vidrow2, :vamountused
        do
        begin
            vamountused = coalesce(vamountused, 0);
            vamountlinked = minvalue(vamounttolink - vgotamount, vamountused);
    
            if (vamountlinked > 0) then
            begin
                vgotamount = vgotamount + vamountlinked;
                vamountlinked2 = vamountlinked2 + vamountlinked;

                insert into m_links
                values (:vidrow2, :pidrow, :viditem, -:vamountlinked);
                
                update m_rows
                set isgone = 0
                where id = :vidrow2 and isgone = 1;

                vselltotalprice = vselltotalprice + vsellprice * vamountlinked;
                vbuytotalprice = vbuytotalprice + vbuyprice * vamountlinked;
                        
                if (vgotamount >= vamounttolink) then leave;
            end
        end

        if (vamountlinked2 > 0) then
        begin
            insert into m_links
            values (:vidrow, :pidrow, :viditem, :vamountlinked2);
        end
    end

    if (vgotamount < vamounttolink) then
    begin
        result = 'FAILURE';
        exception ex_failure
            'Not enough amount sent to buyer to return for '
            || 'item:[' || :viditem || ']';
    end

    vselltotalprice = round(vselltotalprice, 2);
    vsellprice = round(vselltotalprice / vamounttolink, 4);
    vbuytotalprice = round(vbuytotalprice, 2);
    vbuyprice = round(vbuytotalprice / vamounttolink, 4);

    update m_rows
    set 
        oldprice = :vsellprice,
        toldprice = :vselltotalprice,
        buyprice = -:vbuyprice,
        tbuyprice = -:vbuytotalprice
    where id = :pidrow;

    result = 'OK';
    suspend;
end^


ALTER PROCEDURE SP_M_MAKELINKS_31B (
    PIDDOC INTEGER,
    PNEWDOCSTATE INTEGER)
RETURNS (
    RESULT VARCHAR(300))
AS
    declare variable vidrow integer;
begin
    -- atgriezts pircejam
    execute procedure SP_M_CALC_DOC_AMOUNTS(PIDDOC, 0);

    for select m_rows.id
    from m_docs
    join m_rows on m_docs.id = :piddoc and m_docs.id = m_rows.iddoc
    join m_items on m_items.id = m_rows.iditem and
        m_items.isservice = 0
    order by m_rows.idseq, m_rows.id
    into :vidrow
    do
    begin
        execute procedure SP_M_MAKELINKS_31A (:vidrow)
        returning_values :result;
    end

    update m_rows
    set idseq = gen_id(gen_m_docseq, 1)
    where iddoc = :piddoc
    order by idseq, id;

    update m_docs
    set
        idseq = gen_id(gen_m_docseq, 1),
        state = :pnewdocstate
    where id = :piddoc;

    result = 'OK';
    suspend;
end^


ALTER PROCEDURE SP_M_MAKELINKS_32A (
    PIDROW INTEGER)
RETURNS (
    CREDDOCID INTEGER,
    CREDROWID INTEGER,
    IDITEM INTEGER,
    AMOUNT DAMOUNT,
    PRICE DPRICEX,
    TPRICE MONEY)
AS
    declare variable vidstorein integer;
    declare variable vidstoreout integer;
    declare variable vamounttolink damount;
    declare variable vamountinstore damount;
    declare variable vdt date;
    declare variable vidrow integer;
    declare variable vidrow2 integer;
    declare variable vamounttotal damount;
    declare variable vamountused damount;
    declare variable vgotamount damount;
    declare variable vamountlinked damount;
    declare variable visservices integer;
begin
    -- atgriezts no pirceja - atlasam linkus
    select
        m_rows.iditem, m_docs.dt, m_rows.amount,
        m_docs.idstorein, m_docs.idstoreout
    from m_rows
    join m_docs on m_rows.id = :pidrow and m_docs.id = m_rows.iddoc
    into :iditem, :vdt, :vamounttolink, :vidstorein, :vidstoreout;

    if (vamounttolink >= 0) then exit;

    vamounttolink = -vamounttolink;

    vgotamount = 0;

    for select
        D1.id as iddoc,
        R1.id as idrow,
        R1.price,
        R1.amount as amountotal
    from m_rows as R1
    join m_docs as D1 on
        R1.iditem = :iditem and
        D1.idstorein = :vidstorein and
        D1.id = R1.iddoc and
        D1.dt <= :vdt and
        D1.state in (2, 3) and
        D1.tp = 3
    order by D1.dt desc, R1.idseq desc, R1.id desc
    into :creddocid, :credrowid, :price, :vamounttotal
    do
    begin
        for select id1, sum(amount)
        from m_links
        where id2 = :vidrow
        group by id1
        order by id1
        into :vidrow2, :vamountused
        do
        begin
            vamountused = coalesce(vamountused, 0);
            vamountlinked = minvalue(vamounttolink - vgotamount, vamountused);
    
            if (vamountlinked > 0) then
            begin
                vgotamount = vgotamount + vamountlinked;
    
                amount = vamountlinked;
                tprice = round(price * vamountlinked, 2);
                
                suspend;
                if (vgotamount >= vamounttolink) then exit;
            end
        end
    end

    if (vgotamount < vamounttolink) then exit;
        --exception ex_failure
        --    'Not enough amount sent to buyer to return for '
        --    || 'item:[' || :viditem || ']';

end^


ALTER PROCEDURE SP_M_MAKELINKS_32B (
    PIDDOC INTEGER)
RETURNS (
    IDROW INTEGER,
    CREDDOCID INTEGER,
    CREDROWID INTEGER,
    IDITEM INTEGER,
    AMOUNT DAMOUNT,
    PRICE DPRICEX,
    TPRICE MONEY,
    CREDDOCDT DATE,
    CREDDOCSR TYPE OF COLUMN M_DOCS.SR,
    CREDDOCNR TYPE OF COLUMN M_DOCS.NR)
AS
begin
    -- atgriezts no pirceja - atlasam linkus
    for select m_rows.id
    from m_docs
    join m_rows on m_docs.id = :piddoc and m_docs.id = m_rows.iddoc
    join m_items on m_items.id = m_rows.iditem and
        m_items.isservice = 0
    order by m_rows.idseq, m_rows.id
    into :idrow
    do
    begin
        for select
            t1.creddocid, t1.credrowid, t1.iditem,
            t1.amount, t1.price, t1.tprice,
            m_docs.dt, m_docs.sr, m_docs.nr
        from SP_M_MAKELINKS_32A(:idrow) as t1
        join m_docs on m_docs.id = t1.creddocid
        into
            :creddocid, :credrowid, :iditem,
            :amount, :price, :tprice,
            :creddocdt, :creddocsr, :creddocnr

        do suspend;
    end
end^


ALTER PROCEDURE SP_M_MAKELINKS_33A (
    PIDROW INTEGER)
RETURNS (
    SELLPRICE DPRICEX,
    SELLTOTALPRICE DPRICEX,
    BUYPRICE DPRICEX,
    BUYTOTALPRICE DPRICEX,
    RESULT VARCHAR(300))
AS
    declare variable viditem integer;
    declare variable viditem2 integer;
    declare variable vidstorein integer;
    declare variable vidstoreout integer;
    declare variable vamounttolink damount;
    declare variable vamountinstore damount;
    declare variable vdt date;
    declare variable vidrow integer;
    declare variable vamounttotal integer;
    declare variable vamountused integer;
    declare variable vgotamount damount;
    declare variable vamountlinked damount;
    declare variable vsellprice dpricex;
    declare variable vselltotalprice dpricex;
    declare variable vbuyprice dpricex;
    declare variable vbuytotalprice dpricex;
begin
    -- atgriezts no pirceja - testi un cenas
    select
        m_rows.iditem, m_docs.dt, m_rows.amount,
        m_docs.idstorein, m_docs.idstoreout
    from m_rows
    join m_docs on m_rows.id = :pidrow and m_docs.id = m_rows.iddoc
    into :viditem, :vdt, :vamounttolink, :vidstorein, :vidstoreout;

    if (vamounttolink >= 0) then
    begin
        result = 'Amount must be negative for item:[' || :viditem || ']';
        suspend;
        exit;
    end

    vamounttolink = -vamounttolink;

    vgotamount = 0;
    selltotalprice = 0;
    buytotalprice = 0;

    for select
        R1.id,
        R1.price,
        R1.buyprice,
        R1.amount as amountotal
    from m_rows as R1
    join m_docs as D1 on
        R1.iditem = :viditem and
        D1.idstorein = :vidstorein and
        D1.id = R1.iddoc and
        D1.dt <= :vdt and
        D1.state in (2, 3) and
        D1.tp = 3
    order by D1.dt desc, R1.idseq desc
    into :vidrow, :vsellprice, :vbuyprice, :vamounttotal
    do
    begin
        select sum(m_links.amount) as amountused
        from m_links
        where id1 = :vidrow
        into :vamountused;

        vamountused = coalesce(vamountused, 0);
        vamountlinked = minvalue(vamounttolink - vgotamount, vamounttotal - vamountused);

        if (vamountlinked > 0) then
        begin
            vgotamount = vgotamount + vamountlinked;

            selltotalprice = selltotalprice + vsellprice * vamountlinked;
            buytotalprice = buytotalprice + vbuyprice * vamountlinked;
                    
            if (vgotamount >= vamounttolink) then leave;
        end
    end

    if (vgotamount < vamounttolink) then
    begin
        result = 'Not enough amount sent to buyer to return for ' || :viditem;
        suspend;
        exit;
    end

    selltotalprice = round(selltotalprice, 2);
    sellprice = round(selltotalprice / vamounttolink, 4);
    buytotalprice = round(buytotalprice, 2);
    buyprice = round(buytotalprice / vamounttolink, 4);
    result = 'OK';

    suspend;
end^


ALTER PROCEDURE SP_M_MAKELINKS_33B (
    PIDDOC INTEGER)
RETURNS (
    IDROW INTEGER,
    SELLPRICE DPRICEX,
    SELLTOTALPRICE DPRICEX,
    BUYPRICE DPRICEX,
    BUYTOTALPRICE DPRICEX,
    RESULT VARCHAR(300))
AS
begin
    -- atgriezts no pircƒìja - tsti un cenas
    for select m_rows.id
    from m_docs
    join m_rows on m_docs.id = :piddoc and m_docs.id = m_rows.iddoc
    join m_items on m_items.id = m_rows.iditem and
        m_items.isservice = 0
    order by m_rows.idseq, m_rows.id
    into :idrow
    do
    begin
        execute procedure SP_M_MAKELINKS_33a (:idrow)
        returning_values :sellprice, :selltotalprice,
            :buyprice, :buytotalprice, :result;

        suspend;
    end
end^


ALTER PROCEDURE SP_M_MAKELINKS_41 (
    PIDDOC INTEGER,
    PNEWDOCSTATE INTEGER)
RETURNS (
    RESULT VARCHAR(300))
AS
    declare variable vidrow integer;
begin
    -- iek≈°ƒìja pƒÅrvieto≈°ana
    execute procedure SP_M_CALC_DOC_AMOUNTS(PIDDOC, 0);

    update m_docs
    set
        idseq = gen_id(gen_m_docseq, 1),
        state = :pnewdocstate
    where id = :piddoc;

    update m_rows
    set idseq = gen_id(gen_m_docseq, 1)
    where iddoc = :piddoc
    order by idseq, id;

    result = 'OK';
    suspend;
end^


ALTER PROCEDURE SP_M_MAKELINKS_51A (
    PIDROW INTEGER)
RETURNS (
    RESULT VARCHAR(300))
AS
    declare variable vidrow2 integer;
    declare variable viditem integer;
    declare variable vamounttolink damount;
    declare variable vamountincredit damount;
    declare variable vamountsold damount;
    declare variable vamountlinked damount;
    declare variable vamountused integer;
    declare variable vgotamount damount;
    declare variable vidcredrow integer;
    declare variable voldsellprice dpricex;
    declare variable vbuyprice dpricex;
    declare variable vdt date;
    declare variable vdt2 date;
begin
    -- realizacijas kreditrekins
    select
        m_rows.iditem, m_rows.amount, m_rows.idcredrow, m_docs.dt
    from m_rows
    join m_docs on m_rows.id = :pidrow and m_docs.id = m_rows.iddoc
    into :viditem, :vamounttolink, :vidcredrow, :vdt;
    
    if (vamounttolink >= 0) then
        exception ex_failure 'Amount must be negative for '
                || 'item:[' || :viditem || ']';

    vamounttolink = -vamounttolink;

    select R1.amount, R1.price, R1.buyprice, D1.dt
    from m_rows as R1
    join m_docs as D1 on D1.id = R1.iddoc
    where R1.id = :vidcredrow
    into :vamountsold, :voldsellprice, :vbuyprice, :vdt2;

    if (vamountsold is null) then
        exception ex_failure 'Credit row not found';

    if (vamounttolink > vamountsold) then
        exception ex_failure 'Credited amount greater than sale '
            || 'item:[' || :viditem || ']';

    if (vdt < vdt2) then
        exception ex_failure 'Creditdoc date older than original doc';

    select sum(R1.amount)
    from m_rows as R1
    join m_docs as D1 on D1.id = R1.iddoc and 
        R1.idcredrow = :vidcredrow and
        D1.state in (2,3)
    into :vamountincredit;

    vamountincredit = -coalesce(vamountincredit, 0);

    if (vamountincredit + vamounttolink > vamountsold) then
        exception ex_failure 'Credited amount greater than sale '
            || 'item:[' || :viditem || ']';

    select sum(amount)
    from m_links
    where id1 = :vidcredrow
    into :vamountlinked;

    if (vamountlinked + vamounttolink > vamountsold) then
        exception ex_failure 'Used amount greater than sale item:[' || :viditem || ']';

    update or insert into m_links (id1, id2, iditem, amount)
    values (:vidcredrow, :pidrow, :viditem, :vamounttolink);

    update m_rows
    set
        price = :voldsellprice,
        tprice = round(amount * :voldsellprice, 2),
        oldprice = :voldsellprice,
        toldprice = round(amount * :voldsellprice, 2),
        buyprice = :vbuyprice,
        tbuyprice = round(amount * :vbuyprice, 2)
    where id = :pidrow;


    vgotamount = 0;

    for select id1, sum(amount)
    from m_links
    where id2 = :vidcredrow
    group by id1
    order by id1
    into :vidrow2, :vamountused
    do
    begin
        vamountused = coalesce(vamountused, 0);
        vamountlinked = minvalue(vamounttolink - vgotamount, vamountused);

        if (vamountlinked > 0) then
        begin
            vgotamount = vgotamount + vamountlinked;

            insert into m_links
            values (:vidrow2, :pidrow, :viditem, -:vamountlinked);

            update m_rows
            set isgone = 0
            where id = :vidrow2 and isgone = 1;
    
            if (vgotamount >= vamounttolink) then leave;
        end
    end

    if (vgotamount < vamounttolink) then
    begin
        result = 'FAILURE';
        exception ex_failure
            'Not enough amount sent to buyer to return for '
            || 'item:[' || :viditem || ']';
    end


    result = 'OK';
    suspend;
end^


ALTER PROCEDURE SP_M_MAKELINKS_51B (
    PIDDOC INTEGER,
    PNEWDOCSTATE INTEGER)
RETURNS (
    RESULT VARCHAR(300))
AS
    declare variable vidirow integer;
begin
    execute procedure SP_M_CALC_DOC_AMOUNTS(PIDDOC, 0);

    for select m_rows.id
    from m_docs
    join m_rows on m_docs.id = :piddoc and m_docs.id = m_rows.iddoc
    join m_items on m_items.id = m_rows.iditem and
        m_items.isservice = 0
    order by m_rows.idseq, m_rows.id
    into :vidirow
    do
    begin
        execute procedure SP_M_MAKELINKS_51A (:vidirow)
        returning_values :result;
    end

    update m_docs
    set
        idseq = gen_id(gen_m_docseq, 1),
        state = :pnewdocstate
    where id = :piddoc;

    update m_rows
    set idseq = gen_id(gen_m_docseq, 1)
    where iddoc = :piddoc
    order by idseq, id;

    result = 'OK';
    suspend;
end^


ALTER PROCEDURE SP_M_MAKELINKS_52 (
    PIDDOC INTEGER)
RETURNS (
    RIDROW INTEGER,
    RESULT VARCHAR(300))
AS
    declare variable viditem integer;
    declare variable vamounttolink damount;
    declare variable vamountincredit damount;
    declare variable vamountsold damount;
    declare variable vamountlinked damount;
    declare variable vidrow integer;
    declare variable vidcreddoc integer;
    declare variable vidcredrow integer;
begin
    -- realizacijas kreditrekins - tests
    for select
        m_rows.iditem, m_rows.amount,
        m_docs.idcreddoc, m_rows.idcredrow, m_rows.id
    from m_rows
    join m_docs on m_docs.id = :piddoc and m_docs.id = m_rows.iddoc
    join m_items on m_items.id = m_rows.iditem and
        m_items.isservice = 0
    order by m_rows.idseq, m_rows.id
    into :viditem, :vamounttolink, :vidcreddoc, :vidcredrow, :ridrow
    do
    begin

        select R1.amount
        from m_rows as R1
        where R1.id = :vidcredrow
        into :vamountsold;
    
        if (vamounttolink >= 0) then
        begin
            result = 'Amount mus be negative for item:[' || :viditem || ']';
            suspend;
            exit;
        end

        vamounttolink = -vamounttolink;

        if (vamounttolink > vamountsold) then
        begin
            result = 'Credited amount greater than sale '
                || 'item:[' || :viditem || ']';
            suspend;
            exit;
        end
    
        select sum(R1.amount)
        from m_rows as R1
        join m_docs as D1 on D1.id = R1.iddoc and 
            R1.idcredrow = :vidcredrow and
            D1.state in (2,3)
        into :vamountincredit;
    
        vamountincredit = -coalesce(vamountincredit, 0);

        if ((vamountincredit + vamounttolink) > vamountsold) then
        begin
            result = 'Credited amount greater than sale '
                || 'item:[' || :viditem || ']';
            suspend;
            exit;
        end

        select sum(amount)
        from m_links
        where id1 = :vidcredrow
        into :vamountlinked;
    
        if (vamountlinked + vamounttolink > vamountsold) then
            exception ex_failure 'Used amount greater than sale item:[' || :viditem || ']';


    end

end^


ALTER PROCEDURE SP_M_MAKELINKS_61A (
    PIDROW INTEGER)
RETURNS (
    RESULT VARCHAR(300))
AS
    declare variable viditem integer;
    declare variable vamounttolink damount;
    declare variable vamountincredit damount;
    declare variable vamountreceived damount;
    declare variable vamountlinked damount;
    declare variable vidcredrow integer;
    declare variable vbuyprice dpricex;
    declare variable vdt date;
    declare variable vdt2 date;
begin
    -- piegadataja kreditrekins
    select
        m_rows.iditem, m_rows.amount, m_rows.idcredrow, m_docs.dt
    from m_rows
    join m_docs on m_rows.id = :pidrow and m_docs.id = m_rows.iddoc
    into :viditem, :vamounttolink, :vidcredrow, :vdt;
    
    select R1.amount, R1.price, D1.dt
    from m_rows as R1
    join m_docs as D1 on D1.id = R1.iddoc
    where R1.id = :vidcredrow
    into :vamountreceived, :vbuyprice, :vdt2;

    if (vamountreceived is null) then
        exception ex_failure 'Credit row not found';

    select sum(R1.amount)
    from m_rows as R1
    join m_docs as D1 on D1.id = R1.iddoc and 
        R1.idcredrow = :vidcredrow and
        D1.state in (2,3)
    into :vamountincredit;

    vamountincredit = coalesce(vamountincredit, 0);

    if (vamountincredit + vamounttolink > vamountreceived) then
        exception ex_failure 'Credited amount greater than received for item:[' || :viditem || ']';

    select sum(amount)
    from m_links
    where id1 = :vidcredrow and iditem = :viditem
    into :vamountlinked;

    vamountlinked = coalesce(vamountlinked, 0);

    if (vamountlinked + vamounttolink > vamountreceived) then
        exception ex_failure 'Used amount greater than received for item:[' || :viditem || ']';

    if (vdt < vdt2) then
        exception ex_failure 'Creditdoc date older than original doc';

    update or insert into m_links (id1, id2, iditem, amount)
    values (:vidcredrow, :pidrow, :viditem, :vamounttolink);
    
    update m_rows
    set
        buyprice = :vbuyprice,
        tbuyprice = round(amount * :vbuyprice, 2)
    where id = :pidrow;

    result = 'OK';
    suspend;
end^


ALTER PROCEDURE SP_M_MAKELINKS_61B (
    PIDDOC INTEGER,
    PNEWDOCSTATE INTEGER)
RETURNS (
    RESULT VARCHAR(300))
AS
    declare variable vidirow integer;
begin
    execute procedure SP_M_CALC_DOC_AMOUNTS(PIDDOC, 0);

    for select m_rows.id
    from m_docs
    join m_rows on m_docs.id = :piddoc and m_docs.id = m_rows.iddoc
    join m_items on m_items.id = m_rows.iditem and
        m_items.isservice = 0
    order by m_rows.idseq, m_rows.id
    into :vidirow
    do
    begin
        execute procedure SP_M_MAKELINKS_61A (:vidirow)
        returning_values :result;
    end

    update m_docs
    set
        idseq = gen_id(gen_m_docseq, 1),
        state = :pnewdocstate
    where id = :piddoc;

    update m_rows
    set idseq = gen_id(gen_m_docseq, 1)
    where iddoc = :piddoc
    order by idseq, id;

    result = 'OK';
    suspend;
end^


ALTER PROCEDURE SP_M_MAKELINKS_62 (
    PIDDOC INTEGER)
RETURNS (
    RIDROW INTEGER,
    RESULT VARCHAR(300))
AS
    declare variable viditem integer;
    declare variable vidstore integer;
    declare variable vamounttolink damount;
    declare variable vamountinstore damount;
    declare variable vamountincredit damount;
    declare variable vamountreceived damount;
    declare variable vdt date;
    declare variable vidrow integer;
    declare variable vidcreddoc integer;
    declare variable vidcredrow integer;
begin
    -- piegades kreditrekins - tests
    for select
        m_rows.iditem, m_docs.dt, m_rows.amount, m_docs.idstorein,
        m_docs.idcreddoc, m_rows.idcredrow, m_rows.id
    from m_rows
    join m_docs on m_docs.id = :piddoc and m_docs.id = m_rows.iddoc
    join m_items on m_items.id = m_rows.iditem and
        m_items.isservice = 0
    order by m_rows.idseq, m_rows.id
    into :viditem, :vdt, :vamounttolink, :vidstore,
        :vidcreddoc, :vidcredrow, :ridrow
    do
    begin

        if (vamounttolink <= 0) then
        begin
            result = 'Amount cant be < 0 ' || :ridrow;
            suspend;
            exit;
        end

        select amountinstore
        from m_items
        where id = :viditem
        into :vamountinstore;
    
        if (vamountinstore < vamounttolink) then
        begin
            result = 'Not enough amount in stock for item:[' || :viditem || ']';
            suspend;
            exit;
        end
    
        select amount
        from m_items_per_store
        where iditem = :viditem and idstore = :vidstore
        into :vamountinstore;
    
        vamountinstore = coalesce(:vamountinstore, 0) - :vamounttolink;
    
        if (vamountinstore < 0) then
        begin
            result = 'Not enough amount in stock for item:[' || :viditem || ']';
            suspend;
            exit;
        end

        select R1.amount
        from m_rows as R1
        where R1.id = :vidcredrow
        into :vamountreceived;
    
        if (vamounttolink > vamountreceived) then
        begin
            result = 'Credited amount greater than received for item:[' || :viditem || ']';
            suspend;
            exit;
        end
    
        select sum(R1.amount)
        from m_rows as R1
        join m_docs as D1 on D1.id = R1.iddoc and 
            R1.idcredrow = :vidcredrow and
            D1.state in (2,3)
        into :vamountincredit;
    
        vamountincredit = coalesce(vamountincredit, 0);

        if ((vamountincredit + vamounttolink) > vamountreceived) then
        begin
            result = 'Credited amount greater than received for item:[' || :viditem || ']';
            suspend;
        end

    end

end^


ALTER PROCEDURE SP_M_RECALC_ROWSISGONE_1
RETURNS (
    RET INTEGER)
AS
    declare vid integer;
    declare vtotalamount damount;
    declare vusedamount damount;
    declare visgone integer;
begin
    for select
        R1.id,
        min(R1.amount) as totalamount,
        sum(L1.amount) as usedamount
    from m_rows as R1
    join m_links as L1 on R1.id = L1.id1
    group by R1.id
    into :vid, :vtotalamount, :vusedamount
    do begin
        visgone = iif(vusedamount < vtotalamount, 0, 1);
        update m_rows
        set isgone = :visgone
        where id = :vid and isgone <> :visgone;
    end

    for select
        R1.id
    from m_rows as R1
    left join m_links as L1 on R1.id = L1.id1
    where isgone = 1 and L1.id1 is null
    into :vid
    do begin
        update m_rows
        set isgone = 0
        where id = :vid;
    end

    ret = 1;
    suspend;
end^


ALTER PROCEDURE SP_M_RECALC_ROWSISGONE_2 (
    PIDDOC INTEGER)
AS
    declare vid integer;
    declare vtotalamount damount;
    declare vusedamount damount;
    declare visgone integer;
begin
    for select
        R1.id,
        min(R1.amount) as totalamount,
        sum(L1.amount) as usedamount
    from m_rows as R1
    join (
        select distinct iditem
        from m_rows
        where iddoc = :piddoc
    ) as IT1
        on R1.iditem = IT1.iditem
    join m_links as L1 on R1.id = L1.id1
    group by R1.id
    into :vid, :vtotalamount, :vusedamount
    do begin
        visgone = iif(vusedamount < vtotalamount, 0, 1);
        update m_rows
        set isgone = :visgone
        where id = :vid and isgone <> :visgone;
    end

    for select
        R1.id
    from m_rows as R1
    join (
        select distinct iditem
        from m_rows
        where iddoc = :piddoc
    ) as IT1
        on R1.iditem = IT1.iditem
    left join m_links as L1 on R1.id = L1.id1
    where isgone = 1 and L1.id1 is null
    into :vid
    do begin
        update m_rows
        set isgone = 0
        where id = :vid;
    end

end^


ALTER PROCEDURE SP_M_RECALCAMOUNTS_1
RETURNS (
    RET INTEGER)
AS
    declare viditem integer;
    declare vidstore integer;
    declare vamount damount;
begin
    update m_items_per_store
    set amount = 0
    where amount <> 0;

    for select
        T2.iditem,
        T2.idstore,
        T2.amount
    from
    (
        select
            T1.iditem,
            T1.idstore,
            sum(T1.amount) as amount
        from
        (
            select
                R1.iditem,
                D1.idstorein as idstore,
                R1.amount
            from m_rows as R1
            join m_docs as D1 on D1.id = R1.iddoc and
                D1.state in (2, 3)
            join m_stores on m_stores.id = D1.idstorein
            join m_storetype on m_storetype.id = m_stores.tp and
                m_storetype.trackstock = 1
        
            union all
        
            select
                R1.iditem,
                D1.idstoreout as idstore,
                -R1.amount
            from m_rows as R1
            join m_docs as D1 on D1.id = R1.iddoc and
                D1.state in (2, 3)
            join m_stores on m_stores.id = D1.idstoreout
            join m_storetype on m_storetype.id = m_stores.tp and
                m_storetype.trackstock = 1

        ) as T1
        group by T1.iditem, T1.idstore
    ) as T2
    join m_items on m_items.id = T2.iditem and
        m_items.isservice = 0
    into :viditem, :vidstore, :vamount
    do
    begin
        if (vamount < 0) then
            exception ex_failure 'Not enough amount in stock for store '
                || 'item:[' || :viditem || ']'
                || 'store:[' || :vidstore || ']';

        if (vamount > 0) then
        begin
            update or insert into m_items_per_store (iditem, idstore, amount)
            values (:viditem, :vidstore, :vamount)
            matching (iditem, idstore);
        end
    end

    for select iditem, amount
    from (
        select iditem, sum(amount) as amount
        from m_items_per_store
        group by iditem
    ) as T1
    join m_items on m_items.id = T1.iditem and
        m_items.amountinstore <> T1.amount
    into :viditem, :vamount do
    begin
        update m_items
        set amountinstore = :vamount
        where id = :viditem and amountinstore <> :vamount;
    end

    ret = 1;
    suspend;
end^


ALTER PROCEDURE SP_M_RECALCAMOUNTS_2 (
    PIDDOC INTEGER)
RETURNS (
    RET INTEGER)
AS
    declare viditem integer;
    declare vidstore integer;
    declare vamount damount;
begin
    update m_items_per_store as T1
    set amount = 0
    where amount <> 0 and
        exists (
            select iditem
            from m_rows
            where iddoc = :piddoc and
                iditem = T1.iditem);

    for select
        T2.iditem,
        T2.idstore,
        T2.amount
    from
    (
        select
            T1.iditem,
            T1.idstore,
            sum(T1.amount) as amount
        from
        (
            select
                R1.iditem,
                D1.idstorein as idstore,
                R1.amount
            from m_rows as R1
            join (
                select distinct iditem
                from m_rows
                where iddoc = :piddoc
            ) as IT1
                on R1.iditem = IT1.iditem
            join m_docs as D1 on D1.id = R1.iddoc and
                D1.state in (2, 3)
            join m_stores on m_stores.id = D1.idstorein
            join m_storetype on m_storetype.id = m_stores.tp and
                m_storetype.trackstock = 1

            union all
        
            select
                R1.iditem,
                D1.idstoreout as idstore,
                -R1.amount
            from m_rows as R1
            join (
                select distinct iditem
                from m_rows
                where iddoc = :piddoc
            ) as IT1
                on R1.iditem = IT1.iditem
            join m_docs as D1 on D1.id = R1.iddoc and
                D1.state in (2, 3)
            join m_stores on m_stores.id = D1.idstoreout
            join m_storetype on m_storetype.id = m_stores.tp and
                m_storetype.trackstock = 1

        ) as T1
        group by T1.iditem, T1.idstore
    ) as T2
    join m_items on m_items.id = T2.iditem and
        m_items.isservice = 0
    into :viditem, :vidstore, :vamount
    do
    begin
        if (vamount < 0) then
            exception ex_failure 'Not enough amount in stock for store '
                || 'item:[' || :viditem || ']'
                || 'store:[' || :vidstore || ']';

        if (vamount > 0) then
        begin
            update or insert into m_items_per_store (iditem, idstore, amount)
            values (:viditem, :vidstore, :vamount)
            matching (iditem, idstore);
        end
    end

    for select iditem, amount
    from (
        with IT1 as (
            select distinct iditem
            from m_rows
            where iddoc = :piddoc)
        select T1.iditem, sum(T1.amount) as amount
        from m_items_per_store as T1
        join IT1 on IT1.iditem = T1.iditem
        group by T1.iditem
    ) as T2
    join m_items on m_items.id = T2.iditem and
        m_items.amountinstore <> T2.amount
    into :viditem, :vamount do
    begin
        update m_items
        set amountinstore = :vamount
        where id = :viditem and amountinstore <> :vamount;
    end

    ret = 1;
    suspend;
end^


ALTER PROCEDURE SP_M_RECALCITEM_01A (
    PSTARTDATE DATE,
    PPROGRESSTEP INTEGER)
RETURNS (
    RET INTEGER)
AS
    declare vret damount;


    declare vcuriditem integer;

    declare vidrow1 integer;
    declare viditem1 integer;
    declare vtam1 damount;
    declare vdt1 date;
    declare vprice1 dpricex;
    declare vtp1 integer;

    declare vidrow2 integer;
    declare viditem2 integer;
    declare vtam2 damount;
    declare vdt2 date;
    declare vprice2 dpricex;

    declare vidrow3 integer;
    declare vtam3 damount;

    declare avidrow1 integer;
    declare avidrow2 integer;
    declare vdoctp integer;

    declare vamused damount;
    declare vamleft1 damount;
    declare vamleft2 damount;
    declare vtotalprice dpricex;

    declare vprogress integer;
    declare veventmessage varchar(20);

    declare CUR1 cursor for
    (
        select
            R1.id,
            R1.iditem,
            R1.amount as amountotal,
            D1.dt,
            R1.buyprice,
            D1.tp
        from m_rows as R1
        join m_docs as D1 on
            D1.id = R1.iddoc and
            D1.state in (2, 3)
        join m_doctypes on D1.tp = m_doctypes.id and
            (m_doctypes.optype = 1 or
            D1.tp in (5, 7))
        join m_items on m_items.id = R1.iditem and
            m_items.isservice = 0

        order by R1.iditem, D1.dt, R1.idseq, R1.id
    );

    declare CUR2 cursor for
    (
        select
            R1.id,
            R1.iditem,
            D1.dt, 
            D1.tp,
            R1.amount as amountotal
        from m_rows as R1
        join m_docs as D1 on
            D1.id = R1.iddoc and
            D1.state in (2, 3) and
            ((:pstartdate is null) or (D1.dt >= :pstartdate))
        join m_doctypes on D1.tp = m_doctypes.id and
            (m_doctypes.optype = 2 or
               D1.tp in (5, 7))
        join m_items on m_items.id = R1.iditem and
            m_items.isservice = 0
        order by R1.iditem, dt, R1.idseq, R1.id
    );

    declare CUR3 cursor for
    (
        select
            R1.id,
            R1.iditem,
            R1.amount as amountotal,
            -L1.amount as amountreturned,
            D1.dt,
            R1.buyprice,
            D1.tp
        from m_links as L1
        join m_rows as R1 on
            L1.id2 = :vidrow3 and
            --L1.amount < 0 and -- we have links with amount > 0 to original sale doc
                                -- or rely on optype = 1
            R1.id = L1.id1
        join m_docs as D1 on
            D1.id = R1.iddoc and
            D1.state in (2, 3)
        join m_doctypes on D1.tp = m_doctypes.id and
            m_doctypes.optype = 1
        join m_items on m_items.id = R1.iditem and
            m_items.isservice = 0

        order by R1.iditem, D1.dt, R1.idseq, R1.id
    );
begin
    veventmessage = 'Progress_' || current_connection;
    vprogress = 0;

    execute procedure sp_m_recalcamounts_1
    returning_values ret;

    if (pprogresstep > 0) then
        IN AUTONOMOUS TRANSACTION DO
            post_event veventmessage;

    if (pstartdate is null) then
    begin
        delete from m_links;
    end else
    begin
        for select m_links.id1, m_links.id2
        from m_links
        join m_rows as R2
            on R2.id = m_links.id2
        join m_docs as D2
            on D2.id = R2.iddoc and
                D2.dt >= :pstartdate
        into :vidrow1, :vidrow2
        do begin
            delete from m_links
            where id1 = :vidrow1 and id2 = :vidrow2;
        end
    end

    if (pprogresstep > 0) then
        IN AUTONOMOUS TRANSACTION DO
            post_event veventmessage;

    merge into m_rows
    using (
        select m_docs.id
        from m_docs
        join m_doctypes on m_doctypes.id = m_docs.tp and
            m_doctypes.optype = 1
        ) as T1
    on T1.id = m_rows.iddoc and
        (buyprice <> price or
        tbuyprice <> tprice)
    when matched then
    update set buyprice = price, tbuyprice = tprice;

    vamleft1 = 0;
    vamleft2 = 0;
    vtotalprice = 0;

    vcuriditem = null;

    open cur1;
    open cur2;

    vidrow1 = null;
    vidrow3 = null;

    while(1=1) do
    begin
        if (vamleft2 = 0) then
        begin
            while(1=1) do
            begin
                vprogress = vprogress + 1;
                if ((pprogresstep > 0) and (vprogress >= pprogresstep)) then
                begin
                    IN AUTONOMOUS TRANSACTION DO
                        post_event veventmessage;
                    vprogress = 0;
                end

                fetch cur2
                into :vidrow2, :viditem2, :vdt2, :vdoctp, :vtam2;
                if (row_count = 0) then leave;
                
                if ((vcuriditem is null) or (vcuriditem < viditem2)) then
                begin
                    vcuriditem = viditem2;
                    vamleft1 = 0;
                end

                vtotalprice = 0;
                vamleft2 = 0;
                vret = 0;
                if (vdoctp in (3, 10)) then
                begin
                    vamleft2 = vtam2;
                    leave;
                end
                else if (vdoctp = 4) then
                    execute procedure sp_m_recalcitem_04 (:vidrow2, :vidrow1)
                    returning_values :vret;
                else if (vdoctp = 5) then
                    execute procedure sp_m_recalcitem_05 (:vidrow2, :vidrow1)
                    returning_values :vret;
                else if (vdoctp = 6) then
                    execute procedure sp_m_recalcitem_06 (:vidrow2, :vidrow1)
                    returning_values :vret;
                else if (vdoctp = 7) then
                    execute procedure sp_m_recalcitem_07 (:vidrow2, :vidrow1)
                    returning_values :vret;

                if (vidrow1 is not null) then
                    vamleft1 = vamleft1 - vret;
            end
            if (row_count = 0) then leave;
        end

        if (vamleft1 = 0) then
        begin
            while(1=1) do
            begin
                vprogress = vprogress + 1;
                if ((pprogresstep > 0) and (vprogress >= pprogresstep)) then
                begin
                    IN AUTONOMOUS TRANSACTION DO
                        post_event veventmessage;
                    vprogress = 0;
                end
                
                if (vidrow3 is null) then
                begin

                    fetch cur1
                    into :vidrow1, :viditem1, :vtam1, :vdt1, :vprice1, :vtp1;

                    if ((row_count = 0) or (viditem1 > vcuriditem)) then leave;
    
                    if (vtp1 in (5,7)) then
                    begin

                        vidrow3 = vidrow1;
                        open cur3;

                    end else
                    begin

                        if (viditem1 = vcuriditem) then
                        begin
                            select sum(m_links.amount) as amountused
                            from m_links
                            where m_links.id1 = :vidrow1
                                --and m_links.amount > 0
                            into :vamused;
                            vamused = coalesce(vamused, 0);
            
                            vamleft1 = vtam1 - vamused;
                            if (vamleft1 > 0) then leave;
                        end

                    end

                end else
                begin

                    fetch cur3
                    into :vidrow1, :viditem1, :vtam1, :vtam3, :vdt1, :vprice1, :vtp1;

                    if (row_count = 0) then
                    begin

                        vidrow3 = null;
                        close cur3;

                    end else
                    begin

                        select sum(m_links.amount) as amountused
                        from m_links
                        where m_links.id1 = :vidrow1
                        into :vamused;
                        vamused = coalesce(vamused, 0);
        
                        if (vamused < vtam1) then
                        begin
                            vamleft1 = vtam1 - vamused;

                            -- maybe cant give more then vtam3, or we loose some row1
                            -- a bit incorrect, but we cant do it right anyway
                            -- vamleft1 = minvalue(vtam1 - vamused, vtam3);
                            leave;
                        end
                    end

                end

            end

            if ((row_count = 0) or (vdt1 > vdt2) or
                (viditem1 > vcuriditem)) then
            begin
                close cur1;
                close cur2;
                if (vidrow3 is not null) then
                    close cur3;
                exception ex_failure 'Not enough amount in stock '
                    || 'item:[' || :vcuriditem || ']';
            end

        end
        
        if (vamleft1 < 0) then
            exception ex_failure 'Bad code: vamleft1 < 0';

        vamused = minvalue(vamleft1, vamleft2);

        if (vamused > 0) then
        begin
            vamleft1 = vamleft1 - vamused;
            vamleft2 = vamleft2 - vamused;

            vtotalprice = vtotalprice + vamused * vprice1;

            if ((avidrow1 = vidrow1) and (avidrow2 = vidrow2)) then
            begin
                close cur1;
                close cur2;
                exception ex_failure 'Bad code';
            end
    
            insert into m_links (id1, id2, iditem, amount)
            values (:vidrow1, :vidrow2, :vcuriditem, :vamused);

            if (vidrow3 is not null) then
            begin

                update m_links as L1
                set L1.amount = L1.amount + :vamused
                where L1.id1 = :vidrow3 and L1.id2 = :vidrow2;

                if (row_count = 0) then
                    insert into m_links (id1, id2, iditem, amount)
                    values (:vidrow3, :vidrow2, :vcuriditem, :vamused);

            end

            avidrow1 = vidrow1;
            avidrow2 = vidrow2;

            if (vamleft2 = 0) then
            begin
                vtotalprice = round(vtotalprice, 2);
                vprice2 = round(vtotalprice / vtam2, 4);

                update m_rows
                set buyprice = :vprice2,
                    tbuyprice = :vtotalprice
                    --idseq = gen_id(gen_m_docseq, 1)
                where id = :vidrow2 and
                    (buyprice <> :vprice2 or
                    tbuyprice <> :vtotalprice);
            end

        end

    end
    close cur1;
    close cur2;

    execute procedure SP_M_RECALC_ROWSISGONE_1
    returning_values ret;

    ret = 1;
    suspend;
end^


ALTER PROCEDURE SP_M_RECALCITEM_01A_1 (
    PSTARTDATE DATE,
    PPROGRESSTEP INTEGER)
RETURNS (
    RET INTEGER)
AS
    declare vret damount;

    declare vcuriditem integer;
    declare viditem1 integer;
    declare viditem2 integer;

    declare vidrow1 integer;
    declare vidrow2 integer;
    declare avidrow1 integer;
    declare avidrow2 integer;
    declare vdoctp integer;
    declare vdt1 date;
    declare vdt2 date;

    declare vamused damount;
    declare vtam1 damount;
    declare vtam2 damount;
    declare vamleft1 damount;
    declare vamleft2 damount;
    declare vprice dpricex;
    declare vprice2 dpricex;
    declare vtotalprice dpricex;

    declare vprogress integer;
    declare veventmessage varchar(20);

    declare CUR1 cursor for
    (
        select
            R1.id,
            R1.iditem,
            R1.amount as amountotal,
            D1.dt,
            R1.buyprice
        from m_rows as R1
        join m_docs as D1 on
            D1.id = R1.iddoc and
            D1.state in (2, 3)
        join m_doctypes on D1.tp = m_doctypes.id and
            m_doctypes.optype = 1
        join m_items on m_items.id = R1.iditem and
            m_items.isservice = 0

        order by R1.iditem, D1.dt, R1.idseq, R1.id
    );

    declare CUR2 cursor for
    (
        select
            R1.id,
            R1.iditem,
            D1.dt, 
            D1.tp,
            R1.amount as amountotal
        from m_rows as R1
        join m_docs as D1 on
            D1.id = R1.iddoc and
            D1.state in (2, 3) and
            ((:pstartdate is null) or (D1.dt >= :pstartdate))
        join m_doctypes on D1.tp = m_doctypes.id and
            (m_doctypes.optype = 2 or
               D1.tp in (5, 7))
        join m_items on m_items.id = R1.iditem and
            m_items.isservice = 0
        order by R1.iditem, dt, R1.idseq, R1.id
    );
begin
    veventmessage = 'Progress_' || current_connection;
    vprogress = 0;

    execute procedure sp_m_recalcamounts_1
    returning_values ret;

    if (pprogresstep > 0) then
        IN AUTONOMOUS TRANSACTION DO
            post_event veventmessage;

    if (pstartdate is null) then
    begin
        delete from m_links;
    end else
    begin
        for select m_links.id1, m_links.id2
        from m_links
        join m_rows as R2
            on R2.id = m_links.id2
        join m_docs as D2
            on D2.id = R2.iddoc and
                D2.dt >= :pstartdate
        into :vidrow1, :vidrow2
        do begin
            delete from m_links
            where id1 = :vidrow1 and id2 = :vidrow2;
        end
    end

    if (pprogresstep > 0) then
        IN AUTONOMOUS TRANSACTION DO
            post_event veventmessage;

    merge into m_rows
    using (
        select m_docs.id
        from m_docs
        join m_doctypes on m_doctypes.id = m_docs.tp and
            m_doctypes.optype = 1
        ) as T1
    on T1.id = m_rows.iddoc and
        (buyprice <> price or
        tbuyprice <> tprice)
    when matched then
    update set buyprice = price, tbuyprice = tprice;

    vamleft1 = 0;
    vamleft2 = 0;
    vtotalprice = 0;

    vcuriditem = null;

    open cur1;
    open cur2;

    vidrow1 = null;

    while(1=1) do
    begin
        if (vamleft2 = 0) then
        begin
            while(1=1) do
            begin
                vprogress = vprogress + 1;
                if ((pprogresstep > 0) and (vprogress >= pprogresstep)) then
                begin
                    IN AUTONOMOUS TRANSACTION DO
                        post_event veventmessage;
                    vprogress = 0;
                end

                fetch cur2
                into :vidrow2, :viditem2, :vdt2, :vdoctp, :vtam2;
                if (row_count = 0) then leave;
                
                if ((vcuriditem is null) or (vcuriditem < viditem2)) then
                begin
                    vcuriditem = viditem2;
                    vamleft1 = 0;
                end

                vtotalprice = 0;
                vamleft2 = 0;
                vret = 0;
                if (vdoctp in (3, 10)) then
                begin
                    vamleft2 = vtam2;
                    leave;
                end
                else if (vdoctp = 4) then
                    execute procedure sp_m_recalcitem_04 (:vidrow2, :vidrow1)
                    returning_values :vret;
                else if (vdoctp = 5) then
                    execute procedure sp_m_recalcitem_05 (:vidrow2, :vidrow1)
                    returning_values :vret;
                else if (vdoctp = 6) then
                    execute procedure sp_m_recalcitem_06 (:vidrow2, :vidrow1)
                    returning_values :vret;
                else if (vdoctp = 7) then
                    execute procedure sp_m_recalcitem_07 (:vidrow2, :vidrow1)
                    returning_values :vret;

                if (vidrow1 is not null) then
                    vamleft1 = vamleft1 - vret;
            end
            if (row_count = 0) then leave;
        end

        if (vamleft1 = 0) then
        begin
            while(1=1) do
            begin
                vprogress = vprogress + 1;
                if ((pprogresstep > 0) and (vprogress >= pprogresstep)) then
                begin
                    IN AUTONOMOUS TRANSACTION DO
                        post_event veventmessage;
                    vprogress = 0;
                end

                fetch cur1
                into :vidrow1, :viditem1, :vtam1, :vdt1, :vprice;

                if ((row_count = 0) or (viditem1 > vcuriditem)) then leave;

                if (viditem1 = vcuriditem) then
                begin
                    select sum(m_links.amount) as amountused
                    from m_links
                    where m_links.id1 = :vidrow1
                    into :vamused;
                    vamused = coalesce(vamused, 0);
    
                    if (vamused < vtam1) then leave;
                end
            end

            if ((row_count = 0) or (vdt1 > vdt2) or
                (viditem1 > vcuriditem)) then
            begin
                close cur1;
                close cur2;
                exception ex_failure 'Not enough amount in stock '
                    || 'item:[' || :vcuriditem || ']';
            end

            vamleft1 = vtam1 - vamused;
        end
        
        vamused = minvalue(vamleft1, vamleft2);

        if (vamused > 0) then
        begin
            vamleft1 = vamleft1 - vamused;
            vamleft2 = vamleft2 - vamused;

            vtotalprice = vtotalprice + vamused * vprice;

            if ((avidrow1 = vidrow1) and (avidrow2 = vidrow2)) then
            begin
                close cur1;
                close cur2;
                exception ex_failure 'Bad code';
            end
    
            insert into m_links (id1, id2, iditem, amount)
            values (:vidrow1, :vidrow2, :vcuriditem, :vamused);

            avidrow1 = vidrow1;
            avidrow2 = vidrow2;

            if (vamleft2 = 0) then
            begin
                vtotalprice = round(vtotalprice, 2);
                vprice2 = round(vtotalprice / vtam2, 4);

                update m_rows
                set buyprice = :vprice2,
                    tbuyprice = :vtotalprice
                    --idseq = gen_id(gen_m_docseq, 1)
                where id = :vidrow2 and
                    (buyprice <> :vprice2 or
                    tbuyprice <> :vtotalprice);
            end

        end

    end
    close cur1;
    close cur2;

    execute procedure SP_M_RECALC_ROWSISGONE_1
    returning_values ret;

    ret = 1;
    suspend;
end^


ALTER PROCEDURE SP_M_RECALCITEM_01B (
    PSTARTDATE DATE,
    PPROGRESSTEP INTEGER)
RETURNS (
    RET INTEGER)
AS
    declare vret damount;

    declare vcuriditem integer;
    declare viditem1 integer;
    declare viditem2 integer;

    declare vidrow1 integer;
    declare vidrow2 integer;
    declare avidrow1 integer;
    declare avidrow2 integer;
    declare vdoctp integer;
    declare vdt1 date;
    declare vdt2 date;

    declare vamused damount;
    declare vtam1 damount;
    declare vtam2 damount;
    declare vamleft1 damount;
    declare vamleft2 damount;
    declare vprice dpricex;
    declare vprice2 dpricex;
    declare vtotalprice dpricex;

    declare vprogress integer;
    declare veventmessage varchar(20);

    declare CUR1 cursor for
    (
        select
            R1.id,
            R1.iditem,
            R1.amount as amountotal,
            D1.dt,
            R1.buyprice
        from m_rows as R1
        join m_docs as D1 on
            D1.id = R1.iddoc and
            D1.state in (2, 3) and
            R1.isgone = 0
        join m_doctypes on D1.tp = m_doctypes.id and
            m_doctypes.optype = 1
        join m_items on m_items.id = R1.iditem and
            m_items.isservice = 0
        order by R1.iditem, D1.dt, R1.idseq, R1.id
    );

    declare CUR2 cursor for
    (
        select
            R1.id,
            R1.iditem,
            D1.dt, 
            D1.tp,
            R1.amount as amountotal
        from m_rows as R1
        join m_docs as D1 on
            D1.id = R1.iddoc and
            D1.state in (2, 3) and
            ((:pstartdate is null) or (D1.dt >= :pstartdate))
        join m_doctypes on D1.tp = m_doctypes.id and
            (m_doctypes.optype = 2 or
               D1.tp in (5, 7))
        join m_items on m_items.id = R1.iditem and
            m_items.isservice = 0
        order by R1.iditem, dt, R1.idseq, R1.id
    );
begin
    -- with isgone
    veventmessage = 'Progress_' || current_connection;
    vprogress = 0;

    execute procedure sp_m_recalcamounts_1
    returning_values ret;

    if (pprogresstep > 0) then
        IN AUTONOMOUS TRANSACTION DO
            post_event veventmessage;

    if (pstartdate is null) then
    begin
        delete from m_links;

        update m_rows
        set isgone = 0
        where isgone = 1;
    end else
    begin
        for select distinct R1.id
        from m_links
        join m_rows as R2
            on R2.id = m_links.id2
        join m_rows as R1
            on R1.id = m_links.id1 and
                R1.isgone = 1
        join m_docs as D2
            on D2.id = R2.iddoc and
                D2.dt >= :pstartdate
        into :vidrow1
        do begin
            update m_rows
            set isgone = 0
            where id = :vidrow1;
        end

        for select m_links.id1, m_links.id2
        from m_links
        join m_rows as R2
            on R2.id = m_links.id2
        join m_docs as D2
            on D2.id = R2.iddoc and
                D2.dt >= :pstartdate
        into :vidrow1, :vidrow2
        do begin
            delete from m_links
            where id1 = :vidrow1 and id2 = :vidrow2;
        end
    end

    if (pprogresstep > 0) then
        IN AUTONOMOUS TRANSACTION DO
            post_event veventmessage;

    merge into m_rows
    using (
        select m_docs.id
        from m_docs
        join m_doctypes on m_doctypes.id = m_docs.tp and
            m_doctypes.optype = 1
        ) as T1
    on T1.id = m_rows.iddoc and
        (buyprice <> price or
        tbuyprice <> tprice)
    when matched then
    update set buyprice = price, tbuyprice = tprice;

    vamleft1 = 0;
    vamleft2 = 0;
    vtotalprice = 0;

    vcuriditem = null;

    open cur1;
    open cur2;

    vidrow1 = null;

    while(1=1) do
    begin
        if (vamleft2 = 0) then
        begin
            while(1=1) do
            begin
                vprogress = vprogress + 1;
                if ((pprogresstep > 0) and (vprogress >= pprogresstep)) then
                begin
                    IN AUTONOMOUS TRANSACTION DO
                        post_event veventmessage;
                    vprogress = 0;
                end

                fetch cur2
                into :vidrow2, :viditem2, :vdt2, :vdoctp, :vtam2;
                if (row_count = 0) then leave;
                
                if ((vcuriditem is null) or (vcuriditem < viditem2)) then
                begin
                    vcuriditem = viditem2;
                    vamleft1 = 0;
                end

                vtotalprice = 0;
                vamleft2 = 0;
                vret = 0;
                if (vdoctp in (3, 10)) then
                begin
                    vamleft2 = vtam2;
                    leave;
                end
                else if (vdoctp = 4) then
                    execute procedure sp_m_recalcitem_04 (:vidrow2, :vidrow1)
                    returning_values :vret;
                else if (vdoctp = 5) then
                    execute procedure sp_m_recalcitem_05 (:vidrow2, :vidrow1)
                    returning_values :vret;
                else if (vdoctp = 6) then
                    execute procedure sp_m_recalcitem_06 (:vidrow2, :vidrow1)
                    returning_values :vret;
                else if (vdoctp = 7) then
                    execute procedure sp_m_recalcitem_07 (:vidrow2, :vidrow1)
                    returning_values :vret;

                if (vidrow1 is not null) then
                    vamleft1 = vamleft1 - vret;
            end
            if (row_count = 0) then leave;
        end

        if (vamleft1 = 0) then
        begin
            while(1=1) do
            begin
                vprogress = vprogress + 1;
                if ((pprogresstep > 0) and (vprogress >= pprogresstep)) then
                begin
                    IN AUTONOMOUS TRANSACTION DO
                        post_event veventmessage;
                    vprogress = 0;
                end

                fetch cur1
                into :vidrow1, :viditem1, :vtam1, :vdt1, :vprice;

                if ((row_count = 0) or (viditem1 > vcuriditem)) then leave;

                if (viditem1 = vcuriditem) then
                begin
                    select sum(m_links.amount) as amountused
                    from m_links
                    where m_links.id1 = :vidrow1
                    into :vamused;
                    vamused = coalesce(vamused, 0);
    
                    if (vamused < vtam1) then leave;
                end
            end

            if ((row_count = 0) or (vdt1 > vdt2) or
                (viditem1 > vcuriditem)) then
            begin
                close cur1;
                close cur2;
                exception ex_failure 'Not enough amount in stock '
                    || 'item:[' || :vcuriditem || ']';
            end

            vamleft1 = vtam1 - vamused;
        end
        
        vamused = minvalue(vamleft1, vamleft2);

        if (vamused > 0) then
        begin
            vamleft1 = vamleft1 - vamused;
            vamleft2 = vamleft2 - vamused;

            vtotalprice = vtotalprice + vamused * vprice;

            if ((avidrow1 = vidrow1) and (avidrow2 = vidrow2)) then
            begin
                close cur1;
                close cur2;
                exception ex_failure 'Bad code';
            end
    
            insert into m_links (id1, id2, iditem, amount)
            values (:vidrow1, :vidrow2, :vcuriditem, :vamused);

            avidrow1 = vidrow1;
            avidrow2 = vidrow2;

            if (vamleft2 = 0) then
            begin
                vtotalprice = round(vtotalprice, 2);
                vprice2 = round(vtotalprice / vtam2, 4);

                update m_rows
                set buyprice = :vprice2,
                    tbuyprice = :vtotalprice
                    --idseq = gen_id(gen_m_docseq, 1)
                where id = :vidrow2 and
                    (buyprice <> :vprice2 or
                    tbuyprice <> :vtotalprice);
            end

        end

    end
    close cur1;
    close cur2;

    execute procedure SP_M_RECALC_ROWSISGONE_1
    returning_values ret;

    ret = 1;
    suspend;
end^


ALTER PROCEDURE SP_M_RECALCITEM_01C (
    PIDDOC INTEGER,
    PNEWDOCSTATE INTEGER,
    PPROGRESSTEP INTEGER)
RETURNS (
    RET INTEGER)
AS
    declare vret damount;
    declare vstartdate date;
    declare vcuriditem integer;

    declare vidrow1 integer;
    declare viditem1 integer;
    declare vtam1 damount;
    declare vdt1 date;
    declare vprice1 dpricex;
    declare vtp1 integer;

    declare vidrow2 integer;
    declare viditem2 integer;
    declare vtam2 damount;
    declare vdt2 date;
    declare vprice2 dpricex;

    declare vidrow3 integer;
    declare vtam3 damount;

    declare avidrow1 integer;
    declare avidrow2 integer;
    declare vdoctp integer;

    declare vamused damount;
    declare vamleft1 damount;
    declare vamleft2 damount;
    declare vtotalprice dpricex;

    declare vprogress integer;
    declare veventmessage varchar(20);

    declare CUR1 cursor for
    (
        with IT1 as (
            select distinct iditem
            from m_rows
            where iddoc = :piddoc)
        select
            R1.id,
            R1.iditem,
            R1.amount as amountotal,
            D1.dt,
            R1.buyprice,
            D1.tp
        from m_rows as R1
        join IT1 on IT1.iditem = R1.iditem
        join m_docs as D1 on
            D1.id = R1.iddoc and
            D1.state in (2, 3) and
            R1.isgone = 0
        join m_doctypes on D1.tp = m_doctypes.id and
            m_doctypes.optype = 1
        join m_items on m_items.id = R1.iditem and
            m_items.isservice = 0
        order by R1.iditem, D1.dt, R1.idseq, R1.id
    );

    declare CUR2 cursor for
    (
        with IT1 as (
            select distinct iditem
            from m_rows
            where iddoc = :piddoc)
        select
            R1.id,
            R1.iditem,
            D1.dt, 
            D1.tp,
            R1.amount as amountotal
        from m_rows as R1
        join IT1 on IT1.iditem = R1.iditem
        join m_docs as D1 on
            D1.id = R1.iddoc and
            D1.state in (2, 3) and
            ((:vstartdate is null) or (D1.dt >= :vstartdate))
        join m_doctypes on D1.tp = m_doctypes.id and
            (m_doctypes.optype = 2 or
               D1.tp in (5, 7))
        join m_items on m_items.id = R1.iditem and
            m_items.isservice = 0
        order by R1.iditem, dt, R1.idseq, R1.id
    );

    declare CUR3 cursor for
    (
        select
            R1.id,
            R1.iditem,
            R1.amount as amountotal,
            -L1.amount as amountreturned,
            D1.dt,
            R1.buyprice,
            D1.tp
        from m_links as L1
        join m_rows as R1 on
            L1.id2 = :vidrow3 and
            R1.id = L1.id1
        join m_docs as D1 on
            D1.id = R1.iddoc and
            D1.state in (2, 3)
        join m_doctypes on D1.tp = m_doctypes.id and
            m_doctypes.optype = 1
        join m_items on m_items.id = R1.iditem and
            m_items.isservice = 0

        order by R1.iditem, D1.dt, R1.idseq, R1.id
    );
begin
    -- recalc items in doc - with isgone
    veventmessage = 'Progress_' || current_connection;
    vprogress = 0;
    
    select dt from m_docs where id = :piddoc
    into :vstartdate;

    if (vstartdate is null) then
        exception ex_failure 'Bad piddoc';

    update m_rows
    set idseq = gen_id(gen_m_docseq, 1)
    where iddoc = :piddoc
    order by idseq, id;


    update m_docs
    set
        idseq = gen_id(gen_m_docseq, 1),
        state = :pnewdocstate
    where id = :piddoc;

    execute procedure SP_M_DEL_FINDOC(:piddoc);

    execute procedure sp_m_recalcamounts_2(:piddoc)
    returning_values ret;

    if (pprogresstep > 0) then
        IN AUTONOMOUS TRANSACTION DO
            post_event veventmessage;

    for select distinct R1.id
    from m_links
    join m_rows as R2
        on R2.id = m_links.id2
    join (
        select distinct iditem
        from m_rows
        where iddoc = :piddoc
    ) as IT1
        on R2.iditem = IT1.iditem
    join m_rows as R1
        on R1.id = m_links.id1 and
            R1.isgone = 1
    join m_docs as D2
        on D2.id = R2.iddoc and
            D2.dt >= :vstartdate
    into :vidrow1
    do begin
        update m_rows
        set isgone = 0
        where id = :vidrow1;
    end

    for select m_links.id1, m_links.id2
    from m_links
    join m_rows as R2
        on R2.id = m_links.id2
    join (
        select distinct iditem
        from m_rows
        where iddoc = :piddoc
    ) as IT1
        on R2.iditem = IT1.iditem
    join m_docs as D2
        on D2.id = R2.iddoc and
            D2.dt >= :vstartdate
    into :vidrow1, :vidrow2
    do begin
        delete from m_links
        where id1 = :vidrow1 and id2 = :vidrow2;
    end


    if (pprogresstep > 0) then
        IN AUTONOMOUS TRANSACTION DO
            post_event veventmessage;


    merge into m_rows
    using (
        select R1.id
        from m_rows as R1
        join m_docs as D1 on D1.id = R1.iddoc
        join m_doctypes on m_doctypes.id = D1.tp and
            m_doctypes.optype = 1
        join (
            select distinct iditem
            from m_rows
            where iddoc = :piddoc
        ) as IT1 on IT1.iditem = R1.iditem
    ) as T1
    on T1.id = m_rows.id and
        (buyprice <> price or
        tbuyprice <> tprice)
    when matched then
    update set buyprice = price, tbuyprice = tprice;




    vamleft1 = 0;
    vamleft2 = 0;
    vtotalprice = 0;

    vcuriditem = null;

    open cur1;
    open cur2;

    vidrow1 = null;
    vidrow3 = null;

    while(1=1) do
    begin
        if (vamleft2 = 0) then
        begin
            while(1=1) do
            begin
                vprogress = vprogress + 1;
                if ((pprogresstep > 0) and (vprogress >= pprogresstep)) then
                begin
                    IN AUTONOMOUS TRANSACTION DO
                        post_event veventmessage;
                    vprogress = 0;
                end

                fetch cur2
                into :vidrow2, :viditem2, :vdt2, :vdoctp, :vtam2;
                if (row_count = 0) then leave;
                
                if ((vcuriditem is null) or (vcuriditem < viditem2)) then
                begin
                    vcuriditem = viditem2;
                    vamleft1 = 0;
                end

                vtotalprice = 0;
                vamleft2 = 0;
                vret = 0;
                if (vdoctp in (3, 10)) then
                begin
                    vamleft2 = vtam2;
                    leave;
                end
                else if (vdoctp = 4) then
                    execute procedure sp_m_recalcitem_04 (:vidrow2, :vidrow1)
                    returning_values :vret;
                else if (vdoctp = 5) then
                    execute procedure sp_m_recalcitem_05 (:vidrow2, :vidrow1)
                    returning_values :vret;
                else if (vdoctp = 6) then
                    execute procedure sp_m_recalcitem_06 (:vidrow2, :vidrow1)
                    returning_values :vret;
                else if (vdoctp = 7) then
                    execute procedure sp_m_recalcitem_07 (:vidrow2, :vidrow1)
                    returning_values :vret;

                if (vidrow1 is not null) then
                    vamleft1 = vamleft1 - vret;
            end
            if (row_count = 0) then leave;
        end

        if (vamleft1 = 0) then
        begin
            while(1=1) do
            begin
                vprogress = vprogress + 1;
                if ((pprogresstep > 0) and (vprogress >= pprogresstep)) then
                begin
                    IN AUTONOMOUS TRANSACTION DO
                        post_event veventmessage;
                    vprogress = 0;
                end

                if (vidrow3 is null) then
                begin
    
                    fetch cur1
                    into :vidrow1, :viditem1, :vtam1, :vdt1, :vprice1, :vtp1;
    
                    if ((row_count = 0) or (viditem1 > vcuriditem)) then leave;
    
                    if (vtp1 in (5,7)) then
                    begin

                        vidrow3 = vidrow1;
                        open cur3;

                    end else
                    begin
    
                        if (viditem1 = vcuriditem) then
                        begin
                            select sum(m_links.amount) as amountused
                            from m_links
                            where m_links.id1 = :vidrow1
                            into :vamused;
                            vamused = coalesce(vamused, 0);
            
                            vamleft1 = vtam1 - vamused;
                            if (vamleft1 > 0) then leave;
                        end

                    end

                end else
                begin

                    fetch cur3
                    into :vidrow1, :viditem1, :vtam1, :vtam3, :vdt1, :vprice1, :vtp1;

                    if (row_count = 0) then
                    begin

                        vidrow3 = null;
                        close cur3;

                    end else
                    begin

                        select sum(m_links.amount) as amountused
                        from m_links
                        where m_links.id1 = :vidrow1
                        into :vamused;
                        vamused = coalesce(vamused, 0);
        
                        if (vamused < vtam1) then
                        begin
                            vamleft1 = vtam1 - vamused;

                            -- maybe cant give more then vtam3, or we loose some row1
                            -- a bit incorrect, but we cant do it right anyway
                            -- vamleft1 = minvalue(vtam1 - vamused, vtam3);
                            leave;
                        end
                    end

                end

            end

            if ((row_count = 0) or (vdt1 > vdt2) or
                (viditem1 > vcuriditem)) then
            begin
                close cur1;
                close cur2;
                if (vidrow3 is not null) then
                    close cur3;
                exception ex_failure 'Not enough amount in stock '
                    || 'item:[' || :vcuriditem || ']';
            end

        end

        if (vamleft1 < 0) then
            exception ex_failure 'Bad code: vamleft1 < 0';
        
        vamused = minvalue(vamleft1, vamleft2);

        if (vamused > 0) then
        begin
            vamleft1 = vamleft1 - vamused;
            vamleft2 = vamleft2 - vamused;

            vtotalprice = vtotalprice + vamused * vprice1;

            if ((avidrow1 = vidrow1) and (avidrow2 = vidrow2)) then
            begin
                close cur1;
                close cur2;
                exception ex_failure 'Bad code';
            end
    
            insert into m_links (id1, id2, iditem, amount)
            values (:vidrow1, :vidrow2, :vcuriditem, :vamused);

            if (vidrow3 is not null) then
            begin

                update m_links as L1
                set L1.amount = L1.amount + :vamused
                where L1.id1 = :vidrow3 and L1.id2 = :vidrow2;

                if (row_count = 0) then
                    insert into m_links (id1, id2, iditem, amount)
                    values (:vidrow3, :vidrow2, :vcuriditem, :vamused);

            end

            avidrow1 = vidrow1;
            avidrow2 = vidrow2;

            if (vamleft2 = 0) then
            begin
                vtotalprice = round(vtotalprice, 2);
                vprice2 = round(vtotalprice / vtam2, 4);

                update m_rows
                set buyprice = :vprice2,
                    tbuyprice = :vtotalprice
                    --idseq = gen_id(gen_m_docseq, 1)
                where id = :vidrow2 and
                    (buyprice <> :vprice2 or
                    tbuyprice <> :vtotalprice);
            end

        end

    end
    close cur1;
    close cur2;

    execute procedure SP_M_RECALC_ROWSISGONE_2(:piddoc);

    ret = 1;
    suspend;
end^


ALTER PROCEDURE SP_M_RECALCITEM_01C_1 (
    PIDDOC INTEGER,
    PNEWDOCSTATE INTEGER,
    PPROGRESSTEP INTEGER)
RETURNS (
    RET INTEGER)
AS
    declare vret damount;
    declare vstartdate date;
    declare vcuriditem integer;
    declare viditem1 integer;
    declare viditem2 integer;

    declare vidrow1 integer;
    declare vidrow2 integer;
    declare avidrow1 integer;
    declare avidrow2 integer;
    declare vdoctp integer;
    declare vdt1 date;
    declare vdt2 date;

    declare vamused damount;
    declare vtam1 damount;
    declare vtam2 damount;
    declare vamleft1 damount;
    declare vamleft2 damount;
    declare vprice dpricex;
    declare vprice2 dpricex;
    declare vtotalprice dpricex;

    declare vprogress integer;
    declare veventmessage varchar(20);

    declare CUR1 cursor for
    (
        with IT1 as (
            select distinct iditem
            from m_rows
            where iddoc = :piddoc)
        select
            R1.id,
            R1.iditem,
            R1.amount as amountotal,
            D1.dt,
            R1.buyprice
        from m_rows as R1
        join IT1 on IT1.iditem = R1.iditem
        join m_docs as D1 on
            D1.id = R1.iddoc and
            D1.state in (2, 3) and
            R1.isgone = 0
        join m_doctypes on D1.tp = m_doctypes.id and
            m_doctypes.optype = 1
        join m_items on m_items.id = R1.iditem and
            m_items.isservice = 0
        order by R1.iditem, D1.dt, R1.idseq, R1.id
    );

    declare CUR2 cursor for
    (
        with IT1 as (
            select distinct iditem
            from m_rows
            where iddoc = :piddoc)
        select
            R1.id,
            R1.iditem,
            D1.dt, 
            D1.tp,
            R1.amount as amountotal
        from m_rows as R1
        join IT1 on IT1.iditem = R1.iditem
        join m_docs as D1 on
            D1.id = R1.iddoc and
            D1.state in (2, 3) and
            ((:vstartdate is null) or (D1.dt >= :vstartdate))
        join m_doctypes on D1.tp = m_doctypes.id and
            (m_doctypes.optype = 2 or
               D1.tp in (5, 7))
        join m_items on m_items.id = R1.iditem and
            m_items.isservice = 0
        order by R1.iditem, dt, R1.idseq, R1.id
    );
begin
    -- recalc items in doc - with isgone
    veventmessage = 'Progress_' || current_connection;
    vprogress = 0;
    
    select dt from m_docs where id = :piddoc
    into :vstartdate;

    if (vstartdate is null) then
        exception ex_failure 'Bad piddoc';

    update m_rows
    set idseq = gen_id(gen_m_docseq, 1)
    where iddoc = :piddoc
    order by idseq, id;


    update m_docs
    set
        idseq = gen_id(gen_m_docseq, 1),
        state = :pnewdocstate
    where id = :piddoc;

    execute procedure SP_M_DEL_FINDOC(:piddoc);

    execute procedure sp_m_recalcamounts_2(:piddoc)
    returning_values ret;

    if (pprogresstep > 0) then
        IN AUTONOMOUS TRANSACTION DO
            post_event veventmessage;

    for select distinct R1.id
    from m_links
    join m_rows as R2
        on R2.id = m_links.id2
    join (
        select distinct iditem
        from m_rows
        where iddoc = :piddoc
    ) as IT1
        on R2.iditem = IT1.iditem
    join m_rows as R1
        on R1.id = m_links.id1 and
            R1.isgone = 1
    join m_docs as D2
        on D2.id = R2.iddoc and
            D2.dt >= :vstartdate
    into :vidrow1
    do begin
        update m_rows
        set isgone = 0
        where id = :vidrow1;
    end

    for select m_links.id1, m_links.id2
    from m_links
    join m_rows as R2
        on R2.id = m_links.id2
    join (
        select distinct iditem
        from m_rows
        where iddoc = :piddoc
    ) as IT1
        on R2.iditem = IT1.iditem
    join m_docs as D2
        on D2.id = R2.iddoc and
            D2.dt >= :vstartdate
    into :vidrow1, :vidrow2
    do begin
        delete from m_links
        where id1 = :vidrow1 and id2 = :vidrow2;
    end


    if (pprogresstep > 0) then
        IN AUTONOMOUS TRANSACTION DO
            post_event veventmessage;


    merge into m_rows
    using (
        select R1.id
        from m_rows as R1
        join m_docs as D1 on D1.id = R1.iddoc
        join m_doctypes on m_doctypes.id = D1.tp and
            m_doctypes.optype = 1
        join (
            select distinct iditem
            from m_rows
            where iddoc = :piddoc
        ) as IT1 on IT1.iditem = R1.iditem
    ) as T1
    on T1.id = m_rows.id and
        (buyprice <> price or
        tbuyprice <> tprice)
    when matched then
    update set buyprice = price, tbuyprice = tprice;




    vamleft1 = 0;
    vamleft2 = 0;
    vtotalprice = 0;

    vcuriditem = null;

    open cur1;
    open cur2;

    vidrow1 = null;

    while(1=1) do
    begin
        if (vamleft2 = 0) then
        begin
            while(1=1) do
            begin
                vprogress = vprogress + 1;
                if ((pprogresstep > 0) and (vprogress >= pprogresstep)) then
                begin
                    IN AUTONOMOUS TRANSACTION DO
                        post_event veventmessage;
                    vprogress = 0;
                end

                fetch cur2
                into :vidrow2, :viditem2, :vdt2, :vdoctp, :vtam2;
                if (row_count = 0) then leave;
                
                if ((vcuriditem is null) or (vcuriditem < viditem2)) then
                begin
                    vcuriditem = viditem2;
                    vamleft1 = 0;
                end

                vtotalprice = 0;
                vamleft2 = 0;
                vret = 0;
                if (vdoctp in (3, 10)) then
                begin
                    vamleft2 = vtam2;
                    leave;
                end
                else if (vdoctp = 4) then
                    execute procedure sp_m_recalcitem_04 (:vidrow2, :vidrow1)
                    returning_values :vret;
                else if (vdoctp = 5) then
                    execute procedure sp_m_recalcitem_05 (:vidrow2, :vidrow1)
                    returning_values :vret;
                else if (vdoctp = 6) then
                    execute procedure sp_m_recalcitem_06 (:vidrow2, :vidrow1)
                    returning_values :vret;
                else if (vdoctp = 7) then
                    execute procedure sp_m_recalcitem_07 (:vidrow2, :vidrow1)
                    returning_values :vret;

                if (vidrow1 is not null) then
                    vamleft1 = vamleft1 - vret;
            end
            if (row_count = 0) then leave;
        end

        if (vamleft1 = 0) then
        begin
            while(1=1) do
            begin
                vprogress = vprogress + 1;
                if ((pprogresstep > 0) and (vprogress >= pprogresstep)) then
                begin
                    IN AUTONOMOUS TRANSACTION DO
                        post_event veventmessage;
                    vprogress = 0;
                end

                fetch cur1
                into :vidrow1, :viditem1, :vtam1, :vdt1, :vprice;

                if ((row_count = 0) or (viditem1 > vcuriditem)) then leave;

                if (viditem1 = vcuriditem) then
                begin
                    select sum(m_links.amount) as amountused
                    from m_links
                    where m_links.id1 = :vidrow1
                    into :vamused;
                    vamused = coalesce(vamused, 0);
    
                    if (vamused < vtam1) then leave;
                end
            end

            if ((row_count = 0) or (vdt1 > vdt2) or
                (viditem1 > vcuriditem)) then
            begin
                close cur1;
                close cur2;
                exception ex_failure 'Not enough amount in stock '
                    || 'item:[' || :vcuriditem || ']';
            end

            vamleft1 = vtam1 - vamused;
        end
        
        vamused = minvalue(vamleft1, vamleft2);

        if (vamused > 0) then
        begin
            vamleft1 = vamleft1 - vamused;
            vamleft2 = vamleft2 - vamused;

            vtotalprice = vtotalprice + vamused * vprice;

            if ((avidrow1 = vidrow1) and (avidrow2 = vidrow2)) then
            begin
                close cur1;
                close cur2;
                exception ex_failure 'Bad code';
            end
    
            insert into m_links (id1, id2, iditem, amount)
            values (:vidrow1, :vidrow2, :vcuriditem, :vamused);

            avidrow1 = vidrow1;
            avidrow2 = vidrow2;

            if (vamleft2 = 0) then
            begin
                vtotalprice = round(vtotalprice, 2);
                vprice2 = round(vtotalprice / vtam2, 4);

                update m_rows
                set buyprice = :vprice2,
                    tbuyprice = :vtotalprice
                    --idseq = gen_id(gen_m_docseq, 1)
                where id = :vidrow2 and
                    (buyprice <> :vprice2 or
                    tbuyprice <> :vtotalprice);
            end

        end

    end
    close cur1;
    close cur2;

    execute procedure SP_M_RECALC_ROWSISGONE_2(:piddoc);

    ret = 1;
    suspend;
end^


ALTER PROCEDURE SP_M_RECALCITEM_04 (
    PIDROW INTEGER,
    PCURIDROW1 INTEGER)
RETURNS (
    RCURAMOUNTUSED DAMOUNT)
AS
    declare variable viditem integer;
    declare variable vidstorein integer;
    declare variable vidstoreout integer;
    declare variable vamounttolink damount;
    declare variable vamountinstore damount;
    declare variable vdt date;
    declare variable vidrow integer;
    declare variable vamounttotal damount;
    declare variable vamountused damount;
    declare variable vgotamount damount;
    declare variable vamountlinked damount;
    declare variable vprice dpricex;
    declare variable vtotalprice dpricex;
begin
    -- atgriezts piegadatajam
    select
        m_rows.iditem, m_docs.dt, m_rows.amount,
        m_docs.idstorein, m_docs.idstoreout
    from m_rows
    join m_docs on m_rows.id = :pidrow and m_docs.id = m_rows.iddoc
    into :viditem, :vdt, :vamounttolink, :vidstorein, :vidstoreout;

    rcuramountused = 0;
    vgotamount = 0;
    vtotalprice = 0;

    for select
        R1.id,
        R1.price,
        R1.amount as amountotal
    from m_rows as R1
    join m_docs as D1 on
        R1.iditem = :viditem and
        R1.isgone = 0 and
        D1.idstoreout = :vidstorein and
        D1.id = R1.iddoc and
        D1.dt <= :vdt and
        D1.state in (2, 3) and
        D1.tp = 1
    order by D1.dt desc, R1.idseq desc
    into :vidrow, :vprice, :vamounttotal
    do
    begin
        select sum(m_links.amount) as amountused
        from m_links
        where id1 = :vidrow
        into :vamountused;
        vamountused = coalesce(vamountused, 0);

        vamountlinked = minvalue(vamounttolink - vgotamount, vamounttotal - vamountused);

        if (vamountlinked > 0) then
        begin
            vgotamount = vgotamount + vamountlinked;
    
            insert into m_links (id1, id2, iditem, amount)
            values (:vidrow, :pidrow, :viditem, :vamountlinked);
            
            if ((pcuridrow1 is not null) and (vidrow = pcuridrow1)) then
            begin
                rcuramountused = vamountlinked;
            end

            vtotalprice = vtotalprice + vprice * vamountlinked;
    
            if (vgotamount >= vamounttolink) then leave;
        end
    end

    if (vgotamount < vamounttolink) then
    begin
        exception ex_failure 'Not enough amount recieved from supplier to return for '
            || 'item:[' || :viditem || ']';
    end

    vtotalprice = round(vtotalprice, 2);
    vprice = round(:vtotalprice / :vamounttolink, 4);

    update m_rows
    set
        price = :vprice,
        tprice = :vtotalprice,
        idseq = gen_id(gen_m_docseq, 1)
    where id = :pidrow and
        (price <> :vprice or
        tprice <> :vtotalprice);

    suspend;
end^


ALTER PROCEDURE SP_M_RECALCITEM_05 (
    PIDROW INTEGER,
    PCURIDROW1 INTEGER)
RETURNS (
    RCURAMOUNTUSED INTEGER)
AS
    declare variable viditem integer;
    declare variable vidstorein integer;
    declare variable vidstoreout integer;
    declare variable vamounttolink damount;
    declare variable vamountinstore damount;
    declare variable vdt date;
    declare variable vidrow integer;
    declare variable vidrow2 integer;
    declare variable vamounttotal integer;
    declare variable vamountused integer;
    declare variable vgotamount damount;
    declare variable vamountlinked damount;
    declare variable vamountlinked2 damount;
    declare variable vsellprice dpricex;
    declare variable vselltotalprice dpricex;
    declare variable vbuyprice dpricex;
    declare variable vbuytotalprice dpricex;
begin
    -- atgriezts no pirceja
    select
        m_rows.iditem, m_docs.dt, m_rows.amount,
        m_docs.idstorein, m_docs.idstoreout
    from m_rows
    join m_docs on m_rows.id = :pidrow and m_docs.id = m_rows.iddoc
    into :viditem, :vdt, :vamounttolink, :vidstorein, :vidstoreout;

    if (vamounttolink >= 0) then
        exception ex_failure 'Amount must be negative '
                || 'item:[' || :viditem || ']';

    vamounttolink = -vamounttolink;

    rcuramountused = 0;
    vgotamount = 0;
    vselltotalprice = 0;
    vbuytotalprice = 0;

    for select
        R1.id,
        R1.price,
        R1.buyprice,
        R1.amount as amountotal
    from m_rows as R1
    join m_docs as D1 on
        R1.iditem = :viditem and
        D1.idstorein = :vidstorein and
        D1.id = R1.iddoc and
        D1.dt <= :vdt and
        D1.state in (2, 3) and
        D1.tp = 3
    order by D1.dt desc, R1.idseq desc
    into :vidrow, :vsellprice, :vbuyprice, :vamounttotal
    do
    begin
        vamountlinked2 = 0;

        for select id1, sum(amount)
        from m_links
        where id2 = :vidrow
        group by id1
        order by id1
        into :vidrow2, :vamountused
        do
        begin
            vamountused = coalesce(vamountused, 0);
            vamountlinked = minvalue(vamounttolink - vgotamount, vamountused);
    
            if (vamountlinked > 0) then
            begin
                vgotamount = vgotamount + vamountlinked;
                vamountlinked2 = vamountlinked2 + vamountlinked;

                if ((pcuridrow1 is not null) and (vidrow2 = pcuridrow1)) then
                    rcuramountused = rcuramountused - vamountlinked;

                insert into m_links
                values (:vidrow2, :pidrow, :viditem, -:vamountlinked);
                
                if (vgotamount >= vamounttolink) then leave;
            end
        end

        if (vamountlinked2 > 0) then
        begin
            vselltotalprice = vselltotalprice + vsellprice * vamountlinked2;
            vbuytotalprice = vbuytotalprice + vbuyprice * vamountlinked2;

            insert into m_links
            values (:vidrow, :pidrow, :viditem, :vamountlinked2);
        end

    end

    if (vgotamount < vamounttolink) then
    begin
        exception ex_failure
            'Not enough amount sent to buyer to return for '
            || 'item:[' || :viditem || ']';
    end

    vselltotalprice = round(vselltotalprice, 2);
    vsellprice = round(vselltotalprice / vamounttolink, 4);
    vbuytotalprice = round(vbuytotalprice, 2);
    vbuyprice = round(vbuytotalprice / vamounttolink, 4);

    update m_rows
    set 
        oldprice = :vsellprice,
        toldprice = :vselltotalprice,
        buyprice = :vbuyprice,
        tbuyprice = :vbuytotalprice
    where id = :pidrow and
        (oldprice <> :vsellprice or
        toldprice <> :vselltotalprice or
        buyprice <> :vbuyprice or
        tbuyprice <> :vbuytotalprice);

    suspend;
end^


ALTER PROCEDURE SP_M_RECALCITEM_06 (
    PIDROW INTEGER,
    PCURIDROW1 INTEGER)
RETURNS (
    RCURAMOUNTUSED INTEGER)
AS
    declare variable viditem integer;
    declare variable vamounttolink damount;
    declare variable vamountincredit damount;
    declare variable vamountreceived damount;
    declare variable vamountlinked damount;
    declare variable vdt date;
    declare variable vdt2 date;
    declare variable vidcreddoc integer;
    declare variable vidcredrow integer;
    declare variable vbuyprice dpricex;
    declare variable vtbuyprice dpricex;
begin
    -- piegadataja kreditrekins
    rcuramountused = 0;

    select
        m_rows.iditem, m_docs.dt, m_rows.amount,
        m_docs.idcreddoc, m_rows.idcredrow
    from m_rows
    join m_docs on m_rows.id = :pidrow and m_docs.id = m_rows.iddoc
    into :viditem, :vdt, :vamounttolink,
        :vidcreddoc, :vidcredrow;
    
    select R1.amount, D1.dt
    from m_rows as R1
    join m_docs as D1 on D1.id = R1.iddoc
    where R1.id = :vidcredrow
    into :vamountreceived, :vdt2;

    if (vamounttolink < 0) then
        exception ex_failure 'Amount cant be < 0 ' || :pidrow;

    if (vamounttolink > vamountreceived) then
        exception ex_failure 'Credited amount greater than reveived for item:[' || :viditem || ']';

    if (vdt < vdt2) then
        exception ex_failure 'Creditdoc date older than original doc';

    select sum(R1.amount)
    from m_rows as R1
    join m_docs as D1 on D1.id = R1.iddoc and 
        R1.idcredrow = :vidcredrow and
        D1.state in (2,3)
    into :vamountincredit;
    
    vamountincredit = coalesce(vamountincredit, 0);

    if (vamountincredit > vamountreceived) then
        exception ex_failure 'Credited amount greater than received for item:[' || :viditem || ']';

    update or insert into m_links (id1, id2, iditem, amount)
    values (:vidcredrow, :pidrow, :viditem, :vamounttolink);
    
    select sum(amount)
    from m_links
    where id1 = :vidcredrow and iditem = :viditem
    into :vamountlinked;

    vamountlinked = coalesce(vamountlinked, 0);

    if (vamountlinked > vamountreceived) then
        exception ex_failure 'Used amount greater than received for item:[' || :viditem || ']';

    if ((pcuridrow1 is not null) and (vidcredrow = pcuridrow1)) then
    begin
        rcuramountused = vamounttolink;
    end

    select m_rows.price, m_docs.dt
    from m_rows join m_docs on m_docs.id = m_rows.iddoc
    where m_rows.id = :vidcredrow
    into :vbuyprice, :vdt2;

    vtbuyprice = round(vamounttolink * vbuyprice, 2);

    update m_rows
    set
        buyprice = :vbuyprice,
        tbuyprice = :vtbuyprice
    where id = :pidrow and
        (buyprice <> :vbuyprice or
        tbuyprice <> :vtbuyprice);

    suspend;
end^


ALTER PROCEDURE SP_M_RECALCITEM_07 (
    PIDROW INTEGER,
    PCURIDROW1 INTEGER)
RETURNS (
    RCURAMOUNTUSED INTEGER)
AS
    declare variable vidrow integer;
    declare variable viditem integer;
    declare variable vamounttolink damount;
    declare variable vamountincredit damount;
    declare variable vamountsold damount;
    declare variable vamountlinked damount;
    declare variable vgotamount damount;
    declare variable vamountused damount;
    declare variable vdt date;
    declare variable vdt2 date;
    declare variable vidcreddoc integer;
    declare variable vidcredrow integer;
    declare variable vsellprice dpricex;
    declare variable vbuyprice dpricex;
    declare variable vtsellprice dpricex;
    declare variable vtbuyprice dpricex;
begin
    -- realizacijas kreditrekins
    rcuramountused = 0;

    select
        m_rows.iditem, m_docs.dt, m_rows.amount,
        m_docs.idcreddoc, m_rows.idcredrow
    from m_rows
    join m_docs on m_rows.id = :pidrow and m_docs.id = m_rows.iddoc
    into :viditem, :vdt, :vamounttolink,
        :vidcreddoc, :vidcredrow;
    
    select R1.amount, D1.dt, R1.price, R1.buyprice
    from m_rows as R1
    join m_docs as D1 on D1.id = R1.iddoc
    where R1.id = :vidcredrow
    into :vamountsold, :vdt2, :vsellprice, :vbuyprice;


    if (vamounttolink >= 0) then
        exception ex_failure 'Amount must be negative ' || :pidrow;

    vamounttolink = -vamounttolink;

    if (vamounttolink > vamountsold) then
        exception ex_failure 'Credited amount greater than sale '
            || 'item:[' || :viditem || ']';

    if (vdt < vdt2) then
        exception ex_failure 'Creditdoc date older than original doc';

    select sum(R1.amount)
    from m_rows as R1
    join m_docs as D1 on D1.id = R1.iddoc and 
        R1.idcredrow = :vidcredrow and
        D1.state in (2,3)
    into :vamountincredit;

    vamountincredit = coalesce(vamountincredit, 0);

    if (vamountincredit > vamountsold) then
        exception ex_failure 'Credited amount greater than sold '
            || 'item:[' || :viditem || ']';

    update or insert into m_links (id1, id2, iditem, amount)
    values (:vidcredrow, :pidrow, :viditem, :vamounttolink);
    
    select sum(amount)
    from m_links
    where id1 = :vidcredrow and iditem = :viditem
    into :vamountlinked;

    vamountlinked = coalesce(vamountlinked, 0);

    if (vamountlinked > vamountsold) then
        exception ex_failure 'Used amount greater than sale item:[' || :viditem || ']';


    vgotamount = 0;

    for select id1, sum(amount)
    from m_links
    where id2 = :vidcredrow
    group by id1
    order by id1
    into :vidrow, :vamountused
    do
    begin
        vamountused = coalesce(vamountused, 0);
        vamountlinked = minvalue(vamounttolink - vgotamount, vamountused);

        if (vamountlinked > 0) then
        begin
            vgotamount = vgotamount + vamountlinked;

            if ((pcuridrow1 is not null) and (vidrow = pcuridrow1)) then
                rcuramountused = rcuramountused - vamounttolink;

            insert into m_links
            values (:vidrow, :pidrow, :viditem, -:vamountlinked);
    
            if (vgotamount >= vamounttolink) then leave;
        end
    end

    if (vgotamount < vamounttolink) then
    begin
        exception ex_failure
            'Not enough amount sent to buyer to return for '
            || 'item:[' || :viditem || ']';
    end

    vtsellprice = round(vamounttolink * vsellprice, 2);
    vtbuyprice = round(vamounttolink * vbuyprice, 2);

    update m_rows
    set
        oldprice = :vsellprice,
        toldprice = :vtsellprice,
        buyprice = :vbuyprice,
        tbuyprice = :vtbuyprice
    where id = :pidrow and
        (oldprice <> :vsellprice or
        toldprice <> :vtsellprice or
        buyprice <> :vbuyprice or
        tbuyprice <> :vtbuyprice);

    suspend;
end^


ALTER PROCEDURE SP_M_RECALCLASTDATES_1
AS
    declare viditem integer;
    declare vdt date;
begin
    for select m_items.id, T1.dt
    from m_items
    left join
    (
        select m_rows.iditem, max(m_docs.dt) as dt
        from m_rows 
        join m_links on m_links.id2 = m_rows.id
        join m_docs on m_docs.id = m_rows.iddoc
        group by m_rows.iditem
    ) as t1 on T1.iditem = m_items.id
    where m_items.isservice = 0
    into :viditem, :vdt
    do
    begin
        update m_items
        set lastsaledate = :vdt
        where id = :viditem and
            ((lastsaledate is null and :vdt is not null) or
            (lastsaledate is not null and :vdt is null) or
            (lastsaledate <> :vdt));
    end
end^


ALTER PROCEDURE SP_M_REMOVELINKS_01 (
    PIDDOC INTEGER,
    PNEWDOCSTATE INTEGER)
RETURNS (
    RESULT VARCHAR(300))
AS
    declare variable vidrow integer;
    declare variable viditem integer;
    declare variable vidrow2 integer;
begin
    for select m_rows.id, m_rows.iditem
    from m_docs
    join m_rows on m_docs.id = :piddoc and m_docs.id = m_rows.iddoc
    join m_items on m_items.id = m_rows.iditem and
        m_items.isservice = 0
    order by m_rows.idseq, m_rows.id
    into :vidrow, :viditem
    do
    begin
        if (exists(
            select first 1 id1
            from m_links
            where id1 = :vidrow))
        then
            exception ex_failure 'Items in row used in other doc '
                || 'item:[' || viditem || '] '
                || 'idrow:[' || vidrow || ']';
            
        for select m_rows.id
        from m_links
        join m_rows on m_links.id2 = :vidrow and
            m_rows.id = m_links.id1 and
            m_rows.isgone = 1
        into :vidrow2
        do
        begin
            update m_rows
            set isgone = 0
            where id = :vidrow2;
        end

        delete from m_links
        where id2 = :vidrow;
    end

    update m_rows
    set idseq = gen_id(gen_m_docseq, 1)
    where iddoc = :piddoc
    order by idseq, id;

    update m_docs
    set
        idseq = gen_id(gen_m_docseq, 1),
        state = :pnewdocstate
    where id = :piddoc;

    execute procedure SP_M_CALC_DOC_AMOUNTS(PIDDOC, 1);

    execute procedure SP_M_DEL_FINDOC(:piddoc);

    result = 'OK';
    suspend;
end^


ALTER PROCEDURE SP_M_REP_COSTACC_1 (
    PDT1 DATE,
    PDT2 DATE)
RETURNS (
    TP INTEGER,
    ACC1 TYPE OF COLUMN M_DOCS.ACCIN,
    ACC2 TYPE OF COLUMN M_DOCS.ACCIN,
    COST MONEY)
AS
begin
    for select tp, acc1, acc2, tbuyprice
    from
    (
        select
            D1.tp,
            R1.acc7 as acc1,
            D1.accout as acc2,
            sum(R1.tbuyprice) as tbuyprice
        from m_docs as D1
        join m_rows as R1 on D1.id = R1.iddoc and
            D1.dt between :pdt1 and :pdt2 and
            D1.tp in (3,5,7) and
            D1.state in (2,3) and
            D1.acctp2 = 1
        join m_stores as S1 on S1.id = D1.idstorein
        join m_storetype as ST1 on ST1.id = S1.tp and
            ST1.trackstock = 0
        join m_stores as S2 on S2.id = D1.idstoreout
        join m_storetype as ST2 on ST2.id = S2.tp and
            ST2.trackstock = 1
        join m_items on m_items.id = R1.iditem and
            m_items.isservice = 0
        group by D1.tp, R1.acc7, D1.accout
    ) as T1
    order by tp
    into :tp, :acc1, :acc2, :cost
    do
        suspend;
end^


ALTER PROCEDURE SP_M_REP_COSTACC_2 (
    PDT1 DATE,
    PDT2 DATE)
RETURNS (
    ID TYPE OF COLUMN M_DOCS.ID,
    DT TYPE OF COLUMN M_DOCS.DT,
    SR TYPE OF COLUMN M_DOCS.SR,
    NR TYPE OF COLUMN M_DOCS.NR,
    TP TYPE OF COLUMN M_DOCS.TP,
    IDSTOREOUT TYPE OF COLUMN M_DOCS.IDSTOREOUT,
    IDSTOREIN TYPE OF COLUMN M_DOCS.IDSTOREIN,
    ACC1 TYPE OF COLUMN M_DOCS.ACCIN,
    ACC2 TYPE OF COLUMN M_DOCS.ACCIN,
    COST MONEY)
AS
begin
    for select
        id,
        dt,
        sr,
        nr,
        tp,
        idstoreout,
        idstorein,
        acc1,
        acc2,
        tbuyprice
    from
    (
        select
            D1.id,
            min(D1.dt) as dt,
            min(D1.sr) as sr,
            min(D1.nr) as nr,
            min(D1.tp) as tp,
            min(D1.idstoreout) as idstoreout,
            min(D1.idstorein) as idstorein,
            R1.acc7 as acc1,
            D1.accout as acc2,
            sum(R1.tbuyprice) as tbuyprice
        from m_docs as D1
        join m_rows as R1 on D1.id = R1.iddoc and
            D1.dt between :pdt1 and :pdt2 and
            D1.tp in (3,5,7) and
            D1.state in (2,3) and
            D1.acctp2 = 1
        join m_stores as S1 on S1.id = D1.idstorein
        join m_storetype as ST1 on ST1.id = S1.tp and
            ST1.trackstock = 0
        join m_stores as S2 on S2.id = D1.idstoreout
        join m_storetype as ST2 on ST2.id = S2.tp and
            ST2.trackstock = 1
        join m_items on m_items.id = R1.iditem and
            m_items.isservice = 0
        group by D1.id, R1.acc7, D1.accout
    ) as T1
    order by dt
    into :id, :dt, :sr, :nr, :tp, :idstoreout, :idstorein, :acc1, :acc2, :cost
    do
        suspend;
end^


ALTER PROCEDURE SP_M_REP_ITEMLINKS_1 (
    PIDITEM INTEGER,
    PDT1 DATE,
    PDT2 DATE)
RETURNS (
    AIDD TYPE OF COLUMN M_ROWS.ID,
    AIDR TYPE OF COLUMN M_DOCS.ID,
    ADT TYPE OF COLUMN M_DOCS.DT,
    ASR TYPE OF COLUMN M_DOCS.SR,
    ANR TYPE OF COLUMN M_DOCS.NR,
    ATP TYPE OF COLUMN M_DOCS.TP,
    AIDSTOREIN TYPE OF COLUMN M_DOCS.IDSTOREIN,
    AIDSTOREOUT TYPE OF COLUMN M_DOCS.IDSTOREOUT,
    AAMOUNT TYPE OF COLUMN M_ROWS.AMOUNT,
    ABUYPRICE TYPE OF COLUMN M_ROWS.BUYPRICE,
    BIDD TYPE OF COLUMN M_ROWS.ID,
    BIDR TYPE OF COLUMN M_DOCS.ID,
    BDT TYPE OF COLUMN M_DOCS.DT,
    BSR TYPE OF COLUMN M_DOCS.SR,
    BNR TYPE OF COLUMN M_DOCS.NR,
    BTP TYPE OF COLUMN M_DOCS.TP,
    BIDSTOREIN TYPE OF COLUMN M_DOCS.IDSTOREIN,
    BIDSTOREOUT TYPE OF COLUMN M_DOCS.IDSTOREOUT,
    BAMOUNT TYPE OF COLUMN M_ROWS.AMOUNT,
    BBUYPRICE TYPE OF COLUMN M_ROWS.BUYPRICE,
    AMOUNTLINKED TYPE OF COLUMN M_ROWS.AMOUNT)
AS
    declare vaidseq integer;
    declare vbidseq integer;
begin
    for select *
    from
    (
        select
            left_part.idd as aidd,
            left_part.idr as aidr,
            left_part.idseq as aidseq,
            left_part.dt as adt,
            left_part.sr as asr,
            left_part.nr as anr,
            left_part.tp as atp,
            left_part.idstorein as aidstorein,
            left_part.idstoreout as aidstoreout,
            left_part.amount as aamount,
            left_part.buyprice as abuyprice,
    
            right_part.idd as bidd,
            right_part.idr as bidr,
            right_part.idseq as bidseq,
            right_part.dt as bdt,
            right_part.sr as bsr,
            right_part.nr as bnr,
            right_part.tp as btp,
            right_part.idstorein as bidstorein,
            right_part.idstoreout as bidstoreout,
            right_part.amount as bamount,
            right_part.buyprice as bbuyprice,
    
            left_part.amountlinked
        from
        (
            select
                L1.id2 as id2,
                D1.id as idd,
                R1.id as idr,
                D1.idseq,
                D1.dt,
                D1.sr,
                D1.nr,
                D1.tp,
                D1.idstorein,
                D1.idstoreout,
                R1.amount,
                R1.buyprice,
                L1.amount as amountlinked
            from m_rows as R1
            join m_docs as D1 on R1.iditem = :piditem and
                D1.id = R1.iddoc and
                D1.state in (2,3)
            join m_doctypes as DT1 on DT1.id = D1.tp and
                DT1.optype = 1
            left join m_links as L1 on L1.id1 = R1.id
        ) as left_part
    
        left join
    
        (
            select
                D1.id as idd,
                R1.id as idr,
                D1.idseq,
                D1.dt,
                D1.sr,
                D1.nr,
                D1.tp,
                D1.idstorein,
                D1.idstoreout,
                R1.amount,
                R1.buyprice
            from m_rows as R1
            join m_docs as D1 on R1.iditem = :piditem and
                D1.id = R1.iddoc and
                D1.state in (2,3)
            join m_doctypes as DT1 on DT1.id = D1.tp and
                DT1.optype = 2
        ) as right_part on left_part.id2 = right_part.idr
        where (left_part.dt between :pdt1 and :pdt2 or
            right_part.dt between :pdt1 and :pdt2)
    
        union all

        select
            null as aidd,
            null as aidr,
            null as aidseq,
            null as adt,
            null as asr,
            null as anr,
            null as atp,
            null as aidstorein,
            null as aidstoreout,
            null as aamount,
            null as abuyprice,

            D1.id as bidd,
            R1.id as bidr,
            D1.idseq as bidseq,
            D1.dt as bdt,
            D1.sr as bsr,
            D1.nr as bnr,
            D1.tp as btp,
            D1.idstorein as bidstorein,
            D1.idstoreout as bidstoreout,
            R1.amount as bamount,
            R1.buyprice as bbuyprice,

            null as amountlinked

        from m_rows as R1
        join m_docs as D1 on R1.iditem = :piditem and
            D1.id = R1.iddoc and
            D1.state in (2,3)
        join m_doctypes as DT1 on DT1.id = D1.tp and
            DT1.optype = 2
        left join m_links as L1 on L1.id2 = R1.id
        where L1.id1 is null and
            D1.dt between :pdt1 and :pdt2
    )
    order by adt, aidseq, bdt, bidseq
    into
        :aidd,
        :aidr,
        :vaidseq,
        :adt,
        :asr,
        :anr,
        :atp,
        :aidstorein,
        :aidstoreout,
        :aamount,
        :abuyprice,

        :bidd,
        :bidr,
        :vbidseq,
        :bdt,
        :bsr,
        :bnr,
        :btp,
        :bidstorein,
        :bidstoreout,
        :bamount,
        :bbuyprice,

        :amountlinked

    do
    suspend;
end^


ALTER PROCEDURE SP_M_REP_ITEMSAMOUNTS_1 (
    PDT1 DATE,
    PDT2 DATE,
    PCAT INTEGER)
RETURNS (
    IDITEM INTEGER,
    TP INTEGER,
    AMOUNT DAMOUNT)
AS
    declare viditem integer;
    declare vtp integer;
    declare vamount damount;

    declare vlastiditem integer;
    declare vamountatend damount;
begin
    vlastiditem = null;
    vamountatend = 0;

    for select iditem, tp, amount
    from
    (
        select T1.iditem, -1 as tp, sum(T1.amount) as amount
        from
        (
            select R1.iditem, 0 as tp, R1.amount
            from m_docs as D1
            join m_rows as R1 on D1.id = R1.iddoc and
                D1.dt < :pdt1 and
                D1.state in (2,3)
            join m_stores as S1 on S1.id = D1.idstorein
            join m_storetype as ST1 on ST1.id = S1.tp and
                ST1.trackstock = 1
            join m_stores as S2 on S2.id = D1.idstoreout
            join m_storetype as ST2 on ST2.id = S2.tp and
                ST2.trackstock = 0
            
            union all
        
            select R1.iditem, 0 as tp, -R1.amount
            from m_docs as D1
            join m_rows as R1 on D1.id = R1.iddoc and
                D1.dt < :pdt1 and
                D1.state in (2,3)
            join m_stores as S1 on S1.id = D1.idstorein
            join m_storetype as ST1 on ST1.id = S1.tp and
                ST1.trackstock = 0
            join m_stores as S2 on S2.id = D1.idstoreout
            join m_storetype as ST2 on ST2.id = S2.tp and
                ST2.trackstock = 1
        ) as T1
        group by T1.iditem
    
        union all
    
        select R1.iditem, D1.tp, sum(R1.amount) as amount
        from m_docs as D1
        join m_rows as R1 on D1.id = R1.iddoc and
            D1.dt between :pdt1 and :pdt2 and
            D1.state in (2,3)
        join m_stores as S1 on S1.id = D1.idstorein
        join m_storetype as ST1 on ST1.id = S1.tp and
            ST1.trackstock = 1
        join m_stores as S2 on S2.id = D1.idstoreout
        join m_storetype as ST2 on ST2.id = S2.tp and
            ST2.trackstock = 0
        group by R1.iditem, D1.tp
    
        union all
    
        select R1.iditem, D1.tp, -sum(R1.amount) as amount
        from m_docs as D1
        join m_rows as R1 on D1.id = R1.iddoc and
            D1.dt between :pdt1 and :pdt2 and
            D1.state in (2,3)
        join m_stores as S1 on S1.id = D1.idstorein
        join m_storetype as ST1 on ST1.id = S1.tp and
            ST1.trackstock = 0
        join m_stores as S2 on S2.id = D1.idstoreout
        join m_storetype as ST2 on ST2.id = S2.tp and
            ST2.trackstock = 1
        group by R1.iditem, D1.tp
    ) as T2
    join m_items on m_items.id = T2.iditem and
        m_items.isservice = 0 and
        (:pcat is null or m_items.cat = :pcat)
    order by iditem, tp
    into :viditem, :vtp, :vamount
    do
    begin
        if (vlastiditem is null) then vlastiditem = viditem;
        if (vlastiditem <> viditem) then
        begin
            iditem = vlastiditem;
            tp = 100;
            amount = vamountatend;
            suspend;

            vlastiditem = viditem;
            vamountatend = 0;
        end

        vamountatend = vamountatend + vamount;

        iditem = viditem;
        tp = vtp;
        amount = vamount;
        suspend;
    end

    if (vlastiditem is not null) then
    begin
        iditem = vlastiditem;
        tp = 100;
        amount = vamountatend;
        suspend;
    end

end^


ALTER PROCEDURE SP_M_REP_ITEMSAMOUNTS_2 (
    PDT1 DATE,
    PDT2 DATE,
    PCAT INTEGER)
RETURNS (
    IDITEM INTEGER,
    TP INTEGER,
    AMOUNT DAMOUNT,
    TBUYPRICE MONEY)
AS
    declare viditem integer;
    declare vtp integer;
    declare vamount damount;
    declare vbuyprice money;

    declare vlastiditem integer;
    declare vamountatend damount;
    declare vbuypriceatend money;
begin
    vlastiditem = null;
    vamountatend = 0;
    vbuypriceatend = 0;

    for select iditem, tp, amount, tbuyprice
    from
    (
        select
            T1.iditem,
            -1 as tp,
            sum(T1.amount) as amount,
            sum(T1.tbuyprice) as tbuyprice
        from
        (
            select R1.iditem, 0 as tp, R1.amount, R1.tbuyprice
            from m_docs as D1
            join m_rows as R1 on D1.id = R1.iddoc and
                D1.dt < :pdt1 and
                D1.state in (2,3)
            join m_stores as S1 on S1.id = D1.idstorein
            join m_storetype as ST1 on ST1.id = S1.tp and
                ST1.trackstock = 1
            join m_stores as S2 on S2.id = D1.idstoreout
            join m_storetype as ST2 on ST2.id = S2.tp and
                ST2.trackstock = 0
            
            union all
        
            select R1.iditem, 0 as tp, -R1.amount, -R1.tbuyprice
            from m_docs as D1
            join m_rows as R1 on D1.id = R1.iddoc and
                D1.dt < :pdt1 and
                D1.state in (2,3)
            join m_stores as S1 on S1.id = D1.idstorein
            join m_storetype as ST1 on ST1.id = S1.tp and
                ST1.trackstock = 0
            join m_stores as S2 on S2.id = D1.idstoreout
            join m_storetype as ST2 on ST2.id = S2.tp and
                ST2.trackstock = 1
        ) as T1
        group by T1.iditem
    
        union all
    
        select
            R1.iditem,
            D1.tp,
            sum(R1.amount) as amount,
            sum(R1.tbuyprice) as tbuyprice
        from m_docs as D1
        join m_rows as R1 on D1.id = R1.iddoc and
            D1.dt between :pdt1 and :pdt2 and
            D1.state in (2,3)
        join m_stores as S1 on S1.id = D1.idstorein
        join m_storetype as ST1 on ST1.id = S1.tp and
            ST1.trackstock = 1
        join m_stores as S2 on S2.id = D1.idstoreout
        join m_storetype as ST2 on ST2.id = S2.tp and
            ST2.trackstock = 0
        group by R1.iditem, D1.tp
    
        union all
    
        select
            R1.iditem,
            D1.tp,
            -sum(R1.amount) as amount,
            -sum(R1.tbuyprice) as tbuyprice
        from m_docs as D1
        join m_rows as R1 on D1.id = R1.iddoc and
            D1.dt between :pdt1 and :pdt2 and
            D1.state in (2,3)
        join m_stores as S1 on S1.id = D1.idstorein
        join m_storetype as ST1 on ST1.id = S1.tp and
            ST1.trackstock = 0
        join m_stores as S2 on S2.id = D1.idstoreout
        join m_storetype as ST2 on ST2.id = S2.tp and
            ST2.trackstock = 1
        group by R1.iditem, D1.tp
    ) as T2
    join m_items on m_items.id = T2.iditem and
        m_items.isservice = 0 and
        (:pcat is null or m_items.cat = :pcat)
    order by iditem, tp
    into :viditem, :vtp, :vamount, :vbuyprice
    do
    begin
        if (vlastiditem is null) then vlastiditem = viditem;
        if (vlastiditem <> viditem) then
        begin
            iditem = vlastiditem;
            tp = 100;
            amount = vamountatend;
            tbuyprice = vbuypriceatend;
            suspend;

            vlastiditem = viditem;
            vamountatend = 0;
            vbuypriceatend = 0;
        end
        vamountatend = vamountatend + vamount;
        vbuypriceatend = vbuypriceatend + vbuyprice;

        iditem = viditem;
        tp = vtp;
        amount = vamount;
        tbuyprice = vbuyprice;
        suspend;
    end

    if (vlastiditem is not null) then
    begin
        iditem = vlastiditem;
        tp = 100;
        amount = vamountatend;
        tbuyprice = vbuypriceatend;
        suspend;
    end

end^


ALTER PROCEDURE SP_M_REP_ITEMSAMOUNTS_3 (
    PDT1 DATE,
    PDT2 DATE,
    PCAT INTEGER)
RETURNS (
    IDITEM INTEGER,
    TP INTEGER,
    AMOUNT DAMOUNT,
    TSELLPRICE MONEY,
    TBUYPRICE MONEY,
    ITEMPRICE DPRICEX)
AS
    declare viditem integer;
    declare vtp integer;
    declare vamount damount;
    declare vbuyprice money;
    declare vprice money;

    declare vlastiditem integer;
    declare vamountatend damount;
    declare vsellpriceatend money;
    declare vbuypriceatend money;
begin
    vlastiditem = null;
    vamountatend = 0;
    vsellpriceatend = 0;
    vbuypriceatend = 0;

    for select iditem, tp, amount, tprice, tbuyprice, m_items.sellprice
    from
    (
        select
            T1.iditem,
            -1 as tp,
            sum(T1.amount) as amount,
            0 as tprice,
            sum(T1.tbuyprice) as tbuyprice
        from
        (
            select R1.iditem, R1.amount, R1.tbuyprice
            from m_docs as D1
            join m_rows as R1 on D1.id = R1.iddoc and
                D1.dt < :pdt1 and
                D1.state in (2,3)
            join m_stores as S1 on S1.id = D1.idstorein
            join m_storetype as ST1 on ST1.id = S1.tp and
                ST1.trackstock = 1
            join m_stores as S2 on S2.id = D1.idstoreout
            join m_storetype as ST2 on ST2.id = S2.tp and
                ST2.trackstock = 0
            
            union all
        
            select R1.iditem, -R1.amount, -R1.tbuyprice
            from m_docs as D1
            join m_rows as R1 on D1.id = R1.iddoc and
                D1.dt < :pdt1 and
                D1.state in (2,3)
            join m_stores as S1 on S1.id = D1.idstorein
            join m_storetype as ST1 on ST1.id = S1.tp and
                ST1.trackstock = 0
            join m_stores as S2 on S2.id = D1.idstoreout
            join m_storetype as ST2 on ST2.id = S2.tp and
                ST2.trackstock = 1
        ) as T1
        group by T1.iditem
    
        union all
    
        select
            R1.iditem,
            D1.tp,
            sum(R1.amount) as amount,
            sum(R1.tprice) as tprice,
            sum(R1.tbuyprice) as tbuyprice
        from m_docs as D1
        join m_rows as R1 on D1.id = R1.iddoc and
            D1.dt between :pdt1 and :pdt2 and
            D1.state in (2,3)
        join m_stores as S1 on S1.id = D1.idstorein
        join m_storetype as ST1 on ST1.id = S1.tp and
            ST1.trackstock = 1
        join m_stores as S2 on S2.id = D1.idstoreout
        join m_storetype as ST2 on ST2.id = S2.tp and
            ST2.trackstock = 0
        group by R1.iditem, D1.tp
    
        union all
    
        select
            R1.iditem,
            D1.tp,
            -sum(R1.amount) as amount,
            -sum(R1.tprice) as tprice,
            -sum(R1.tbuyprice) as tbuyprice
        from m_docs as D1
        join m_rows as R1 on D1.id = R1.iddoc and
            D1.dt between :pdt1 and :pdt2 and
            D1.state in (2,3)
        join m_stores as S1 on S1.id = D1.idstorein
        join m_storetype as ST1 on ST1.id = S1.tp and
            ST1.trackstock = 0
        join m_stores as S2 on S2.id = D1.idstoreout
        join m_storetype as ST2 on ST2.id = S2.tp and
            ST2.trackstock = 1
        group by R1.iditem, D1.tp
    ) as T2
    join m_items on m_items.id = T2.iditem and
        m_items.isservice = 0 and
        (:pcat is null or m_items.cat = :pcat)
    order by iditem, tp
    into :viditem, :vtp, :vamount, :vprice, :vbuyprice, :itemprice
    do
    begin
        if (vlastiditem is null) then vlastiditem = viditem;
        if (vlastiditem <> viditem) then
        begin
            iditem = vlastiditem;
            tp = 100;
            amount = vamountatend;
            tsellprice = vsellpriceatend;
            tbuyprice = vbuypriceatend;
            suspend;

            vlastiditem = viditem;
            vamountatend = 0;
            vsellpriceatend = 0;
            vbuypriceatend = 0;
        end
        vamountatend = vamountatend + vamount;
        vsellpriceatend = vsellpriceatend + vprice;
        vbuypriceatend = vbuypriceatend + vbuyprice;

        iditem = viditem;
        tp = vtp;
        amount = vamount;
        tsellprice = vprice;
        tbuyprice = vbuyprice;
        suspend;
    end

    if (vlastiditem is not null) then
    begin
        iditem = vlastiditem;
        tp = 100;
        amount = vamountatend;
        tsellprice = vsellpriceatend;
        tbuyprice = vbuypriceatend;
     suspend;
    end

end^


ALTER PROCEDURE SP_M_REP_ITEMSAMOUNTS_4 (
    PDT1 DATE,
    PDT2 DATE,
    PCAT INTEGER)
RETURNS (
    IDSTORE INTEGER,
    TP INTEGER,
    AMOUNT DAMOUNT,
    TSELLPRICE MONEY,
    TBUYPRICE MONEY)
AS
    declare vidstore integer;
    declare vtp integer;
    declare vamount damount;
    declare vbuyprice money;
    declare vprice money;

    declare vlastidstore integer;
    declare vamountatend damount;
    declare vsellpriceatend money;
    declare vbuypriceatend money;
begin
    vlastidstore = null;
    vamountatend = 0;
    vsellpriceatend = 0;
    vbuypriceatend = 0;

    for select
        idstore,
        tp,
        sum(amount) as amount,
        sum(tprice) as tprice,
        sum(tbuyprice) as tbuyprice
    from
    (
        select
            T1.iditem,
            T1.idstore,
            -1 as tp,
            sum(T1.amount) as amount,
            0 as tprice,
            sum(T1.tbuyprice) as tbuyprice
        from
        (
            select
                R1.iditem,
                D1.idstoreout as idstore,
                R1.amount,
                R1.tbuyprice
            from m_docs as D1
            join m_rows as R1 on D1.id = R1.iddoc and
                D1.dt < :pdt1 and
                D1.state in (2,3)
            join m_stores as S1 on S1.id = D1.idstorein
            join m_storetype as ST1 on ST1.id = S1.tp and
                ST1.trackstock = 1
            join m_stores as S2 on S2.id = D1.idstoreout
            join m_storetype as ST2 on ST2.id = S2.tp and
                ST2.trackstock = 0
            
            union all
        
            select
                R1.iditem,
                D2.idstoreout as idstore,
                -L1.amount,
                -round(L1.amount * R2.buyprice,2) as tbuyprice
            from m_docs as D1
            join m_rows as R1 on D1.id = R1.iddoc and
                D1.dt < :pdt1 and
                D1.state in (2,3)
            join m_stores as S1 on S1.id = D1.idstorein
            join m_storetype as ST1 on ST1.id = S1.tp and
                ST1.trackstock = 0
            join m_stores as S2 on S2.id = D1.idstoreout
            join m_storetype as ST2 on ST2.id = S2.tp and
                ST2.trackstock = 1
            join m_links as L1 on L1.id2 = R1.id
            join m_rows as R2 on R2.id = L1.id1
            join m_docs as D2 on D2.id = R2.iddoc
        ) as T1
        group by T1.iditem, T1.idstore
    
        union all
    
        select
            R1.iditem, 
            D1.idstoreout as idstore,
            D1.tp,
            sum(R1.amount) as amount,
            sum(R1.tprice) as tprice,
            sum(R1.tbuyprice) as tbuyprice
        from m_docs as D1
        join m_rows as R1 on D1.id = R1.iddoc and
            D1.dt between :pdt1 and :pdt2 and
            D1.state in (2,3)
        join m_stores as S1 on S1.id = D1.idstorein
        join m_storetype as ST1 on ST1.id = S1.tp and
            ST1.trackstock = 1
        join m_stores as S2 on S2.id = D1.idstoreout
        join m_storetype as ST2 on ST2.id = S2.tp and
            ST2.trackstock = 0
        group by R1.iditem, D1.idstoreout, D1.tp
    
        union all
    
        select
            R1.iditem, 
            D2.idstoreout as idstore,
            D1.tp,
            -sum(L1.amount) as amount,
            -sum(round(L1.amount * R1.price,2)) as tprice,
            -sum(round(L1.amount * R2.buyprice,2)) as tbuyprice

        from m_docs as D1
        join m_rows as R1 on D1.id = R1.iddoc and
            D1.dt between :pdt1 and :pdt2 and
            D1.state in (2,3)
        join m_stores as S1 on S1.id = D1.idstorein
        join m_storetype as ST1 on ST1.id = S1.tp and
            ST1.trackstock = 0
        join m_stores as S2 on S2.id = D1.idstoreout
        join m_storetype as ST2 on ST2.id = S2.tp and
            ST2.trackstock = 1
        join m_links as L1 on L1.id2 = R1.id
        join m_rows as R2 on R2.id = L1.id1
        join m_docs as D2 on D2.id = R2.iddoc

        group by R1.iditem, D2.idstoreout, D1.tp

    ) as T2
    join m_items on m_items.id = T2.iditem and
        m_items.isservice = 0 and
        (:pcat is null or m_items.cat = :pcat)
    group by idstore, tp
    order by idstore, tp
    into :vidstore, :vtp, :vamount, :vprice, :vbuyprice
    do
    begin
        if (vlastidstore is null) then vlastidstore = vidstore;
        if (vlastidstore <> vidstore) then
        begin
            idstore = vlastidstore;
            tp = 100;
            amount = vamountatend;
            tsellprice = vsellpriceatend;
            tbuyprice = vbuypriceatend;
            suspend;

            vlastidstore = vidstore;
            vamountatend = 0;
            vsellpriceatend = 0;
            vbuypriceatend = 0;
        end
        vamountatend = vamountatend + vamount;
        vsellpriceatend = vsellpriceatend + vprice;
        vbuypriceatend = vbuypriceatend + vbuyprice;

        idstore = vidstore;
        tp = vtp;
        amount = vamount;
        tsellprice = vprice;
        tbuyprice = vbuyprice;
        suspend;
    end

    if (vlastidstore is not null) then
    begin
        idstore = vlastidstore;
        tp = 100;
        amount = vamountatend;
        tsellprice = vsellpriceatend;
        tbuyprice = vbuypriceatend;
     suspend;
    end

end^


ALTER PROCEDURE SP_M_REP_ITEMSAMOUNTS_5 (
    PDT1 DATE,
    PDT2 DATE,
    PCAT INTEGER)
RETURNS (
    IDCAT INTEGER,
    TP INTEGER,
    AMOUNT DAMOUNT,
    TSELLPRICE MONEY,
    TBUYPRICE MONEY)
AS
    declare vidcat integer;
    declare vtp integer;
    declare vamount damount;
    declare vbuyprice money;
    declare vprice money;

    declare vlastidcat integer;
    declare vamountatend damount;
    declare vsellpriceatend money;
    declare vbuypriceatend money;
begin
    vlastidcat = null;
    vamountatend = 0;
    vsellpriceatend = 0;
    vbuypriceatend = 0;

    for select
        m_items.cat as idcat,
        tp,
        sum(amount) as amount,
        sum(tprice) as tprice,
        sum(tbuyprice) as tbuyprice
    from
    (
        select
            T1.iditem,
            -1 as tp,
            sum(T1.amount) as amount,
            0 as tprice,
            sum(T1.tbuyprice) as tbuyprice
        from
        (
            select R1.iditem, R1.amount, R1.tbuyprice
            from m_docs as D1
            join m_rows as R1 on D1.id = R1.iddoc and
                D1.dt < :pdt1 and
                D1.state in (2,3)
            join m_stores as S1 on S1.id = D1.idstorein
            join m_storetype as ST1 on ST1.id = S1.tp and
                ST1.trackstock = 1
            join m_stores as S2 on S2.id = D1.idstoreout
            join m_storetype as ST2 on ST2.id = S2.tp and
                ST2.trackstock = 0
            
            union all
        
            select R1.iditem, -R1.amount, -R1.tbuyprice
            from m_docs as D1
            join m_rows as R1 on D1.id = R1.iddoc and
                D1.dt < :pdt1 and
                D1.state in (2,3)
            join m_stores as S1 on S1.id = D1.idstorein
            join m_storetype as ST1 on ST1.id = S1.tp and
                ST1.trackstock = 0
            join m_stores as S2 on S2.id = D1.idstoreout
            join m_storetype as ST2 on ST2.id = S2.tp and
                ST2.trackstock = 1
        ) as T1
        group by T1.iditem
    
        union all
    
        select
            R1.iditem,
            D1.tp,
            sum(R1.amount) as amount,
            sum(R1.tprice) as tprice,
            sum(R1.tbuyprice) as tbuyprice
        from m_docs as D1
        join m_rows as R1 on D1.id = R1.iddoc and
            D1.dt between :pdt1 and :pdt2 and
            D1.state in (2,3)
        join m_stores as S1 on S1.id = D1.idstorein
        join m_storetype as ST1 on ST1.id = S1.tp and
            ST1.trackstock = 1
        join m_stores as S2 on S2.id = D1.idstoreout
        join m_storetype as ST2 on ST2.id = S2.tp and
            ST2.trackstock = 0
        group by R1.iditem, D1.tp
    
        union all
    
        select
            R1.iditem,
            D1.tp,
            -sum(R1.amount) as amount,
            -sum(R1.tprice) as tprice,
            -sum(R1.tbuyprice) as tbuyprice
        from m_docs as D1
        join m_rows as R1 on D1.id = R1.iddoc and
            D1.dt between :pdt1 and :pdt2 and
            D1.state in (2,3)
        join m_stores as S1 on S1.id = D1.idstorein
        join m_storetype as ST1 on ST1.id = S1.tp and
            ST1.trackstock = 0
        join m_stores as S2 on S2.id = D1.idstoreout
        join m_storetype as ST2 on ST2.id = S2.tp and
            ST2.trackstock = 1
        group by R1.iditem, D1.tp
    ) as T2
    join m_items on m_items.id = T2.iditem and
        m_items.isservice = 0 and
        (:pcat is null or m_items.cat = :pcat)
    group by m_items.cat, T2.tp
    order by idcat, tp
    into :vidcat, :vtp, :vamount, :vprice, :vbuyprice
    do
    begin
        if (vlastidcat is null) then vlastidcat = vidcat;
        if (vlastidcat <> vidcat) then
        begin
            idcat = vlastidcat;
            tp = 100;
            amount = vamountatend;
            tsellprice = vsellpriceatend;
            tbuyprice = vbuypriceatend;
            suspend;

            vlastidcat = vidcat;
            vamountatend = 0;
            vsellpriceatend = 0;
            vbuypriceatend = 0;
        end
        vamountatend = vamountatend + vamount;
        vsellpriceatend = vsellpriceatend + vprice;
        vbuypriceatend = vbuypriceatend + vbuyprice;

        idcat = vidcat;
        tp = vtp;
        amount = vamount;
        tsellprice = vprice;
        tbuyprice = vbuyprice;
        suspend;
    end

    if (vlastidcat is not null) then
    begin
        idcat = vlastidcat;
        tp = 100;
        amount = vamountatend;
        tsellprice = vsellpriceatend;
        tbuyprice = vbuypriceatend;
     suspend;
    end

end^


ALTER PROCEDURE SP_OPS_DELETE (
    ORIGINAL_ID INTEGER,
    ORIGINAL_DOCID INTEGER,
    ISNULL_DESCR INTEGER,
    ORIGINAL_DESCR VARCHAR(50),
    ORIGINAL_AC11 VARCHAR(8),
    ISNULL_AC12 INTEGER,
    ORIGINAL_AC12 VARCHAR(8),
    ISNULL_AC13 INTEGER,
    ORIGINAL_AC13 VARCHAR(5),
    ISNULL_AC14 INTEGER,
    ORIGINAL_AC14 VARCHAR(8),
    ISNULL_AC15 INTEGER,
    ORIGINAL_AC15 VARCHAR(5),
    ORIGINAL_AC21 VARCHAR(8),
    ISNULL_AC22 INTEGER,
    ORIGINAL_AC22 VARCHAR(8),
    ISNULL_AC23 INTEGER,
    ORIGINAL_AC23 VARCHAR(5),
    ISNULL_AC24 INTEGER,
    ORIGINAL_AC24 VARCHAR(8),
    ISNULL_AC25 INTEGER,
    ORIGINAL_AC25 VARCHAR(5),
    ORIGINAL_SUMMC NUMERIC(15,4),
    ORIGINAL_CUR VARCHAR(3),
    ORIGINAL_SUMM NUMERIC(15,4),
    ISNULL_QV INTEGER,
    ORIGINAL_QV FLOAT,
    ISNULL_ZDT INTEGER,
    ORIGINAL_ZDT TIMESTAMP)
AS
declare variable VUSER varchar(50);
    declare variable O_ZDT timestamp;
begin

    DELETE FROM OPS
    WHERE (
        (id = :Original_id) AND
        (DocId = :Original_DocId) AND
        ((:IsNull_Descr = 1 AND Descr IS NULL) OR (Descr = :Original_Descr)) AND
        (AC11 = :Original_AC11) AND
        ((:IsNull_AC12 = 1 AND AC12 IS NULL) OR (AC12 = :Original_AC12)) AND
        ((:IsNull_AC13 = 1 AND AC13 IS NULL) OR (AC13 = :Original_AC13)) AND
        ((:IsNull_AC14 = 1 AND AC14 IS NULL) OR (AC14 = :Original_AC14)) AND
        ((:IsNull_AC15 = 1 AND AC15 IS NULL) OR (AC15 = :Original_AC15)) AND
        (AC21 = :Original_AC21) AND
        ((:IsNull_AC22 = 1 AND AC22 IS NULL) OR (AC22 = :Original_AC22)) AND
        ((:IsNull_AC23 = 1 AND AC23 IS NULL) OR (AC23 = :Original_AC23)) AND
        ((:IsNull_AC24 = 1 AND AC24 IS NULL) OR (AC24 = :Original_AC24)) AND
        ((:IsNull_AC25 = 1 AND AC25 IS NULL) OR (AC25 = :Original_AC25)) AND
        (SummC = :Original_SummC) AND
        (Cur = :Original_Cur) AND
        (Summ = :Original_Summ) AND
        ((:IsNull_QV = 1 AND QV IS NULL) OR (QV = :Original_QV))
    );

    O_ZDt = :Original_ZDt;
    IF (:IsNull_ZDt = 1) THEN
    BEGIN
        O_ZDt = null;
    END

    VUSER = rdb$get_context('USER_SESSION', 'UserName');
    if(VUSER is null) then VUSER = User;

     execute procedure sp_ops_delete_log(
        :Original_id,
        :vuser,
        :Original_DocId, 
        :Original_AC11, 
        :Original_AC12, 
        :Original_AC13, 
        :Original_AC14, 
        :Original_AC15, 
        :Original_AC21, 
        :Original_AC22, 
        :Original_AC23, 
        :Original_AC24, 
        :Original_AC25, 
        :Original_SummC, 
        :Original_Cur, 
        :Original_Summ, 
        :Original_QV,
        :O_ZDt);

end^


ALTER PROCEDURE SP_OPS_DELETE_LOG (
    ID INTEGER,
    USR VARCHAR(15),
    ORIGINAL_DOCID INTEGER,
    ORIGINAL_AC11 VARCHAR(8),
    ORIGINAL_AC12 VARCHAR(8),
    ORIGINAL_AC13 VARCHAR(5),
    ORIGINAL_AC14 VARCHAR(8),
    ORIGINAL_AC15 VARCHAR(5),
    ORIGINAL_AC21 VARCHAR(8),
    ORIGINAL_AC22 VARCHAR(8),
    ORIGINAL_AC23 VARCHAR(5),
    ORIGINAL_AC24 VARCHAR(8),
    ORIGINAL_AC25 VARCHAR(5),
    ORIGINAL_SUMMC NUMERIC(15,4),
    ORIGINAL_CUR VARCHAR(3),
    ORIGINAL_SUMM NUMERIC(15,4),
    ORIGINAL_QV FLOAT,
    ORIGINAL_ZDT TIMESTAMP)
AS
DECLARE idl INT;
    DECLARE now timestamp;
    DECLARE xdt timestamp;
BEGIN
    now = localtimestamp(0);
    xdt = dateadd(-1 hour to now);

    IF (:Original_ZDt IS NULL OR :Original_ZDt < xdt)
    THEN BEGIN
        INSERT INTO LOPS 
            (dtl, dtld, usl, id, DocId,
            AC11, AC12, AC13, AC14, AC15,
            AC21, AC22, AC23, AC24, AC25,
            SummC, Cur, Summ, QV, ODT)
        VALUES 
        (
            :now,
            :now,
            :Usr,
            :id,
            :Original_DocId, 
            :Original_AC11,
            :Original_AC12, 
            :Original_AC13, 
            :Original_AC14, 
            :Original_AC15, 
            :Original_AC21, 
            :Original_AC22, 
            :Original_AC23, 
            :Original_AC24, 
            :Original_AC25, 
            :Original_SummC, 
            :Original_Cur, 
            :Original_Summ, 
            :Original_QV,
            :ORIGINAL_ZDT
        );
    END
    ELSE BEGIN

        UPDATE LOPS
        SET 
            dtld = :now
        WHERE LOPS.id = :id;

    END
END^


ALTER PROCEDURE SP_OPS_FILTER_AND (
    PDATE1 DATE,
    PDATE2 DATE,
    PTEXT VARCHAR(50),
    PCLID VARCHAR(15),
    PAC11 VARCHAR(8),
    PAC12 VARCHAR(8),
    PAC13 VARCHAR(5),
    PAC14 VARCHAR(8),
    PAC15 VARCHAR(5),
    PAC21 VARCHAR(8),
    PAC22 VARCHAR(8),
    PAC23 VARCHAR(5),
    PAC24 VARCHAR(8),
    PAC25 VARCHAR(5),
    PDOCGR VARCHAR(10))
RETURNS (
    ID TYPE OF COLUMN OPS.ID,
    DOCID TYPE OF COLUMN OPS.DOCID,
    DESCR TYPE OF COLUMN OPS.DESCR,
    AC11 TYPE OF COLUMN OPS.AC11,
    AC12 TYPE OF COLUMN OPS.AC12,
    AC13 TYPE OF COLUMN OPS.AC13,
    AC14 TYPE OF COLUMN OPS.AC14,
    AC15 TYPE OF COLUMN OPS.AC15,
    AC21 TYPE OF COLUMN OPS.AC21,
    AC22 TYPE OF COLUMN OPS.AC22,
    AC23 TYPE OF COLUMN OPS.AC23,
    AC24 TYPE OF COLUMN OPS.AC24,
    AC25 TYPE OF COLUMN OPS.AC25,
    SUMMC TYPE OF COLUMN OPS.SUMMC,
    CUR TYPE OF COLUMN OPS.CUR,
    SUMM TYPE OF COLUMN OPS.SUMM,
    QV TYPE OF COLUMN OPS.QV,
    NL TYPE OF COLUMN OPS.NL,
    ZDT TYPE OF COLUMN OPS.ZDT)
AS
begin
    if
    (
        pac11 is null and
        pac12 is null and
        pac13 is null and
        pac14 is null and
        pac15 is null and
        pac21 is null and
        pac22 is null and
        pac23 is null and
        pac24 is null and
        pac25 is null

    )
    then begin
        for select ops.id,
                 ops.docid,
                 ops.descr,
                 ops.ac11,
                 ops.ac12,
                 ops.ac13,
                 ops.ac14,
                 ops.ac15,
                 ops.ac21,
                 ops.ac22,
                 ops.ac23,
                 ops.ac24,
                 ops.ac25,
                 ops.summc,
                 ops.cur,
                 ops.summ,
                 ops.qv,
                 ops.nl,
                 ops.zdt
        
          FROM OPSd JOIN OPS ON OPSd.id = OPS.DocId

          WHERE
            (:pdate1 IS NULL OR opsd.DETE >= :pdate1) AND
            (:pdate2 IS NULL OR opsd.DETE <= :pdate2) AND
            (:pclid IS NULL OR ClId = :pclid OR ClId2 = :pclid) AND
            (:ptext IS NULL OR OPSd.Descr LIKE :ptext)  AND
            (
                :PDOCGR IS NULL OR EXISTS(
                    SELECT DTA.ID
                    FROM doctypb AS DTB inner join doctypa AS DTA on DTB.ida = DTA.id
                    WHERE DTB.ID = OPSD.doctyp AND DTA.ID = :PDOCGR
                )
            )

          ORDER BY OPSd.DETE, OPSd.id, OPS.id
          into :id,
               :docid,
               :descr,
               :ac11,
               :ac12,
               :ac13,
               :ac14,
               :ac15,
               :ac21,
               :ac22,
               :ac23,
               :ac24,
               :ac25,
               :summc,
               :cur,
               :summ,
               :qv,
               :nl,
               :zdt
        do
        begin
            suspend;
        end
    end

    else begin

        for select ops.id,
                 ops.docid,
                 ops.descr,
                 ops.ac11,
                 ops.ac12,
                 ops.ac13,
                 ops.ac14,
                 ops.ac15,
                 ops.ac21,
                 ops.ac22,
                 ops.ac23,
                 ops.ac24,
                 ops.ac25,
                 ops.summc,
                 ops.cur,
                 ops.summ,
                 ops.qv,
                 ops.nl,
                 ops.zdt
        
          FROM OPSd JOIN OPS ON OPSd.id = OPS.DocId

          WHERE
            (:pdate1 IS NULL OR opsd.DETE >= :pdate1) AND
            (:pdate2 IS NULL OR opsd.DETE <= :pdate2) AND
            (:pclid IS NULL OR ClId = :pclid OR ClId2 = :pclid) AND
            (:ptext IS NULL OR OPSd.Descr LIKE :ptext) AND
            (
                :PDOCGR IS NULL OR EXISTS(
                    SELECT DTA.ID
                    FROM doctypb AS DTB inner join doctypa AS DTA on DTB.ida = DTA.id
                    WHERE DTB.ID = OPSD.doctyp AND DTA.ID = :PDOCGR
                )
            ) AND
            EXISTS
            (
                
                SELECT NULL
                FROM OPS o1
                WHERE
                (
                    (o1.DocId = OPSd.id) AND
                    (
                        (
                            (:pac11 IS NULL OR o1.AC11 LIKE :pac11) AND
                            (:pac12 IS NULL OR o1.AC12 LIKE :pac12) AND
                            (:pac13 IS NULL OR o1.AC13 LIKE :pac13) AND
                            (:pac14 IS NULL OR o1.AC14 LIKE :pac14) AND
                            (:pac15 IS NULL OR o1.AC15 LIKE :pac15)
                        )
                        AND
                        (
                            (:pac21 IS NULL OR o1.AC21 LIKE :pac21) AND
                            (:pac22 IS NULL OR o1.AC22 LIKE :pac22) AND
                            (:pac23 IS NULL OR o1.AC23 LIKE :pac23) AND
                            (:pac24 IS NULL OR o1.AC24 LIKE :pac24) AND
                            (:pac25 IS NULL OR o1.AC25 LIKE :pac25)
                        )
                    )
                )
            )

          ORDER BY OPSd.DETE, OPSd.id, OPS.id
          into :id,
               :docid,
               :descr,
               :ac11,
               :ac12,
               :ac13,
               :ac14,
               :ac15,
               :ac21,
               :ac22,
               :ac23,
               :ac24,
               :ac25,
               :summc,
               :cur,
               :summ,
               :qv,
               :nl,
               :zdt
        do
        begin
            suspend;
        end

    end
end^


ALTER PROCEDURE SP_OPS_FILTER_OR (
    PDATE1 DATE,
    PDATE2 DATE,
    PTEXT VARCHAR(50),
    PCLID VARCHAR(15),
    PAC11 VARCHAR(8),
    PAC12 VARCHAR(8),
    PAC13 VARCHAR(5),
    PAC14 VARCHAR(8),
    PAC15 VARCHAR(5),
    PAC21 VARCHAR(8),
    PAC22 VARCHAR(8),
    PAC23 VARCHAR(5),
    PAC24 VARCHAR(8),
    PAC25 VARCHAR(5),
    PDOCGR VARCHAR(10))
RETURNS (
    ID TYPE OF COLUMN OPS.ID,
    DOCID TYPE OF COLUMN OPS.DOCID,
    DESCR TYPE OF COLUMN OPS.DESCR,
    AC11 TYPE OF COLUMN OPS.AC11,
    AC12 TYPE OF COLUMN OPS.AC12,
    AC13 TYPE OF COLUMN OPS.AC13,
    AC14 TYPE OF COLUMN OPS.AC14,
    AC15 TYPE OF COLUMN OPS.AC15,
    AC21 TYPE OF COLUMN OPS.AC21,
    AC22 TYPE OF COLUMN OPS.AC22,
    AC23 TYPE OF COLUMN OPS.AC23,
    AC24 TYPE OF COLUMN OPS.AC24,
    AC25 TYPE OF COLUMN OPS.AC25,
    SUMMC TYPE OF COLUMN OPS.SUMMC,
    CUR TYPE OF COLUMN OPS.CUR,
    SUMM TYPE OF COLUMN OPS.SUMM,
    QV TYPE OF COLUMN OPS.QV,
    NL TYPE OF COLUMN OPS.NL,
    ZDT TYPE OF COLUMN OPS.ZDT)
AS
begin
    if
    (
        pac11 is null and
        pac12 is null and
        pac13 is null and
        pac14 is null and
        pac15 is null and
        pac21 is null and
        pac22 is null and
        pac23 is null and
        pac24 is null and
        pac25 is null

    )
    then begin
        for select ops.id,
                 ops.docid,
                 ops.descr,
                 ops.ac11,
                 ops.ac12,
                 ops.ac13,
                 ops.ac14,
                 ops.ac15,
                 ops.ac21,
                 ops.ac22,
                 ops.ac23,
                 ops.ac24,
                 ops.ac25,
                 ops.summc,
                 ops.cur,
                 ops.summ,
                 ops.qv,
                 ops.nl,
                 ops.zdt
        
          FROM OPSd JOIN OPS ON OPSd.id = OPS.DocId

          WHERE
            (:pdate1 IS NULL OR opsd.DETE >= :pdate1) AND
            (:pdate2 IS NULL OR opsd.DETE <= :pdate2) AND
            (:pclid IS NULL OR ClId = :pclid OR ClId2 = :pclid) AND
            (:ptext IS NULL OR OPSd.Descr LIKE :ptext) AND
            (
                :PDOCGR IS NULL OR EXISTS(
                    SELECT DTA.ID
                    FROM doctypb AS DTB inner join doctypa AS DTA on DTB.ida = DTA.id
                    WHERE DTB.ID = OPSD.doctyp AND DTA.ID = :PDOCGR
                )
            )

          ORDER BY OPSd.DETE, OPSd.id, OPS.id
          into :id,
               :docid,
               :descr,
               :ac11,
               :ac12,
               :ac13,
               :ac14,
               :ac15,
               :ac21,
               :ac22,
               :ac23,
               :ac24,
               :ac25,
               :summc,
               :cur,
               :summ,
               :qv,
               :nl,
               :zdt
        do
        begin
            suspend;
        end
    end

    else begin

        for select ops.id,
                 ops.docid,
                 ops.descr,
                 ops.ac11,
                 ops.ac12,
                 ops.ac13,
                 ops.ac14,
                 ops.ac15,
                 ops.ac21,
                 ops.ac22,
                 ops.ac23,
                 ops.ac24,
                 ops.ac25,
                 ops.summc,
                 ops.cur,
                 ops.summ,
                 ops.qv,
                 ops.nl,
                 ops.zdt
        
          FROM OPSd JOIN OPS ON OPSd.id = OPS.DocId

          WHERE
            (:pdate1 IS NULL OR opsd.DETE >= :pdate1) AND
            (:pdate2 IS NULL OR opsd.DETE <= :pdate2) AND
            (:pclid IS NULL OR ClId = :pclid OR ClId2 = :pclid) AND
            (:ptext IS NULL OR OPSd.Descr LIKE :ptext) AND
            (
                :PDOCGR IS NULL OR EXISTS(
                    SELECT DTA.ID
                    FROM doctypb AS DTB inner join doctypa AS DTA on DTB.ida = DTA.id
                    WHERE DTB.ID = OPSD.doctyp AND DTA.ID = :PDOCGR
                )
            ) AND
            EXISTS
            (
                
                SELECT NULL
                FROM OPS o1
                WHERE
                (
                    (o1.DocId = OPSd.id) AND
                    (
                        (
                            (:pac11 IS NULL OR o1.AC11 LIKE :pac11) AND
                            (:pac12 IS NULL OR o1.AC12 LIKE :pac12) AND
                            (:pac13 IS NULL OR o1.AC13 LIKE :pac13) AND
                            (:pac14 IS NULL OR o1.AC14 LIKE :pac14) AND
                            (:pac15 IS NULL OR o1.AC15 LIKE :pac15)
                        )
                        OR
                        (
                            (:pac21 IS NULL OR o1.AC21 LIKE :pac21) AND
                            (:pac22 IS NULL OR o1.AC22 LIKE :pac22) AND
                            (:pac23 IS NULL OR o1.AC23 LIKE :pac23) AND
                            (:pac24 IS NULL OR o1.AC24 LIKE :pac24) AND
                            (:pac25 IS NULL OR o1.AC25 LIKE :pac25)
                        )
                    )
                )
            )

          ORDER BY OPSd.DETE, OPSd.id, OPS.id
          into :id,
               :docid,
               :descr,
               :ac11,
               :ac12,
               :ac13,
               :ac14,
               :ac15,
               :ac21,
               :ac22,
               :ac23,
               :ac24,
               :ac25,
               :summc,
               :cur,
               :summ,
               :qv,
               :nl,
               :zdt
        do
        begin
            suspend;
        end

    end
end^


ALTER PROCEDURE SP_OPS_ID
RETURNS (
    NEXTID INTEGER)
AS
begin
    nextid = GEN_ID("GEN_OPS_ID",1);
    suspend;
end^


ALTER PROCEDURE SP_OPS_IDK (
    PK INTEGER)
RETURNS (
    NEXTID INTEGER)
AS
begin
    nextid = GEN_ID("GEN_OPS_ID", :PK);
    suspend;
end^


ALTER PROCEDURE SP_OPS_INSERT (
    PID INTEGER,
    PDOCID INTEGER,
    PDESCR VARCHAR(50),
    PAC11 VARCHAR(8),
    PAC12 VARCHAR(8),
    PAC13 VARCHAR(5),
    PAC14 VARCHAR(8),
    PAC15 VARCHAR(5),
    PAC21 VARCHAR(8),
    PAC22 VARCHAR(8),
    PAC23 VARCHAR(5),
    PAC24 VARCHAR(8),
    PAC25 VARCHAR(5),
    PSUMMC NUMERIC(15,4),
    PCUR VARCHAR(3),
    PSUMM NUMERIC(15,4),
    PQV FLOAT,
    PNL SMALLINT)
RETURNS (
    ID TYPE OF COLUMN OPS.ID,
    DOCID TYPE OF COLUMN OPS.DOCID,
    DESCR TYPE OF COLUMN OPS.DESCR,
    AC11 TYPE OF COLUMN OPS.AC11,
    AC12 TYPE OF COLUMN OPS.AC12,
    AC13 TYPE OF COLUMN OPS.AC13,
    AC14 TYPE OF COLUMN OPS.AC14,
    AC15 TYPE OF COLUMN OPS.AC15,
    AC21 TYPE OF COLUMN OPS.AC21,
    AC22 TYPE OF COLUMN OPS.AC22,
    AC23 TYPE OF COLUMN OPS.AC23,
    AC24 TYPE OF COLUMN OPS.AC24,
    AC25 TYPE OF COLUMN OPS.AC25,
    SUMMC TYPE OF COLUMN OPS.SUMMC,
    CUR TYPE OF COLUMN OPS.CUR,
    SUMM TYPE OF COLUMN OPS.SUMM,
    QV TYPE OF COLUMN OPS.QV,
    NL TYPE OF COLUMN OPS.NL,
    ZDT TYPE OF COLUMN OPS.ZDT)
AS
declare newid int;
begin
    INSERT INTO OPS
        (id, ZDt, DocId, Descr,
        AC11, AC12, AC13, AC14, AC15, 
        AC21, AC22, AC23, AC24, AC25, 
        SummC, Cur, Summ, QV, NL) 
    VALUES 
        (:pid, localtimestamp(0), :pDocId, :pDescr,
        :pAC11, :pAC12, :pAC13, :pAC14, :pAC15,
        :pAC21, :pAC22, :pAC23, :pAC24, :pAC25,
        :pSummC, :pCur, :pSumm, :pQV, :pNL)
    RETURNING
        id, DocId, Descr, 
        AC11, AC12, AC13, AC14, AC15, 
        AC21, AC22, AC23, AC24, AC25, 
        SummC, Cur, Summ, QV, NL, ZDt
    INTO
        :id, :DocId, :Descr,
        :AC11, :AC12, :AC13, :AC14, :AC15, 
        :AC21, :AC22, :AC23, :AC24, :AC25, 
        :SummC, :Cur, :Summ, :QV, :NL, :ZDt;

end^


ALTER PROCEDURE SP_OPS_UPDATE (
    PDOCID INTEGER,
    PDESCR VARCHAR(50),
    PAC11 VARCHAR(8),
    PAC12 VARCHAR(8),
    PAC13 VARCHAR(5),
    PAC14 VARCHAR(8),
    PAC15 VARCHAR(5),
    PAC21 VARCHAR(8),
    PAC22 VARCHAR(8),
    PAC23 VARCHAR(5),
    PAC24 VARCHAR(8),
    PAC25 VARCHAR(5),
    PSUMMC NUMERIC(15,4),
    PCUR VARCHAR(3),
    PSUMM NUMERIC(15,4),
    PQV FLOAT,
    PNL SMALLINT,
    ORIGINAL_ID INTEGER,
    ORIGINAL_DOCID INTEGER,
    ISNULL_DESCR INTEGER,
    ORIGINAL_DESCR VARCHAR(50),
    ORIGINAL_AC11 VARCHAR(8),
    ISNULL_AC12 INTEGER,
    ORIGINAL_AC12 VARCHAR(8),
    ISNULL_AC13 INTEGER,
    ORIGINAL_AC13 VARCHAR(5),
    ISNULL_AC14 INTEGER,
    ORIGINAL_AC14 VARCHAR(8),
    ISNULL_AC15 INTEGER,
    ORIGINAL_AC15 VARCHAR(5),
    ORIGINAL_AC21 VARCHAR(8),
    ISNULL_AC22 INTEGER,
    ORIGINAL_AC22 VARCHAR(8),
    ISNULL_AC23 INTEGER,
    ORIGINAL_AC23 VARCHAR(5),
    ISNULL_AC24 INTEGER,
    ORIGINAL_AC24 VARCHAR(8),
    ISNULL_AC25 INTEGER,
    ORIGINAL_AC25 VARCHAR(5),
    ORIGINAL_SUMMC NUMERIC(15,4),
    ORIGINAL_CUR VARCHAR(3),
    ORIGINAL_SUMM NUMERIC(15,4),
    ISNULL_QV INTEGER,
    ORIGINAL_QV FLOAT,
    ISNULL_NL INTEGER,
    ORIGINAL_NL SMALLINT,
    ISNULL_ZDT INTEGER,
    ORIGINAL_ZDT TIMESTAMP,
    PID INTEGER)
RETURNS (
    ID TYPE OF COLUMN OPS.ID,
    DOCID TYPE OF COLUMN OPS.DOCID,
    DESCR TYPE OF COLUMN OPS.DESCR,
    AC11 TYPE OF COLUMN OPS.AC11,
    AC12 TYPE OF COLUMN OPS.AC12,
    AC13 TYPE OF COLUMN OPS.AC13,
    AC14 TYPE OF COLUMN OPS.AC14,
    AC15 TYPE OF COLUMN OPS.AC15,
    AC21 TYPE OF COLUMN OPS.AC21,
    AC22 TYPE OF COLUMN OPS.AC22,
    AC23 TYPE OF COLUMN OPS.AC23,
    AC24 TYPE OF COLUMN OPS.AC24,
    AC25 TYPE OF COLUMN OPS.AC25,
    SUMMC TYPE OF COLUMN OPS.SUMMC,
    CUR TYPE OF COLUMN OPS.CUR,
    SUMM TYPE OF COLUMN OPS.SUMM,
    QV TYPE OF COLUMN OPS.QV,
    NL TYPE OF COLUMN OPS.NL,
    ZDT TYPE OF COLUMN OPS.ZDT)
AS
declare variable VUSER varchar(50);
    declare variable O_ZDT timestamp;
begin

    UPDATE OPS
    SET 
        DocId = :pDocId,
        Descr = :pDescr,
        AC11 = :pAC11,
        AC12 = :pAC12,
        AC13 = :pAC13,
        AC14 = :pAC14,
        AC15 = :pAC15,
        AC21 = :pAC21,
        AC22 = :pAC22,
        AC23 = :pAC23,
        AC24 = :pAC24,
        AC25 = :pAC25,
        SummC = :pSummC,
        Cur = :pCur,
        Summ = :pSumm,
        QV = :pQV,
        NL = :pNL,
        ZDt = localtimestamp(0)
    WHERE (
        (id = :Original_id) AND
        (DocId = :Original_DocId) AND
        ((:IsNull_Descr = 1 AND Descr IS NULL) OR (Descr = :Original_Descr)) AND
        (AC11 = :Original_AC11) AND
        ((:IsNull_AC12 = 1 AND AC12 IS NULL) OR (AC12 = :Original_AC12)) AND
        ((:IsNull_AC13 = 1 AND AC13 IS NULL) OR (AC13 = :Original_AC13)) AND
        ((:IsNull_AC14 = 1 AND AC14 IS NULL) OR (AC14 = :Original_AC14)) AND
        ((:IsNull_AC15 = 1 AND AC15 IS NULL) OR (AC15 = :Original_AC15)) AND
        (AC21 = :Original_AC21) AND
        ((:IsNull_AC22 = 1 AND AC22 IS NULL) OR (AC22 = :Original_AC22)) AND
        ((:IsNull_AC23 = 1 AND AC23 IS NULL) OR (AC23 = :Original_AC23)) AND
        ((:IsNull_AC24 = 1 AND AC24 IS NULL) OR (AC24 = :Original_AC24)) AND
        ((:IsNull_AC25 = 1 AND AC25 IS NULL) OR (AC25 = :Original_AC25)) AND
        (SummC = :Original_SummC) AND
        (Cur = :Original_Cur) AND
        (Summ = :Original_Summ) AND
        ((:IsNull_QV = 1 AND QV IS NULL) OR (QV = :Original_QV))
    );

    O_ZDt = ORIGINAL_ZDT;
    IF (ISNULL_ZDT = 1) THEN
    BEGIN
        O_ZDt = null;
    END

    VUSER = rdb$get_context('USER_SESSION', 'UserName');
    if(VUSER is null) then VUSER = User;

     execute procedure sp_ops_update_log(
        :Original_id,
        :vuser,
        :Original_DocId, 
        :Original_AC11, 
        :Original_AC12, 
        :Original_AC13, 
        :Original_AC14, 
        :Original_AC15, 
        :Original_AC21, 
        :Original_AC22, 
        :Original_AC23, 
        :Original_AC24, 
        :Original_AC25, 
        :Original_SummC, 
        :Original_Cur, 
        :Original_Summ, 
        :Original_QV,
        :O_ZDt);


    SELECT 
        id, DocId, Descr, 
        AC11, AC12, AC13, AC14, AC15, 
        AC21, AC22, AC23, AC24, AC25, 
        SummC, Cur, Summ, QV, NL, ZDt
    FROM OPS 
    WHERE (id = :pid)
    INTO
        :id, :DocId, :Descr,
        :AC11, :AC12, :AC13, :AC14, :AC15, 
        :AC21, :AC22, :AC23, :AC24, :AC25, 
        :SummC, :Cur, :Summ, :QV, :NL, :ZDt;

end^


ALTER PROCEDURE SP_OPS_UPDATE_LOG (
    ID INTEGER,
    USR VARCHAR(15),
    ORIGINAL_DOCID INTEGER,
    ORIGINAL_AC11 VARCHAR(8),
    ORIGINAL_AC12 VARCHAR(8),
    ORIGINAL_AC13 VARCHAR(5),
    ORIGINAL_AC14 VARCHAR(8),
    ORIGINAL_AC15 VARCHAR(5),
    ORIGINAL_AC21 VARCHAR(8),
    ORIGINAL_AC22 VARCHAR(8),
    ORIGINAL_AC23 VARCHAR(5),
    ORIGINAL_AC24 VARCHAR(8),
    ORIGINAL_AC25 VARCHAR(5),
    ORIGINAL_SUMMC NUMERIC(15,4),
    ORIGINAL_CUR VARCHAR(3),
    ORIGINAL_SUMM NUMERIC(15,4),
    ORIGINAL_QV FLOAT,
    ORIGINAL_ZDT TIMESTAMP)
AS
declare variable IDL integer;
    declare variable NOW timestamp;
    declare variable XDT timestamp;
BEGIN
    now = localtimestamp(0);
    xdt = dateadd(-1 hour to now);

    IF (:Original_ZDt IS NULL OR :Original_ZDt < xdt)
    THEN BEGIN
        INSERT INTO LOPS 
            (dtl, usl, id, DocId,
            AC11, AC12, AC13, AC14, AC15,
            AC21, AC22, AC23, AC24, AC25,
            SummC, Cur, Summ, QV, ODT)
        VALUES 
        (
            :now,
            :Usr,
            :id,
            :Original_DocId, 
            :Original_AC11,
            :Original_AC12, 
            :Original_AC13, 
            :Original_AC14, 
            :Original_AC15, 
            :Original_AC21, 
            :Original_AC22, 
            :Original_AC23, 
            :Original_AC24, 
            :Original_AC25, 
            :Original_SummC, 
            :Original_Cur, 
            :Original_Summ, 
            :Original_QV,
            :ORIGINAL_ZDT
        );
    END
END^


ALTER PROCEDURE SP_OPSD_DELETE (
    ORIGINAL_ID INTEGER,
    ORIGINAL_DATE DATE,
    ISNULL_NRX INTEGER,
    ORIGINAL_NRX VARCHAR(5),
    ISNULL_DOCTYP INTEGER,
    ORIGINAL_DOCTYP VARCHAR(10),
    ISNULL_DOCST INTEGER,
    ORIGINAL_DOCST VARCHAR(6),
    ISNULL_DOCNR INTEGER,
    ORIGINAL_DOCNR VARCHAR(15),
    ISNULL_CLID INTEGER,
    ORIGINAL_CLID VARCHAR(15),
    ISNULL_CLID2 INTEGER,
    ORIGINAL_CLID2 VARCHAR(15),
    ISNULL_DESCR INTEGER,
    ORIGINAL_DESCR VARCHAR(80),
    ORIGINAL_SUMM NUMERIC(15,4),
    ORIGINAL_PVN NUMERIC(15,4),
    ORIGINAL_ZNR INTEGER,
    ISNULL_ZU INTEGER,
    ORIGINAL_ZU VARCHAR(20),
    ISNULL_ZDT INTEGER,
    ORIGINAL_ZDT TIMESTAMP,
    ISNULL_DT2 INTEGER,
    ORIGINAL_DT2 DATE,
    ISNULL_IDDOCM INTEGER,
    ORIGINAL_IDDOCM INTEGER)
AS
declare variable VUSER varchar(50);
declare variable O_ZDT timestamp;
begin
    DELETE FROM OPSd
    WHERE 
    (
        (id = :Original_id) AND 
        (DETE = :Original_Date) AND
        ((:IsNull_NrX = 1 AND NrX IS NULL) OR (NrX = :Original_NrX)) AND 
        ((:IsNull_DocTyp = 1 AND DocTyp IS NULL) OR (DocTyp = :Original_DocTyp)) AND 
        ((:IsNull_DocSt = 1 AND DocSt IS NULL) OR (DocSt = :Original_DocSt)) AND 
        ((:IsNull_DocNr = 1 AND DocNr IS NULL) OR (DocNr = :Original_DocNr)) AND 
        ((:IsNull_ClId = 1 AND ClId IS NULL) OR (ClId = :Original_ClId)) AND 
        ((:IsNull_ClId2 = 1 AND ClId2 IS NULL) OR (ClId2 = :Original_ClId2)) AND 
        ((:IsNull_Descr = 1 AND Descr IS NULL) OR (Descr = :Original_Descr)) AND 
        (Summ = :Original_Summ) AND 
        (PVN = :Original_PVN) AND 
        (ZNR = :Original_ZNR) AND 
        ((:IsNull_DT2 = 1 AND DT2 IS NULL) OR (DT2 = :Original_DT2)) AND
        ((:IsNull_iddocm = 1 AND IDDOCM IS NULL) OR (IDDOCM = :Original_iddocm))
    );

    O_ZDt = :Original_ZDt;
    IF (:IsNull_ZDt = 1) THEN
    BEGIN
        O_ZDt = null;
    END

    VUSER = rdb$get_context('USER_SESSION', 'UserName');
    if(VUSER is null) then VUSER = User;

    EXECUTE PROCEDURE sp_opsd_delete_log(
            :Original_id,
            :VUSER,
            :Original_Date, 
            :Original_NrX, 
            :Original_DocTyp, 
            :Original_DocSt, 
            :Original_DocNr, 
            :Original_ClId, 
            :Original_ClId2, 
            :Original_Descr, 
            :Original_Summ, 
            :Original_PVN, 
            :Original_ZNR,
            :O_ZDt);


end^


ALTER PROCEDURE SP_OPSD_DELETE_LOG (
    ID INTEGER,
    USR VARCHAR(15),
    ORIGINAL_DATE DATE,
    ORIGINAL_NRX VARCHAR(5),
    ORIGINAL_DOCTYP VARCHAR(10),
    ORIGINAL_DOCST VARCHAR(6),
    ORIGINAL_DOCNR VARCHAR(15),
    ORIGINAL_CLID VARCHAR(15),
    ORIGINAL_CLID2 VARCHAR(15),
    ORIGINAL_DESCR VARCHAR(80),
    ORIGINAL_SUMM NUMERIC(15,4),
    ORIGINAL_PVN NUMERIC(15,4),
    ORIGINAL_ZNR INTEGER,
    ORIGINAL_ZDT TIMESTAMP)
AS
declare variable IDL integer;
    declare variable NOW timestamp;
    declare variable XDT timestamp;
begin
    now = current_timestamp(0);
    xdt = dateadd(-1 hour to now);

    IF (:Original_ZDt IS NULL OR :Original_ZDt < xdt)
    THEN BEGIN

        INSERT INTO LOPSD
            (id, ZDt, dtld, ZU, DETE, NrX,
            DocTyp, DocSt, DocNr,
            ClId, ClId2, Descr, Summ, PVN, ZNR, ODT)
        VALUES (
            :id,
            :now,
            :now,
            :Usr,
            :Original_Date, 
            :Original_NrX, 
            :Original_DocTyp, 
            :Original_DocSt, 
            :Original_DocNr, 
            :Original_ClId, 
            :Original_ClId2, 
            :Original_Descr, 
            :Original_Summ, 
            :Original_PVN, 
            :Original_ZNR,
            :ORIGINAL_ZDT
            );

    END
    ELSE BEGIN

        UPDATE LOPSD 
        SET 
            dtld = :now
        WHERE LOPSD.id = :id;

    END

end^


ALTER PROCEDURE SP_OPSD_FILTER_AND (
    PDATE1 DATE,
    PDATE2 DATE,
    PTEXT VARCHAR(50),
    PCLID VARCHAR(15),
    PAC11 VARCHAR(8),
    PAC12 VARCHAR(8),
    PAC13 VARCHAR(5),
    PAC14 VARCHAR(8),
    PAC15 VARCHAR(5),
    PAC21 VARCHAR(8),
    PAC22 VARCHAR(8),
    PAC23 VARCHAR(5),
    PAC24 VARCHAR(8),
    PAC25 VARCHAR(5),
    PDOCGR VARCHAR(10))
RETURNS (
    ID TYPE OF COLUMN OPSD.ID,
    DETE TYPE OF COLUMN OPSD.DETE,
    NRX TYPE OF COLUMN OPSD.NRX,
    DOCTYP TYPE OF COLUMN OPSD.DOCTYP,
    DOCST TYPE OF COLUMN OPSD.DOCST,
    DOCNR TYPE OF COLUMN OPSD.DOCNR,
    CLID TYPE OF COLUMN OPSD.CLID,
    CLID2 TYPE OF COLUMN OPSD.CLID2,
    DESCR TYPE OF COLUMN OPSD.DESCR,
    SUMM TYPE OF COLUMN OPSD.SUMM,
    PVN TYPE OF COLUMN OPSD.PVN,
    OPT TYPE OF COLUMN OPSD.OPT,
    ZNR TYPE OF COLUMN OPSD.ZNR,
    ZU TYPE OF COLUMN OPSD.ZU,
    ZDT TYPE OF COLUMN OPSD.ZDT,
    DT2 TYPE OF COLUMN OPSD.DT2,
    YR TYPE OF COLUMN OPSD.YR,
    NL TYPE OF COLUMN OPSD.NL,
    IDDOCM TYPE OF COLUMN OPSD.IDDOCM)
AS
begin
    if
    (
        pac11 is null and
        pac12 is null and
        pac13 is null and
        pac14 is null and
        pac15 is null and
        pac21 is null and
        pac22 is null and
        pac23 is null and
        pac24 is null and
        pac25 is null

    )
    then begin
        for select
            id, DETE,  nrx, doctyp, docst, docnr,
            clid, clid2, descr, summ, pvn,
            opt, znr, zu, zdt, dt2, nl, yr, iddocm
        from opsd
        where
            (:pdate1 IS NULL OR opsd.DETE >= :pdate1) AND
            (:pdate2 IS NULL OR opsd.DETE <= :pdate2) AND
            (:pclid IS NULL OR ClId = :pclid OR ClId2 = :pclid) AND
            (:ptext IS NULL OR OPSd.Descr LIKE :ptext) AND
            (
                :PDOCGR IS NULL OR EXISTS(
                    SELECT DTA.ID
                    FROM doctypb AS DTB inner join doctypa AS DTA on DTB.ida = DTA.id
                    WHERE DTB.ID = OPSD.doctyp AND DTA.ID = :PDOCGR
                )
            )

        ORDER BY DETE, id
        into
            :id, :DETE, :nrx, :doctyp, :docst, :docnr,
            :clid, :clid2, :descr, :summ, :pvn,
            :opt, :znr, :zu, :zdt, :dt2, :nl, :yr, :iddocm
        do
        begin
            suspend;
        end
    end
    else begin
        for select
            id, DETE,  nrx, doctyp, docst, docnr,
            clid, clid2, descr, summ, pvn,
            opt, znr, zu, zdt, dt2, nl, yr, iddocm
        from opsd
        where
            (:pdate1 IS NULL OR opsd.DETE >= :pdate1) AND
            (:pdate2 IS NULL OR opsd.DETE <= :pdate2) AND
            (:pclid IS NULL OR ClId = :pclid OR ClId2 = :pclid) AND
            (:ptext IS NULL OR OPSd.Descr LIKE :ptext) AND
            (
                :PDOCGR IS NULL OR EXISTS(
                    SELECT DTA.ID
                    FROM doctypb AS DTB inner join doctypa AS DTA on DTB.ida = DTA.id
                    WHERE DTB.ID = OPSD.doctyp AND DTA.ID = :PDOCGR
                )
            ) AND
            EXISTS
            (
                SELECT NULL
                FROM OPS o1
                WHERE
                (
                    (o1.DocId = OPSd.id) AND
                    (
                        (
                            (:pac11 IS NULL OR o1.AC11 LIKE :pac11) AND
                            (:pac12 IS NULL OR o1.AC12 LIKE :pac12) AND
                            (:pac13 IS NULL OR o1.AC13 LIKE :pac13) AND
                            (:pac14 IS NULL OR o1.AC14 LIKE :pac14) AND
                            (:pac15 IS NULL OR o1.AC15 LIKE :pac15)
                        )
                        AND
                        (
                            (:pac21 IS NULL OR o1.AC21 LIKE :pac21) AND
                            (:pac22 IS NULL OR o1.AC22 LIKE :pac22) AND
                            (:pac23 IS NULL OR o1.AC23 LIKE :pac23) AND
                            (:pac24 IS NULL OR o1.AC24 LIKE :pac24) AND
                            (:pac25 IS NULL OR o1.AC25 LIKE :pac25)
                        )
                    )
                )
            )
        ORDER BY DETE, opsd.id
        into
            :id, :DETE, :nrx, :doctyp, :docst, :docnr,
            :clid, :clid2, :descr, :summ, :pvn,
            :opt, :znr, :zu, :zdt, :dt2, :nl, :yr, :iddocm
        do
        begin
            suspend;
        end
    end
end^


ALTER PROCEDURE SP_OPSD_FILTER_OR (
    PDATE1 DATE,
    PDATE2 DATE,
    PTEXT VARCHAR(50),
    PCLID VARCHAR(15),
    PAC11 VARCHAR(8),
    PAC12 VARCHAR(8),
    PAC13 VARCHAR(5),
    PAC14 VARCHAR(8),
    PAC15 VARCHAR(5),
    PAC21 VARCHAR(8),
    PAC22 VARCHAR(8),
    PAC23 VARCHAR(5),
    PAC24 VARCHAR(8),
    PAC25 VARCHAR(5),
    PDOCGR VARCHAR(10))
RETURNS (
    ID TYPE OF COLUMN OPSD.ID,
    DETE TYPE OF COLUMN OPSD.DETE,
    NRX TYPE OF COLUMN OPSD.NRX,
    DOCTYP TYPE OF COLUMN OPSD.DOCTYP,
    DOCST TYPE OF COLUMN OPSD.DOCST,
    DOCNR TYPE OF COLUMN OPSD.DOCNR,
    CLID TYPE OF COLUMN OPSD.CLID,
    CLID2 TYPE OF COLUMN OPSD.CLID2,
    DESCR TYPE OF COLUMN OPSD.DESCR,
    SUMM TYPE OF COLUMN OPSD.SUMM,
    PVN TYPE OF COLUMN OPSD.PVN,
    OPT TYPE OF COLUMN OPSD.OPT,
    ZNR TYPE OF COLUMN OPSD.ZNR,
    ZU TYPE OF COLUMN OPSD.ZU,
    ZDT TYPE OF COLUMN OPSD.ZDT,
    DT2 TYPE OF COLUMN OPSD.DT2,
    YR TYPE OF COLUMN OPSD.YR,
    NL TYPE OF COLUMN OPSD.NL,
    IDDOCM TYPE OF COLUMN OPSD.IDDOCM)
AS
begin
    if
    (
        pac11 is null and
        pac12 is null and
        pac13 is null and
        pac14 is null and
        pac15 is null and
        pac21 is null and
        pac22 is null and
        pac23 is null and
        pac24 is null and
        pac25 is null

    )
    then begin
        for select
            id, DETE,  nrx, doctyp, docst, docnr,
            clid, clid2, descr, summ, pvn,
            opt, znr, zu, zdt, dt2, nl, yr, iddocm
        from opsd
        where
            (:pdate1 IS NULL OR opsd.DETE >= :pdate1) AND
            (:pdate2 IS NULL OR opsd.DETE <= :pdate2) AND
            (:pclid IS NULL OR ClId = :pclid OR ClId2 = :pclid) AND
            (:ptext IS NULL OR OPSd.Descr LIKE :ptext) AND
            (
                :PDOCGR IS NULL OR EXISTS(
                    SELECT DTA.ID
                    FROM doctypb AS DTB inner join doctypa AS DTA on DTB.ida = DTA.id
                    WHERE DTB.ID = OPSD.doctyp AND DTA.ID = :PDOCGR
                )
            )
        ORDER BY DETE, id
        into
            :id, :DETE, :nrx, :doctyp, :docst, :docnr,
            :clid, :clid2, :descr, :summ, :pvn,
            :opt, :znr, :zu, :zdt, :dt2, :nl, :yr, :iddocm
        do
        begin
            suspend;
        end
    end
    else begin
        for select
            id, DETE,  nrx, doctyp, docst, docnr,
            clid, clid2, descr, summ, pvn,
            opt, znr, zu, zdt, dt2, nl, yr, iddocm
        from opsd
        where
            (:pdate1 IS NULL OR opsd.DETE >= :pdate1) AND
            (:pdate2 IS NULL OR opsd.DETE <= :pdate2) AND
            (:pclid IS NULL OR ClId = :pclid OR ClId2 = :pclid) AND
            (:ptext IS NULL OR OPSd.Descr LIKE :ptext) AND
            (
                :PDOCGR IS NULL OR EXISTS(
                    SELECT DTA.ID
                    FROM doctypb AS DTB inner join doctypa AS DTA on DTB.ida = DTA.id
                    WHERE DTB.ID = OPSD.doctyp AND DTA.ID = :PDOCGR
                )
            ) AND
            EXISTS
            (
                SELECT NULL
                FROM OPS o1
                WHERE
                (
                    (o1.DocId = OPSd.id) AND
                    (
                        (
                            (:pac11 IS NULL OR o1.AC11 LIKE :pac11) AND
                            (:pac12 IS NULL OR o1.AC12 LIKE :pac12) AND
                            (:pac13 IS NULL OR o1.AC13 LIKE :pac13) AND
                            (:pac14 IS NULL OR o1.AC14 LIKE :pac14) AND
                            (:pac15 IS NULL OR o1.AC15 LIKE :pac15)
                        )
                        OR
                        (
                            (:pac21 IS NULL OR o1.AC21 LIKE :pac21) AND
                            (:pac22 IS NULL OR o1.AC22 LIKE :pac22) AND
                            (:pac23 IS NULL OR o1.AC23 LIKE :pac23) AND
                            (:pac24 IS NULL OR o1.AC24 LIKE :pac24) AND
                            (:pac25 IS NULL OR o1.AC25 LIKE :pac25)
                        )
                    )
                )
            )
        ORDER BY DETE, opsd.id
        into
            :id, :DETE, :nrx, :doctyp, :docst, :docnr,
            :clid, :clid2, :descr, :summ, :pvn,
            :opt, :znr, :zu, :zdt, :dt2, :nl, :yr, :iddocm
        do
        begin
            suspend;
        end
    end
end^


ALTER PROCEDURE SP_OPSD_GETNEXTNRFORYEARA (
    YR INTEGER)
RETURNS (
    NEXTNR INTEGER)
AS
begin
    execute procedure SP_OPSD_GETNEXTNRFORYEARA_K(:yr, 1)
    returning_values :NEXTNR;

    suspend;
end^


ALTER PROCEDURE SP_OPSD_GETNEXTNRFORYEARA_K (
    YR INTEGER,
    PK INTEGER)
RETURNS (
    NEXTNR INTEGER)
AS
declare variable K integer;
begin
    if (yr < 2010 or (yr > 2030) ) then
    begin
        nextnr = -1;
        exit;
    end
    k = yr - 2010;

    if (k < 16) then
        if (k < 8) then
            if (k < 4) then
                nextnr = case k
                when 0 then gen_id(year00, :pk)
                when 1 then gen_id(year01, :pk)
                when 2 then gen_id(year02, :pk)
                when 3 then gen_id(year03, :pk)
                end;
            else
                nextnr = case k
                when 4 then gen_id(year04, :pk)
                when 5 then gen_id(year05, :pk)
                when 6 then gen_id(year06, :pk)
                when 7 then gen_id(year07, :pk)
                end;
        else
            if (k < 12) then
                nextnr = case k
                when 8 then gen_id(year08, :pk)
                when 9 then gen_id(year09, :pk)
                when 10 then gen_id(year10, :pk)
                when 11 then gen_id(year11, :pk)
                end;
            else
                nextnr = case k
                when 12 then gen_id(year12, :pk)
                when 13 then gen_id(year13, :pk)
                when 14 then gen_id(year14, :pk)
                when 15 then gen_id(year15, :pk)
                end;
    else
        if (k < 24) then
            if (k < 20) then
                nextnr = case k
                when 16 then gen_id(year16, :pk)
                when 17 then gen_id(year17, :pk)
                when 18 then gen_id(year18, :pk)
                when 19 then gen_id(year19, :pk)
                end;
            else
                nextnr = case k
                when 20 then gen_id(year20, :pk)
                when 21 then gen_id(year21, :pk)
                when 22 then gen_id(year22, :pk)
                when 23 then gen_id(year23, :pk)
                end;
        else
            if (k < 28) then
                nextnr = case k
                when 24 then gen_id(year24, :pk)
                when 25 then gen_id(year25, :pk)
                when 26 then gen_id(year26, :pk)
                when 27 then gen_id(year27, :pk)
                end;
            else
                nextnr = case k
                when 28 then gen_id(year28, :pk)
                when 29 then gen_id(year29, :pk)
                when 30 then gen_id(year30, :pk)
                when 31 then gen_id(year31, :pk)
                end;

    suspend;

end^


ALTER PROCEDURE SP_OPSD_ID
RETURNS (
    NEXTID INTEGER)
AS
begin
    nextid = GEN_ID("GEN_OPSD_ID",1);
    suspend;
end^


ALTER PROCEDURE SP_OPSD_IDK (
    PK INTEGER)
RETURNS (
    NEXTID INTEGER)
AS
begin
    nextid = GEN_ID("GEN_OPSD_ID", :PK);
    suspend;
end^


ALTER PROCEDURE SP_OPSD_INSERT (
    PID INTEGER,
    PDETE DATE,
    PNRX VARCHAR(5),
    PDOCTYP VARCHAR(10),
    PDOCST VARCHAR(6),
    PDOCNR VARCHAR(15),
    PCLID VARCHAR(15),
    PCLID2 VARCHAR(15),
    PDESCR VARCHAR(80),
    PSUMM NUMERIC(15,4),
    PPVN NUMERIC(15,4),
    POPT INTEGER,
    PZNR INTEGER,
    PZU VARCHAR(20),
    PZDT TIMESTAMP,
    PDT2 DATE,
    PNL SMALLINT,
    PIDDOCM INTEGER)
RETURNS (
    ID TYPE OF COLUMN OPSD.ID,
    DETE TYPE OF COLUMN OPSD.DETE,
    NRX TYPE OF COLUMN OPSD.NRX,
    DOCTYP TYPE OF COLUMN OPSD.DOCTYP,
    DOCST TYPE OF COLUMN OPSD.DOCST,
    DOCNR TYPE OF COLUMN OPSD.DOCNR,
    CLID TYPE OF COLUMN OPSD.CLID,
    CLID2 TYPE OF COLUMN OPSD.CLID2,
    DESCR TYPE OF COLUMN OPSD.DESCR,
    SUMM TYPE OF COLUMN OPSD.SUMM,
    PVN TYPE OF COLUMN OPSD.PVN,
    OPT TYPE OF COLUMN OPSD.OPT,
    ZNR TYPE OF COLUMN OPSD.ZNR,
    ZU TYPE OF COLUMN OPSD.ZU,
    ZDT TYPE OF COLUMN OPSD.ZDT,
    DT2 TYPE OF COLUMN OPSD.DT2,
    YR TYPE OF COLUMN OPSD.YR,
    NL TYPE OF COLUMN OPSD.NL,
    IDDOCM TYPE OF COLUMN OPSD.IDDOCM)
AS
begin
    INSERT INTO OPSd
        (id, DETE, NrX, DocTyp, DocSt, DocNr,
        ClId, ClId2, Descr, Summ, PVN,
        Opt, ZNR, ZU, ZDt, DT2, NL, IDDOCM)
    VALUES
        (:pid, :pDete, :pNrX, :pDocTyp, :pDocSt, :pDocNr,
        :pClId, :pClId2, :pDescr, :pSumm, :pPVN,
        :pOpt, :pznr, :pZU, localtimestamp(0), :pDT2, 0, :piddocm)
    RETURNING
        id, DETE,  nrx, doctyp, docst, docnr,
        clid, clid2, descr, summ, pvn,
        opt, znr, zu, zdt, dt2, nl, yr, iddocm
    INTO
        :id, :DETE, :nrx, :doctyp, :docst, :docnr,
        :clid, :clid2, :descr, :summ, :pvn,
        :opt, :znr, :zu, :zdt, :dt2, :nl, :yr, :iddocm;

    suspend;

end^


ALTER PROCEDURE SP_OPSD_UPDATE (
    PDETE DATE,
    PNRX VARCHAR(5),
    PDOCTYP VARCHAR(10),
    PDOCST VARCHAR(6),
    PDOCNR VARCHAR(15),
    PCLID VARCHAR(15),
    PCLID2 VARCHAR(15),
    PDESCR VARCHAR(80),
    PSUMM NUMERIC(15,4),
    PPVN NUMERIC(15,4),
    POPT INTEGER,
    PZNR INTEGER,
    PZU VARCHAR(20),
    PZDT TIMESTAMP,
    PDT2 DATE,
    PNL SMALLINT,
    ORIGINAL_ID INTEGER,
    ORIGINAL_DATE DATE,
    ISNULL_NRX INTEGER,
    ORIGINAL_NRX VARCHAR(5),
    ISNULL_DOCTYP INTEGER,
    ORIGINAL_DOCTYP VARCHAR(10),
    ISNULL_DOCST INTEGER,
    ORIGINAL_DOCST VARCHAR(6),
    ISNULL_DOCNR INTEGER,
    ORIGINAL_DOCNR VARCHAR(15),
    ISNULL_CLID INTEGER,
    ORIGINAL_CLID VARCHAR(15),
    ISNULL_CLID2 INTEGER,
    ORIGINAL_CLID2 VARCHAR(15),
    ISNULL_DESCR INTEGER,
    ORIGINAL_DESCR VARCHAR(80),
    ORIGINAL_SUMM NUMERIC(15,4),
    ORIGINAL_PVN NUMERIC(15,4),
    ISNULL_OPT INTEGER,
    ORIGINAL_OPT INTEGER,
    ORIGINAL_ZNR INTEGER,
    ISNULL_ZU INTEGER,
    ORIGINAL_ZU VARCHAR(20),
    ISNULL_ZDT INTEGER,
    ORIGINAL_ZDT TIMESTAMP,
    ISNULL_DT2 INTEGER,
    ORIGINAL_DT2 DATE,
    ISNULL_NL INTEGER,
    ORIGINAL_NL SMALLINT,
    ISNULL_YR INTEGER,
    ORIGINAL_YR INTEGER,
    PID INTEGER,
    ISNULL_IDDOCM INTEGER,
    ORIGINAL_IDDOCM INTEGER,
    PIDDOCM INTEGER)
RETURNS (
    ID TYPE OF COLUMN OPSD.ID,
    DETE TYPE OF COLUMN OPSD.DETE,
    NRX TYPE OF COLUMN OPSD.NRX,
    DOCTYP TYPE OF COLUMN OPSD.DOCTYP,
    DOCST TYPE OF COLUMN OPSD.DOCST,
    DOCNR TYPE OF COLUMN OPSD.DOCNR,
    CLID TYPE OF COLUMN OPSD.CLID,
    CLID2 TYPE OF COLUMN OPSD.CLID2,
    DESCR TYPE OF COLUMN OPSD.DESCR,
    SUMM TYPE OF COLUMN OPSD.SUMM,
    PVN TYPE OF COLUMN OPSD.PVN,
    OPT TYPE OF COLUMN OPSD.OPT,
    ZNR TYPE OF COLUMN OPSD.ZNR,
    ZU TYPE OF COLUMN OPSD.ZU,
    ZDT TYPE OF COLUMN OPSD.ZDT,
    DT2 TYPE OF COLUMN OPSD.DT2,
    YR TYPE OF COLUMN OPSD.YR,
    NL TYPE OF COLUMN OPSD.NL,
    IDDOCM TYPE OF COLUMN OPSD.IDDOCM)
AS
declare variable XYR integer;
declare variable NEXTNR integer;
declare variable VUSER varchar(50);
declare variable O_ZDT timestamp;
begin
    /*
    xyr = EXTRACT(YEAR FROM :pDete);
    NEXTNR = :Original_ZNR;

    IF (:Original_yr <> xyr) THEN
    BEGIN
        EXECUTE PROCEDURE  sp_opsd_getNextNrForYearA(:xyr) returning_values :nextnr;
        IF (NEXTNR = -1) THEN
        BEGIN
            exception my_exception_badyearvalue;
            EXIT;
        END
    END
    */
    --VUSER = USER;
    VUSER = PZU;

    UPDATE OPSd
    SET 
        DETE = :pDete,
        NrX = :pNrX,
        DocTyp = :pDocTyp,
        DocSt = :pDocSt,
        DocNr = :pDocNr,
        ClId = :pClId,
        ClId2 = :pClId2,
        Descr = :pDescr,
        Summ = :pSumm,
        PVN = :pPVN,
        Opt = :pOpt,
        ZNR = :pznr,
        ZU = :VUSER,
        ZDt = localtimestamp(0),
        DT2 = :pDT2,
        NL = :pNL,
        IDDOCM = :PIDDOCM
    WHERE 
    (
        (id = :Original_id) AND 
        (DETE = :Original_Date) AND
        ((:IsNull_NrX = 1 AND NrX IS NULL) OR (NrX = :Original_NrX)) AND 
        ((:IsNull_DocTyp = 1 AND DocTyp IS NULL) OR (DocTyp = :Original_DocTyp)) AND 
        ((:IsNull_DocSt = 1 AND DocSt IS NULL) OR (DocSt = :Original_DocSt)) AND 
        ((:IsNull_DocNr = 1 AND DocNr IS NULL) OR (DocNr = :Original_DocNr)) AND 
        ((:IsNull_ClId = 1 AND ClId IS NULL) OR (ClId = :Original_ClId)) AND 
        ((:IsNull_ClId2 = 1 AND ClId2 IS NULL) OR (ClId2 = :Original_ClId2)) AND 
        ((:IsNull_Descr = 1 AND Descr IS NULL) OR (Descr = :Original_Descr)) AND 
        (Summ = :Original_Summ) AND 
        (PVN = :Original_PVN) AND 
        (ZNR = :Original_ZNR) AND 
        ((:IsNull_DT2 = 1 AND DT2 IS NULL) OR (DT2 = :Original_DT2)) AND
        ((:IsNull_IDDOCM = 1 AND IDDOCM IS NULL) OR (IDDOCM = :Original_IDDOCM))
    );

    O_ZDt = :Original_ZDt;
    IF (:IsNull_ZDt = 1) THEN
    BEGIN
        O_ZDt = null;
    END

    EXECUTE PROCEDURE sp_opsd_update_log(
            :Original_id,
            :VUSER,
            :Original_Date, 
            :Original_NrX, 
            :Original_DocTyp, 
            :Original_DocSt, 
            :Original_DocNr, 
            :Original_ClId, 
            :Original_ClId2, 
            :Original_Descr, 
            :Original_Summ, 
            :Original_PVN, 
            :Original_ZNR,
            :O_ZDt);


end^


ALTER PROCEDURE SP_OPSD_UPDATE_LOG (
    ID INTEGER,
    USR VARCHAR(15),
    ORIGINAL_DATE DATE,
    ORIGINAL_NRX VARCHAR(5),
    ORIGINAL_DOCTYP VARCHAR(10),
    ORIGINAL_DOCST VARCHAR(6),
    ORIGINAL_DOCNR VARCHAR(15),
    ORIGINAL_CLID VARCHAR(15),
    ORIGINAL_CLID2 VARCHAR(15),
    ORIGINAL_DESCR VARCHAR(80),
    ORIGINAL_SUMM NUMERIC(15,4),
    ORIGINAL_PVN NUMERIC(15,4),
    ORIGINAL_ZNR INTEGER,
    ORIGINAL_ZDT TIMESTAMP)
AS
declare variable NOW timestamp;
    declare variable XDT timestamp;
begin
    now = localtimestamp(0);
    xdt = dateadd(-1 hour to now);

    IF (:Original_ZDt IS NULL OR :Original_ZDt < xdt)
    THEN BEGIN
        INSERT INTO LOPSD
            (id, ZDt, ZU, DETE, NrX,
            DocTyp, DocSt, DocNr,
            ClId, ClId2, Descr, Summ, PVN, ZNR, ODT)
        VALUES (
            :id,
            :now,
            :Usr,
            :Original_Date, 
            :Original_NrX, 
            :Original_DocTyp, 
            :Original_DocSt, 
            :Original_DocNr, 
            :Original_ClId, 
            :Original_ClId2, 
            :Original_Descr, 
            :Original_Summ, 
            :Original_PVN, 
            :Original_ZNR,
            :ORIGINAL_ZDT
            );

    END

end^


ALTER PROCEDURE SP_PARAMS (
    USERNAME VARCHAR(20))
RETURNS (
    ID TYPE OF COLUMN PARAMS.ID,
    PNAME TYPE OF COLUMN PARAMS.PNAME,
    PVALUE TYPE OF COLUMN PARAMS.PVALUE,
    USR TYPE OF COLUMN PARAMS.USR)
AS
begin
    FOR SELECT id, pname, pvalue, usr
    FROM params
    WHERE Params.Usr = 'SYSTEM' OR Params.Usr = :username
    ORDER BY Params.PName
    INTO :id, :pname, :pvalue, :usr
    do
    begin
        suspend;
    end
end^


ALTER PROCEDURE SP_REKINS_11 (
    PDID INTEGER)
RETURNS (
    ID TYPE OF COLUMN OPS.ID,
    DOCID TYPE OF COLUMN OPS.DOCID,
    DESCR TYPE OF COLUMN OPS.DESCR,
    AC11 TYPE OF COLUMN OPS.AC11,
    AC12 TYPE OF COLUMN OPS.AC12,
    AC13 TYPE OF COLUMN OPS.AC13,
    AC14 TYPE OF COLUMN OPS.AC14,
    AC15 TYPE OF COLUMN OPS.AC15,
    AC21 TYPE OF COLUMN OPS.AC21,
    AC22 TYPE OF COLUMN OPS.AC22,
    AC23 TYPE OF COLUMN OPS.AC23,
    AC24 TYPE OF COLUMN OPS.AC24,
    AC25 TYPE OF COLUMN OPS.AC25,
    SUMMC TYPE OF COLUMN OPS.SUMMC,
    CUR TYPE OF COLUMN OPS.CUR,
    SUMM TYPE OF COLUMN OPS.SUMM,
    QV TYPE OF COLUMN OPS.QV,
    NL TYPE OF COLUMN OPS.NL,
    ZDT TYPE OF COLUMN OPS.ZDT)
AS
begin
  for select ops.id,
             ops.docid,
             ops.descr,
             ops.ac11,
             ops.ac12,
             ops.ac13,
             ops.ac14,
             ops.ac15,
             ops.ac21,
             ops.ac22,
             ops.ac23,
             ops.ac24,
             ops.ac25,
             ops.summc,
             ops.cur,
             ops.summ,
             ops.qv,
             ops.nl,
             ops.zdt

      FROM OPS
      WHERE
        ops.DOCID = :PDID
      ORDER BY ops.id

      into :id,
           :docid,
           :descr,
           :ac11,
           :ac12,
           :ac13,
           :ac14,
           :ac15,
           :ac21,
           :ac22,
           :ac23,
           :ac24,
           :ac25,
           :summc,
           :cur,
           :summ,
           :qv,
           :nl,
           :zdt
  do
  begin
    suspend;
  end
end^


ALTER PROCEDURE SP_REP_APGR_01 (
    SDT DATE,
    EDT DATE,
    PAC VARCHAR(8))
RETURNS (
    ID TYPE OF COLUMN ROPS2A.ID,
    SPID TYPE OF COLUMN ROPS2A.SPID,
    AC TYPE OF COLUMN ROPS2A.AC,
    RAC TYPE OF COLUMN ROPS2A.RAC,
    NAME TYPE OF COLUMN ROPS2A.NAME,
    B0 TYPE OF COLUMN ROPS2A.B0,
    SDB TYPE OF COLUMN ROPS2A.SDB,
    SCR TYPE OF COLUMN ROPS2A.SCR,
    TDB TYPE OF COLUMN ROPS2A.TDB,
    TCR TYPE OF COLUMN ROPS2A.TCR,
    CLID TYPE OF COLUMN ROPS2A.CLID,
    NAME1 TYPE OF COLUMN ROPS2A.NAME1,
    REGNR TYPE OF COLUMN ROPS2A.REGNR,
    RNAME TYPE OF COLUMN ROPS2A.RNAME)
AS
begin
    FOR SELECT
        gen_id(GEN_ROPS2A_ID, 1) as ID,
        current_connection as SPID,
        :PAC as AC,
        null as RAC,
        acp21.name as NAME,
        0 as b0,
        coalesce(T2.ADb, 0.00) as sdb,
        coalesce(T2.ACr, 0.00) as scr,
        coalesce(T2.BDb, 0.00) as tdb,
        coalesce(T2.BCr, 0.00) as tcr,
        null as clid,
        null as name1,
        null as regnr,
        null as rname
    FROM
    (
        SELECT SUM(SDb) AS ADb, SUM(SCr) AS ACr, SUM(TDb) AS BDb, SUM(TCr) AS BCr
        FROM
        (
            SELECT 
                OPS.AC11 AS AC,
                CASE
                    WHEN OPSd.Dete < :sdt THEN OPS.Summ
                    ELSE 0.00
                END as SDb,
                0.00 as SCr,
                CASE
                    WHEN OPSd.Dete >= :sdt THEN OPS.Summ
                    ELSE 0.00
                END as TDb,
                0.00 as TCr

            FROM OPSd JOIN OPS ON OPSd.id = OPS.DocId
            WHERE OPSd.Dete <= :edt AND OPS.AC11 LIKE :pac

            UNION ALL

            SELECT 
                OPS.AC21 AS AC,
                0.00 as SDb,
                CASE
                    WHEN OPSd.Dete < :sdt THEN OPS.Summ
                    ELSE 0.00
                END as SCr,
                0.00 as TDb,
                CASE
                    WHEN OPSd.Dete >= :sdt THEN OPS.Summ
                    ELSE 0.00
                END as TCr

            FROM OPSd JOIN OPS ON OPSd.id = OPS.DocId
            WHERE OPSd.Dete <= :edt AND OPS.AC21 LIKE :pac

            UNION ALL

            SELECT 
                Bal0.AC11 AS AC,
                Bal0.SummD AS SDb,
                Bal0.SummC AS SCr,
                0.00 AS TDb,
                0.00 AS TCr
            FROM Bal0
            WHERE Bal0.AC11 LIKE :pac

        ) AS T1

    ) AS T2
    LEFT JOIN AcP21 ON :pac = AcP21.AC

    INTO
        :id, :spid, :ac, :rac, :name,
        :b0,
        :sdb, :scr, :tdb, :tcr,
        :clid, :name1, :regnr, :rname

    do
    begin
        suspend;
    end

end^


ALTER PROCEDURE SP_REP_APGR_01_CLID (
    SDT DATE,
    EDT DATE,
    PAC VARCHAR(8),
    PCLID VARCHAR(15))
RETURNS (
    ID TYPE OF COLUMN ROPS2A.ID,
    SPID TYPE OF COLUMN ROPS2A.SPID,
    AC TYPE OF COLUMN ROPS2A.AC,
    RAC TYPE OF COLUMN ROPS2A.RAC,
    NAME TYPE OF COLUMN ROPS2A.NAME,
    B0 TYPE OF COLUMN ROPS2A.B0,
    SDB TYPE OF COLUMN ROPS2A.SDB,
    SCR TYPE OF COLUMN ROPS2A.SCR,
    TDB TYPE OF COLUMN ROPS2A.TDB,
    TCR TYPE OF COLUMN ROPS2A.TCR,
    CLID TYPE OF COLUMN ROPS2A.CLID,
    NAME1 TYPE OF COLUMN ROPS2A.NAME1,
    REGNR TYPE OF COLUMN ROPS2A.REGNR,
    RNAME TYPE OF COLUMN ROPS2A.RNAME)
AS
begin
    FOR SELECT
        gen_id(GEN_ROPS2A_ID, 1) as ID,
        current_connection as SPID,
        :PAC as AC,
        null as RAC,
        acp21.name as NAME,
        0 as b0,
        coalesce(T2.ADb, 0.00) as sdb,
        coalesce(T2.ACr, 0.00) as scr,
        coalesce(T2.BDb, 0.00) as tdb,
        coalesce(T2.BCr, 0.00) as tcr,
        :pclid as clid,
        Persons.Name as name1,
        Persons.regnr as regnr,
        null as rname
    FROM
    (
        SELECT SUM(SDb) AS ADb, SUM(SCr) AS ACr, SUM(TDb) AS BDb, SUM(TCr) AS BCr
        FROM
        (
            SELECT 
                OPS.AC11 AS AC,
                CASE
                    WHEN OPSd.Dete < :sdt THEN OPS.Summ
                    ELSE 0.00
                END as SDb,
                0.00 as SCr,
                CASE
                    WHEN OPSd.Dete >= :sdt THEN OPS.Summ
                    ELSE 0.00
                END as TDb,
                0.00 as TCr

            FROM OPSd JOIN OPS ON OPSd.id = OPS.DocId
            WHERE
                OPSd.Dete <= :edt AND
                OPS.AC11 LIKE :pac AND
                OPSd.clid = :pclid


            UNION ALL

            SELECT 
                OPS.AC21 AS AC,
                0.00 as SDb,
                CASE
                    WHEN OPSd.Dete < :sdt THEN OPS.Summ
                    ELSE 0.00
                END as SCr,
                0.00 as TDb,
                CASE
                    WHEN OPSd.Dete >= :sdt THEN OPS.Summ
                    ELSE 0.00
                END as TCr

            FROM OPSd JOIN OPS ON OPSd.id = OPS.DocId
            WHERE
                OPSd.Dete <= :edt AND
                OPS.AC21 LIKE :pac AND
                OPSd.clid = :pclid

            UNION ALL

            SELECT 
                Bal0.AC11 AS AC,
                Bal0.SummD AS SDb,
                Bal0.SummC AS SCr,
                0.00 AS TDb,
                0.00 AS TCr
            FROM Bal0
            WHERE
                Bal0.AC11 LIKE :pac AND
                Bal0.ClId = :pclid

        ) AS T1

    ) AS T2
    LEFT JOIN AcP21 ON :pac = AcP21.AC
    LEFT JOIN Persons ON :pclid = Persons.ClId

    INTO
        :id, :spid, :ac, :rac, :name,
        :b0,
        :sdb, :scr, :tdb, :tcr,
        :clid, :name1, :regnr, :rname

    do
    begin
        suspend;
    end

end^


ALTER PROCEDURE SP_REP_APGR_01_CLID2 (
    SDT DATE,
    EDT DATE,
    PAC VARCHAR(8),
    PCLID VARCHAR(15))
RETURNS (
    ID TYPE OF COLUMN ROPS2A.ID,
    SPID TYPE OF COLUMN ROPS2A.SPID,
    AC TYPE OF COLUMN ROPS2A.AC,
    RAC TYPE OF COLUMN ROPS2A.RAC,
    NAME TYPE OF COLUMN ROPS2A.NAME,
    B0 TYPE OF COLUMN ROPS2A.B0,
    SDB TYPE OF COLUMN ROPS2A.SDB,
    SCR TYPE OF COLUMN ROPS2A.SCR,
    TDB TYPE OF COLUMN ROPS2A.TDB,
    TCR TYPE OF COLUMN ROPS2A.TCR,
    CLID TYPE OF COLUMN ROPS2A.CLID,
    NAME1 TYPE OF COLUMN ROPS2A.NAME1,
    REGNR TYPE OF COLUMN ROPS2A.REGNR,
    RNAME TYPE OF COLUMN ROPS2A.RNAME)
AS
begin
    FOR SELECT
        gen_id(GEN_ROPS2A_ID, 1) as ID,
        current_connection as SPID,
        :PAC as AC,
        null as RAC,
        acp21.name as NAME,
        0 as b0,
        coalesce(T2.ADb, 0.00) as sdb,
        coalesce(T2.ACr, 0.00) as scr,
        coalesce(T2.BDb, 0.00) as tdb,
        coalesce(T2.BCr, 0.00) as tcr,
        :pclid as clid,
        Persons.Name as name1,
        Persons.regnr as regnr,
        null as rname
    FROM
    (
        SELECT SUM(SDb) AS ADb, SUM(SCr) AS ACr, SUM(TDb) AS BDb, SUM(TCr) AS BCr
        FROM
        (
            SELECT 
                OPS.AC11 AS AC,
                CASE
                    WHEN OPSd.Dete < :sdt THEN OPS.Summ
                    ELSE 0.00
                END as SDb,
                0.00 as SCr,
                CASE
                    WHEN OPSd.Dete >= :sdt THEN OPS.Summ
                    ELSE 0.00
                END as TDb,
                0.00 as TCr

            FROM OPSd JOIN OPS ON OPSd.id = OPS.DocId
            WHERE
                OPSd.Dete <= :edt AND
                OPS.AC11 LIKE :pac AND
                OPSd.clid2 = :pclid


            UNION ALL

            SELECT 
                OPS.AC21 AS AC,
                0.00 as SDb,
                CASE
                    WHEN OPSd.Dete < :sdt THEN OPS.Summ
                    ELSE 0.00
                END as SCr,
                0.00 as TDb,
                CASE
                    WHEN OPSd.Dete >= :sdt THEN OPS.Summ
                    ELSE 0.00
                END as TCr

            FROM OPSd JOIN OPS ON OPSd.id = OPS.DocId
            WHERE
                OPSd.Dete <= :edt AND
                OPS.AC21 LIKE :pac AND
                OPSd.clid2 = :pclid

            UNION ALL

            SELECT 
                Bal0.AC11 AS AC,
                Bal0.SummD AS SDb,
                Bal0.SummC AS SCr,
                0.00 AS TDb,
                0.00 AS TCr
            FROM Bal0
            WHERE
                Bal0.AC11 LIKE :pac AND
                Bal0.ClId = :pclid

        ) AS T1

    ) AS T2
    LEFT JOIN AcP21 ON :pac = AcP21.AC
    LEFT JOIN Persons ON :pclid = Persons.ClId

    INTO
        :id, :spid, :ac, :rac, :name,
        :b0,
        :sdb, :scr, :tdb, :tcr,
        :clid, :name1, :regnr, :rname

    do
    begin
        suspend;
    end

end^


ALTER PROCEDURE SP_REP_APGR_02 (
    SDT DATE,
    EDT DATE,
    PAC VARCHAR(8))
RETURNS (
    ID TYPE OF COLUMN ROPS2A.ID,
    SPID TYPE OF COLUMN ROPS2A.SPID,
    AC TYPE OF COLUMN ROPS2A.AC,
    RAC TYPE OF COLUMN ROPS2A.RAC,
    NAME TYPE OF COLUMN ROPS2A.NAME,
    B0 TYPE OF COLUMN ROPS2A.B0,
    SDB TYPE OF COLUMN ROPS2A.SDB,
    SCR TYPE OF COLUMN ROPS2A.SCR,
    TDB TYPE OF COLUMN ROPS2A.TDB,
    TCR TYPE OF COLUMN ROPS2A.TCR,
    CLID TYPE OF COLUMN ROPS2A.CLID,
    NAME1 TYPE OF COLUMN ROPS2A.NAME1,
    REGNR TYPE OF COLUMN ROPS2A.REGNR,
    RNAME TYPE OF COLUMN ROPS2A.RNAME)
AS
begin
    FOR SELECT
        gen_id(GEN_ROPS2A_ID, 1) as ID,
        current_connection as SPID,
        T2.AC as AC,
        null as RAC,
        acp21.name as NAME,
        T2.ADb - T2.ACr as b0,
        T2.ADb as sdb,
        T2.ACr as scr,
        T2.BDb as tdb,
        T2.BCr as tcr,
        null as clid,
        null as name1,
        null as regnr,
        null as rname
    FROM
    (
        SELECT AC, SUM(SDb) AS ADb, SUM(SCr) AS ACr, SUM(TDb) AS BDb, SUM(TCr) AS BCr
        FROM
        (
            SELECT 
                OPS.AC11 AS AC,
                CASE
                    WHEN OPSd.Dete < :sdt THEN OPS.Summ
                    ELSE 0.00
                END as SDb,
                0.00 as SCr,
                CASE
                    WHEN OPSd.Dete >= :sdt THEN OPS.Summ
                    ELSE 0.00
                END as TDb,
                0.00 as TCr

            FROM OPSd JOIN OPS ON OPSd.id = OPS.DocId
            WHERE OPSd.Dete <= :edt AND OPS.AC11 LIKE :pac

            UNION ALL

            SELECT 
                OPS.AC21 AS AC,
                0.00 as SDb,
                CASE
                    WHEN OPSd.Dete < :sdt THEN OPS.Summ
                    ELSE 0.00
                END as SCr,
                0.00 as TDb,
                CASE
                    WHEN OPSd.Dete >= :sdt THEN OPS.Summ
                    ELSE 0.00
                END as TCr

            FROM OPSd JOIN OPS ON OPSd.id = OPS.DocId
            WHERE OPSd.Dete <= :edt AND OPS.AC21 LIKE :pac

            UNION ALL

            SELECT 
                Bal0.AC11 AS AC,
                Bal0.SummD AS SDb,
                Bal0.SummC AS SCr,
                0.00 AS TDb,
                0.00 AS TCr
            FROM Bal0
            WHERE Bal0.AC11 LIKE :pac

        ) AS T1
        GROUP BY AC

    ) AS T2
    LEFT JOIN AcP21 ON T2.AC = AcP21.AC

    WHERE 
        (T2.ADb - T2.ACr) <> 0.00 OR
        T2.BDb <> 0.00 OR
        T2.BCr <> 0.00

    ORDER BY AC

    INTO
        :id, :spid, :ac, :rac, :name,
        :b0,
        :sdb, :scr, :tdb, :tcr,
        :clid, :name1, :regnr, :rname

    do
    begin
        suspend;
    end

end^


ALTER PROCEDURE SP_REP_APGR_02_CLID (
    SDT DATE,
    EDT DATE,
    PAC VARCHAR(8),
    PCLID VARCHAR(15))
RETURNS (
    ID TYPE OF COLUMN ROPS2A.ID,
    SPID TYPE OF COLUMN ROPS2A.SPID,
    AC TYPE OF COLUMN ROPS2A.AC,
    RAC TYPE OF COLUMN ROPS2A.RAC,
    NAME TYPE OF COLUMN ROPS2A.NAME,
    B0 TYPE OF COLUMN ROPS2A.B0,
    SDB TYPE OF COLUMN ROPS2A.SDB,
    SCR TYPE OF COLUMN ROPS2A.SCR,
    TDB TYPE OF COLUMN ROPS2A.TDB,
    TCR TYPE OF COLUMN ROPS2A.TCR,
    CLID TYPE OF COLUMN ROPS2A.CLID,
    NAME1 TYPE OF COLUMN ROPS2A.NAME1,
    REGNR TYPE OF COLUMN ROPS2A.REGNR,
    RNAME TYPE OF COLUMN ROPS2A.RNAME)
AS
begin
    FOR SELECT
        gen_id(GEN_ROPS2A_ID, 1) as ID,
        current_connection as SPID,
        T2.AC as AC,
        null as RAC,
        acp21.name as NAME,
        T2.ADb - T2.ACr as b0,
        T2.ADb as sdb,
        T2.ACr as scr,
        T2.BDb as tdb,
        T2.BCr as tcr,
        T2.Clid as clid,
        Persons.Name as name1,
        Persons.regnr as regnr,
        null as rname
    FROM
    (
        SELECT T1.AC, T1.clid, SUM(SDb) AS ADb, SUM(SCr) AS ACr, SUM(TDb) AS BDb, SUM(TCr) AS BCr
        FROM
        (
            SELECT 
                OPS.AC11 AS AC,
                OPSd.ClId AS Clid,
                CASE
                    WHEN OPSd.Dete < :sdt THEN OPS.Summ
                    ELSE 0.00
                END as SDb,
                0.00 as SCr,
                CASE
                    WHEN OPSd.Dete >= :sdt THEN OPS.Summ
                    ELSE 0.00
                END as TDb,
                0.00 as TCr

            FROM OPSd JOIN OPS ON OPSd.id = OPS.DocId
            WHERE
                OPSd.Dete <= :edt AND
                OPS.AC11 LIKE :pac AND
                (:pclid IS NULL OR OPSd.ClId = :pclid)


            UNION ALL

            SELECT 
                OPS.AC21 AS AC,
                OPSd.ClId AS Clid,
                0.00 as SDb,
                CASE
                    WHEN OPSd.Dete < :sdt THEN OPS.Summ
                    ELSE 0.00
                END as SCr,
                0.00 as TDb,
                CASE
                    WHEN OPSd.Dete >= :sdt THEN OPS.Summ
                    ELSE 0.00
                END as TCr

            FROM OPSd JOIN OPS ON OPSd.id = OPS.DocId
            WHERE
                OPSd.Dete <= :edt AND
                OPS.AC21 LIKE :pac AND
                (:pclid IS NULL OR OPSd.ClId = :pclid)

            UNION ALL

            SELECT 
                Bal0.AC11 AS AC,
                Bal0.ClId AS Clid,
                Bal0.SummD AS SDb,
                Bal0.SummC AS SCr,
                0.00 AS TDb,
                0.00 AS TCr
            FROM Bal0
            WHERE
                Bal0.AC11 LIKE :pac AND
                (:pclid IS NULL OR Bal0.ClId = :pclid)

        ) AS T1
        GROUP BY T1.AC, T1.clid

    ) AS T2
    LEFT JOIN AcP21 ON T2.AC = AcP21.AC
    LEFT JOIN Persons ON T2.Clid = Persons.ClId

    WHERE 
        (T2.ADb - T2.ACr) <> 0.00 OR
        T2.BDb <> 0.00 OR
        T2.BCr <> 0.00

    ORDER BY AC, Clid

    INTO
        :id, :spid, :ac, :rac, :name,
        :b0,
        :sdb, :scr, :tdb, :tcr,
        :clid, :name1, :regnr, :rname

    do
    begin
        suspend;
    end

end^


ALTER PROCEDURE SP_REP_APGR_10 (
    SDT DATE,
    EDT DATE,
    PAC VARCHAR(8))
RETURNS (
    ID TYPE OF COLUMN ROPS2A.ID,
    SPID TYPE OF COLUMN ROPS2A.SPID,
    AC TYPE OF COLUMN ROPS2A.AC,
    RAC TYPE OF COLUMN ROPS2A.RAC,
    NAME TYPE OF COLUMN ROPS2A.NAME,
    B0 TYPE OF COLUMN ROPS2A.B0,
    SDB TYPE OF COLUMN ROPS2A.SDB,
    SCR TYPE OF COLUMN ROPS2A.SCR,
    TDB TYPE OF COLUMN ROPS2A.TDB,
    TCR TYPE OF COLUMN ROPS2A.TCR,
    CLID TYPE OF COLUMN ROPS2A.CLID,
    NAME1 TYPE OF COLUMN ROPS2A.NAME1,
    REGNR TYPE OF COLUMN ROPS2A.REGNR,
    RNAME TYPE OF COLUMN ROPS2A.RNAME)
AS
begin
    FOR SELECT
        gen_id(GEN_ROPS2A_ID, 1) as ID,
        current_connection as SPID,
        :PAC as AC,
        null as RAC,
        acp21.name as NAME,
        0 as b0,
        coalesce(T2.ADb, 0.00) as sdb,
        coalesce(T2.ACr, 0.00) as scr,
        coalesce(T2.BDb, 0.00) as tdb,
        coalesce(T2.BCr, 0.00) as tcr,
        null as clid,
        null as name1,
        null as regnr,
        null as rname
    FROM
    (
        SELECT SUM(SDb) AS ADb, SUM(SCr) AS ACr, SUM(TDb) AS BDb, SUM(TCr) AS BCr
        FROM
        (
            SELECT 
                OPS.AC11 AS AC,
                CASE
                    WHEN OPSd.Dete < :sdt THEN OPS.Summ
                    ELSE 0.00
                END as SDb,
                0.00 as SCr,
                CASE
                    WHEN OPSd.Dete >= :sdt THEN OPS.Summ
                    ELSE 0.00
                END as TDb,
                0.00 as TCr

            FROM OPSd JOIN OPS ON OPSd.id = OPS.DocId
            WHERE OPSd.Dete <= :edt AND OPS.AC11 LIKE :pac

            UNION ALL

            SELECT 
                OPS.AC21 AS AC,
                0.00 as SDb,
                CASE
                    WHEN OPSd.Dete < :sdt THEN OPS.Summ
                    ELSE 0.00
                END as SCr,
                0.00 as TDb,
                CASE
                    WHEN OPSd.Dete >= :sdt THEN OPS.Summ
                    ELSE 0.00
                END as TCr

            FROM OPSd JOIN OPS ON OPSd.id = OPS.DocId
            WHERE OPSd.Dete <= :edt AND OPS.AC21 LIKE :pac

            UNION ALL

            SELECT 
                Bal0.AC11 AS AC,
                Bal0.SummD AS SDb,
                Bal0.SummC AS SCr,
                0.00 AS TDb,
                0.00 AS TCr
            FROM Bal0
            WHERE Bal0.AC11 LIKE :pac

        ) AS T1

    ) AS T2
    LEFT JOIN AcP21 ON :pac = AcP21.AC

    INTO
        :id, :spid, :ac, :rac, :name,
        :b0,
        :sdb, :scr, :tdb, :tcr,
        :clid, :name1, :regnr, :rname

    do
    begin
        suspend;
    end

end^


ALTER PROCEDURE SP_REP_APGR_10_CLID (
    SDT DATE,
    EDT DATE,
    PAC VARCHAR(8),
    PCLID VARCHAR(15))
RETURNS (
    ID TYPE OF COLUMN ROPS2A.ID,
    SPID TYPE OF COLUMN ROPS2A.SPID,
    AC TYPE OF COLUMN ROPS2A.AC,
    RAC TYPE OF COLUMN ROPS2A.RAC,
    NAME TYPE OF COLUMN ROPS2A.NAME,
    B0 TYPE OF COLUMN ROPS2A.B0,
    SDB TYPE OF COLUMN ROPS2A.SDB,
    SCR TYPE OF COLUMN ROPS2A.SCR,
    TDB TYPE OF COLUMN ROPS2A.TDB,
    TCR TYPE OF COLUMN ROPS2A.TCR,
    CLID TYPE OF COLUMN ROPS2A.CLID,
    NAME1 TYPE OF COLUMN ROPS2A.NAME1,
    REGNR TYPE OF COLUMN ROPS2A.REGNR,
    RNAME TYPE OF COLUMN ROPS2A.RNAME)
AS
begin
    FOR SELECT
        gen_id(GEN_ROPS2A_ID, 1) as ID,
        current_connection as SPID,
        T2.AC as AC,
        null as RAC,
        acp21.name as NAME,
        0 as b0,
        T2.ADb as sdb,
        T2.ACr as scr,
        T2.BDb as tdb,
        T2.BCr as tcr,
        T2.Clid as clid,
        Persons.Name as name1,
        Persons.regnr as regnr,
        null as rname
    FROM
    (
        SELECT T1.AC, T1.clid, SUM(SDb) AS ADb, SUM(SCr) AS ACr, SUM(TDb) AS BDb, SUM(TCr) AS BCr
        FROM
        (
            SELECT 
                OPS.AC11 AS AC,
                OPSd.ClId AS Clid,
                CASE
                    WHEN OPSd.Dete < :sdt THEN OPS.Summ
                    ELSE 0.00
                END as SDb,
                0.00 as SCr,
                CASE
                    WHEN OPSd.Dete >= :sdt THEN OPS.Summ
                    ELSE 0.00
                END as TDb,
                0.00 as TCr

            FROM OPSd JOIN OPS ON OPSd.id = OPS.DocId
            WHERE
                OPSd.Dete <= :edt AND
                OPS.AC11 LIKE :pac AND
                (:pclid IS NULL OR OPSd.ClId = :pclid)


            UNION ALL

            SELECT 
                OPS.AC21 AS AC,
                OPSd.ClId AS Clid,
                0.00 as SDb,
                CASE
                    WHEN OPSd.Dete < :sdt THEN OPS.Summ
                    ELSE 0.00
                END as SCr,
                0.00 as TDb,
                CASE
                    WHEN OPSd.Dete >= :sdt THEN OPS.Summ
                    ELSE 0.00
                END as TCr

            FROM OPSd JOIN OPS ON OPSd.id = OPS.DocId
            WHERE
                OPSd.Dete <= :edt AND
                OPS.AC21 LIKE :pac AND
                (:pclid IS NULL OR OPSd.ClId = :pclid)

            UNION ALL

            SELECT 
                Bal0.AC11 AS AC,
                Bal0.ClId AS Clid,
                Bal0.SummD AS SDb,
                Bal0.SummC AS SCr,
                0.00 AS TDb,
                0.00 AS TCr
            FROM Bal0
            WHERE
                Bal0.AC11 LIKE :pac AND
                (:pclid IS NULL OR Bal0.ClId = :pclid)

        ) AS T1
        GROUP BY T1.AC, T1.clid

    ) AS T2
    LEFT JOIN AcP21 ON :pac = AcP21.AC
    LEFT JOIN Persons ON T2.Clid = Persons.ClId

    WHERE 
        (T2.ADb - T2.ACr) <> 0.00 OR
        T2.BDb <> 0.00 OR
        T2.BCr <> 0.00

    ORDER BY AC, Clid

    INTO
        :id, :spid, :ac, :rac, :name,
        :b0,
        :sdb, :scr, :tdb, :tcr,
        :clid, :name1, :regnr, :rname

    do
    begin
        suspend;
    end

end^


ALTER PROCEDURE SP_REP_APGR_11 (
    SDT DATE,
    EDT DATE,
    PAC VARCHAR(8))
RETURNS (
    ID TYPE OF COLUMN ROPS2A.ID,
    SPID TYPE OF COLUMN ROPS2A.SPID,
    AC TYPE OF COLUMN ROPS2A.AC,
    RAC TYPE OF COLUMN ROPS2A.RAC,
    NAME TYPE OF COLUMN ROPS2A.NAME,
    B0 TYPE OF COLUMN ROPS2A.B0,
    SDB TYPE OF COLUMN ROPS2A.SDB,
    SCR TYPE OF COLUMN ROPS2A.SCR,
    TDB TYPE OF COLUMN ROPS2A.TDB,
    TCR TYPE OF COLUMN ROPS2A.TCR,
    CLID TYPE OF COLUMN ROPS2A.CLID,
    NAME1 TYPE OF COLUMN ROPS2A.NAME1,
    REGNR TYPE OF COLUMN ROPS2A.REGNR,
    RNAME TYPE OF COLUMN ROPS2A.RNAME)
AS
begin
    FOR SELECT
        gen_id(GEN_ROPS2A_ID, 1) as ID,
        current_connection as SPID,
        T2.AC as AC,
        null as RAC,
        acp21.name as NAME,
        T2.ADb - T2.ACr as b0,
        T2.ADb as sdb,
        T2.ACr as scr,
        T2.BDb as tdb,
        T2.BCr as tcr,
        null as clid,
        null as name1,
        null as regnr,
        null as rname
    FROM
    (
        SELECT AC, SUM(SDb) AS ADb, SUM(SCr) AS ACr, SUM(TDb) AS BDb, SUM(TCr) AS BCr
        FROM
        (
            SELECT 
                OPS.AC11 AS AC,
                CASE
                    WHEN OPSd.Dete < :sdt THEN OPS.Summ
                    ELSE 0.00
                END as SDb,
                0.00 as SCr,
                CASE
                    WHEN OPSd.Dete >= :sdt THEN OPS.Summ
                    ELSE 0.00
                END as TDb,
                0.00 as TCr

            FROM OPSd JOIN OPS ON OPSd.id = OPS.DocId
            WHERE OPSd.Dete <= :edt AND OPS.AC11 LIKE :pac

            UNION ALL

            SELECT 
                OPS.AC21 AS AC,
                0.00 as SDb,
                CASE
                    WHEN OPSd.Dete < :sdt THEN OPS.Summ
                    ELSE 0.00
                END as SCr,
                0.00 as TDb,
                CASE
                    WHEN OPSd.Dete >= :sdt THEN OPS.Summ
                    ELSE 0.00
                END as TCr

            FROM OPSd JOIN OPS ON OPSd.id = OPS.DocId
            WHERE OPSd.Dete <= :edt AND OPS.AC21 LIKE :pac

            UNION ALL

            SELECT 
                Bal0.AC11 AS AC,
                Bal0.SummD AS SDb,
                Bal0.SummC AS SCr,
                0.00 AS TDb,
                0.00 AS TCr
            FROM Bal0
            WHERE Bal0.AC11 LIKE :pac

        ) AS T1
        GROUP BY AC

    ) AS T2
    LEFT JOIN AcP21 ON T2.AC = AcP21.AC

    WHERE 
        (T2.ADb - T2.ACr) <> 0.00 OR
        T2.BDb <> 0.00 OR
        T2.BCr <> 0.00

    ORDER BY AC

    INTO
        :id, :spid, :ac, :rac, :name,
        :b0,
        :sdb, :scr, :tdb, :tcr,
        :clid, :name1, :regnr, :rname

    do
    begin
        suspend;
    end

end^


ALTER PROCEDURE SP_REP_APGR_21 (
    SDT DATE,
    EDT DATE,
    PAC VARCHAR(8),
    PACLEN INTEGER)
RETURNS (
    ID TYPE OF COLUMN ROPS2A.ID,
    SPID TYPE OF COLUMN ROPS2A.SPID,
    AC TYPE OF COLUMN ROPS2A.AC,
    RAC TYPE OF COLUMN ROPS2A.RAC,
    NAME TYPE OF COLUMN ROPS2A.NAME,
    B0 TYPE OF COLUMN ROPS2A.B0,
    SDB TYPE OF COLUMN ROPS2A.SDB,
    SCR TYPE OF COLUMN ROPS2A.SCR,
    TDB TYPE OF COLUMN ROPS2A.TDB,
    TCR TYPE OF COLUMN ROPS2A.TCR,
    CLID TYPE OF COLUMN ROPS2A.CLID,
    NAME1 TYPE OF COLUMN ROPS2A.NAME1,
    REGNR TYPE OF COLUMN ROPS2A.REGNR,
    RNAME TYPE OF COLUMN ROPS2A.RNAME)
AS
begin
    FOR SELECT
        gen_id(GEN_ROPS2A_ID, 1) as ID,
        current_connection as SPID,
        T2.AC as AC,
        null as RAC,
        acp21.name as NAME,
        T2.ADb - T2.ACr as b0,
        T2.ADb as sdb,
        T2.ACr as scr,
        T2.BDb as tdb,
        T2.BCr as tcr,
        null as clid,
        null as name1,
        null as regnr,
        null as rname
    FROM
    (
        SELECT AC, SUM(SDb) AS ADb, SUM(SCr) AS ACr, SUM(TDb) AS BDb, SUM(TCr) AS BCr
        FROM
        (
            SELECT 
                LEFT(OPS.AC11, :paclen) AS AC,
                CASE
                    WHEN OPSd.Dete < :sdt THEN OPS.Summ
                    ELSE 0.00
                END as SDb,
                0.00 as SCr,
                CASE
                    WHEN OPSd.Dete >= :sdt THEN OPS.Summ
                    ELSE 0.00
                END as TDb,
                0.00 as TCr

            FROM OPSd JOIN OPS ON OPSd.id = OPS.DocId
            WHERE OPSd.Dete <= :edt AND OPS.AC11 LIKE :pac

            UNION ALL

            SELECT 
                LEFT(OPS.AC21, :paclen) AS AC,
                0.00 as SDb,
                CASE
                    WHEN OPSd.Dete < :sdt THEN OPS.Summ
                    ELSE 0.00
                END as SCr,
                0.00 as TDb,
                CASE
                    WHEN OPSd.Dete >= :sdt THEN OPS.Summ
                    ELSE 0.00
                END as TCr

            FROM OPSd JOIN OPS ON OPSd.id = OPS.DocId
            WHERE OPSd.Dete <= :edt AND OPS.AC21 LIKE :pac

            UNION ALL

            SELECT 
                LEFT(Bal0.AC11, :paclen) AS AC,
                Bal0.SummD AS SDb,
                Bal0.SummC AS SCr,
                0.00 AS TDb,
                0.00 AS TCr
            FROM Bal0
            WHERE Bal0.AC11 LIKE :pac

        ) AS T1
        GROUP BY AC

    ) AS T2
    LEFT JOIN AcP21 ON T2.AC = AcP21.AC

    WHERE 
        (T2.ADb - T2.ACr) <> 0.00 OR
        T2.BDb <> 0.00 OR
        T2.BCr <> 0.00

    ORDER BY AC

    INTO
        :id, :spid, :ac, :rac, :name,
        :b0,
        :sdb, :scr, :tdb, :tcr,
        :clid, :name1, :regnr, :rname

    do
    begin
        suspend;
    end

end^


ALTER PROCEDURE SP_REP_APGR_CUR_01 (
    SDT DATE,
    EDT DATE,
    PAC VARCHAR(8),
    PCUR VARCHAR(3))
RETURNS (
    ID TYPE OF COLUMN ROPS2A.ID,
    SPID TYPE OF COLUMN ROPS2A.SPID,
    AC TYPE OF COLUMN ROPS2A.AC,
    RAC TYPE OF COLUMN ROPS2A.RAC,
    NAME TYPE OF COLUMN ROPS2A.NAME,
    B0 TYPE OF COLUMN ROPS2A.B0,
    SDB TYPE OF COLUMN ROPS2A.SDB,
    SCR TYPE OF COLUMN ROPS2A.SCR,
    TDB TYPE OF COLUMN ROPS2A.TDB,
    TCR TYPE OF COLUMN ROPS2A.TCR,
    CLID TYPE OF COLUMN ROPS2A.CLID,
    NAME1 TYPE OF COLUMN ROPS2A.NAME1,
    REGNR TYPE OF COLUMN ROPS2A.REGNR,
    RNAME TYPE OF COLUMN ROPS2A.RNAME)
AS
begin
    FOR SELECT
        gen_id(GEN_ROPS2A_ID, 1) as ID,
        current_connection as SPID,
        T2.AC as AC,
        null as RAC,
        acp21.name as NAME,
        T2.ADb - T2.ACr as b0,
        T2.ADb as sdb,
        T2.ACr as scr,
        T2.BDb as tdb,
        T2.BCr as tcr,
        null as clid,
        null as name1,
        null as regnr,
        null as rname
    FROM
    (
        SELECT AC, SUM(SDb) AS ADb, SUM(SCr) AS ACr, SUM(TDb) AS BDb, SUM(TCr) AS BCr
        FROM
        (
            SELECT 
                OPS.AC11 AS AC,
                CASE
                    WHEN OPSd.Dete < :sdt THEN OPS.Summ
                    ELSE 0.00
                END as SDb,
                0.00 as SCr,
                CASE
                    WHEN OPSd.Dete >= :sdt THEN OPS.Summ
                    ELSE 0.00
                END as TDb,
                0.00 as TCr

            FROM OPSd JOIN OPS ON OPSd.id = OPS.DocId
            WHERE
                OPSd.Dete <= :edt AND
                OPS.AC11 = :pac AND
                OPS.Cur = :pcur

            UNION ALL

            SELECT 
                OPS.AC21 AS AC,
                0.00 as SDb,
                CASE
                    WHEN OPSd.Dete < :sdt THEN OPS.Summ
                    ELSE 0.00
                END as SCr,
                0.00 as TDb,
                CASE
                    WHEN OPSd.Dete >= :sdt THEN OPS.Summ
                    ELSE 0.00
                END as TCr

            FROM OPSd JOIN OPS ON OPSd.id = OPS.DocId
            WHERE
                OPSd.Dete <= :edt AND
                OPS.AC21 = :pac AND
                OPS.Cur = :pcur

            UNION ALL

            SELECT 
                Bal0.AC11 AS AC,
                Bal0.SummD AS SDb,
                Bal0.SummC AS SCr,
                0.00 AS TDb,
                0.00 AS TCr
            FROM Bal0
            WHERE Bal0.AC11 = :pac AND Bal0.Cur = :pcur

        ) AS T1
        GROUP BY AC

    ) AS T2
    LEFT JOIN AcP21 ON T2.AC = AcP21.AC

    WHERE 
        (T2.ADb - T2.ACr) <> 0.00 OR
        T2.BDb <> 0.00 OR
        T2.BCr <> 0.00

    ORDER BY AC

    INTO
        :id, :spid, :ac, :rac, :name,
        :b0,
        :sdb, :scr, :tdb, :tcr,
        :clid, :name1, :regnr, :rname

    do
    begin
        suspend;
    end

end^


ALTER PROCEDURE SP_REP_APGR_CUR_01_CLID (
    SDT DATE,
    EDT DATE,
    PAC VARCHAR(8),
    PCLID VARCHAR(8),
    PCUR VARCHAR(3))
RETURNS (
    ID TYPE OF COLUMN ROPS2A.ID,
    SPID TYPE OF COLUMN ROPS2A.SPID,
    AC TYPE OF COLUMN ROPS2A.AC,
    RAC TYPE OF COLUMN ROPS2A.RAC,
    NAME TYPE OF COLUMN ROPS2A.NAME,
    B0 TYPE OF COLUMN ROPS2A.B0,
    SDB TYPE OF COLUMN ROPS2A.SDB,
    SCR TYPE OF COLUMN ROPS2A.SCR,
    TDB TYPE OF COLUMN ROPS2A.TDB,
    TCR TYPE OF COLUMN ROPS2A.TCR,
    CLID TYPE OF COLUMN ROPS2A.CLID,
    NAME1 TYPE OF COLUMN ROPS2A.NAME1,
    REGNR TYPE OF COLUMN ROPS2A.REGNR,
    RNAME TYPE OF COLUMN ROPS2A.RNAME)
AS
begin
    FOR SELECT
        gen_id(GEN_ROPS2A_ID, 1) as ID,
        current_connection as SPID,
        T2.AC as AC,
        null as RAC,
        acp21.name as NAME,
        T2.ADb - T2.ACr as b0,
        T2.ADb as sdb,
        T2.ACr as scr,
        T2.BDb as tdb,
        T2.BCr as tcr,
        T2.Clid as clid,
        Persons.Name as name1,
        Persons.regnr as regnr,
        null as rname
    FROM
    (
        SELECT AC, T1.Clid AS Clid, SUM(SDb) AS ADb, SUM(SCr) AS ACr, SUM(TDb) AS BDb, SUM(TCr) AS BCr
        FROM
        (
            SELECT 
                OPS.AC11 AS AC,
                OPSd.ClId AS Clid,
                CASE
                    WHEN OPSd.Dete < :sdt THEN OPS.Summ
                    ELSE 0.00
                END as SDb,
                0.00 as SCr,
                CASE
                    WHEN OPSd.Dete >= :sdt THEN OPS.Summ
                    ELSE 0.00
                END as TDb,
                0.00 as TCr

            FROM OPSd JOIN OPS ON OPSd.id = OPS.DocId
            WHERE
                OPSd.Dete <= :edt AND
                OPS.AC11 LIKE :pac AND
                OPS.Cur = :pcur AND
                (:pclid IS NULL OR OPSd.ClId = :pclid)

            UNION ALL

            SELECT 
                OPS.AC21 AS AC,
                OPSd.ClId AS Clid,
                0.00 as SDb,
                CASE
                    WHEN OPSd.Dete < :sdt THEN OPS.Summ
                    ELSE 0.00
                END as SCr,
                0.00 as TDb,
                CASE
                    WHEN OPSd.Dete >= :sdt THEN OPS.Summ
                    ELSE 0.00
                END as TCr

            FROM OPSd JOIN OPS ON OPSd.id = OPS.DocId
            WHERE
                OPSd.Dete <= :edt AND
                OPS.AC21 = :pac AND
                OPS.Cur = :pcur AND
                (:pclid IS NULL OR OPSd.ClId = :pclid)

            UNION ALL

            SELECT 
                Bal0.AC11 AS AC,
                Bal0.ClId AS Clid,
                Bal0.SummD AS SDb,
                Bal0.SummC AS SCr,
                0.00 AS TDb,
                0.00 AS TCr
            FROM Bal0
            WHERE
                Bal0.AC11 = :pac AND
                Bal0.Cur = :pcur AND
                (:pclid IS NULL OR Bal0.ClId = :pclid)

        ) AS T1
        GROUP BY AC, T1.Clid

    ) AS T2
    LEFT JOIN AcP21 ON T2.AC = AcP21.AC
    LEFT JOIN Persons ON T2.Clid = Persons.ClId

    WHERE 
        (T2.ADb - T2.ACr) <> 0.00 OR
        T2.BDb <> 0.00 OR
        T2.BCr <> 0.00

    ORDER BY AC

    INTO
        :id, :spid, :ac, :rac, :name,
        :b0,
        :sdb, :scr, :tdb, :tcr,
        :clid, :name1, :regnr, :rname

    do
    begin
        suspend;
    end

end^


ALTER PROCEDURE SP_REP_APGR_DZ_11 (
    SDT DATE,
    EDT DATE)
RETURNS (
    ID TYPE OF COLUMN ROPS3A.ID,
    SPID TYPE OF COLUMN ROPS3A.SPID,
    RAC TYPE OF COLUMN ROPS3A.RAC,
    NAME TYPE OF COLUMN ROPS3A.NAME,
    SDB TYPE OF COLUMN ROPS3A.SDB,
    SCR TYPE OF COLUMN ROPS3A.SCR,
    AC1 TYPE OF COLUMN ROPS3A.AC1,
    CLID TYPE OF COLUMN ROPS3A.CLID)
AS
begin
    FOR SELECT
        gen_id(GEN_ROPS3A_ID, 1) as id,
        current_connection as spid,
        T2.AC AS RAc,
        Acp23.Name AS Name,
        T2.BDb AS SDb,
        T2.BCr AS SCr,
        NULL AS AC1,
        NULL AS Clid

    FROM
    (
        SELECT AC, SUM(TDb) AS BDb, SUM(TCr) AS BCr
        FROM
        (
            SELECT 
                OPS.AC13 AS AC,
                OPS.Summ AS TDb,
                0.00 AS TCr

            FROM OPSd JOIN OPS ON OPSd.id = OPS.DocId
            WHERE 
                OPSd.Dete BETWEEN :sdt AND :edt AND
                OPS.AC13 IS NOT NULL AND
                OPS.AC13 NOT IN ('KA','BA','CN')

            UNION ALL

            SELECT 
                OPS.AC23 AS AC,
                0.00 AS TDb,
                OPS.Summ AS TCr

            FROM OPSd JOIN OPS ON OPSd.id = OPS.DocId
            WHERE 
                OPSd.Dete BETWEEN :sdt AND :edt AND
                OPS.AC23 IS NOT NULL AND
                OPS.AC23 NOT IN ('KA','BA','CN')

        ) AS T1

        GROUP BY T1.AC
    ) AS T2    
    LEFT JOIN Acp23 ON Acp23.idx = T2.AC
    
    ORDER BY RAc

    INTO
        :id, :spid, :rac, :name,
        :sdb, :scr, :ac1, :clid
    do
    begin
        suspend;
    end
end^


ALTER PROCEDURE SP_REP_APGR_DZ_12 (
    SDT DATE,
    EDT DATE)
RETURNS (
    ID TYPE OF COLUMN ROPS2A.ID,
    SPID TYPE OF COLUMN ROPS2A.SPID,
    AC TYPE OF COLUMN ROPS2A.AC,
    RAC TYPE OF COLUMN ROPS2A.RAC,
    NAME TYPE OF COLUMN ROPS2A.NAME,
    B0 TYPE OF COLUMN ROPS2A.B0,
    SDB TYPE OF COLUMN ROPS2A.SDB,
    SCR TYPE OF COLUMN ROPS2A.SCR,
    TDB TYPE OF COLUMN ROPS2A.TDB,
    TCR TYPE OF COLUMN ROPS2A.TCR,
    CLID TYPE OF COLUMN ROPS2A.CLID,
    NAME1 TYPE OF COLUMN ROPS2A.NAME1,
    REGNR TYPE OF COLUMN ROPS2A.REGNR,
    RNAME TYPE OF COLUMN ROPS2A.RNAME)
AS
begin
    FOR SELECT
        gen_id(GEN_ROPS2A_ID, 1) as ID,
        current_connection as SPID,
        T2.AC as AC,
        null as RAC,
        acp23.name as NAME,
        T2.ADb - T2.ACr as b0,
        T2.ADb as sdb,
        T2.ACr as scr,
        T2.BDb as tdb,
        T2.BCr as tcr,
        null as clid,
        null as name1,
        null as regnr,
        null as rname
    FROM
    (
        SELECT AC, SUM(SDb) AS ADb, SUM(SCr) AS ACr, SUM(TDb) AS BDb, SUM(TCr) AS BCr
        FROM
        (
            SELECT 
                OPS.AC13 AS AC,
                OPS.Summ AS SDb,
                0.00 AS SCr,
                0.00 AS TDb,
                0.00 AS TCr

            FROM OPSd JOIN OPS ON OPSd.id = OPS.DocId
            WHERE 
                OPSd.Dete < :sdt AND
                OPS.AC13 IN ('KA', 'BA', 'CN')

            UNION ALL

            SELECT 
                OPS.AC23 AS AC,
                0.00 AS SDb,
                OPS.Summ AS SCr,
                0.00 AS TDb,
                0.00 AS TCr

            FROM OPSd JOIN OPS ON OPSd.id = OPS.DocId
            WHERE 
                OPSd.Dete < :sdt AND
                OPS.AC23 IN ('KA', 'BA', 'CN')

            UNION ALL

            SELECT 
                OPS.AC13 AS AC,
                0.00 AS SDb,
                0.00 AS SCr,
                OPS.Summ AS TDb,
                0.00 AS TCr

            FROM OPSd JOIN OPS ON OPSd.id = OPS.DocId
            WHERE 
                OPSd.Dete BETWEEN :sdt AND :edt AND 
                OPS.AC13 IN ('KA', 'BA', 'CN')

            UNION ALL

            SELECT 
                OPS.AC23 AS AC,
                0.00 AS SDb,
                0.00 AS SCr,
                0.00 AS TDb,
                OPS.Summ AS TCr

            FROM OPSd JOIN OPS ON OPSd.id = OPS.DocId
            WHERE 
                OPSd.Dete BETWEEN :sdt AND :edt AND 
                OPS.AC23 IN ('KA', 'BA', 'CN')
            
            UNION ALL

            
            SELECT 
                AcP21.id1 AS AC,
                Bal0.SummD AS SDb,
                Bal0.SummC AS SCr,
                0.00 AS TDb,
                0.00 AS TCr

            FROM Bal0 JOIN AcP21 ON Bal0.AC11 = AcP21.AC
            WHERE AcP21.id1 IN ('KA', 'BA', 'CN')

        ) AS T1

        GROUP BY T1.AC
    ) AS T2    

    LEFT JOIN Acp23 ON Acp23.idx = T2.AC
    
    ORDER BY AC

    into
        :id, :spid, :ac, :rac, :name,
        :b0,
        :sdb, :scr, :tdb, :tcr,
        :clid, :name1, :regnr, :rname
    do
    begin
        suspend;
    end

end^


ALTER PROCEDURE SP_REP_APGR_FULL_11 (
    SDT DATE,
    EDT DATE,
    PAC1 VARCHAR(8),
    PAC2 VARCHAR(8),
    PAC3 VARCHAR(5),
    PAC4 VARCHAR(8),
    PAC5 VARCHAR(5),
    PCLID VARCHAR(15),
    PXAC1 INTEGER,
    PXAC2 INTEGER,
    PXAC3 INTEGER,
    PXAC4 INTEGER,
    PXAC5 INTEGER,
    PXCLID INTEGER)
RETURNS (
    ID TYPE OF COLUMN TREPAPAN.ID,
    SPID TYPE OF COLUMN TREPAPAN.SPID,
    AC1 TYPE OF COLUMN TREPAPAN.AC1,
    AC2 TYPE OF COLUMN TREPAPAN.AC2,
    AC3 TYPE OF COLUMN TREPAPAN.AC3,
    AC4 TYPE OF COLUMN TREPAPAN.AC4,
    AC5 TYPE OF COLUMN TREPAPAN.AC5,
    CL TYPE OF COLUMN TREPAPAN.CL,
    S1 TYPE OF COLUMN TREPAPAN.S1,
    S2 TYPE OF COLUMN TREPAPAN.S2,
    S3 TYPE OF COLUMN TREPAPAN.S3,
    S4 TYPE OF COLUMN TREPAPAN.S4)
AS
begin
    FOR SELECT
        gen_id(gen_trepapan_id, 1) AS ID,
        current_connection AS spid,
        T3.AC1 AS AC1,
        T3.AC2 AS AC2,
        T3.AC3 AS AC3,
        T3.AC4 AS AC4,
        T3.AC5 AS AC5,
        T3.CL AS CL,
        T3.SS1 AS S1,
        T3.SS2 AS S2,
        T3.SS3 AS s3,
        T3.SS4 AS s4
    FROM
    (
        SELECT 
            AC1, AC2, AC3, AC4, AC5, CL,
            SUM(SS1) AS SS1, SUM(SS2) AS SS2, SUM(SS3) AS SS3, SUM(SS4) AS SS4
        FROM
        (
            SELECT 
                CASE WHEN :pxac1 = 1 THEN T1.AC1 ELSE NULL END AS AC1,
                CASE WHEN :pxac2 = 1 THEN T1.AC2 ELSE NULL END AS AC2,
                CASE WHEN :pxac3 = 1 THEN T1.AC3 ELSE NULL END AS AC3,
                CASE WHEN :pxac4 = 1 THEN T1.AC4 ELSE NULL END AS AC4,
                CASE WHEN :pxac5 = 1 THEN T1.AC5 ELSE NULL END AS AC5,
                CASE WHEN :pxclid = 1 THEN T1.CL ELSE NULL END AS CL,
                SUM(S1) AS SS1, SUM(S2) AS SS2, SUM(s3) AS SS3, SUM(s4) AS SS4
            FROM
            (
                SELECT 
                    OPS.AC11 AS AC1,
                    OPS.AC12 AS AC2,
                    OPS.AC13 AS AC3,
                    OPS.AC14 AS AC4,
                    OPS.AC15 AS AC5,
                    OPSd.ClId AS CL,
                    OPS.Summ AS S1,
                    0.00 AS S2,
                    coalesce(OPS.QV, 0.00) AS s3,
                    0.00 AS S4

                FROM OPSd JOIN OPS ON OPSd.id = OPS.DocId
                WHERE 
                    OPSd.Dete BETWEEN :sdt AND :edt AND 
                    (:pac1 IS NULL OR OPS.AC11 LIKE :pac1) AND
                    (:pac2 IS NULL OR OPS.AC12 LIKE :pac2) AND
                    (:pac3 IS NULL OR OPS.AC13 LIKE :pac3) AND
                    (:pac4 IS NULL OR OPS.AC14 LIKE :pac4) AND
                    (:pac5 IS NULL OR OPS.AC15 LIKE :pac5) AND
                    (:pclid IS NULL OR OPSd.ClId = :pclid)

                UNION ALL

                SELECT 
                    OPS.AC21 AS AC1,
                    OPS.AC22 AS AC2,
                    OPS.AC23 AS AC3,
                    OPS.AC24 AS AC4,
                    OPS.AC25 AS AC5,
                    OPSd.ClId AS CL,
                    0.00 AS S1,
                    OPS.Summ AS S2,
                    0.00 AS S3,
                    coalesce(OPS.QV, 0.00) AS s4

                FROM OPSd JOIN OPS ON OPSd.id = OPS.DocId
                WHERE 
                    OPSd.Dete BETWEEN :sdt AND :edt AND 
                    (:pac1 IS NULL OR OPS.AC21 LIKE :pac1) AND
                    (:pac2 IS NULL OR OPS.AC22 LIKE :pac2) AND
                    (:pac3 IS NULL OR OPS.AC23 LIKE :pac3) AND
                    (:pac4 IS NULL OR OPS.AC24 LIKE :pac4) AND
                    (:pac5 IS NULL OR OPS.AC25 LIKE :pac5) AND
                    (:pclid IS NULL OR OPSd.ClId = :pclid)

            ) AS T1
            GROUP BY T1.AC1, T1.AC2, T1.AC3, T1.AC4, T1.AC5, T1.CL

        )AS T2
        GROUP BY T2.AC1, T2.AC2, T2.AC3, T2.AC4, T2.AC5, T2.CL

    ) AS T3    
    ORDER BY AC1, AC2, AC3, AC4, AC5, CL

    into
        :id, :spid, :ac1, :ac2, :ac3, :ac4, :ac5,
        :cl, :s1, :s2, :s3, :s4
    do
    begin
        suspend;
    end
end^


ALTER PROCEDURE SP_REP_APGR_FULL_12 (
    SDT DATE,
    EDT DATE,
    PAC1 VARCHAR(8),
    PAC2 VARCHAR(8),
    PAC3 VARCHAR(5),
    PAC4 VARCHAR(8),
    PAC5 VARCHAR(5),
    PCLID VARCHAR(15))
RETURNS (
    ID TYPE OF COLUMN TREPAPAN.ID,
    SPID TYPE OF COLUMN TREPAPAN.SPID,
    AC1 TYPE OF COLUMN TREPAPAN.AC1,
    AC2 TYPE OF COLUMN TREPAPAN.AC2,
    AC3 TYPE OF COLUMN TREPAPAN.AC3,
    AC4 TYPE OF COLUMN TREPAPAN.AC4,
    AC5 TYPE OF COLUMN TREPAPAN.AC5,
    CL TYPE OF COLUMN TREPAPAN.CL,
    S1 TYPE OF COLUMN TREPAPAN.S1,
    S2 TYPE OF COLUMN TREPAPAN.S2,
    S3 TYPE OF COLUMN TREPAPAN.S3,
    S4 TYPE OF COLUMN TREPAPAN.S4)
AS
begin
    FOR SELECT
        gen_id(gen_trepapan_id, 1) AS ID,
        current_connection AS spid,
        T2.AC1 AS AC1,
        T2.AC2 AS AC2,
        T2.AC3 AS AC3,
        T2.AC4 AS AC4,
        T2.AC5 AS AC5,
        T2.CL AS CL,
        T2.SS1 AS S1,
        T2.SS2 AS S2,
        T2.SS3 AS s3,
        T2.SS4 AS s4
    FROM
    (
        SELECT
            AC1, AC2, AC3, AC4, AC5, CL,
            SUM(S1) AS SS1, SUM(S2) AS SS2, SUM(s3) AS SS3, SUM(s4) AS SS4
        FROM
        (
            SELECT 
                OPS.AC11 AS AC1,
                OPS.AC12 AS AC2,
                OPS.AC13 AS AC3,
                OPS.AC14 AS AC4,
                OPS.AC15 AS AC5,
                OPSd.ClId AS CL,
                OPS.Summ AS S1,
                0.00 AS S2,
                coalesce(OPS.QV, 0.00) AS s3,
                0.00 AS S4

            FROM OPSd JOIN OPS ON OPSd.id = OPS.DocId
            WHERE 
                OPSd.Dete BETWEEN :sdt AND :edt AND 
                (:pac1 IS NULL OR OPS.AC11 LIKE :pac1) AND
                (:pac2 IS NULL OR OPS.AC12 LIKE :pac2) AND
                (:pac3 IS NULL OR OPS.AC13 LIKE :pac3) AND
                (:pac4 IS NULL OR OPS.AC14 LIKE :pac4) AND
                (:pac5 IS NULL OR OPS.AC15 LIKE :pac5)

            UNION ALL

            SELECT 
                OPS.AC21 AS AC1,
                OPS.AC22 AS AC2,
                OPS.AC23 AS AC3,
                OPS.AC24 AS AC4,
                OPS.AC25 AS AC5,
                OPSd.ClId AS CL,
                0.00 AS S1,
                OPS.Summ AS S2,
                0.00 AS S3,
                coalesce(OPS.QV, 0.00) AS s4

            FROM OPSd JOIN OPS ON OPSd.id = OPS.DocId
            WHERE 
                OPSd.Dete BETWEEN :sdt AND :edt AND 
                (:pac1 IS NULL OR OPS.AC21 LIKE :pac1) AND
                (:pac2 IS NULL OR OPS.AC22 LIKE :pac2) AND
                (:pac3 IS NULL OR OPS.AC23 LIKE :pac3) AND
                (:pac4 IS NULL OR OPS.AC24 LIKE :pac4) AND
                (:pac5 IS NULL OR OPS.AC25 LIKE :pac5)

        ) AS T1

        GROUP BY T1.AC1, T1.AC2, T1.AC3, T1.AC4, T1.AC5, T1.CL
    ) AS T2    
    ORDER BY AC1, AC2, AC3, AC4, AC5, CL

    into
        :id, :spid, :ac1, :ac2, :ac3, :ac4, :ac5,
        :cl, :s1, :s2, :s3, :s4
    do
    begin
        suspend;
    end
end^


ALTER PROCEDURE SP_REP_APGR_MT_11 (
    SDT DATE,
    EDT DATE,
    PAC VARCHAR(8))
RETURNS (
    ID TYPE OF COLUMN TREPMT.ID,
    SPID TYPE OF COLUMN TREPMT.SPID,
    AD TYPE OF COLUMN TREPMT.AD,
    AC1 TYPE OF COLUMN TREPMT.AC1,
    AC2 TYPE OF COLUMN TREPMT.AC2,
    ACN1 TYPE OF COLUMN TREPMT.ACN1,
    ACN2 TYPE OF COLUMN TREPMT.ACN2,
    M1 TYPE OF COLUMN TREPMT.M1,
    M2 TYPE OF COLUMN TREPMT.M2,
    M3 TYPE OF COLUMN TREPMT.M3,
    M4 TYPE OF COLUMN TREPMT.M4,
    M5 TYPE OF COLUMN TREPMT.M5,
    M6 TYPE OF COLUMN TREPMT.M6,
    M7 TYPE OF COLUMN TREPMT.M7,
    M8 TYPE OF COLUMN TREPMT.M8,
    M9 TYPE OF COLUMN TREPMT.M9,
    M10 TYPE OF COLUMN TREPMT.M10,
    M11 TYPE OF COLUMN TREPMT.M11,
    M12 TYPE OF COLUMN TREPMT.M12,
    N1 TYPE OF COLUMN TREPMT.N1,
    N2 TYPE OF COLUMN TREPMT.N2,
    N3 TYPE OF COLUMN TREPMT.N3,
    N4 TYPE OF COLUMN TREPMT.N4,
    N5 TYPE OF COLUMN TREPMT.N5,
    N6 TYPE OF COLUMN TREPMT.N6,
    N7 TYPE OF COLUMN TREPMT.N7,
    N8 TYPE OF COLUMN TREPMT.N8,
    N9 TYPE OF COLUMN TREPMT.N9,
    N10 TYPE OF COLUMN TREPMT.N10,
    N11 TYPE OF COLUMN TREPMT.N11,
    N12 TYPE OF COLUMN TREPMT.N12,
    MT TYPE OF COLUMN TREPMT.MT,
    NT TYPE OF COLUMN TREPMT.NT)
AS
begin
    FOR SELECT
        gen_id(GEN_TREPMT_ID, 1) AS id,
        current_connection AS spid,
        null AS ad,
        T3.AC AS AC1,
        null AS AC2,
        AcP21.Name AS ACN1,
        NULL AS ACN2,
        M1,M2,M3,M4,M5,M6,M7,M8,M9,M10,M11,M12,
        N1,N2,N3,N4,N5,N6,N7,N8,N9,N10,N11,N12,
        0 AS MT, 0 as NT
    FROM
    (
        SELECT 
            AC,
            SUM(CASE WHEN MT = 1 THEN ADb ELSE 0.00 END) AS M1,
            SUM(CASE WHEN MT = 2 THEN ADb ELSE 0.00 END) AS M2,
            SUM(CASE WHEN MT = 3 THEN ADb ELSE 0.00 END) AS M3,
            SUM(CASE WHEN MT = 4 THEN ADb ELSE 0.00 END) AS M4,
            SUM(CASE WHEN MT = 5 THEN ADb ELSE 0.00 END) AS M5,
            SUM(CASE WHEN MT = 6 THEN ADb ELSE 0.00 END) AS M6,
            SUM(CASE WHEN MT = 7 THEN ADb ELSE 0.00 END) AS M7,
            SUM(CASE WHEN MT = 8 THEN ADb ELSE 0.00 END) AS M8,
            SUM(CASE WHEN MT = 9 THEN ADb ELSE 0.00 END) AS M9,
            SUM(CASE WHEN MT = 10 THEN ADb ELSE 0.00 END) AS M10,
            SUM(CASE WHEN MT = 11 THEN ADb ELSE 0.00 END) AS M11,
            SUM(CASE WHEN MT = 12 THEN ADb ELSE 0.00 END) AS M12,
            
            SUM(CASE WHEN MT = 1 THEN ACr ELSE 0.00 END) AS N1,
            SUM(CASE WHEN MT = 2 THEN ACr ELSE 0.00 END) AS N2,
            SUM(CASE WHEN MT = 3 THEN ACr ELSE 0.00 END) AS N3,
            SUM(CASE WHEN MT = 4 THEN ACr ELSE 0.00 END) AS N4,
            SUM(CASE WHEN MT = 5 THEN ACr ELSE 0.00 END) AS N5,
            SUM(CASE WHEN MT = 6 THEN ACr ELSE 0.00 END) AS N6,
            SUM(CASE WHEN MT = 7 THEN ACr ELSE 0.00 END) AS N7,
            SUM(CASE WHEN MT = 8 THEN ACr ELSE 0.00 END) AS N8,
            SUM(CASE WHEN MT = 9 THEN ACr ELSE 0.00 END) AS N9,
            SUM(CASE WHEN MT = 10 THEN ACr ELSE 0.00 END) AS N10,
            SUM(CASE WHEN MT = 11 THEN ACr ELSE 0.00 END) AS N11,
            SUM(CASE WHEN MT = 12 THEN ACr ELSE 0.00 END) AS N12

        FROM
        (
            SELECT AC, MT, SUM(SDb) AS ADb, SUM(SCr) AS ACr
            FROM
            (
                SELECT 
                    OPS.AC11 AS AC,
                    EXTRACT(MONTH FROM OPSd.Dete) AS MT,
                    OPS.Summ AS SDb,
                    0.00 AS SCr

                FROM OPSd JOIN OPS ON OPSd.id = OPS.DocId
                WHERE OPSd.Dete BETWEEN :sdt AND :edt AND OPS.AC11 LIKE :pac

                UNION ALL

                SELECT 
                    OPS.AC21 AS AC,
                    EXTRACT(MONTH FROM OPSd.Dete) AS MT,
                    0.00 AS SDb,
                    OPS.Summ AS SCr

                FROM OPSd JOIN OPS ON OPSd.id = OPS.DocId
                WHERE OPSd.Dete BETWEEN :sdt AND :edt AND OPS.AC21 LIKE :pac

            ) AS T1

            GROUP BY T1.AC, T1.MT

        ) AS T2
        GROUP BY T2.AC
    ) AS T3

    LEFT JOIN AcP21 ON AcP21.AC = T3.AC
    ORDER BY AC1

    into
        id, spid, ad, ac1, ac2, acn1, acn2,
        m1, m2, m3, m4, m5, m6, m7, m8, m9, m10, m11, m12,
        n1, n2, n3, n4, n5, n6, n7, n8, n9, n10, n11, n12,
        mt, nt
    do
    begin
        suspend;
    end
end^


ALTER PROCEDURE SP_REP_APGR_MT_12 (
    SDT DATE,
    EDT DATE,
    PAC VARCHAR(8))
RETURNS (
    ID TYPE OF COLUMN TREPMT.ID,
    SPID TYPE OF COLUMN TREPMT.SPID,
    AD TYPE OF COLUMN TREPMT.AD,
    AC1 TYPE OF COLUMN TREPMT.AC1,
    AC2 TYPE OF COLUMN TREPMT.AC2,
    ACN1 TYPE OF COLUMN TREPMT.ACN1,
    ACN2 TYPE OF COLUMN TREPMT.ACN2,
    M1 TYPE OF COLUMN TREPMT.M1,
    M2 TYPE OF COLUMN TREPMT.M2,
    M3 TYPE OF COLUMN TREPMT.M3,
    M4 TYPE OF COLUMN TREPMT.M4,
    M5 TYPE OF COLUMN TREPMT.M5,
    M6 TYPE OF COLUMN TREPMT.M6,
    M7 TYPE OF COLUMN TREPMT.M7,
    M8 TYPE OF COLUMN TREPMT.M8,
    M9 TYPE OF COLUMN TREPMT.M9,
    M10 TYPE OF COLUMN TREPMT.M10,
    M11 TYPE OF COLUMN TREPMT.M11,
    M12 TYPE OF COLUMN TREPMT.M12,
    N1 TYPE OF COLUMN TREPMT.N1,
    N2 TYPE OF COLUMN TREPMT.N2,
    N3 TYPE OF COLUMN TREPMT.N3,
    N4 TYPE OF COLUMN TREPMT.N4,
    N5 TYPE OF COLUMN TREPMT.N5,
    N6 TYPE OF COLUMN TREPMT.N6,
    N7 TYPE OF COLUMN TREPMT.N7,
    N8 TYPE OF COLUMN TREPMT.N8,
    N9 TYPE OF COLUMN TREPMT.N9,
    N10 TYPE OF COLUMN TREPMT.N10,
    N11 TYPE OF COLUMN TREPMT.N11,
    N12 TYPE OF COLUMN TREPMT.N12,
    MT TYPE OF COLUMN TREPMT.MT,
    NT TYPE OF COLUMN TREPMT.NT)
AS
begin
    FOR SELECT
        gen_id(GEN_TREPMT_ID, 1) AS id,
        current_connection AS spid,
        null AS ad,
        T3.AC1 AS AC1,
        T3.AC2 AS AC2,
        AcP21.Name AS ACN1,
        AcP24.Name AS ACN2,
        M1,M2,M3,M4,M5,M6,M7,M8,M9,M10,M11,M12,
        N1,N2,N3,N4,N5,N6,N7,N8,N9,N10,N11,N12,
        0 AS MT, 0 as NT
    FROM
    (
        SELECT 
            AC1, AC2,
            SUM(CASE WHEN MT = 1 THEN ADb ELSE 0.00 END) AS M1,
            SUM(CASE WHEN MT = 2 THEN ADb ELSE 0.00 END) AS M2,
            SUM(CASE WHEN MT = 3 THEN ADb ELSE 0.00 END) AS M3,
            SUM(CASE WHEN MT = 4 THEN ADb ELSE 0.00 END) AS M4,
            SUM(CASE WHEN MT = 5 THEN ADb ELSE 0.00 END) AS M5,
            SUM(CASE WHEN MT = 6 THEN ADb ELSE 0.00 END) AS M6,
            SUM(CASE WHEN MT = 7 THEN ADb ELSE 0.00 END) AS M7,
            SUM(CASE WHEN MT = 8 THEN ADb ELSE 0.00 END) AS M8,
            SUM(CASE WHEN MT = 9 THEN ADb ELSE 0.00 END) AS M9,
            SUM(CASE WHEN MT = 10 THEN ADb ELSE 0.00 END) AS M10,
            SUM(CASE WHEN MT = 11 THEN ADb ELSE 0.00 END) AS M11,
            SUM(CASE WHEN MT = 12 THEN ADb ELSE 0.00 END) AS M12,
            
            SUM(CASE WHEN MT = 1 THEN ACr ELSE 0.00 END) AS N1,
            SUM(CASE WHEN MT = 2 THEN ACr ELSE 0.00 END) AS N2,
            SUM(CASE WHEN MT = 3 THEN ACr ELSE 0.00 END) AS N3,
            SUM(CASE WHEN MT = 4 THEN ACr ELSE 0.00 END) AS N4,
            SUM(CASE WHEN MT = 5 THEN ACr ELSE 0.00 END) AS N5,
            SUM(CASE WHEN MT = 6 THEN ACr ELSE 0.00 END) AS N6,
            SUM(CASE WHEN MT = 7 THEN ACr ELSE 0.00 END) AS N7,
            SUM(CASE WHEN MT = 8 THEN ACr ELSE 0.00 END) AS N8,
            SUM(CASE WHEN MT = 9 THEN ACr ELSE 0.00 END) AS N9,
            SUM(CASE WHEN MT = 10 THEN ACr ELSE 0.00 END) AS N10,
            SUM(CASE WHEN MT = 11 THEN ACr ELSE 0.00 END) AS N11,
            SUM(CASE WHEN MT = 12 THEN ACr ELSE 0.00 END) AS N12

        FROM
        (
            SELECT AC1, AC2, MT, SUM(SDb) AS ADb, SUM(SCr) AS ACr
            FROM
            (
                SELECT 
                    OPS.AC11 AS AC1,
                    OPS.AC14 AS AC2,
                    EXTRACT(MONTH FROM OPSd.Dete) AS MT,
                    OPS.Summ AS SDb,
                    0.00 AS SCr

                FROM OPSd JOIN OPS ON OPSd.id = OPS.DocId
                WHERE OPSd.Dete BETWEEN :sdt AND :edt AND OPS.AC11 LIKE :pac

                UNION ALL

                SELECT 
                    OPS.AC21 AS AC,
                    OPS.AC24 AS AC2,
                    EXTRACT(MONTH FROM OPSd.Dete) AS MT,
                    0.00 AS SDb,
                    OPS.Summ AS SCr

                FROM OPSd JOIN OPS ON OPSd.id = OPS.DocId
                WHERE OPSd.Dete BETWEEN :sdt AND :edt AND OPS.AC21 LIKE :pac

            ) AS T1

            GROUP BY T1.AC2, T1.AC1, T1.MT

        ) AS T2
        GROUP BY T2.AC2, T2.AC1
    ) AS T3

    LEFT JOIN AcP21 ON AcP21.AC = T3.AC1
    LEFT JOIN AcP24 ON AcP24.idx = T3.AC2

    ORDER BY AC2, AC1

    into
        id, spid, ad, ac1, ac2, acn1, acn2,
        m1, m2, m3, m4, m5, m6, m7, m8, m9, m10, m11, m12,
        n1, n2, n3, n4, n5, n6, n7, n8, n9, n10, n11, n12,
        mt, nt
    do
    begin
        suspend;
    end
end^


ALTER PROCEDURE SP_REP_APGR_MT_21 (
    SDT DATE,
    EDT DATE,
    PAC VARCHAR(8))
RETURNS (
    ID TYPE OF COLUMN TREPMT.ID,
    SPID TYPE OF COLUMN TREPMT.SPID,
    AD TYPE OF COLUMN TREPMT.AD,
    AC1 TYPE OF COLUMN TREPMT.AC1,
    AC2 TYPE OF COLUMN TREPMT.AC2,
    ACN1 TYPE OF COLUMN TREPMT.ACN1,
    ACN2 TYPE OF COLUMN TREPMT.ACN2,
    M1 TYPE OF COLUMN TREPMT.M1,
    M2 TYPE OF COLUMN TREPMT.M2,
    M3 TYPE OF COLUMN TREPMT.M3,
    M4 TYPE OF COLUMN TREPMT.M4,
    M5 TYPE OF COLUMN TREPMT.M5,
    M6 TYPE OF COLUMN TREPMT.M6,
    M7 TYPE OF COLUMN TREPMT.M7,
    M8 TYPE OF COLUMN TREPMT.M8,
    M9 TYPE OF COLUMN TREPMT.M9,
    M10 TYPE OF COLUMN TREPMT.M10,
    M11 TYPE OF COLUMN TREPMT.M11,
    M12 TYPE OF COLUMN TREPMT.M12,
    N1 TYPE OF COLUMN TREPMT.N1,
    N2 TYPE OF COLUMN TREPMT.N2,
    N3 TYPE OF COLUMN TREPMT.N3,
    N4 TYPE OF COLUMN TREPMT.N4,
    N5 TYPE OF COLUMN TREPMT.N5,
    N6 TYPE OF COLUMN TREPMT.N6,
    N7 TYPE OF COLUMN TREPMT.N7,
    N8 TYPE OF COLUMN TREPMT.N8,
    N9 TYPE OF COLUMN TREPMT.N9,
    N10 TYPE OF COLUMN TREPMT.N10,
    N11 TYPE OF COLUMN TREPMT.N11,
    N12 TYPE OF COLUMN TREPMT.N12,
    MT TYPE OF COLUMN TREPMT.MT,
    NT TYPE OF COLUMN TREPMT.NT)
AS
begin
-- Mx - debeta summa, Nx - daudzums
    FOR SELECT
        gen_id(GEN_TREPMT_ID, 1) AS id,
        current_connection AS spid,
        null AS ad,
        T3.AC1 AS AC1,
        T3.AC2 AS AC2,
        AcP21.Name AS ACN1,
        AcP24.Name AS ACN2,
        M1,M2,M3,M4,M5,M6,M7,M8,M9,M10,M11,M12,
        N1,N2,N3,N4,N5,N6,N7,N8,N9,N10,N11,N12,
        0 AS MT, 0 as NT
    FROM
    (
        SELECT 
            AC1, AC2,
            SUM(CASE WHEN MT = 1 THEN ADb ELSE 0.00 END) AS M1,
            SUM(CASE WHEN MT = 2 THEN ADb ELSE 0.00 END) AS M2,
            SUM(CASE WHEN MT = 3 THEN ADb ELSE 0.00 END) AS M3,
            SUM(CASE WHEN MT = 4 THEN ADb ELSE 0.00 END) AS M4,
            SUM(CASE WHEN MT = 5 THEN ADb ELSE 0.00 END) AS M5,
            SUM(CASE WHEN MT = 6 THEN ADb ELSE 0.00 END) AS M6,
            SUM(CASE WHEN MT = 7 THEN ADb ELSE 0.00 END) AS M7,
            SUM(CASE WHEN MT = 8 THEN ADb ELSE 0.00 END) AS M8,
            SUM(CASE WHEN MT = 9 THEN ADb ELSE 0.00 END) AS M9,
            SUM(CASE WHEN MT = 10 THEN ADb ELSE 0.00 END) AS M10,
            SUM(CASE WHEN MT = 11 THEN ADb ELSE 0.00 END) AS M11,
            SUM(CASE WHEN MT = 12 THEN ADb ELSE 0.00 END) AS M12,
            
            SUM(CASE WHEN MT = 1 THEN AQV ELSE 0.00 END) AS N1,
            SUM(CASE WHEN MT = 2 THEN AQV ELSE 0.00 END) AS N2,
            SUM(CASE WHEN MT = 3 THEN AQV ELSE 0.00 END) AS N3,
            SUM(CASE WHEN MT = 4 THEN AQV ELSE 0.00 END) AS N4,
            SUM(CASE WHEN MT = 5 THEN AQV ELSE 0.00 END) AS N5,
            SUM(CASE WHEN MT = 6 THEN AQV ELSE 0.00 END) AS N6,
            SUM(CASE WHEN MT = 7 THEN AQV ELSE 0.00 END) AS N7,
            SUM(CASE WHEN MT = 8 THEN AQV ELSE 0.00 END) AS N8,
            SUM(CASE WHEN MT = 9 THEN AQV ELSE 0.00 END) AS N9,
            SUM(CASE WHEN MT = 10 THEN AQV ELSE 0.00 END) AS N10,
            SUM(CASE WHEN MT = 11 THEN AQV ELSE 0.00 END) AS N11,
            SUM(CASE WHEN MT = 12 THEN AQV ELSE 0.00 END) AS N12

        FROM
        (
            SELECT AC1, AC2, MT, SUM(SDb) AS ADb, SUM(SQV) AS AQV
            FROM
            (
                SELECT 
                    OPS.AC11 AS AC1,
                    OPS.AC14 AS AC2,
                    EXTRACT(MONTH FROM OPSd.Dete) AS MT,
                    OPS.Summ AS SDb,
                    coalesce(OPS.QV, 0.00) AS SQV

                FROM OPSd JOIN OPS ON OPSd.id = OPS.DocId
                WHERE OPSd.Dete BETWEEN :sdt AND :edt AND OPS.AC11 LIKE :pac

            ) AS T1

            GROUP BY T1.AC1, T1.AC2, T1.MT

        ) AS T2
        GROUP BY T2.AC1, T2.AC2
    ) AS T3

    LEFT JOIN AcP21 ON AcP21.AC = T3.AC1
    LEFT JOIN AcP24 ON AcP24.idx = T3.AC2

    ORDER BY AC1, AC2

    into
        id, spid, ad, ac1, ac2, acn1, acn2,
        m1, m2, m3, m4, m5, m6, m7, m8, m9, m10, m11, m12,
        n1, n2, n3, n4, n5, n6, n7, n8, n9, n10, n11, n12,
        mt, nt
    do
    begin
        suspend;
    end
end^


ALTER PROCEDURE SP_REP_APGR_MT_22 (
    SDT DATE,
    EDT DATE,
    PAC VARCHAR(8))
RETURNS (
    ID TYPE OF COLUMN TREPMT.ID,
    SPID TYPE OF COLUMN TREPMT.SPID,
    AD TYPE OF COLUMN TREPMT.AD,
    AC1 TYPE OF COLUMN TREPMT.AC1,
    AC2 TYPE OF COLUMN TREPMT.AC2,
    ACN1 TYPE OF COLUMN TREPMT.ACN1,
    ACN2 TYPE OF COLUMN TREPMT.ACN2,
    M1 TYPE OF COLUMN TREPMT.M1,
    M2 TYPE OF COLUMN TREPMT.M2,
    M3 TYPE OF COLUMN TREPMT.M3,
    M4 TYPE OF COLUMN TREPMT.M4,
    M5 TYPE OF COLUMN TREPMT.M5,
    M6 TYPE OF COLUMN TREPMT.M6,
    M7 TYPE OF COLUMN TREPMT.M7,
    M8 TYPE OF COLUMN TREPMT.M8,
    M9 TYPE OF COLUMN TREPMT.M9,
    M10 TYPE OF COLUMN TREPMT.M10,
    M11 TYPE OF COLUMN TREPMT.M11,
    M12 TYPE OF COLUMN TREPMT.M12,
    N1 TYPE OF COLUMN TREPMT.N1,
    N2 TYPE OF COLUMN TREPMT.N2,
    N3 TYPE OF COLUMN TREPMT.N3,
    N4 TYPE OF COLUMN TREPMT.N4,
    N5 TYPE OF COLUMN TREPMT.N5,
    N6 TYPE OF COLUMN TREPMT.N6,
    N7 TYPE OF COLUMN TREPMT.N7,
    N8 TYPE OF COLUMN TREPMT.N8,
    N9 TYPE OF COLUMN TREPMT.N9,
    N10 TYPE OF COLUMN TREPMT.N10,
    N11 TYPE OF COLUMN TREPMT.N11,
    N12 TYPE OF COLUMN TREPMT.N12,
    MT TYPE OF COLUMN TREPMT.MT,
    NT TYPE OF COLUMN TREPMT.NT)
AS
begin
-- Mx - debeta summa, Nx - daudzums
    FOR SELECT
        gen_id(GEN_TREPMT_ID, 1) AS id,
        current_connection AS spid,
        null AS ad,
        T3.AC1 AS AC1,
        T3.AC2 AS AC2,
        AcP21.Name AS ACN1,
        AcP24.Name AS ACN2,
        M1,M2,M3,M4,M5,M6,M7,M8,M9,M10,M11,M12,
        N1,N2,N3,N4,N5,N6,N7,N8,N9,N10,N11,N12,
        0 AS MT, 0 as NT
    FROM
    (
        SELECT 
            AC1, AC2,
            SUM(CASE WHEN MT = 1 THEN ADb ELSE 0.00 END) AS M1,
            SUM(CASE WHEN MT = 2 THEN ADb ELSE 0.00 END) AS M2,
            SUM(CASE WHEN MT = 3 THEN ADb ELSE 0.00 END) AS M3,
            SUM(CASE WHEN MT = 4 THEN ADb ELSE 0.00 END) AS M4,
            SUM(CASE WHEN MT = 5 THEN ADb ELSE 0.00 END) AS M5,
            SUM(CASE WHEN MT = 6 THEN ADb ELSE 0.00 END) AS M6,
            SUM(CASE WHEN MT = 7 THEN ADb ELSE 0.00 END) AS M7,
            SUM(CASE WHEN MT = 8 THEN ADb ELSE 0.00 END) AS M8,
            SUM(CASE WHEN MT = 9 THEN ADb ELSE 0.00 END) AS M9,
            SUM(CASE WHEN MT = 10 THEN ADb ELSE 0.00 END) AS M10,
            SUM(CASE WHEN MT = 11 THEN ADb ELSE 0.00 END) AS M11,
            SUM(CASE WHEN MT = 12 THEN ADb ELSE 0.00 END) AS M12,
            
            SUM(CASE WHEN MT = 1 THEN AQV ELSE 0.00 END) AS N1,
            SUM(CASE WHEN MT = 2 THEN AQV ELSE 0.00 END) AS N2,
            SUM(CASE WHEN MT = 3 THEN AQV ELSE 0.00 END) AS N3,
            SUM(CASE WHEN MT = 4 THEN AQV ELSE 0.00 END) AS N4,
            SUM(CASE WHEN MT = 5 THEN AQV ELSE 0.00 END) AS N5,
            SUM(CASE WHEN MT = 6 THEN AQV ELSE 0.00 END) AS N6,
            SUM(CASE WHEN MT = 7 THEN AQV ELSE 0.00 END) AS N7,
            SUM(CASE WHEN MT = 8 THEN AQV ELSE 0.00 END) AS N8,
            SUM(CASE WHEN MT = 9 THEN AQV ELSE 0.00 END) AS N9,
            SUM(CASE WHEN MT = 10 THEN AQV ELSE 0.00 END) AS N10,
            SUM(CASE WHEN MT = 11 THEN AQV ELSE 0.00 END) AS N11,
            SUM(CASE WHEN MT = 12 THEN AQV ELSE 0.00 END) AS N12

        FROM
        (
            SELECT AC1, AC2, MT, SUM(SDb) AS ADb, SUM(SQV) AS AQV
            FROM
            (
                SELECT 
                    OPS.AC21 AS AC1,
                    OPS.AC24 AS AC2,
                    EXTRACT(MONTH FROM OPSd.Dete) AS MT,
                    OPS.Summ AS SDb,
                    coalesce(OPS.QV, 0.00) AS SQV

                FROM OPSd JOIN OPS ON OPSd.id = OPS.DocId
                WHERE OPSd.Dete BETWEEN :sdt AND :edt AND OPS.AC21 LIKE :pac

            ) AS T1

            GROUP BY T1.AC1, T1.AC2, T1.MT

        ) AS T2
        GROUP BY T2.AC1, T2.AC2
    ) AS T3

    LEFT JOIN AcP21 ON AcP21.AC = T3.AC1
    LEFT JOIN AcP24 ON AcP24.idx = T3.AC2

    ORDER BY AC1, AC2

    into
        id, spid, ad, ac1, ac2, acn1, acn2,
        m1, m2, m3, m4, m5, m6, m7, m8, m9, m10, m11, m12,
        n1, n2, n3, n4, n5, n6, n7, n8, n9, n10, n11, n12,
        mt, nt
    do
    begin
        suspend;
    end
end^


ALTER PROCEDURE SP_REP_APGR_NP_11 (
    SDT DATE,
    EDT DATE,
    PAC VARCHAR(8))
RETURNS (
    ID TYPE OF COLUMN ROPS2A.ID,
    SPID TYPE OF COLUMN ROPS2A.SPID,
    AC TYPE OF COLUMN ROPS2A.AC,
    RAC TYPE OF COLUMN ROPS2A.RAC,
    NAME TYPE OF COLUMN ROPS2A.NAME,
    B0 TYPE OF COLUMN ROPS2A.B0,
    SDB TYPE OF COLUMN ROPS2A.SDB,
    SCR TYPE OF COLUMN ROPS2A.SCR,
    TDB TYPE OF COLUMN ROPS2A.TDB,
    TCR TYPE OF COLUMN ROPS2A.TCR,
    CLID TYPE OF COLUMN ROPS2A.CLID,
    NAME1 TYPE OF COLUMN ROPS2A.NAME1,
    REGNR TYPE OF COLUMN ROPS2A.REGNR,
    RNAME TYPE OF COLUMN ROPS2A.RNAME)
AS
begin
    FOR SELECT
        gen_id(GEN_ROPS2A_ID, 1) AS id,
        current_connection AS spid,
        T2.AC AS AC,
        NULL AS RAC,
        AcP21.Name AS Name,
        0.00 AS B0,
        0.00 AS SDb,
        0.00 AS SCr,
        T2.BDb AS TDb,
        T2.BCr AS TCr,
        NULL AS Clid,
        NULL AS Name1,
        NULL AS RegNr,
        NULL AS RName
    FROM
    (
        SELECT AC, SUM(TDb) AS BDb, SUM(TCr) AS BCr
        FROM
        (
            SELECT 
                OPS.AC12 AS AC,
                OPS.Summ AS TDb,
                0.00 AS TCr

            FROM OPSd JOIN OPS ON OPSd.id = OPS.DocId
            WHERE OPSd.Dete BETWEEN :sdt AND :edt AND OPS.AC12 LIKE :pac

            UNION ALL

            SELECT 
                OPS.AC22 AS AC,
                0.00 AS TDb,
                OPS.Summ AS TCr

            FROM OPSd JOIN OPS ON OPSd.id = OPS.DocId
            WHERE OPSd.Dete BETWEEN :sdt AND :edt AND OPS.AC22 LIKE :pac

        ) AS T1

        GROUP BY T1.AC
    ) AS T2    

    LEFT JOIN AcP21    ON AcP21.AC = T2.AC
    
    ORDER BY AC

    into
        :id, :spid, :ac, :rac, :name,
        :b0,
        :sdb, :scr, :tdb, :tcr,
        :clid, :name1, :regnr, :rname
    do
    begin
        suspend;
    end

end^


ALTER PROCEDURE SP_REP_APGR_NP_12 (
    SDT DATE,
    EDT DATE,
    PAC VARCHAR(8),
    PACLEN INTEGER)
RETURNS (
    ID TYPE OF COLUMN ROPS2A.ID,
    SPID TYPE OF COLUMN ROPS2A.SPID,
    AC TYPE OF COLUMN ROPS2A.AC,
    RAC TYPE OF COLUMN ROPS2A.RAC,
    NAME TYPE OF COLUMN ROPS2A.NAME,
    B0 TYPE OF COLUMN ROPS2A.B0,
    SDB TYPE OF COLUMN ROPS2A.SDB,
    SCR TYPE OF COLUMN ROPS2A.SCR,
    TDB TYPE OF COLUMN ROPS2A.TDB,
    TCR TYPE OF COLUMN ROPS2A.TCR,
    CLID TYPE OF COLUMN ROPS2A.CLID,
    NAME1 TYPE OF COLUMN ROPS2A.NAME1,
    REGNR TYPE OF COLUMN ROPS2A.REGNR,
    RNAME TYPE OF COLUMN ROPS2A.RNAME)
AS
begin
    FOR SELECT
        gen_id(GEN_ROPS2A_ID, 1) AS id,
        current_connection AS spid,
        T2.AC AS AC,
        NULL AS RAC,
        AcP21.Name AS Name,
        0.00 AS B0,
        0.00 AS SDb,
        0.00 AS SCr,
        T2.BDb AS TDb,
        T2.BCr AS TCr,
        NULL AS Clid,
        NULL AS Name1,
        NULL AS RegNr,
        NULL AS RName
    FROM
    (
        SELECT AC, SUM(TDb) AS BDb, SUM(TCr) AS BCr
        FROM
        (
            SELECT 
                LEFT(OPS.AC12, :paclen) AS AC,
                OPS.Summ AS TDb,
                0.00 AS TCr

            FROM OPSd JOIN OPS ON OPSd.id = OPS.DocId
            WHERE OPSd.Dete BETWEEN :sdt AND :edt AND OPS.AC12 LIKE :pac

            UNION ALL

            SELECT 
                LEFT(OPS.AC22, :paclen) AS AC,
                0.00 AS TDb,
                OPS.Summ AS TCr

            FROM OPSd JOIN OPS ON OPSd.id = OPS.DocId
            WHERE OPSd.Dete BETWEEN :sdt AND :edt AND OPS.AC22 LIKE :pac

        ) AS T1

        GROUP BY T1.AC
    ) AS T2    

    LEFT JOIN AcP21    ON AcP21.AC = T2.AC
    
    ORDER BY AC

    into
        :id, :spid, :ac, :rac, :name,
        :b0,
        :sdb, :scr, :tdb, :tcr,
        :clid, :name1, :regnr, :rname
    do
    begin
        suspend;
    end

end^


ALTER PROCEDURE SP_REP_BAL_11 (
    SDT DATE,
    EDT DATE)
RETURNS (
    AC VARCHAR(8),
    S1 MONEY,
    S2 MONEY)
AS
begin
    FOR SELECT
        T2.AC AS AC,
        T2.ADb - T2.ACr AS S1,
        T2.BDb - T2.BCr AS S2
    FROM
    (
        SELECT AC, SUM(SDb) AS ADb, SUM(SCr) AS ACr, SUM(TDb) AS BDb, SUM(TCr) AS BCr
        FROM
        (
            SELECT 
                OPS.AC11 AS AC,
                CASE
                    WHEN OPSd.Dete < :sdt THEN OPS.Summ
                    ELSE 0.00
                END AS SDb,
                0.00 AS SCr,
                CASE
                    WHEN OPSd.Dete >= :sdt THEN OPS.Summ
                    ELSE 0.00
                END AS TDb,
                0.00 AS TCr

            FROM OPSd JOIN OPS ON OPSd.id = OPS.DocId
            WHERE OPSd.Dete <= :edt

            UNION ALL

            SELECT 
                OPS.AC21 AS AC,
                0.00 AS SDb,
                CASE
                    WHEN OPSd.Dete < :sdt THEN OPS.Summ
                    ELSE 0.00
                END AS SCr,
                0.00 AS TDb,
                CASE
                    WHEN OPSd.Dete >= :sdt THEN OPS.Summ
                    ELSE 0.00
                END AS TCr

            FROM OPSd JOIN OPS ON OPSd.id = OPS.DocId
            WHERE OPSd.Dete <= :edt

            UNION ALL

            SELECT 
                Bal0.AC11 AS AC,
                Bal0.SummD AS SDb,
                Bal0.SummC AS SCr,
                0.00 AS TDb,
                0.00 AS TCr
            FROM Bal0

        ) AS T1

        GROUP BY T1.AC
    ) AS T2    

    WHERE (ADb - ACr) <> 0.00 OR BDb <> 0.00 OR BCr <> 0.00

    ORDER BY AC

    INTO
        :AC, :S1, S2
    DO
    BEGIN
        SUSPEND;
    END
end^


ALTER PROCEDURE SP_REP_BAL_12 (
    SDT DATE,
    EDT DATE,
    PBALID VARCHAR(10))
RETURNS (
    ID TYPE OF COLUMN BALA21.ID,
    SPID TYPE OF COLUMN BALA21.SPID,
    BID TYPE OF COLUMN BALA21.BID,
    S1 TYPE OF COLUMN BALA21.S1,
    S2 TYPE OF COLUMN BALA21.S2)
AS
begin
    INSERT INTO ttemp_balaC (AC, S1, S2)
        SELECT T1.AC, T1.S1, T1.S2
        FROM sp_rep_bal_11(:SDT, :EDT) AS T1;

    INSERT INTO ttemp_BalA21 (bid, S1, S2)
    SELECT 
        BalA2.id AS bid,
        SUM(iif(BalA3.tp = 'Db', T1a.S1, - T1a.S1)) AS s1,
        SUM(iif(BalA3.tp = 'Db', T1a.S2, - T1a.S2)) AS s2
    FROM BalA1
        INNER JOIN BalA2 ON BalA1.balid = BalA2.balid
        INNER JOIN BalA3 ON BalA2.id = BalA3.id2
        INNER JOIN ttemp_balaC AS T1a ON T1a.AC LIKE REPLACE(BalA3.ac,'*','%')
    WHERE
        BalA1.balid = :pbalid AND
        BalA2.tp = 'S'
    GROUP BY BalA2.id;


    INSERT INTO ttemp_BalA21 (bid, S1, S2)
    SELECT 
        BalA2.id AS bid,
        SUM(T2.s1) AS s1,
        SUM(T2.s2) AS s2
    FROM 
        BalA1 
        INNER JOIN BalA2 ON BalA1.balid = BalA2.balid
        INNER JOIN
            (
                SELECT BalA2.nr, ttemp_BalA21.s1, ttemp_BalA21.s2
                FROM BalA2 INNER JOIN ttemp_BalA21 
                    ON ttemp_BalA21.bid = BalA2.id
            ) AS T2
            ON T2.nr BETWEEN BalA2.nr1 AND BalA2.nr2
    WHERE
        BalA1.balid = :pbalid AND
        BalA2.tp = 'K'
    GROUP BY BalA2.id;


    INSERT INTO ttemp_BalA21 (bid, S1, S2)
    SELECT 
        BalA2.id AS bid,
        SUM(T2.s1) AS s1,
        SUM(T2.s2) AS s2
    FROM 
        BalA1 
        INNER JOIN BalA2 ON BalA1.balid = BalA2.balid
        INNER JOIN
            (
                SELECT BalA2.nr, ttemp_BalA21.s1, ttemp_BalA21.s2
                FROM BalA2 INNER JOIN ttemp_BalA21 
                    ON ttemp_BalA21.bid = BalA2.id
            ) AS T2
            ON T2.nr = BalA2.nr1
    WHERE
        BalA1.balid = :pbalid AND
        BalA2.tp = 'V'
    GROUP BY BalA2.id;


    FOR SELECT
        ttemp_BalA21.bid AS id, -- hack
        0 AS spid,
        ttemp_BalA21.bid AS bid,
        ttemp_BalA21.s1 AS s1,
        ttemp_BalA21.s2 AS s2
    FROM ttemp_BalA21
        INNER JOIN BalA2 ON ttemp_BalA21.bid = BalA2.id
    ORDER BY BalA2.nr

    into
        :id, :spid, :bid, :s1, :s2
    do
    begin
        suspend;
    end
end^


ALTER PROCEDURE SP_REP_BAL_13 (
    PBALID VARCHAR(10))
RETURNS (
    AC TYPE OF COLUMN ACP21.AC,
    NAME TYPE OF COLUMN ACP21.NAME,
    ID1 TYPE OF COLUMN ACP21.ID1,
    ID2 TYPE OF COLUMN ACP21.ID2)
AS
begin
-- rezult√Ñ¬Åt√Ñ¬Å AcP21.AC, kas netika iesumm√Ñ‚Äúti bilances formul√Ñ¬Ås
    FOR SELECT
        AcP21.AC, null, null, null
    FROM AcP21 LEFT JOIN
    (    
        SELECT DISTINCT AcP21.AC
        FROM BalA1
            INNER JOIN BalA2 ON BalA1.balid = BalA2.balid
            INNER JOIN BalA3 ON BalA2.id = BalA3.id2
            INNER JOIN AcP21 ON AcP21.AC LIKE REPLACE(BalA3.ac,'*','%')
        WHERE
            BalA1.balid = :pbalid AND
            BalA2.tp = 'S'
    ) AS T1 ON AcP21.AC = T1.AC
    WHERE T1.AC IS NULL
    ORDER BY AC
      into :ac, :name, :id1, :id2
  do
  begin
    suspend;
  end
end^


ALTER PROCEDURE SP_REP_BAL_21 (
    SDT DATE,
    EDT DATE)
RETURNS (
    AC VARCHAR(8),
    M0 MONEY,
    M1 MONEY,
    M2 MONEY,
    M3 MONEY,
    M4 MONEY,
    M5 MONEY,
    M6 MONEY,
    M7 MONEY,
    M8 MONEY,
    M9 MONEY,
    M10 MONEY,
    M11 MONEY,
    M12 MONEY)
AS
begin
    FOR SELECT
        AC, M0, M1, M2, M3, M4, M5, M6, M7, M8, M9, M10, M11, M12
    FROM
    (
        SELECT
            T2.AC AS AC,
            SUM(CASE WHEN MT = 0 THEN S1 ELSE 0.00 END) AS M0,
            SUM(CASE WHEN MT = 1 THEN S1 ELSE 0.00 END) AS M1,
            SUM(CASE WHEN MT = 2 THEN S1 ELSE 0.00 END) AS M2,
            SUM(CASE WHEN MT = 3 THEN S1 ELSE 0.00 END) AS M3,
            SUM(CASE WHEN MT = 4 THEN S1 ELSE 0.00 END) AS M4,
            SUM(CASE WHEN MT = 5 THEN S1 ELSE 0.00 END) AS M5,
            SUM(CASE WHEN MT = 6 THEN S1 ELSE 0.00 END) AS M6,
            SUM(CASE WHEN MT = 7 THEN S1 ELSE 0.00 END) AS M7,
            SUM(CASE WHEN MT = 8 THEN S1 ELSE 0.00 END) AS M8,
            SUM(CASE WHEN MT = 9 THEN S1 ELSE 0.00 END) AS M9,
            SUM(CASE WHEN MT = 10 THEN S1 ELSE 0.00 END) AS M10,
            SUM(CASE WHEN MT = 11 THEN S1 ELSE 0.00 END) AS M11,
            SUM(CASE WHEN MT = 12 THEN S1 ELSE 0.00 END) AS M12
        FROM
        (
            SELECT AC, MT, SUM(SDb - SCr) AS S1
            FROM
            (
                SELECT 
                    OPS.AC11 AS AC,
                    CASE
                        WHEN OPSd.Dete < :sdt THEN 0
                        ELSE EXTRACT(MONTH FROM OPSd.Dete)
                    END AS MT,
    
                    OPS.Summ AS SDb,
                    0.00 AS SCr
    
                FROM OPSd JOIN OPS ON OPSd.id = OPS.DocId
                WHERE OPSd.Dete <= :edt
    
                UNION ALL
    
                SELECT 
                    OPS.AC21 AS AC,
                    CASE
                        WHEN OPSd.Dete < :sdt THEN 0
                        ELSE EXTRACT(MONTH FROM OPSd.Dete)
                    END AS MT,
    
                    0.00 AS SDb,
                    OPS.Summ AS SCr
    
                FROM OPSd JOIN OPS ON OPSd.id = OPS.DocId
                WHERE OPSd.Dete <= :edt
    
                UNION ALL
    
                SELECT 
                    Bal0.AC11 AS AC,
                    0 AS MT,
                    Bal0.SummD AS SDb,
                    Bal0.SummC AS SCr
                FROM Bal0
    
            ) AS T1
    
            GROUP BY T1.AC, T1.MT
        ) AS T2    
    
        WHERE (S1) <> 0.00
        GROUP BY AC
    )
    ORDER BY AC
    INTO
        :AC, :M0, :M1, :M2, :M3, :M4, :M5, :M6, :M7, :M8, :M9, :M10, :M11, :M12
    DO
    BEGIN
        SUSPEND;
    END
end^


ALTER PROCEDURE SP_REP_BAL_22 (
    SDT DATE,
    EDT DATE,
    PBALID VARCHAR(10))
RETURNS (
    ID INTEGER,
    SPID INTEGER,
    BID INTEGER,
    M0 MONEY,
    M1 MONEY,
    M2 MONEY,
    M3 MONEY,
    M4 MONEY,
    M5 MONEY,
    M6 MONEY,
    M7 MONEY,
    M8 MONEY,
    M9 MONEY,
    M10 MONEY,
    M11 MONEY,
    M12 MONEY)
AS
begin
    INSERT INTO ttemp_balmt1 (AC, M0, M1, M2, M3, M4, M5,
            M6, M7, M8, M9, M10, M11, M12)
        SELECT T1.AC, T1.M0, T1.M1, T1.M2, T1.M3, T1.M4, T1.M5,
                T1.M6, T1.M7, T1.M8, T1.M9, T1.M10, T1.M11, T1.M12
        FROM sp_rep_bal_21(:SDT, :EDT) AS T1;

    INSERT INTO ttemp_BalMT2 (bid, M0, M1, M2, M3, M4, M5,
            M6, M7, M8, M9, M10, M11, M12)
    SELECT 
        BalA2.id AS bid,
        SUM(iif(BalA3.tp = 'Db', T1a.M0, - T1a.M0)) AS M0,
        SUM(iif(BalA3.tp = 'Db', T1a.M1, - T1a.M1)) AS M1,
        SUM(iif(BalA3.tp = 'Db', T1a.M2, - T1a.M2)) AS M2,
        SUM(iif(BalA3.tp = 'Db', T1a.M3, - T1a.M3)) AS M3,
        SUM(iif(BalA3.tp = 'Db', T1a.M4, - T1a.M4)) AS M4,
        SUM(iif(BalA3.tp = 'Db', T1a.M5, - T1a.M5)) AS M5,
        SUM(iif(BalA3.tp = 'Db', T1a.M6, - T1a.M6)) AS M6,
        SUM(iif(BalA3.tp = 'Db', T1a.M7, - T1a.M7)) AS M7,
        SUM(iif(BalA3.tp = 'Db', T1a.M8, - T1a.M8)) AS M8,
        SUM(iif(BalA3.tp = 'Db', T1a.M9, - T1a.M9)) AS M9,
        SUM(iif(BalA3.tp = 'Db', T1a.M10, - T1a.M10)) AS M10,
        SUM(iif(BalA3.tp = 'Db', T1a.M11, - T1a.M11)) AS M11,
        SUM(iif(BalA3.tp = 'Db', T1a.M12, - T1a.M12)) AS M12
    FROM BalA1
        INNER JOIN BalA2 ON BalA1.balid = BalA2.balid
        INNER JOIN BalA3 ON BalA2.id = BalA3.id2
        INNER JOIN ttemp_balMT1 AS T1a ON T1a.AC LIKE REPLACE(BalA3.ac,'*','%')
    WHERE
        BalA1.balid = :pbalid AND
        BalA2.tp = 'S'
    GROUP BY BalA2.id;


    INSERT INTO ttemp_BalMT2 (bid, M0, M1, M2, M3, M4, M5,
            M6, M7, M8, M9, M10, M11, M12)
    SELECT 
        BalA2.id AS bid,
        SUM(T2.M0) AS M0,
        SUM(T2.M1) AS M1,
        SUM(T2.M2) AS M2,
        SUM(T2.M3) AS M3,
        SUM(T2.M4) AS M4,
        SUM(T2.M5) AS M5,
        SUM(T2.M6) AS M6,
        SUM(T2.M7) AS M7,
        SUM(T2.M8) AS M8,
        SUM(T2.M9) AS M9,
        SUM(T2.M10) AS M10,
        SUM(T2.M11) AS M11,
        SUM(T2.M12) AS M12
    FROM 
        BalA1 
        INNER JOIN BalA2 ON BalA1.balid = BalA2.balid
        INNER JOIN
            (
                SELECT
                    BalA2.nr,
                    ttemp_BalMT2.M0,
                    ttemp_BalMT2.M1,
                    ttemp_BalMT2.M2,
                    ttemp_BalMT2.M3,
                    ttemp_BalMT2.M4,
                    ttemp_BalMT2.M5,
                    ttemp_BalMT2.M6,
                    ttemp_BalMT2.M7,
                    ttemp_BalMT2.M8,
                    ttemp_BalMT2.M9,
                    ttemp_BalMT2.M10,
                    ttemp_BalMT2.M11,
                    ttemp_BalMT2.M12
                FROM BalA2 INNER JOIN ttemp_BalMT2
                    ON ttemp_BalMT2.bid = BalA2.id
            ) AS T2
            ON T2.nr BETWEEN BalA2.nr1 AND BalA2.nr2
    WHERE
        BalA1.balid = :pbalid AND
        BalA2.tp = 'K'
    GROUP BY BalA2.id;


    INSERT INTO ttemp_BalMT2 (bid, M0, M1, M2, M3, M4, M5,
            M6, M7, M8, M9, M10, M11, M12)
    SELECT 
        BalA2.id AS bid,
        SUM(T2.M0) AS M0,
        SUM(T2.M1) AS M1,
        SUM(T2.M2) AS M2,
        SUM(T2.M3) AS M3,
        SUM(T2.M4) AS M4,
        SUM(T2.M5) AS M5,
        SUM(T2.M6) AS M6,
        SUM(T2.M7) AS M7,
        SUM(T2.M8) AS M8,
        SUM(T2.M9) AS M9,
        SUM(T2.M10) AS M10,
        SUM(T2.M11) AS M11,
        SUM(T2.M12) AS M12
    FROM 
        BalA1 
        INNER JOIN BalA2 ON BalA1.balid = BalA2.balid
        INNER JOIN
            (
                SELECT
                    BalA2.nr,
                    ttemp_BalMT2.M0,
                    ttemp_BalMT2.M1,
                    ttemp_BalMT2.M2,
                    ttemp_BalMT2.M3,
                    ttemp_BalMT2.M4,
                    ttemp_BalMT2.M5,
                    ttemp_BalMT2.M6,
                    ttemp_BalMT2.M7,
                    ttemp_BalMT2.M8,
                    ttemp_BalMT2.M9,
                    ttemp_BalMT2.M10,
                    ttemp_BalMT2.M11,
                    ttemp_BalMT2.M12
                FROM BalA2 INNER JOIN ttemp_BalMT2
                    ON ttemp_BalMT2.bid = BalA2.id
            ) AS T2
            ON T2.nr = BalA2.nr1
    WHERE
        BalA1.balid = :pbalid AND
        BalA2.tp = 'V'
    GROUP BY BalA2.id;


    FOR SELECT
        ttemp_BalMT2.bid AS id, -- hack
        0 AS spid,
        ttemp_BalMT2.bid AS bid,
        ttemp_BalMT2.M0 AS M0,
        ttemp_BalMT2.M1 AS M1,
        ttemp_BalMT2.M2 AS M2,
        ttemp_BalMT2.M3 AS M3,
        ttemp_BalMT2.M4 AS M4,
        ttemp_BalMT2.M5 AS M5,
        ttemp_BalMT2.M6 AS M6,
        ttemp_BalMT2.M7 AS M7,
        ttemp_BalMT2.M8 AS M8,
        ttemp_BalMT2.M9 AS M9,
        ttemp_BalMT2.M10 AS M10,
        ttemp_BalMT2.M11 AS M11,
        ttemp_BalMT2.M12 AS M12
    FROM ttemp_BalMT2
        INNER JOIN BalA2 ON ttemp_BalMT2.bid = BalA2.id
    ORDER BY BalA2.nr

    into
        :id, :spid, :bid, :M0, :M1, :M2, :M3, :M4, :M5, :M6, :M7, :M8, :M9, :M10, :M11, :M12
    do
    begin
        suspend;
    end
end^


ALTER PROCEDURE SP_REP_CURCHECK_01 (
    SDT DATE,
    EDT DATE,
    PAC VARCHAR(8),
    PCLID VARCHAR(8),
    PCUR VARCHAR(3))
RETURNS (
    ID TYPE OF COLUMN ROPS1A.ID,
    SPID TYPE OF COLUMN ROPS1A.SPID,
    DID TYPE OF COLUMN ROPS1A.DID,
    DETE TYPE OF COLUMN ROPS1A.DETE,
    NRX TYPE OF COLUMN ROPS1A.NRX,
    DOCTYP TYPE OF COLUMN ROPS1A.DOCTYP,
    DOCTYP1 TYPE OF COLUMN ROPS1A.DOCTYP1,
    DOCTYP2 TYPE OF COLUMN ROPS1A.DOCTYP2,
    DOCST TYPE OF COLUMN ROPS1A.DOCST,
    DOCNR TYPE OF COLUMN ROPS1A.DOCNR,
    CLID TYPE OF COLUMN ROPS1A.CLID,
    CLID2 TYPE OF COLUMN ROPS1A.CLID2,
    NAME TYPE OF COLUMN ROPS1A.NAME,
    NAME2 TYPE OF COLUMN ROPS1A.NAME2,
    REGNR TYPE OF COLUMN ROPS1A.REGNR,
    REGNR2 TYPE OF COLUMN ROPS1A.REGNR2,
    B0 TYPE OF COLUMN ROPS1A.B0,
    DESCR TYPE OF COLUMN ROPS1A.DESCR,
    DESCR2 TYPE OF COLUMN ROPS1A.DESCR2,
    AC1 TYPE OF COLUMN ROPS1A.AC1,
    AC2 TYPE OF COLUMN ROPS1A.AC2,
    SAC1 TYPE OF COLUMN ROPS1A.SAC1,
    SAC2 TYPE OF COLUMN ROPS1A.SAC2,
    SUMMC TYPE OF COLUMN ROPS1A.SUMMC,
    CUR TYPE OF COLUMN ROPS1A.CUR,
    SUMM TYPE OF COLUMN ROPS1A.SUMM,
    PVN TYPE OF COLUMN ROPS1A.PVN,
    RAC TYPE OF COLUMN ROPS1A.RAC,
    SDB TYPE OF COLUMN ROPS1A.SDB,
    SCR TYPE OF COLUMN ROPS1A.SCR,
    RAC2 TYPE OF COLUMN ROPS1A.RAC2,
    RAC3 TYPE OF COLUMN ROPS1A.RAC3,
    RAC4 TYPE OF COLUMN ROPS1A.RAC4,
    RAC5 TYPE OF COLUMN ROPS1A.RAC5,
    QV TYPE OF COLUMN ROPS1A.QV,
    ZNR TYPE OF COLUMN ROPS1A.ZNR)
AS
begin
--mekl√Ñ‚Äújam dokumentus ar val√Ö¬´tas konvert√Ñ¬Åcijas k√Ñ¬º√Ö¬´d√Ñ¬Åm
    FOR SELECT
        gen_id(GEN_ROPS1A_ID, 1) as id,
        0 as spid,
        T1.id AS did, 
        T1.Dete AS Dete,
        T1.NrX AS NrX,
        T1.DocTyp AS DocTyp,
        DocTyp.id1 AS DocTyp1, 
        null AS DocTyp2,
        T1.DocSt AS DocSt,
        T1.DocNr AS DocNr,
        T1.ClId AS Clid,
        T1.ClId2 AS Clid2,
        Persons.Name AS Name,
        Persons2.Name AS Name2, 
        Persons.RegNr AS RegNr,
        Persons2.RegNr AS RegNr2,
        0 as b0, 
        T1.Descr AS Descr,
        null AS Descr2,
        null AS AC1,
        null AS AC2,
        null AS SAC1,
        null AS SAC2,
        0 AS SummC,
        null AS Cur,
        T1.Summ AS Summ,
        T1.PVN AS PVN,
        null AS Rac,
        0 AS Sdb,
        0 AS Scr,
        null AS Rac2,
        null AS Rac3,
        null AS Rac4,
        null AS Rac5,
        0 AS qv,
        T1.ZNR AS ZNR
    FROM
        (
            SELECT DISTINCT OPSd.*
            FROM 
                OPSd INNER JOIN OPS ON OPSd.id = OPS.DocId
                LEFT JOIN Currency 
                ON Currency.id = OPS.Cur AND Currency.Dete = OPSd.Dete
            WHERE 
                OPSd.Dete BETWEEN :sdt AND :edt AND 
                OPS.Cur <> 'EUR' AND
                (OPS.AC11 LIKE :pac OR OPS.AC21 LIKE :pac) AND
                (
                    Currency.id IS NULL OR
                    ROUND(OPS.SummC*Currency.rate,2) <> OPS.Summ
                )
        ) AS T1

        LEFT JOIN DocTyp ON T1.DocTyp = DocTyp.id
        LEFT JOIN Persons ON T1.ClId = Persons.ClId
        LEFT JOIN Persons AS Persons2 ON T1.ClId2 = Persons2.ClId        

    ORDER BY T1.Dete, T1.id

    into
        :id, :spid, :did, :dete, :nrx,
        :doctyp, :doctyp1, :doctyp2, :docst, :docnr,
        :clid, :clid2, :name, :name2, :regnr, :regnr2,
        :b0, :descr, :descr2, :ac1, :ac2, :sac1,:sac2,
        :summc, :cur, :summ, :pvn, :rac, :sdb, :scr,
        :rac2, :rac3, :rac4, :rac5, :qv, :znr
    do
    begin
        suspend;
    end
end^


ALTER PROCEDURE SP_REP_CURRDIFF_01 (
    SDT DATE,
    EDT DATE,
    PAC VARCHAR(8),
    PCLID VARCHAR(8),
    PCUR VARCHAR(3))
RETURNS (
    ID TYPE OF COLUMN ROPS2A.ID,
    SPID TYPE OF COLUMN ROPS2A.SPID,
    AC TYPE OF COLUMN ROPS2A.AC,
    RAC TYPE OF COLUMN ROPS2A.RAC,
    NAME TYPE OF COLUMN ROPS2A.NAME,
    B0 TYPE OF COLUMN ROPS2A.B0,
    SDB TYPE OF COLUMN ROPS2A.SDB,
    SCR TYPE OF COLUMN ROPS2A.SCR,
    TDB TYPE OF COLUMN ROPS2A.TDB,
    TCR TYPE OF COLUMN ROPS2A.TCR,
    CLID TYPE OF COLUMN ROPS2A.CLID,
    NAME1 TYPE OF COLUMN ROPS2A.NAME1,
    REGNR TYPE OF COLUMN ROPS2A.REGNR,
    RNAME TYPE OF COLUMN ROPS2A.RNAME)
AS
begin
    FOR SELECT
        gen_id(GEN_ROPS2A_ID, 1) AS id,
        current_connection AS spid,
        T2.AC AS AC,
        NULL AS RAC,
        AcP21.Name AS Name,
        0.00 as b0,
        T2.ADb AS SDb,
        T2.ACr AS SCr,
        T2.BDb AS TDb,
        T2.BCr AS TCr,
        T2.Clid AS Clid,
        Persons.Name AS Name1,
        Persons.regnr AS regnr,
        null as rname
    FROM
    (
        SELECT AC, T1.Clid AS Clid, SUM(SDb) AS ADb, SUM(SCr) AS ACr, SUM(TDb) AS BDb, SUM(TCr) AS BCr
        FROM
        (
            -- :pcur ***************
            SELECT 
                OPS.AC11 AS AC,
                OPSd.ClId AS Clid,
                OPS.SummC AS SDb,
                0.00 AS SCr,
                OPS.Summ AS TDb,
                0.00 AS TCr

            FROM OPSd JOIN OPS ON OPSd.id = OPS.DocId
            WHERE 
                OPSd.Dete <= :edt AND 
                OPS.AC11 = :pac AND 
                OPS.Cur = :pcur AND
                (:pclid IS NULL OR OPSd.ClId = :pclid)

            UNION ALL

            SELECT 
                OPS.AC21 AS AC,
                OPSd.ClId AS Clid,
                0.00 AS SDb,
                OPS.SummC AS SCr,
                0.00 AS TDb,
                OPS.Summ AS TCr


            FROM OPSd JOIN OPS ON OPSd.id = OPS.DocId
            WHERE 
                OPSd.Dete <= :edt AND 
                OPS.AC21 = :pac AND 
                OPS.Cur = :pcur AND
                (:pclid IS NULL OR OPSd.ClId = :pclid)

            -- EUR ***************
            UNION ALL

            SELECT 
                OPS.AC11 AS AC,
                OPSd.ClId AS Clid,
                0.00 AS SDb,
                0.00 AS SCr,
                OPS.Summ AS TDb,
                0.00 AS TCr

            FROM OPSd JOIN OPS ON OPSd.id = OPS.DocId
            WHERE 
                OPSd.Dete <= :edt AND 
                OPS.AC11 = :pac AND 
                OPS.Cur = 'EUR' AND
                (:pclid IS NULL OR OPSd.ClId = :pclid)

            UNION ALL

            SELECT 
                OPS.AC21 AS AC,
                OPSd.ClId AS Clid,
                0.00 AS SDb,
                0.00 AS SCr,
                0.00 AS TDb,
                OPS.Summ AS TCr


            FROM OPSd JOIN OPS ON OPSd.id = OPS.DocId
            WHERE 
                OPSd.Dete <= :edt AND 
                OPS.AC21 = :pac AND 
                OPS.Cur = 'EUR' AND
                (:pclid IS NULL OR OPSd.ClId = :pclid)

            UNION ALL

            SELECT 
                Bal0.AC11 AS AC,
                Bal0.ClId AS Clid,
                Bal0.SummDC AS SDb,
                Bal0.SummCC AS SCr,
                Bal0.SummD AS TDb,
                Bal0.SummC AS TCr
            FROM Bal0
            WHERE 
                Bal0.AC11 = :pac AND 
                Bal0.Cur = :pcur AND
                (:pclid IS NULL OR Bal0.ClId = :pclid)
            
            UNION ALL

            SELECT 
                Bal0.AC11 AS AC,
                Bal0.ClId AS Clid,
                0.00 AS SDb,
                0.00 AS SCr,
                Bal0.SummD AS TDb,
                Bal0.SummC AS TCr
            FROM Bal0
            WHERE 
                Bal0.AC11 = :pac AND 
                Bal0.Cur = 'EUR' AND
                (:pclid IS NULL OR Bal0.ClId = :pclid)

        ) AS T1
        GROUP BY AC, T1.Clid

    ) AS T2    
    LEFT JOIN AcP21 ON T2.AC = AcP21.AC
    LEFT JOIN Persons ON T2.Clid = Persons.ClId
    ORDER BY AC

    
    into
        :id, :spid, :ac, :rac, :name,
        :b0,
        :sdb, :scr, :tdb, :tcr,
        :clid, :name1, :regnr, :rname
    do
    begin
        suspend;
    end
end^


ALTER PROCEDURE SP_REP_DARZ_1 (
    SDT DATE,
    EDT DATE,
    PAC1 TYPE OF COLUMN OPS.AC11,
    PAC3 TYPE OF COLUMN OPS.AC13)
RETURNS (
    ID TYPE OF COLUMN TREPDARZ1.ID,
    SPID TYPE OF COLUMN TREPDARZ1.SPID,
    DID TYPE OF COLUMN TREPDARZ1.DID,
    RID TYPE OF COLUMN TREPDARZ1.RID,
    DETE TYPE OF COLUMN TREPDARZ1.DETE,
    NRX TYPE OF COLUMN TREPDARZ1.NRX,
    DOCTYP TYPE OF COLUMN TREPDARZ1.DOCTYP,
    DOCST TYPE OF COLUMN TREPDARZ1.DOCST,
    DOCNR TYPE OF COLUMN TREPDARZ1.DOCNR,
    CLID TYPE OF COLUMN TREPDARZ1.CLID,
    NAME TYPE OF COLUMN TREPDARZ1.NAME,
    REGNR TYPE OF COLUMN TREPDARZ1.REGNR,
    DESCR TYPE OF COLUMN TREPDARZ1.DESCR,
    AC1 TYPE OF COLUMN TREPDARZ1.AC1,
    AC2 TYPE OF COLUMN TREPDARZ1.AC2,
    AA TYPE OF COLUMN TREPDARZ1.AA,
    A1 TYPE OF COLUMN TREPDARZ1.A1,
    A2 TYPE OF COLUMN TREPDARZ1.A2,
    A3 TYPE OF COLUMN TREPDARZ1.A3,
    A4 TYPE OF COLUMN TREPDARZ1.A4,
    A5 TYPE OF COLUMN TREPDARZ1.A5,
    A6 TYPE OF COLUMN TREPDARZ1.A6,
    A7 TYPE OF COLUMN TREPDARZ1.A7,
    A8 TYPE OF COLUMN TREPDARZ1.A8,
    A9 TYPE OF COLUMN TREPDARZ1.A9,
    A10 TYPE OF COLUMN TREPDARZ1.A10,
    A11 TYPE OF COLUMN TREPDARZ1.A11,
    A12 TYPE OF COLUMN TREPDARZ1.A12,
    A13 TYPE OF COLUMN TREPDARZ1.A13,
    A14 TYPE OF COLUMN TREPDARZ1.A14,
    A15 TYPE OF COLUMN TREPDARZ1.A15,
    A16 TYPE OF COLUMN TREPDARZ1.A16,
    A17 TYPE OF COLUMN TREPDARZ1.A17,
    A18 TYPE OF COLUMN TREPDARZ1.A18)
AS
begin
    FOR SELECT
        gen_id(GEN_TREPDARZ1_ID, 1) AS id,
        current_connection AS spid,
        DocId AS did,
        0 AS rid,
        MAX(Dete) AS Dete,
        MAX(NrX) AS NrX,
        MAX(DocTyp.id1) AS DocTyp,
        MAX(DocSt) AS DocSt,
        MAX(DocNr) AS DocNr,
        MAX(OPSd.clid) AS clid,
        MAX(Persons.name) AS Name,
        MAX(Persons.regnr) AS RegNr,
        MAX(OPSd.descr) AS Descr,

        null AS AC1,
        null AS AC2,
        null AS AA,

        SUM(CASE WHEN AC13 = 'KA' THEN OPS.Summ ELSE 0.00 END) AS A1,
        SUM(CASE WHEN AC23 = 'KA' THEN OPS.Summ ELSE 0.00 END) AS A2,
        
        SUM(CASE WHEN AC13 = 'BA' THEN OPS.Summ ELSE 0.00 END) AS A3,
        SUM(CASE WHEN AC23 = 'BA' THEN OPS.Summ ELSE 0.00 END) AS A4,
                                                                
        SUM(CASE WHEN AC13 = 'CN' THEN OPS.Summ ELSE 0.00 END) AS A5,
        SUM(CASE WHEN AC23 = 'CN' THEN OPS.Summ ELSE 0.00 END) AS A6,

        SUM(CASE WHEN AC23 = 'LIE' THEN OPS.Summ ELSE 0.00 END) AS A7,
        SUM(CASE WHEN AC23 = 'NIE' THEN OPS.Summ ELSE 0.00 END) AS A8,
        SUM(CASE WHEN AC23 = 'SUB' THEN OPS.Summ ELSE 0.00 END) AS A9,
        SUM(CASE WHEN AC23 = 'ZIE' THEN OPS.Summ ELSE 0.00 END) AS A10,
        SUM(CASE WHEN AC23 = 'CIE' THEN OPS.Summ ELSE 0.00 END) AS A11,

        SUM(CASE WHEN AC13 = 'LIZ' THEN OPS.Summ ELSE 0.00 END) AS A12,
        SUM(CASE WHEN AC13 = 'NIZ' THEN OPS.Summ ELSE 0.00 END) AS A13,
        SUM(CASE WHEN AC13 = 'PIZ' THEN OPS.Summ ELSE 0.00 END) AS A14,
        SUM(CASE WHEN AC13 = 'ZIZ' THEN OPS.Summ ELSE 0.00 END) AS A15,
        SUM(CASE WHEN AC13 = 'CIZ' THEN OPS.Summ ELSE 0.00 END) AS A16,

        SUM(CASE WHEN AC13 = 'LIZ1' THEN OPS.Summ ELSE 0.00 END) AS A17,
        SUM(CASE WHEN AC13 = 'NIZ1' THEN OPS.Summ ELSE 0.00 END) AS A18

    FROM
        OPSd JOIN OPS ON OPSd.id = OPS.DocId
        LEFT JOIN persons ON OPSd.clid = Persons.clid
        LEFT JOIN doctyp ON OPSd.doctyp = doctyp.id
    WHERE
        OPSd.Dete BETWEEN :sdt AND :edt AND
        OPS.AC13 IS NOT NULL AND
        OPS.AC23 IS NOT NULL AND
        (:PAC1 IS NULL OR OPS.AC11 = :PAC1 OR OPS.AC21 = :PAC1) AND
        (:PAC3 IS NULL OR OPS.AC13 = :PAC3 OR OPS.AC23 = :PAC3)
    GROUP BY DocId
    ORDER BY Dete, did


    into
        :id, :spid, :did, :rid, :dete, :nrx,
        :doctyp, :docst, :docnr, :clid, :name, :regnr,
        :descr, :ac1, :ac2, :aa,
        :a1, :a2, :a3, :a4, :a5, :a6, :a7, :a8,
        :a9, :a10, :a11, :a12, :a13, :a14,:a15,:a16,:a17,:a18
    do
    begin
        suspend;
    end
end^


ALTER PROCEDURE SP_REP_DARZ_2 (
    SDT DATE,
    EDT DATE,
    PAC1 TYPE OF COLUMN OPS.AC11,
    PAC3 TYPE OF COLUMN OPS.AC13)
RETURNS (
    ID TYPE OF COLUMN TREPDARZ2.ID,
    SPID TYPE OF COLUMN TREPDARZ2.SPID,
    RID0 TYPE OF COLUMN TREPDARZ2.RID0,
    A1 TYPE OF COLUMN TREPDARZ2.A1,
    A2 TYPE OF COLUMN TREPDARZ2.A2,
    A3 TYPE OF COLUMN TREPDARZ2.A3,
    A4 TYPE OF COLUMN TREPDARZ2.A4,
    A5 TYPE OF COLUMN TREPDARZ2.A5,
    A6 TYPE OF COLUMN TREPDARZ2.A6,
    A7 TYPE OF COLUMN TREPDARZ2.A7,
    A8 TYPE OF COLUMN TREPDARZ2.A8,
    A9 TYPE OF COLUMN TREPDARZ2.A9,
    A10 TYPE OF COLUMN TREPDARZ2.A10,
    A11 TYPE OF COLUMN TREPDARZ2.A11,
    A12 TYPE OF COLUMN TREPDARZ2.A12,
    A13 TYPE OF COLUMN TREPDARZ2.A13,
    A14 TYPE OF COLUMN TREPDARZ2.A14,
    A15 TYPE OF COLUMN TREPDARZ2.A15,
    A16 TYPE OF COLUMN TREPDARZ2.A16,
    A17 TYPE OF COLUMN TREPDARZ2.A17,
    A18 TYPE OF COLUMN TREPDARZ2.A18,
    A19 TYPE OF COLUMN TREPDARZ2.A19,
    A20 TYPE OF COLUMN TREPDARZ2.A20,
    A21 TYPE OF COLUMN TREPDARZ2.A21)
AS
begin

    FOR SELECT
        gen_id(GEN_TREPDARZ2_ID, 1) AS id,
        current_connection AS spid,
        coalesce(T2.rid0, 0) AS rid0,
        coalesce(T1.A1, 0.00) AS A1,
        coalesce(T1.A2, 0.00) AS A2,
        coalesce(T1.A3, 0.00) AS A3,
        coalesce(T1.A4, 0.00) AS A4,
        coalesce(T1.A5, 0.00) AS A5,
        coalesce(T1.A6, 0.00) AS A6,
        coalesce(T2.A7, 0.00) AS A7,
        coalesce(T2.A8, 0.00) AS A8,
        coalesce(T2.A9, 0.00) AS A9,
        coalesce(T2.A10, 0.00) AS A10,
        coalesce(T2.A11, 0.00) AS A11,
        coalesce(T2.A12, 0.00) AS A12,
        coalesce(T2.A13, 0.00) AS A13,
        coalesce(T2.A14, 0.00) AS A14,
        coalesce(T2.A15, 0.00) AS A15,
        coalesce(T2.A16, 0.00) AS A16,
        coalesce(T3.A17, 0.00) AS A17,
        coalesce(T3.A18, 0.00) AS A18,
        coalesce(T3.A19, 0.00) AS A19,
        coalesce(T2.A20, 0.00) AS A20,
        coalesce(T2.A21, 0.00) AS A21

    FROM
        (SELECT
            SUM(CASE WHEN AC13 = 'KA' THEN OPS.Summ ELSE 0.00 END) AS A1,
            SUM(CASE WHEN AC23 = 'KA' THEN OPS.Summ ELSE 0.00 END) AS A2,
        
            SUM(CASE WHEN AC13 = 'BA' THEN OPS.Summ ELSE 0.00 END) AS A3,
            SUM(CASE WHEN AC23 = 'BA' THEN OPS.Summ ELSE 0.00 END) AS A4,
        
            SUM(CASE WHEN AC13 = 'CN' THEN OPS.Summ ELSE 0.00 END) AS A5,
            SUM(CASE WHEN AC23 = 'CN' THEN OPS.Summ ELSE 0.00 END) AS A6

        FROM
            OPSd JOIN OPS ON OPSd.id = OPS.DocId

        WHERE
            OPSd.Dete <= :edt AND
            OPS.AC13 IS NOT NULL AND
            OPS.AC23 IS NOT NULL AND
            (:PAC1 IS NULL OR OPS.AC11 = :PAC1 OR OPS.AC21 = :PAC1) AND
            (:PAC3 IS NULL OR OPS.AC13 = :PAC3 OR OPS.AC23 = :PAC3)
        ) AS T1,
        
        (SELECT
            COUNT(DISTINCT DocId) rid0,
        
            SUM(CASE WHEN AC23 = 'LIE' THEN OPS.Summ ELSE 0.00 END) AS A7,
            SUM(CASE WHEN AC23 = 'NIE' THEN OPS.Summ ELSE 0.00 END) AS A8,
            SUM(CASE WHEN AC23 = 'SUB' THEN OPS.Summ ELSE 0.00 END) AS A9,
            SUM(CASE WHEN AC23 = 'ZIE' THEN OPS.Summ ELSE 0.00 END) AS A10,
            SUM(CASE WHEN AC23 = 'CIE' THEN OPS.Summ ELSE 0.00 END) AS A11,

            SUM(CASE WHEN AC13 = 'LIZ' THEN OPS.Summ ELSE 0.00 END) AS A12,
            SUM(CASE WHEN AC13 = 'NIZ' THEN OPS.Summ ELSE 0.00 END) AS A13,
            SUM(CASE WHEN AC13 = 'PIZ' THEN OPS.Summ ELSE 0.00 END) AS A14,
            SUM(CASE WHEN AC13 = 'ZIZ' THEN OPS.Summ ELSE 0.00 END) AS A15,
            SUM(CASE WHEN AC13 = 'CIZ' THEN OPS.Summ ELSE 0.00 END) AS A16,

            SUM(CASE WHEN AC13 = 'LIZ1' THEN OPS.Summ ELSE 0.00 END) AS A20,
            SUM(CASE WHEN AC13 = 'NIZ1' THEN OPS.Summ ELSE 0.00 END) AS A21

        FROM
            OPSd JOIN OPS ON OPSd.id = OPS.DocId
        WHERE
            OPSd.Dete BETWEEN :sdt AND :edt AND
            OPS.AC13 IS NOT NULL AND
            OPS.AC23 IS NOT NULL AND
            (:PAC1 IS NULL OR OPS.AC11 = :PAC1 OR OPS.AC21 = :PAC1) AND
            (:PAC3 IS NULL OR OPS.AC13 = :PAC3 OR OPS.AC23 = :PAC3)
        ) AS T2,

        (SELECT 
            SUM(CASE WHEN AcP21.id1 = 'KA'
                THEN Bal0.SummD - Bal0.SummC ELSE 0.00 END) AS A17,
            SUM(CASE WHEN AcP21.id1 = 'BA'
                THEN Bal0.SummD - Bal0.SummC ELSE 0.00 END) AS A18,
            SUM(CASE WHEN AcP21.id1 = 'CN'
                THEN Bal0.SummD - Bal0.SummC ELSE 0.00 END) AS A19

        FROM Bal0
            INNER JOIN AcP21 ON Bal0.AC11 = AcP21.AC
        WHERE
            AcP21.id1 IN ('KA','BA','CN') AND
            (:PAC1 IS NULL OR AcP21.ac = :PAC1) AND
            (:PAC3 IS NULL OR AcP21.id1 = :PAC3)

        ) AS T3


    into
        :id, :spid, :rid0,
        :a1, :a2, :a3, :a4, :a5, :a6, :a7, :a8, :a9, :a10,
        :a11, :a12, :a13, :a14, :a15, :a16, :a17, :a18, :a19, :a20, :a21
    do
    begin
        suspend;
    end
end^


ALTER PROCEDURE SP_REP_DARZ_3 (
    SDT DATE,
    EDT DATE)
RETURNS (
    ID TYPE OF COLUMN TREPDARZ1.ID,
    SPID TYPE OF COLUMN TREPDARZ1.SPID,
    DID TYPE OF COLUMN TREPDARZ1.DID,
    RID TYPE OF COLUMN TREPDARZ1.RID,
    DETE TYPE OF COLUMN TREPDARZ1.DETE,
    NRX TYPE OF COLUMN TREPDARZ1.NRX,
    DOCTYP TYPE OF COLUMN TREPDARZ1.DOCTYP,
    DOCST TYPE OF COLUMN TREPDARZ1.DOCST,
    DOCNR TYPE OF COLUMN TREPDARZ1.DOCNR,
    CLID TYPE OF COLUMN TREPDARZ1.CLID,
    NAME TYPE OF COLUMN TREPDARZ1.NAME,
    REGNR TYPE OF COLUMN TREPDARZ1.REGNR,
    DESCR TYPE OF COLUMN TREPDARZ1.DESCR,
    AC1 TYPE OF COLUMN TREPDARZ1.AC1,
    AC2 TYPE OF COLUMN TREPDARZ1.AC2,
    AA TYPE OF COLUMN TREPDARZ1.AA,
    A1 TYPE OF COLUMN TREPDARZ1.A1,
    A2 TYPE OF COLUMN TREPDARZ1.A2,
    A3 TYPE OF COLUMN TREPDARZ1.A3,
    A4 TYPE OF COLUMN TREPDARZ1.A4,
    A5 TYPE OF COLUMN TREPDARZ1.A5,
    A6 TYPE OF COLUMN TREPDARZ1.A6,
    A7 TYPE OF COLUMN TREPDARZ1.A7,
    A8 TYPE OF COLUMN TREPDARZ1.A8,
    A9 TYPE OF COLUMN TREPDARZ1.A9,
    A10 TYPE OF COLUMN TREPDARZ1.A10,
    A11 TYPE OF COLUMN TREPDARZ1.A11,
    A12 TYPE OF COLUMN TREPDARZ1.A12,
    A13 TYPE OF COLUMN TREPDARZ1.A13,
    A14 TYPE OF COLUMN TREPDARZ1.A14,
    A15 TYPE OF COLUMN TREPDARZ1.A15,
    A16 TYPE OF COLUMN TREPDARZ1.A16)
AS
begin
    FOR SELECT
        gen_id(GEN_TREPDARZ1_ID, 1) AS id,
        current_connection AS spid,
        DocId AS did,
        0 AS rid,
        MAX(Dete) AS Dete,
        MAX(NrX) AS NrX,
        MAX(DocTyp.id1) AS DocTyp,
        MAX(DocSt) AS DocSt,
        MAX(DocNr) AS DocNr,
        MAX(OPSd.clid) AS clid,
        MAX(Persons.name) AS Name,
        MAX(Persons.regnr) AS RegNr,
        MAX(OPSd.descr) AS Descr,

        null AS AC1,
        null AS AC2,
        null AS AA,

        SUM(CASE WHEN AC13 = 'KA' THEN OPS.Summ ELSE 0.00 END) AS A1,
        SUM(CASE WHEN AC23 = 'KA' THEN OPS.Summ ELSE 0.00 END) AS A2,
        
        SUM(CASE WHEN AC13 = 'BA' THEN OPS.Summ ELSE 0.00 END) AS A3,
        SUM(CASE WHEN AC23 = 'BA' THEN OPS.Summ ELSE 0.00 END) AS A4,
        
        SUM(CASE WHEN AC13 = 'CN' THEN OPS.Summ ELSE 0.00 END) AS A5,
        SUM(CASE WHEN AC23 = 'CN' THEN OPS.Summ ELSE 0.00 END) AS A6,

        SUM(CASE WHEN AC23 = 'LIE' OR AC23 = 'SUB' THEN OPS.Summ ELSE 0.00 END) AS A7,
        SUM(CASE WHEN AC23 = 'NIE' THEN OPS.Summ ELSE 0.00 END) AS A8,
        SUM(CASE WHEN AC23 = 'ZIE' OR AC23 = 'CIE' THEN OPS.Summ ELSE 0.00 END) AS A9,

        SUM(CASE WHEN AC13 = 'DIZ' THEN OPS.Summ ELSE 0.00 END) AS A10,
        SUM(CASE WHEN AC13 = 'MIZ' THEN OPS.Summ ELSE 0.00 END) AS A11,
        SUM(CASE WHEN AC13 = 'LIZ' OR AC13 = 'NIZ' OR AC13 = 'PIZ' THEN OPS.Summ ELSE 0.00 END) AS A12,
        SUM(CASE WHEN AC13 = 'ZIZ' OR AC13 = 'CIZ' THEN OPS.Summ ELSE 0.00 END) AS A13,
        
        0 AS A14,
        0 AS A15,
        0 AS A16

    FROM
        OPSd JOIN OPS ON OPSd.id = OPS.DocId
        LEFT JOIN persons ON OPSd.clid = Persons.clid
        LEFT JOIN doctyp ON OPSd.doctyp = doctyp.id
    WHERE
        OPSd.Dete BETWEEN :sdt AND :edt AND
        OPS.AC13 IS NOT NULL AND
        OPS.AC23 IS NOT NULL
    GROUP BY DocId
    ORDER BY Dete, did

    into
        :id, :spid, :did, :rid, :DETE, :nrx,
        :doctyp, :docst, :docnr, :clid, :name, :regnr,
        :descr, :ac1, :ac2, :aa,
        :a1, :a2, :a3, :a4, :a5, :a6, :a7, :a8,
        :a9, :a10, :a11, :a12, :a13, :a14,:a15,:a16
    do
    begin
        suspend;
    end
end^


ALTER PROCEDURE SP_REP_DARZ_4 (
    SDT DATE,
    EDT DATE)
RETURNS (
    ID TYPE OF COLUMN TREPDARZ2.ID,
    SPID TYPE OF COLUMN TREPDARZ2.SPID,
    RID0 TYPE OF COLUMN TREPDARZ2.RID0,
    A1 TYPE OF COLUMN TREPDARZ2.A1,
    A2 TYPE OF COLUMN TREPDARZ2.A2,
    A3 TYPE OF COLUMN TREPDARZ2.A3,
    A4 TYPE OF COLUMN TREPDARZ2.A4,
    A5 TYPE OF COLUMN TREPDARZ2.A5,
    A6 TYPE OF COLUMN TREPDARZ2.A6,
    A7 TYPE OF COLUMN TREPDARZ2.A7,
    A8 TYPE OF COLUMN TREPDARZ2.A8,
    A9 TYPE OF COLUMN TREPDARZ2.A9,
    A10 TYPE OF COLUMN TREPDARZ2.A10,
    A11 TYPE OF COLUMN TREPDARZ2.A11,
    A12 TYPE OF COLUMN TREPDARZ2.A12,
    A13 TYPE OF COLUMN TREPDARZ2.A13,
    A14 TYPE OF COLUMN TREPDARZ2.A14,
    A15 TYPE OF COLUMN TREPDARZ2.A15,
    A16 TYPE OF COLUMN TREPDARZ2.A16,
    A17 TYPE OF COLUMN TREPDARZ2.A17,
    A18 TYPE OF COLUMN TREPDARZ2.A18,
    A19 TYPE OF COLUMN TREPDARZ2.A19)
AS
begin
    FOR SELECT
        gen_id(GEN_TREPDARZ2_ID, 1) AS id,
        current_connection AS spid,
        coalesce(T2.rid0, 0) AS rid0,
        coalesce(T1.A1, 0.00) AS A1,
        coalesce(T1.A2, 0.00) AS A2,
        coalesce(T1.A3, 0.00) AS A3,
        coalesce(T1.A4, 0.00) AS A4,
        coalesce(T1.A5, 0.00) AS A5,
        coalesce(T1.A6, 0.00) AS A6,
        coalesce(T2.A7, 0.00) AS A7,
        coalesce(T2.A8, 0.00) AS A8,
        coalesce(T2.A9, 0.00) AS A9,
        coalesce(T2.A10, 0.00) AS A10,
        coalesce(T2.A11, 0.00) AS A11,
        coalesce(T2.A12, 0.00) AS A12,
        coalesce(T2.A13, 0.00) AS A13,
        0.00 AS A14,
        0.00 AS A15,
        0.00 AS A16,
        coalesce(T3.A17, 0.00) AS A17,
        coalesce(T3.A18, 0.00) AS A18,
        coalesce(T3.A19, 0.00) AS A19

    FROM
        (SELECT
            SUM(CASE WHEN AC13 = 'KA' THEN OPS.Summ ELSE 0.00 END) AS A1,
            SUM(CASE WHEN AC23 = 'KA' THEN OPS.Summ ELSE 0.00 END) AS A2,
        
            SUM(CASE WHEN AC13 = 'BA' THEN OPS.Summ ELSE 0.00 END) AS A3,
            SUM(CASE WHEN AC23 = 'BA' THEN OPS.Summ ELSE 0.00 END) AS A4,
        
            SUM(CASE WHEN AC13 = 'CN' THEN OPS.Summ ELSE 0.00 END) AS A5,
            SUM(CASE WHEN AC23 = 'CN' THEN OPS.Summ ELSE 0.00 END) AS A6

        FROM
            OPSd JOIN OPS ON OPSd.id = OPS.DocId

        WHERE
            OPSd.Dete <= :edt AND
            OPS.AC13 IS NOT NULL AND
            OPS.AC23 IS NOT NULL

        ) AS T1,

        (SELECT
            COUNT(DISTINCT DocId) rid0,

            SUM(CASE WHEN AC23 = 'LIE' OR AC23 = 'SUB' THEN OPS.Summ ELSE 0.00 END) AS A7,
            SUM(CASE WHEN AC23 = 'NIE' THEN OPS.Summ ELSE 0.00 END) AS A8,
            SUM(CASE WHEN AC23 = 'ZIE' OR AC23 = 'CIE' THEN OPS.Summ ELSE 0.00 END) AS A9,

            SUM(CASE WHEN AC13 = 'DIZ' THEN OPS.Summ ELSE 0.00 END) AS A10,
            SUM(CASE WHEN AC13 = 'MIZ' THEN OPS.Summ ELSE 0.00 END) AS A11,
            SUM(CASE WHEN AC13 = 'LIZ' OR AC13 = 'NIZ' OR AC13 = 'PIZ' THEN OPS.Summ ELSE 0.00 END) AS A12,
            SUM(CASE WHEN AC13 = 'ZIZ' OR AC13 = 'CIZ' THEN OPS.Summ ELSE 0.00 END) AS A13

        FROM
            OPSd JOIN OPS ON OPSd.id = OPS.DocId

        WHERE
            OPSd.Dete BETWEEN :sdt AND :edt AND
            OPS.AC13 IS NOT NULL AND
            OPS.AC23 IS NOT NULL

        ) AS T2,

        (SELECT 
            SUM(CASE WHEN AcP21.id1 = 'KA'
                THEN Bal0.SummD - Bal0.SummC ELSE 0.00 END) AS A17,
            SUM(CASE WHEN AcP21.id1 = 'BA'
                THEN Bal0.SummD - Bal0.SummC ELSE 0.00 END) AS A18,
            SUM(CASE WHEN AcP21.id1 = 'CN'
                THEN Bal0.SummD - Bal0.SummC ELSE 0.00 END) AS A19

        FROM Bal0
            INNER JOIN AcP21 ON Bal0.AC11 = AcP21.AC
        WHERE AcP21.id1 IN ('KA','BA','CN')
        ) AS T3


    into
        :id, :spid, :rid0,
        :a1, :a2, :a3, :a4, :a5, :a6, :a7, :a8, :a9, :a10,
        :a11, :a12, :a13, :a14, :a15, :a16, :a17, :a18, :a19
    do
    begin
        suspend;
    end
end^


ALTER PROCEDURE SP_REP_DOKS_11 (
    PDATE1 DATE,
    PDATE2 DATE,
    PTEXT VARCHAR(50),
    PCLID VARCHAR(15),
    PAC11 VARCHAR(8),
    PAC12 VARCHAR(8),
    PAC13 VARCHAR(5),
    PAC14 VARCHAR(8),
    PAC15 VARCHAR(5),
    PAC21 VARCHAR(8),
    PAC22 VARCHAR(8),
    PAC23 VARCHAR(5),
    PAC24 VARCHAR(8),
    PAC25 VARCHAR(5),
    PDOCGR VARCHAR(10),
    PANDOR VARCHAR(3))
RETURNS (
    ID TYPE OF COLUMN ROPS1A.ID,
    SPID TYPE OF COLUMN ROPS1A.SPID,
    DID TYPE OF COLUMN ROPS1A.DID,
    DETE TYPE OF COLUMN ROPS1A.DETE,
    NRX TYPE OF COLUMN ROPS1A.NRX,
    DOCTYP TYPE OF COLUMN ROPS1A.DOCTYP,
    DOCTYP1 TYPE OF COLUMN ROPS1A.DOCTYP1,
    DOCTYP2 TYPE OF COLUMN ROPS1A.DOCTYP2,
    DOCST TYPE OF COLUMN ROPS1A.DOCST,
    DOCNR TYPE OF COLUMN ROPS1A.DOCNR,
    CLID TYPE OF COLUMN ROPS1A.CLID,
    CLID2 TYPE OF COLUMN ROPS1A.CLID2,
    NAME TYPE OF COLUMN ROPS1A.NAME,
    NAME2 TYPE OF COLUMN ROPS1A.NAME2,
    REGNR TYPE OF COLUMN ROPS1A.REGNR,
    REGNR2 TYPE OF COLUMN ROPS1A.REGNR2,
    B0 TYPE OF COLUMN ROPS1A.B0,
    DESCR TYPE OF COLUMN ROPS1A.DESCR,
    DESCR2 TYPE OF COLUMN ROPS1A.DESCR2,
    AC1 TYPE OF COLUMN ROPS1A.AC1,
    AC2 TYPE OF COLUMN ROPS1A.AC2,
    SAC1 TYPE OF COLUMN ROPS1A.SAC1,
    SAC2 TYPE OF COLUMN ROPS1A.SAC2,
    SUMMC TYPE OF COLUMN ROPS1A.SUMMC,
    CUR TYPE OF COLUMN ROPS1A.CUR,
    SUMM TYPE OF COLUMN ROPS1A.SUMM,
    PVN TYPE OF COLUMN ROPS1A.PVN,
    RAC TYPE OF COLUMN ROPS1A.RAC,
    SDB TYPE OF COLUMN ROPS1A.SDB,
    SCR TYPE OF COLUMN ROPS1A.SCR,
    RAC2 TYPE OF COLUMN ROPS1A.RAC2,
    RAC3 TYPE OF COLUMN ROPS1A.RAC3,
    RAC4 TYPE OF COLUMN ROPS1A.RAC4,
    RAC5 TYPE OF COLUMN ROPS1A.RAC5,
    QV TYPE OF COLUMN ROPS1A.QV,
    ZNR TYPE OF COLUMN ROPS1A.ZNR)
AS
begin
    IF
    (
        :PAC11 IS NULL AND 
        :PAC12 IS NULL AND 
        :PAC13 IS NULL AND 
        :PAC14 IS NULL AND
        :PAC15 IS NULL AND
        :PAC21 IS NULL AND 
        :PAC22 IS NULL AND 
        :PAC23 IS NULL AND 
        :PAC24 IS NULL AND
        :PAC25 IS NULL
    ) THEN
    BEGIN
        FOR SELECT
            gen_id(GEN_ROPS1A_ID, 1) as id,
            current_connection as spid,
            OPSd.id AS did, 
            OPSd.Dete AS Dete,
            OPSd.NrX AS NrX,
            OPSd.DocTyp AS DocTyp,
            DocTyp.id1 AS DocTyp1, 
            null as DocTyp2,
            OPSd.DocSt AS DocSt,
            OPSd.DocNr AS DocNr,
            OPSd.ClId AS Clid,
            OPSd.ClId2 AS Clid2,
            Persons.Name AS Name, 
            Persons2.Name AS Name2, 
            Persons.RegNr AS RegNr,
            Persons2.RegNr AS RegNr2,
            0 AS b0, 
            OPSd.Descr AS Descr,
            null AS Descr2,
            null AS AC1,
            null AS AC2,
            null AS SAC1,
            null AS SAC2,
            0 AS SummC,
            null AS Cur,
            OPSd.Summ AS Summ,
            OPSd.PVN AS PVN,
            null AS Rac,
            0 AS Sdb,
            0 AS SCr,
            null AS Rac2,
            null AS Rac3,
            null AS Rac4,
            null AS Rac5,
            0 AS qv,
            OPSd.ZNR AS ZNR

        FROM OPSd
            LEFT JOIN DocTyp ON OPSd.DocTyp = DocTyp.id
            LEFT JOIN Persons ON OPSd.ClId = Persons.ClId
            LEFT JOIN Persons AS Persons2 ON OPSd.ClId2 = Persons2.ClId        
        WHERE 
        (
            (:PDATE1 IS NULL OR Dete >= :PDATE1) AND
            (:PDATE2 IS NULL OR Dete <= :PDATE2) AND
            (:PCLID IS NULL OR OPSd.ClId = :PCLID OR ClId2 = :pclid) AND
            (:PTEXT IS NULL OR OPSd.Descr LIKE :PTEXT) AND
            (
                :PDOCGR IS NULL OR EXISTS(
                    SELECT DTA.ID
                    FROM doctypb AS DTB inner join doctypa AS DTA on DTB.ida = DTA.id
                    WHERE DTB.ID = OPSD.doctyp AND DTA.ID = :PDOCGR
                )
            )
        )
        ORDER BY Dete, did
        into
            :id, :spid, :did, :DETE, :nrx,
            :doctyp, :doctyp1, :doctyp2, :docst, :docnr,
            :clid, :clid2, :name, :name2, :regnr, :regnr2,
            :b0, :descr, :descr2, :ac1, :ac2, :sac1,:sac2,
            :summc, :cur, :summ, :pvn, :rac, :sdb, :scr,
            :rac2, :rac3, :rac4, :rac5, :qv, :znr
        do
        begin
            suspend;
        end

    END
    ELSE
    BEGIN
        IF (pandor = 'AND') THEN
        BEGIN
            FOR SELECT
                gen_id(GEN_ROPS1A_ID, 1) as id,
                current_connection as spid,
                OPSd.id AS did, 
                OPSd.Dete AS Dete,
                OPSd.NrX AS NrX,
                OPSd.DocTyp AS DocTyp,
                DocTyp.id1 AS DocTyp1, 
                null as DocTyp2,
                OPSd.DocSt AS DocSt,
                OPSd.DocNr AS DocNr,
                OPSd.ClId AS Clid,
                OPSd.ClId2 AS Clid2,
                Persons.Name AS Name, 
                Persons2.Name AS Name2, 
                Persons.RegNr AS RegNr,
                Persons2.RegNr AS RegNr2,
                0 AS b0, 
                OPSd.Descr AS Descr,
                null AS Descr2,
                null AS AC1,
                null AS AC2,
                null AS SAC1,
                null AS SAC2,
                0 AS SummC,
                null AS Cur,
                OPSd.Summ AS Summ,
                OPSd.PVN AS PVN,
                null AS Rac,
                0 AS Sdb,
                0 AS SCr,
                null AS Rac2,
                null AS Rac3,
                null AS Rac4,
                null AS Rac5,
                0 AS qv,
                OPSd.ZNR AS ZNR
            FROM OPSd
                LEFT JOIN DocTyp ON OPSd.DocTyp = DocTyp.id
                LEFT JOIN Persons ON OPSd.ClId = Persons.ClId
                LEFT JOIN Persons AS Persons2 ON OPSd.ClId2 = Persons2.ClId        
            WHERE 
            (
                (:PDATE1 IS NULL OR Dete >= :PDATE1) AND
                (:PDATE2 IS NULL OR Dete <= :PDATE2) AND
                (:PCLID IS NULL OR OPSd.ClId = :PCLID OR ClId2 = :pclid) AND
                (:PTEXT IS NULL OR OPSd.Descr LIKE :PTEXT)  AND
                (
                    :PDOCGR IS NULL OR EXISTS(
                        SELECT DTA.ID
                        FROM doctypb AS DTB inner join doctypa AS DTA on DTB.ida = DTA.id
                        WHERE DTB.ID = OPSD.doctyp AND DTA.ID = :PDOCGR
                    )
                )
                AND

                EXISTS     
                (
                    SELECT NULL
                    FROM OPS
                    WHERE
                    (
                        (OPS.DocId = OPSd.id) AND
                        (:PAC11 IS NULL OR AC11 LIKE :PAC11) AND
                        (:PAC12 IS NULL OR AC12 LIKE :PAC12) AND
                        (:PAC13 IS NULL OR AC13 LIKE :PAC13) AND
                        (:PAC14 IS NULL OR AC14 LIKE :PAC14) AND
                        (:PAC15 IS NULL OR AC15 LIKE :PAC15) AND

                        (:PAC21 IS NULL OR AC21 LIKE :PAC21) AND
                        (:PAC22 IS NULL OR AC22 LIKE :PAC22) AND
                        (:PAC23 IS NULL OR AC23 LIKE :PAC23) AND
                        (:PAC24 IS NULL OR AC24 LIKE :PAC24) AND
                        (:PAC25 IS NULL OR AC25 LIKE :PAC25)
                    )
                )
            )
            ORDER BY Dete, did
            into
                :id, :spid, :did, :DETE, :nrx,
                :doctyp, :doctyp1, :doctyp2, :docst, :docnr,
                :clid, :clid2, :name, :name2, :regnr, :regnr2,
                :b0, :descr, :descr2, :ac1, :ac2, :sac1,:sac2,
                :summc, :cur, :summ, :pvn, :rac, :sdb, :scr,
                :rac2, :rac3, :rac4, :rac5, :qv, :znr
            do
            begin
                suspend;
            end

        END 
        ELSE
        BEGIN
            FOR SELECT
                gen_id(GEN_ROPS1A_ID, 1) as id,
                current_connection as spid,
                OPSd.id AS did, 
                OPSd.Dete AS Dete,
                OPSd.NrX AS NrX,
                OPSd.DocTyp AS DocTyp,
                DocTyp.id1 AS DocTyp1, 
                null as DocTyp2,
                OPSd.DocSt AS DocSt,
                OPSd.DocNr AS DocNr,
                OPSd.ClId AS Clid,
                OPSd.ClId2 AS Clid2,
                Persons.Name AS Name, 
                Persons2.Name AS Name2, 
                Persons.RegNr AS RegNr,
                Persons2.RegNr AS RegNr2,
                0 AS b0, 
                OPSd.Descr AS Descr,
                null AS Descr2,
                null AS AC1,
                null AS AC2,
                null AS SAC1,
                null AS SAC2,
                0 AS SummC,
                null AS Cur,
                OPSd.Summ AS Summ,
                OPSd.PVN AS PVN,
                null AS Rac,
                0 AS Sdb,
                0 AS SCr,
                null AS Rac2,
                null AS Rac3,
                null AS Rac4,
                null AS Rac5,
                0 AS qv,
                OPSd.ZNR AS ZNR
            FROM OPSd
                LEFT JOIN DocTyp ON OPSd.DocTyp = DocTyp.id
                LEFT JOIN Persons ON OPSd.ClId = Persons.ClId
                LEFT JOIN Persons AS Persons2 ON OPSd.ClId2 = Persons2.ClId        

            WHERE 
            (
                (:PDATE1 IS NULL OR Dete >= :PDATE1) AND
                (:PDATE2 IS NULL OR Dete <= :PDATE2) AND
                (:PCLID IS NULL OR OPSd.ClId = :PCLID OR ClId2 = :pclid) AND
                (:PTEXT IS NULL OR OPSd.Descr LIKE :PTEXT) AND
                (
                    :PDOCGR IS NULL OR EXISTS(
                        SELECT DTA.ID
                        FROM doctypb AS DTB inner join doctypa AS DTA on DTB.ida = DTA.id
                        WHERE DTB.ID = OPSD.doctyp AND DTA.ID = :PDOCGR
                    )
                )
                AND

                EXISTS     
                (
                    SELECT NULL
                    FROM OPS
                    WHERE
                    (
                        (OPS.DocId = OPSd.id) AND
                        (
                            (
                                (:PAC11 IS NULL OR AC11 LIKE :PAC11) AND
                                (:PAC12 IS NULL OR AC12 LIKE :PAC12) AND
                                (:PAC13 IS NULL OR AC13 LIKE :PAC13) AND
                                (:PAC14 IS NULL OR AC14 LIKE :PAC14) AND
                                (:PAC15 IS NULL OR AC15 LIKE :PAC15)
                            )
                            OR
                            (
                                (:PAC21 IS NULL OR AC21 LIKE :PAC21) AND
                                (:PAC22 IS NULL OR AC22 LIKE :PAC22) AND
                                (:PAC23 IS NULL OR AC23 LIKE :PAC23) AND
                                (:PAC24 IS NULL OR AC24 LIKE :PAC24) AND
                                (:PAC25 IS NULL OR AC25 LIKE :PAC25)
                            )
                        )
                    )
                )
            )
            ORDER BY Dete, did
            into
                :id, :spid, :did, :DETE, :nrx,
                :doctyp, :doctyp1, :doctyp2, :docst, :docnr,
                :clid, :clid2, :name, :name2, :regnr, :regnr2,
                :b0, :descr, :descr2, :ac1, :ac2, :sac1,:sac2,
                :summc, :cur, :summ, :pvn, :rac, :sdb, :scr,
                :rac2, :rac3, :rac4, :rac5, :qv, :znr
            do
            begin
                suspend;
            end

        END
    END
end^


ALTER PROCEDURE SP_REP_KG_11 (
    SDT DATE,
    EDT DATE,
    PAC VARCHAR(8))
RETURNS (
    ID TYPE OF COLUMN ROPS1A.ID,
    SPID TYPE OF COLUMN ROPS1A.SPID,
    DID TYPE OF COLUMN ROPS1A.DID,
    DETE TYPE OF COLUMN ROPS1A.DETE,
    NRX TYPE OF COLUMN ROPS1A.NRX,
    DOCTYP TYPE OF COLUMN ROPS1A.DOCTYP,
    DOCTYP1 TYPE OF COLUMN ROPS1A.DOCTYP1,
    DOCTYP2 TYPE OF COLUMN ROPS1A.DOCTYP2,
    DOCST TYPE OF COLUMN ROPS1A.DOCST,
    DOCNR TYPE OF COLUMN ROPS1A.DOCNR,
    CLID TYPE OF COLUMN ROPS1A.CLID,
    CLID2 TYPE OF COLUMN ROPS1A.CLID2,
    NAME TYPE OF COLUMN ROPS1A.NAME,
    NAME2 TYPE OF COLUMN ROPS1A.NAME2,
    REGNR TYPE OF COLUMN ROPS1A.REGNR,
    REGNR2 TYPE OF COLUMN ROPS1A.REGNR2,
    B0 TYPE OF COLUMN ROPS1A.B0,
    DESCR TYPE OF COLUMN ROPS1A.DESCR,
    DESCR2 TYPE OF COLUMN ROPS1A.DESCR2,
    AC1 TYPE OF COLUMN ROPS1A.AC1,
    AC2 TYPE OF COLUMN ROPS1A.AC2,
    SAC1 TYPE OF COLUMN ROPS1A.SAC1,
    SAC2 TYPE OF COLUMN ROPS1A.SAC2,
    SUMMC TYPE OF COLUMN ROPS1A.SUMMC,
    CUR TYPE OF COLUMN ROPS1A.CUR,
    SUMM TYPE OF COLUMN ROPS1A.SUMM,
    PVN TYPE OF COLUMN ROPS1A.PVN,
    RAC TYPE OF COLUMN ROPS1A.RAC,
    SDB TYPE OF COLUMN ROPS1A.SDB,
    SCR TYPE OF COLUMN ROPS1A.SCR,
    RAC2 TYPE OF COLUMN ROPS1A.RAC2,
    RAC3 TYPE OF COLUMN ROPS1A.RAC3,
    RAC4 TYPE OF COLUMN ROPS1A.RAC4,
    RAC5 TYPE OF COLUMN ROPS1A.RAC5,
    QV TYPE OF COLUMN ROPS1A.QV,
    ZNR TYPE OF COLUMN ROPS1A.ZNR)
AS
begin
    FOR SELECT
        gen_id(GEN_ROPS1A_ID, 1) AS id,
        current_connection as spid,
        OPSd.id AS did,
        OPSd.Dete,
        OPSd.NrX,
        OPSd.DocTyp,
        DocTyp.id1 AS DocTyp1,
        DocTyp.tpZ AS DocTyp2,
        OPSd.DocSt,
        OPSd.DocNr,
        OPSd.ClId,
        OPSd.ClId2,
        P1.Name AS Name,
        P2.Name AS Name2,
        P1.RegNr AS RegNr,
        P2.RegNr AS RegNr2,
        0 AS b0,
        OPSd.Descr,
        OPS.Descr AS Descr2,
        null AS AC1,
        CASE WHEN OPS.AC11 = :pac THEN OPS.AC21 ELSE OPS.AC11 END AS Ac2,
        null AS SAC1,
        CASE WHEN OPS.AC11 = :pac THEN AcP21_2.Name ELSE AcP21.Name END AS SAc2,
        OPS.SummC AS SummC,
        OPS.cur AS Cur,
        OPS.Summ AS Summ,
        0 AS PVN,
        null AS Rac,
        CASE WHEN OPS.AC11 = :pac THEN OPS.Summ ELSE 0.00 END AS SDb,
        CASE WHEN OPS.AC21 = :pac THEN OPS.Summ ELSE 0.00 END AS SCr,
        null AS Rac2,
        null AS Rac3,
        null AS Rac4,
        null AS Rac5,
        0 AS qv,
        OPSd.ZNR
    FROM
        OPSd INNER 
        JOIN OPS ON OPSd.id = OPS.DocId
        LEFT JOIN AcP21 ON OPS.AC11 = AcP21.AC
        LEFT JOIN AcP21 AS AcP21_2 ON OPS.AC21 = AcP21_2.AC
        LEFT JOIN Persons AS P1 ON OPSd.ClId = P1.ClId
        LEFT JOIN Persons AS P2 ON OPSd.ClId2 = P2.ClId
        LEFT JOIN DocTyp ON OPSd.DocTyp = DocTyp.id
    WHERE
        OPSd.Dete BETWEEN :sdt AND :edt AND
        (OPS.AC11 = :pac OR OPS.AC21 = :pac)
    ORDER BY
        OPSd.Dete, 
        CASE WHEN OPS.AC11 = :pac THEN 1 ELSE 2 END,
        NrX 


    into
        :id, :spid, :did, :DETE, :nrx,
        :doctyp, :doctyp1, :doctyp2, :docst, :docnr,
        :clid, :clid2, :name, :name2, :regnr, :regnr2,
        :b0, :descr, :descr2, :ac1, :ac2, :sac1,:sac2,
        :summc, :cur, :summ, :pvn, :rac, :sdb, :scr,
        :rac2, :rac3, :rac4, :rac5, :qv, :znr
    do
    begin
        suspend;
    end
end^


ALTER PROCEDURE SP_REP_KIEO_1 (
    PDID INTEGER)
RETURNS (
    ID TYPE OF COLUMN ROPS1A.ID,
    SPID TYPE OF COLUMN ROPS1A.SPID,
    DID TYPE OF COLUMN ROPS1A.DID,
    DETE TYPE OF COLUMN ROPS1A.DETE,
    NRX TYPE OF COLUMN ROPS1A.NRX,
    DOCTYP TYPE OF COLUMN ROPS1A.DOCTYP,
    DOCTYP1 TYPE OF COLUMN ROPS1A.DOCTYP1,
    DOCTYP2 TYPE OF COLUMN ROPS1A.DOCTYP2,
    DOCST TYPE OF COLUMN ROPS1A.DOCST,
    DOCNR TYPE OF COLUMN ROPS1A.DOCNR,
    CLID TYPE OF COLUMN ROPS1A.CLID,
    CLID2 TYPE OF COLUMN ROPS1A.CLID2,
    NAME TYPE OF COLUMN ROPS1A.NAME,
    NAME2 TYPE OF COLUMN ROPS1A.NAME2,
    REGNR TYPE OF COLUMN ROPS1A.REGNR,
    REGNR2 TYPE OF COLUMN ROPS1A.REGNR2,
    B0 TYPE OF COLUMN ROPS1A.B0,
    DESCR TYPE OF COLUMN ROPS1A.DESCR,
    DESCR2 TYPE OF COLUMN ROPS1A.DESCR2,
    AC1 TYPE OF COLUMN ROPS1A.AC1,
    AC2 TYPE OF COLUMN ROPS1A.AC2,
    SAC1 TYPE OF COLUMN ROPS1A.SAC1,
    SAC2 TYPE OF COLUMN ROPS1A.SAC2,
    SUMMC TYPE OF COLUMN ROPS1A.SUMMC,
    CUR TYPE OF COLUMN ROPS1A.CUR,
    SUMM TYPE OF COLUMN ROPS1A.SUMM,
    PVN TYPE OF COLUMN ROPS1A.PVN,
    RAC TYPE OF COLUMN ROPS1A.RAC,
    SDB TYPE OF COLUMN ROPS1A.SDB,
    SCR TYPE OF COLUMN ROPS1A.SCR,
    RAC2 TYPE OF COLUMN ROPS1A.RAC2,
    RAC3 TYPE OF COLUMN ROPS1A.RAC3,
    RAC4 TYPE OF COLUMN ROPS1A.RAC4,
    RAC5 TYPE OF COLUMN ROPS1A.RAC5,
    QV TYPE OF COLUMN ROPS1A.QV,
    ZNR TYPE OF COLUMN ROPS1A.ZNR)
AS
begin
    FOR SELECT
        gen_id(GEN_ROPS1A_ID, 1) AS id,
        current_connection as spid,
        OPSd.id AS did,
        OPSd.Dete,
        OPSd.NrX,
        OPSd.DocTyp,
        DocTyp.id1 AS DocTyp1,
        DocTyp.tpZ AS DocTyp2,
        OPSd.DocSt,
        OPSd.DocNr,
        OPSd.ClId,
        OPSd.ClId2,
        P1.Name AS Name,
        P2.Name AS Name2,
        P1.RegNr AS RegNr,
        P2.RegNr AS RegNr2,
        0 AS b0,
        OPSd.Descr,
        OPS.Descr AS Descr2,
        OPS.AC11 AS Ac1,
        OPS.AC21 AS Ac2,
        AcP21.Name AS SAc1,
        AcP21_2.Name AS SAc2,
        OPS.SummC AS SummC,
        OPS.cur AS Cur,
        OPS.Summ AS Summ,
        0 AS PVN,
        null AS Rac,
        OPS.Summ AS SDb,
        0.00 AS SCr,
        null AS Rac2,
        null AS Rac3,
        null AS Rac4,
        null AS Rac5,
        0 AS qv,
        OPSd.ZNR
    FROM
        OPSd INNER 
        JOIN OPS ON OPSd.id = OPS.DocId
        LEFT JOIN AcP21 ON OPS.AC11 = AcP21.AC
        LEFT JOIN AcP21 AS AcP21_2 ON OPS.AC21 = AcP21_2.AC
        LEFT JOIN Persons AS P1 ON OPSd.ClId = P1.ClId
        LEFT JOIN Persons AS P2 ON OPSd.ClId2 = P2.ClId
        LEFT JOIN DocTyp ON OPSd.DocTyp = DocTyp.id
    WHERE
        OPSd.id = :pdid

    into
        :id, :spid, :did, :DETE, :nrx,
        :doctyp, :doctyp1, :doctyp2, :docst, :docnr,
        :clid, :clid2, :name, :name2, :regnr, :regnr2,
        :b0, :descr, :descr2, :ac1, :ac2, :sac1,:sac2,
        :summc, :cur, :summ, :pvn, :rac, :sdb, :scr,
        :rac2, :rac3, :rac4, :rac5, :qv, :znr
    do
    begin
        suspend;
    end
end^


ALTER PROCEDURE SP_REP_KIEO_21 (
    SDT DATE,
    EDT DATE,
    PAC VARCHAR(8))
RETURNS (
    ID TYPE OF COLUMN ROPS1A.ID,
    SPID TYPE OF COLUMN ROPS1A.SPID,
    DID TYPE OF COLUMN ROPS1A.DID,
    DETE TYPE OF COLUMN ROPS1A.DETE,
    NRX TYPE OF COLUMN ROPS1A.NRX,
    DOCTYP TYPE OF COLUMN ROPS1A.DOCTYP,
    DOCTYP1 TYPE OF COLUMN ROPS1A.DOCTYP1,
    DOCTYP2 TYPE OF COLUMN ROPS1A.DOCTYP2,
    DOCST TYPE OF COLUMN ROPS1A.DOCST,
    DOCNR TYPE OF COLUMN ROPS1A.DOCNR,
    CLID TYPE OF COLUMN ROPS1A.CLID,
    CLID2 TYPE OF COLUMN ROPS1A.CLID2,
    NAME TYPE OF COLUMN ROPS1A.NAME,
    NAME2 TYPE OF COLUMN ROPS1A.NAME2,
    REGNR TYPE OF COLUMN ROPS1A.REGNR,
    REGNR2 TYPE OF COLUMN ROPS1A.REGNR2,
    B0 TYPE OF COLUMN ROPS1A.B0,
    DESCR TYPE OF COLUMN ROPS1A.DESCR,
    DESCR2 TYPE OF COLUMN ROPS1A.DESCR2,
    AC1 TYPE OF COLUMN ROPS1A.AC1,
    AC2 TYPE OF COLUMN ROPS1A.AC2,
    SAC1 TYPE OF COLUMN ROPS1A.SAC1,
    SAC2 TYPE OF COLUMN ROPS1A.SAC2,
    SUMMC TYPE OF COLUMN ROPS1A.SUMMC,
    CUR TYPE OF COLUMN ROPS1A.CUR,
    SUMM TYPE OF COLUMN ROPS1A.SUMM,
    PVN TYPE OF COLUMN ROPS1A.PVN,
    RAC TYPE OF COLUMN ROPS1A.RAC,
    SDB TYPE OF COLUMN ROPS1A.SDB,
    SCR TYPE OF COLUMN ROPS1A.SCR,
    RAC2 TYPE OF COLUMN ROPS1A.RAC2,
    RAC3 TYPE OF COLUMN ROPS1A.RAC3,
    RAC4 TYPE OF COLUMN ROPS1A.RAC4,
    RAC5 TYPE OF COLUMN ROPS1A.RAC5,
    QV TYPE OF COLUMN ROPS1A.QV,
    ZNR TYPE OF COLUMN ROPS1A.ZNR)
AS
begin
    FOR SELECT
        gen_id(GEN_ROPS1A_ID, 1) AS id,
        current_connection as spid,
        OPSd.id AS did,
        OPSd.Dete,
        OPSd.NrX,
        OPSd.DocTyp,
        DocTyp.id1 AS DocTyp1,
        DocTyp.tpZ AS DocTyp2,
        OPSd.DocSt,
        OPSd.DocNr,
        OPSd.ClId,
        OPSd.ClId2,
        P1.Name AS Name,
        P2.Name AS Name2,
        P1.RegNr AS RegNr,
        P2.RegNr AS RegNr2,
        0 AS b0,
        OPSd.Descr,
        OPS.Descr AS Descr2,
        OPS.AC11 AS Ac1,
        OPS.AC21 AS Ac2,
        AcP21.Name AS SAc1,
        AcP21_2.Name AS SAc2,
        OPS.SummC AS SummC,
        OPS.cur AS Cur,
        OPS.Summ AS Summ,
        0 AS PVN,
        null AS Rac,
        OPS.Summ AS SDb,
        0.00 AS SCr,
        null AS Rac2,
        null AS Rac3,
        null AS Rac4,
        null AS Rac5,
        0 AS qv,
        OPSd.ZNR
    FROM
        OPSd INNER 
        JOIN OPS ON OPSd.id = OPS.DocId
        LEFT JOIN AcP21 ON OPS.AC11 = AcP21.AC
        LEFT JOIN AcP21 AS AcP21_2 ON OPS.AC21 = AcP21_2.AC
        LEFT JOIN Persons AS P1 ON OPSd.ClId = P1.ClId
        LEFT JOIN Persons AS P2 ON OPSd.ClId2 = P2.ClId
        LEFT JOIN DocTyp ON OPSd.DocTyp = DocTyp.id
    WHERE
        OPSd.Dete BETWEEN :sdt AND :edt AND
        OPS.AC11 = :pac
    ORDER BY
        OPSd.NrX

    into
        :id, :spid, :did, :DETE, :nrx,
        :doctyp, :doctyp1, :doctyp2, :docst, :docnr,
        :clid, :clid2, :name, :name2, :regnr, :regnr2,
        :b0, :descr, :descr2, :ac1, :ac2, :sac1,:sac2,
        :summc, :cur, :summ, :pvn, :rac, :sdb, :scr,
        :rac2, :rac3, :rac4, :rac5, :qv, :znr
    do
    begin
        suspend;
    end
end^


ALTER PROCEDURE SP_REP_KIZO_21 (
    SDT DATE,
    EDT DATE,
    PAC VARCHAR(8))
RETURNS (
    ID TYPE OF COLUMN ROPS1A.ID,
    SPID TYPE OF COLUMN ROPS1A.SPID,
    DID TYPE OF COLUMN ROPS1A.DID,
    DETE TYPE OF COLUMN ROPS1A.DETE,
    NRX TYPE OF COLUMN ROPS1A.NRX,
    DOCTYP TYPE OF COLUMN ROPS1A.DOCTYP,
    DOCTYP1 TYPE OF COLUMN ROPS1A.DOCTYP1,
    DOCTYP2 TYPE OF COLUMN ROPS1A.DOCTYP2,
    DOCST TYPE OF COLUMN ROPS1A.DOCST,
    DOCNR TYPE OF COLUMN ROPS1A.DOCNR,
    CLID TYPE OF COLUMN ROPS1A.CLID,
    CLID2 TYPE OF COLUMN ROPS1A.CLID2,
    NAME TYPE OF COLUMN ROPS1A.NAME,
    NAME2 TYPE OF COLUMN ROPS1A.NAME2,
    REGNR TYPE OF COLUMN ROPS1A.REGNR,
    REGNR2 TYPE OF COLUMN ROPS1A.REGNR2,
    B0 TYPE OF COLUMN ROPS1A.B0,
    DESCR TYPE OF COLUMN ROPS1A.DESCR,
    DESCR2 TYPE OF COLUMN ROPS1A.DESCR2,
    AC1 TYPE OF COLUMN ROPS1A.AC1,
    AC2 TYPE OF COLUMN ROPS1A.AC2,
    SAC1 TYPE OF COLUMN ROPS1A.SAC1,
    SAC2 TYPE OF COLUMN ROPS1A.SAC2,
    SUMMC TYPE OF COLUMN ROPS1A.SUMMC,
    CUR TYPE OF COLUMN ROPS1A.CUR,
    SUMM TYPE OF COLUMN ROPS1A.SUMM,
    PVN TYPE OF COLUMN ROPS1A.PVN,
    RAC TYPE OF COLUMN ROPS1A.RAC,
    SDB TYPE OF COLUMN ROPS1A.SDB,
    SCR TYPE OF COLUMN ROPS1A.SCR,
    RAC2 TYPE OF COLUMN ROPS1A.RAC2,
    RAC3 TYPE OF COLUMN ROPS1A.RAC3,
    RAC4 TYPE OF COLUMN ROPS1A.RAC4,
    RAC5 TYPE OF COLUMN ROPS1A.RAC5,
    QV TYPE OF COLUMN ROPS1A.QV,
    ZNR TYPE OF COLUMN ROPS1A.ZNR)
AS
begin
    for SELECT
        gen_id(GEN_ROPS1A_ID, 1) AS id,
        current_connection as spid,
        OPSd.id AS did,
        OPSd.Dete,
        OPSd.NrX,
        OPSd.DocTyp,
        DocTyp.id1 AS DocTyp1,
        DocTyp.tpZ AS DocTyp2,
        OPSd.DocSt,
        OPSd.DocNr,
        OPSd.ClId,
        OPSd.ClId2,
        P1.Name AS Name,
        P2.Name AS Name2,
        P1.RegNr AS RegNr,
        P2.RegNr AS RegNr2,
        0.0 AS b0,
        OPSd.Descr,
        OPS.Descr AS Descr2,
        OPS.AC11 AS Ac1,
        OPS.AC21 AS Ac2,
        AcP21.Name AS SAc1,
        AcP21_2.Name AS SAc2,
        OPS.SummC AS SummC,
        OPS.cur AS Cur,
        OPS.Summ AS Summ,
        0.0 AS PVN,
        null AS Rac,
        0.00 AS SDb,
        OPS.Summ AS SCr,
        null AS Rac2,
        null AS Rac3,
        null AS Rac4,
        null AS Rac5,
        0 AS qv,
        OPSd.ZNR
    FROM
        OPSd INNER 
        JOIN OPS ON OPSd.id = OPS.DocId
        LEFT JOIN AcP21 ON OPS.AC11 = AcP21.AC
        LEFT JOIN AcP21 AS AcP21_2 ON OPS.AC21 = AcP21_2.AC
        LEFT JOIN Persons AS P1 ON OPSd.ClId = P1.ClId
        LEFT JOIN Persons AS P2 ON OPSd.ClId2 = P2.ClId
        LEFT JOIN DocTyp ON OPSd.DocTyp = DocTyp.id
    WHERE
        OPSd.Dete BETWEEN :sdt AND :edt AND
        OPS.AC21 = :pac
    ORDER BY
        OPSd.NrX

    into
        :id, :spid, :did, :DETE, :nrx,
        :doctyp, :doctyp1, :doctyp2, :docst, :docnr,
        :clid, :clid2, :name, :name2, :regnr, :regnr2,
        :b0, :descr, :descr2, :ac1, :ac2, :sac1,:sac2,
        :summc, :cur, :summ, :pvn, :rac, :sdb, :scr,
        :rac2, :rac3, :rac4, :rac5, :qv, :znr
    do
    begin
        suspend;
    end
end^


ALTER PROCEDURE SP_REP_KORESP_01 (
    SDT DATE,
    EDT DATE,
    PAC VARCHAR(8))
RETURNS (
    ID TYPE OF COLUMN ROPS3A.ID,
    SPID TYPE OF COLUMN ROPS3A.SPID,
    RAC TYPE OF COLUMN ROPS3A.RAC,
    NAME TYPE OF COLUMN ROPS3A.NAME,
    SDB TYPE OF COLUMN ROPS3A.SDB,
    SCR TYPE OF COLUMN ROPS3A.SCR,
    AC1 TYPE OF COLUMN ROPS3A.AC1,
    CLID TYPE OF COLUMN ROPS3A.CLID)
AS
begin
    for SELECT
        gen_id(GEN_ROPS3A_ID, 1) as ID,
        current_connection as SPID,
        T2.AC AS RAC,
        AcP21.Name AS Name,
        T2.BDb AS SDb,
        T2.BCr AS SCr,
        null AS AC1,
        null AS CLID
    FROM
    (
        SELECT AC, SUM(TDb) AS BDb, SUM(TCr) AS BCr
        FROM
        (
            SELECT 
                OPS.AC21 AS AC,
                OPS.Summ AS TDb,
                0.00 AS TCr

            FROM OPSd JOIN OPS ON OPSd.id = OPS.DocId
            WHERE (OPSd.Dete BETWEEN :sdt AND :edt) AND OPS.AC11 LIKE :pac

            UNION ALL

            SELECT 
                OPS.AC11 AS AC,
                0.00 AS TDb,
                OPS.Summ AS TCr

            FROM OPSd JOIN OPS ON OPSd.id = OPS.DocId
            WHERE (OPSd.Dete BETWEEN :sdt AND :edt) AND OPS.AC21 LIKE :pac

        ) AS T1

        GROUP BY T1.AC
    ) AS T2    

    LEFT JOIN AcP21 ON AcP21.AC = T2.AC
    
    ORDER BY RAC

    into
        :id, :spid, :rac, :name, :sdb, :scr, :ac1, :clid
    do
    begin
        suspend;
    end
end^


ALTER PROCEDURE SP_REP_KORESP_01_CLID (
    SDT DATE,
    EDT DATE,
    PAC VARCHAR(8),
    PCLID VARCHAR(15))
RETURNS (
    ID TYPE OF COLUMN ROPS3A.ID,
    SPID TYPE OF COLUMN ROPS3A.SPID,
    RAC TYPE OF COLUMN ROPS3A.RAC,
    NAME TYPE OF COLUMN ROPS3A.NAME,
    SDB TYPE OF COLUMN ROPS3A.SDB,
    SCR TYPE OF COLUMN ROPS3A.SCR,
    AC1 TYPE OF COLUMN ROPS3A.AC1,
    CLID TYPE OF COLUMN ROPS3A.CLID)
AS
begin
    FOR SELECT
        gen_id(GEN_ROPS3A_ID, 1) as ID,
        current_connection as SPID,
        T2.AC AS RAC,
        AcP21.Name AS Name,
        T2.BDb AS SDb,
        T2.BCr AS SCr,
        null AS AC1,
        :pclid AS Clid
    FROM
    (
        SELECT AC, SUM(TDb) AS BDb, SUM(TCr) AS BCr
        FROM
        (
            SELECT 
                OPS.AC21 AS AC,
                OPS.Summ AS TDb,
                0.00 AS TCr

            FROM OPSd JOIN OPS ON OPSd.id = OPS.DocId
            WHERE 
                (OPSd.Dete BETWEEN :sdt AND :edt) AND 
                OPS.AC11 LIKE :pac AND
                OPSd.ClId = :pclid


            UNION ALL

            SELECT 
                OPS.AC11 AS AC,
                0.00 AS TDb,
                OPS.Summ AS TCr

            FROM OPSd JOIN OPS ON OPSd.id = OPS.DocId
            WHERE 
                (OPSd.Dete BETWEEN :sdt AND :edt) AND 
                OPS.AC21 LIKE :pac AND
                OPSd.ClId = :pclid

        ) AS T1

        GROUP BY T1.AC
    ) AS T2    

    LEFT JOIN AcP21 ON AcP21.AC = T2.AC
    
    ORDER BY RAC

    into
        :id, :spid, :rac, :name, :sdb, :scr, :ac1, :clid
    do
    begin
        suspend;
    end
end^


ALTER PROCEDURE SP_REP_KORESP_01_CLID2 (
    SDT DATE,
    EDT DATE,
    PAC VARCHAR(8),
    PCLID VARCHAR(15))
RETURNS (
    ID TYPE OF COLUMN ROPS3A.ID,
    SPID TYPE OF COLUMN ROPS3A.SPID,
    RAC TYPE OF COLUMN ROPS3A.RAC,
    NAME TYPE OF COLUMN ROPS3A.NAME,
    SDB TYPE OF COLUMN ROPS3A.SDB,
    SCR TYPE OF COLUMN ROPS3A.SCR,
    AC1 TYPE OF COLUMN ROPS3A.AC1,
    CLID TYPE OF COLUMN ROPS3A.CLID)
AS
begin
    FOR SELECT
        gen_id(GEN_ROPS3A_ID, 1) as ID,
        current_connection as SPID,
        T2.AC AS RAC,
        AcP21.Name AS Name,
        T2.BDb AS SDb,
        T2.BCr AS SCr,
        null AS AC1,
        :pclid AS Clid
    FROM
    (
        SELECT AC, SUM(TDb) AS BDb, SUM(TCr) AS BCr
        FROM
        (
            SELECT 
                OPS.AC21 AS AC,
                OPS.Summ AS TDb,
                0.00 AS TCr

            FROM OPSd JOIN OPS ON OPSd.id = OPS.DocId
            WHERE 
                (OPSd.Dete BETWEEN :sdt AND :edt) AND 
                OPS.AC11 LIKE :pac AND
                OPSd.ClId2 = :pclid


            UNION ALL

            SELECT 
                OPS.AC11 AS AC,
                0.00 AS TDb,
                OPS.Summ AS TCr

            FROM OPSd JOIN OPS ON OPSd.id = OPS.DocId
            WHERE 
                (OPSd.Dete BETWEEN :sdt AND :edt) AND 
                OPS.AC21 LIKE :pac AND
                OPSd.ClId2 = :pclid

        ) AS T1

        GROUP BY T1.AC
    ) AS T2    

    LEFT JOIN AcP21 ON AcP21.AC = T2.AC
    
    ORDER BY RAC

    into
        :id, :spid, :rac, :name, :sdb, :scr, :ac1, :clid
    do
    begin
        suspend;
    end
end^


ALTER PROCEDURE SP_REP_KORESP_01_CUR (
    SDT DATE,
    EDT DATE,
    PAC VARCHAR(8),
    PCLID VARCHAR(15),
    PCUR VARCHAR(3))
RETURNS (
    ID TYPE OF COLUMN ROPS3A.ID,
    SPID TYPE OF COLUMN ROPS3A.SPID,
    RAC TYPE OF COLUMN ROPS3A.RAC,
    NAME TYPE OF COLUMN ROPS3A.NAME,
    SDB TYPE OF COLUMN ROPS3A.SDB,
    SCR TYPE OF COLUMN ROPS3A.SCR,
    AC1 TYPE OF COLUMN ROPS3A.AC1,
    CLID TYPE OF COLUMN ROPS3A.CLID)
AS
begin
    FOR SELECT
        gen_id(GEN_ROPS3A_ID, 1) as ID,
        current_connection as SPID,
        T2.AC AS RAC,
        AcP21.Name AS Name,
        T2.BDb AS SDb,
        T2.BCr AS SCr,
        null AS AC1,
        null AS Clid
    FROM
    (
        SELECT AC, SUM(TDb) AS BDb, SUM(TCr) AS BCr
        FROM
        (
            SELECT 
                OPS.AC21 AS AC,
                OPS.SummC AS TDb,
                0.00 AS TCr

            FROM OPSd JOIN OPS ON OPSd.id = OPS.DocId
            WHERE 
                (OPSd.Dete BETWEEN :sdt AND :edt) AND 
                OPS.AC11 = :pac AND
                (:pclid IS NULL OR OPSd.ClId = :pclid) AND
                OPS.Cur = :pcur

            UNION ALL

            SELECT 
                OPS.AC11 AS AC,
                0.00 AS TDb,
                OPS.SummC AS TCr

            FROM OPSd JOIN OPS ON OPSd.id = OPS.DocId
            WHERE 
                (OPSd.Dete BETWEEN :sdt AND :edt) AND 
                OPS.AC21 LIKE :pac AND
                (:pclid IS NULL OR OPSd.ClId = :pclid) AND
                OPS.Cur = :pcur

        ) AS T1

        GROUP BY T1.AC
    ) AS T2    

    LEFT JOIN AcP21 ON AcP21.AC = T2.AC
    
    ORDER BY RAC
    into
        :id, :spid, :rac, :name, :sdb, :scr, :ac1, :clid
    do
    begin
        suspend;
    end
end^


ALTER PROCEDURE SP_REP_KORESP_02 (
    SDT DATE,
    EDT DATE,
    PAC VARCHAR(8))
RETURNS (
    ID TYPE OF COLUMN ROPS3A.ID,
    SPID TYPE OF COLUMN ROPS3A.SPID,
    RAC TYPE OF COLUMN ROPS3A.RAC,
    NAME TYPE OF COLUMN ROPS3A.NAME,
    SDB TYPE OF COLUMN ROPS3A.SDB,
    SCR TYPE OF COLUMN ROPS3A.SCR,
    AC1 TYPE OF COLUMN ROPS3A.AC1,
    CLID TYPE OF COLUMN ROPS3A.CLID)
AS
begin
-- summ√Ñ‚Äújam korespond√Ñ‚Äújo√ÖÔ£ºos kontus p√Ñ‚Äúc b√Ñ¬Åzes konta un koresp. konta
    FOR SELECT
        gen_id(GEN_ROPS3A_ID, 1) as ID,
        current_connection as SPID,
        T2.RAC AS RAC,
        AcP21.Name AS Name,
        T2.BDb AS SDb,
        T2.BCr AS SCr,
        T2.AC AS AC1,
        null AS Clid
    FROM
    (
        SELECT AC, RAC, SUM(TDb) AS BDb, SUM(TCr) AS BCr
        FROM
        (
            SELECT 
                OPS.AC11 AS AC,
                OPS.AC21 AS RAC,
                OPS.Summ AS TDb,
                0.00 AS TCr

            FROM OPSd JOIN OPS ON OPSd.id = OPS.DocId
            WHERE (OPSd.Dete BETWEEN :sdt AND :edt) AND OPS.AC11 LIKE :pac

            UNION ALL

            SELECT 
                OPS.AC21 AS AC,
                OPS.AC11 AS RAC,
                0.00 AS TDb,
                OPS.Summ AS TCr

            FROM OPSd JOIN OPS ON OPSd.id = OPS.DocId
            WHERE (OPSd.Dete BETWEEN :sdt AND :edt) AND OPS.AC21 LIKE :pac

        ) AS T1

        GROUP BY T1.AC, T1.RAC
    ) AS T2    

    LEFT JOIN AcP21 ON AcP21.AC = T2.RAC
    
    ORDER BY AC1, RAC

    into
        :id, :spid, :rac, :name, :sdb, :scr, :ac1, :clid
    do
    begin
        suspend;
    end
end^


ALTER PROCEDURE SP_REP_KORESP_02_CLID (
    SDT DATE,
    EDT DATE,
    PAC VARCHAR(8),
    PCLID VARCHAR(15))
RETURNS (
    ID TYPE OF COLUMN ROPS3A.ID,
    SPID TYPE OF COLUMN ROPS3A.SPID,
    RAC TYPE OF COLUMN ROPS3A.RAC,
    NAME TYPE OF COLUMN ROPS3A.NAME,
    SDB TYPE OF COLUMN ROPS3A.SDB,
    SCR TYPE OF COLUMN ROPS3A.SCR,
    AC1 TYPE OF COLUMN ROPS3A.AC1,
    CLID TYPE OF COLUMN ROPS3A.CLID)
AS
begin
-- summ√Ñ‚Äújam pec b√Ñ¬Åzes konta (AC), personas un korespond√Ñ‚Äújo√ÖÔ£º√Ñ¬Å konta (RAC)
    FOR SELECT
        gen_id(GEN_ROPS3A_ID, 1) as ID,
        current_connection as SPID,
        T2.RAC AS RAC,
        AcP21.Name AS Name,
        T2.BDb AS SDb,
        T2.BCr AS SCr,
        T2.AC AS AC1,
        T2.Clid AS Clid
    FROM
    (
        SELECT AC, RAC, Clid, SUM(TDb) AS BDb, SUM(TCr) AS BCr
        FROM
        (
            SELECT 
                OPS.AC11 AS AC,
                OPS.AC21 AS RAC,
                OPSd.ClId AS Clid,
                OPS.Summ AS TDb,
                0.00 AS TCr

            FROM OPSd JOIN OPS ON OPSd.id = OPS.DocId
            WHERE 
                (OPSd.Dete BETWEEN :sdt AND :edt) AND 
                OPS.AC11 LIKE :pac AND
                (:pclid IS NULL OR OPSd.ClId = :pclid)


            UNION ALL

            SELECT 
                OPS.AC21 AS AC,
                OPS.AC11 AS RAC,
                OPSd.ClId AS Clid,
                0.00 AS TDb,
                OPS.Summ AS TCr

            FROM OPSd JOIN OPS ON OPSd.id = OPS.DocId
            WHERE 
                (OPSd.Dete BETWEEN :sdt AND :edt) AND 
                OPS.AC21 LIKE :pac AND
                (:pclid IS NULL OR OPSd.ClId = :pclid)

        ) AS T1

        GROUP BY T1.AC, T1.RAC, Clid
    ) AS T2    

    LEFT JOIN AcP21 ON AcP21.AC = T2.RAC
    
    ORDER BY AC1, Clid, RAC

    into
        :id, :spid, :rac, :name, :sdb, :scr, :ac1, :clid
    do
    begin
        suspend;
    end
end^


ALTER PROCEDURE SP_REP_KORESP_11 (
    PSD DATE,
    PED DATE,
    PAC VARCHAR(8))
RETURNS (
    ID TYPE OF COLUMN ROPS1A.ID,
    SPID TYPE OF COLUMN ROPS1A.SPID,
    DID TYPE OF COLUMN ROPS1A.DID,
    DETE TYPE OF COLUMN ROPS1A.DETE,
    NRX TYPE OF COLUMN ROPS1A.NRX,
    DOCTYP TYPE OF COLUMN ROPS1A.DOCTYP,
    DOCTYP1 TYPE OF COLUMN ROPS1A.DOCTYP1,
    DOCTYP2 TYPE OF COLUMN ROPS1A.DOCTYP2,
    DOCST TYPE OF COLUMN ROPS1A.DOCST,
    DOCNR TYPE OF COLUMN ROPS1A.DOCNR,
    CLID TYPE OF COLUMN ROPS1A.CLID,
    CLID2 TYPE OF COLUMN ROPS1A.CLID2,
    NAME TYPE OF COLUMN ROPS1A.NAME,
    NAME2 TYPE OF COLUMN ROPS1A.NAME2,
    REGNR TYPE OF COLUMN ROPS1A.REGNR,
    REGNR2 TYPE OF COLUMN ROPS1A.REGNR2,
    B0 TYPE OF COLUMN ROPS1A.B0,
    DESCR TYPE OF COLUMN ROPS1A.DESCR,
    DESCR2 TYPE OF COLUMN ROPS1A.DESCR2,
    AC1 TYPE OF COLUMN ROPS1A.AC1,
    AC2 TYPE OF COLUMN ROPS1A.AC2,
    SAC1 TYPE OF COLUMN ROPS1A.SAC1,
    SAC2 TYPE OF COLUMN ROPS1A.SAC2,
    SUMMC TYPE OF COLUMN ROPS1A.SUMMC,
    CUR TYPE OF COLUMN ROPS1A.CUR,
    SUMM TYPE OF COLUMN ROPS1A.SUMM,
    PVN TYPE OF COLUMN ROPS1A.PVN,
    RAC TYPE OF COLUMN ROPS1A.RAC,
    SDB TYPE OF COLUMN ROPS1A.SDB,
    SCR TYPE OF COLUMN ROPS1A.SCR,
    RAC2 TYPE OF COLUMN ROPS1A.RAC2,
    RAC3 TYPE OF COLUMN ROPS1A.RAC3,
    RAC4 TYPE OF COLUMN ROPS1A.RAC4,
    RAC5 TYPE OF COLUMN ROPS1A.RAC5,
    QV TYPE OF COLUMN ROPS1A.QV,
    ZNR TYPE OF COLUMN ROPS1A.ZNR)
AS
begin
    FOR SELECT
        id, spid, did, DETE, nrx,
        doctyp, doctyp1, doctyp2, docst, docnr,
        clid, clid2, name, name2, regnr, regnr2,
        b0, descr, descr2, ac1, ac2, sac1, sac2,
        summc, cur, summ, pvn, rac, sdb, scr,
        rac2, rac3, rac4, rac5, qv, znr

    FROM
    (
        SELECT 
            gen_id(GEN_ROPS1A_ID, 1) AS id,
            current_connection as spid,
            OPSd.id AS did,
            OPSd.Dete,
            OPSd.NrX,
            OPSd.DocTyp,
            DocTyp.id1 AS DocTyp1,
            DocTyp.tpZ AS DocTyp2,
            OPSd.DocSt,
            OPSd.DocNr,
            OPSd.ClId,
            OPSd.ClId2,
            P1.Name AS Name,
            P2.Name AS Name2,
            P1.RegNr AS RegNr,
            P2.RegNr AS RegNr2,
            0 AS b0,
            OPSd.Descr,
            OPS.Descr AS Descr2,
            OPS.AC11 AS Ac1,
            null AS Ac2,
            null AS SAc1,
            null AS SAc2,
            OPS.SummC AS SummC,
            OPS.cur AS Cur,
            OPS.Summ AS Summ,
            0 AS PVN,
            OPS.AC21 AS RAC,
            OPS.Summ AS SDb,
            0.00 AS SCr,
            OPS.AC22 AS RAC2,
            OPS.AC23 AS RAC3,
            OPS.AC24 AS RAC4,
            OPS.AC25 AS RAC5,
            OPS.QV,
            OPSd.ZNR
        FROM
            OPSd INNER 
            JOIN OPS ON OPSd.id = OPS.DocId
            LEFT JOIN Persons AS P1 ON OPSd.ClId = P1.ClId
            LEFT JOIN Persons AS P2 ON OPSd.ClId2 = P2.ClId
            LEFT JOIN DocTyp ON OPSd.DocTyp = DocTyp.id
        WHERE
            (OPSd.Dete BETWEEN :psd AND :ped) AND
            OPS.AC11 LIKE :pac

        UNION ALL

        SELECT 
            gen_id(GEN_ROPS1A_ID, 1) AS id,
            current_connection as spid,
            OPSd.id AS did,
            OPSd.Dete,
            OPSd.NrX,
            OPSd.DocTyp,
            DocTyp.id1 AS DocTyp1,
            DocTyp.tpZ AS DocTyp2,
            OPSd.DocSt,
            OPSd.DocNr,
            OPSd.ClId,
            OPSd.ClId2,
            P1.Name AS Name,
            P2.Name AS Name2,
            P1.RegNr AS RegNr,
            P2.RegNr AS RegNr2,
            0 AS b0,
            OPSd.Descr,
            OPS.Descr AS Descr2,
            OPS.AC21 AS Ac1,
            null AS Ac2,
            null AS SAc1,
            null AS SAc2,
            OPS.SummC AS SummC,
            OPS.cur AS Cur,
            OPS.Summ AS Summ,
            0 AS PVN,
            OPS.AC11 AS RAC,
            0.00 AS SDb,
            OPS.Summ AS SCr,
            OPS.AC12 AS RAC2,
            OPS.AC13 AS RAC3,
            OPS.AC14 AS RAC4,
            OPS.AC15 AS RAC5,
            OPS.QV,
            OPSd.ZNR
        FROM
            OPSd INNER 
            JOIN OPS ON OPSd.id = OPS.DocId
            LEFT JOIN Persons AS P1 ON OPSd.ClId = P1.ClId
            LEFT JOIN Persons AS P2 ON OPSd.ClId2 = P2.ClId
            LEFT JOIN DocTyp ON OPSd.DocTyp = DocTyp.id
        WHERE
            (OPSd.Dete BETWEEN :psd AND :ped) AND
            OPS.AC21 LIKE :pac
    ) AS TT
    ORDER BY TT.Dete, TT.ZNR


    into
        :id, :spid, :did, :DETE, :nrx,
        :doctyp, :doctyp1, :doctyp2, :docst, :docnr,
        :clid, :clid2, :name, :name2, :regnr, :regnr2,
        :b0, :descr, :descr2, :ac1, :ac2, :sac1,:sac2,
        :summc, :cur, :summ, :pvn, :rac, :sdb, :scr,
        :rac2, :rac3, :rac4, :rac5, :qv, :znr
    do
    begin
        suspend;
    end
end^


ALTER PROCEDURE SP_REP_KORESP_11_CLID (
    PSD DATE,
    PED DATE,
    PAC VARCHAR(8),
    PCLID VARCHAR(15))
RETURNS (
    ID TYPE OF COLUMN ROPS1A.ID,
    SPID TYPE OF COLUMN ROPS1A.SPID,
    DID TYPE OF COLUMN ROPS1A.DID,
    DETE TYPE OF COLUMN ROPS1A.DETE,
    NRX TYPE OF COLUMN ROPS1A.NRX,
    DOCTYP TYPE OF COLUMN ROPS1A.DOCTYP,
    DOCTYP1 TYPE OF COLUMN ROPS1A.DOCTYP1,
    DOCTYP2 TYPE OF COLUMN ROPS1A.DOCTYP2,
    DOCST TYPE OF COLUMN ROPS1A.DOCST,
    DOCNR TYPE OF COLUMN ROPS1A.DOCNR,
    CLID TYPE OF COLUMN ROPS1A.CLID,
    CLID2 TYPE OF COLUMN ROPS1A.CLID2,
    NAME TYPE OF COLUMN ROPS1A.NAME,
    NAME2 TYPE OF COLUMN ROPS1A.NAME2,
    REGNR TYPE OF COLUMN ROPS1A.REGNR,
    REGNR2 TYPE OF COLUMN ROPS1A.REGNR2,
    B0 TYPE OF COLUMN ROPS1A.B0,
    DESCR TYPE OF COLUMN ROPS1A.DESCR,
    DESCR2 TYPE OF COLUMN ROPS1A.DESCR2,
    AC1 TYPE OF COLUMN ROPS1A.AC1,
    AC2 TYPE OF COLUMN ROPS1A.AC2,
    SAC1 TYPE OF COLUMN ROPS1A.SAC1,
    SAC2 TYPE OF COLUMN ROPS1A.SAC2,
    SUMMC TYPE OF COLUMN ROPS1A.SUMMC,
    CUR TYPE OF COLUMN ROPS1A.CUR,
    SUMM TYPE OF COLUMN ROPS1A.SUMM,
    PVN TYPE OF COLUMN ROPS1A.PVN,
    RAC TYPE OF COLUMN ROPS1A.RAC,
    SDB TYPE OF COLUMN ROPS1A.SDB,
    SCR TYPE OF COLUMN ROPS1A.SCR,
    RAC2 TYPE OF COLUMN ROPS1A.RAC2,
    RAC3 TYPE OF COLUMN ROPS1A.RAC3,
    RAC4 TYPE OF COLUMN ROPS1A.RAC4,
    RAC5 TYPE OF COLUMN ROPS1A.RAC5,
    QV TYPE OF COLUMN ROPS1A.QV,
    ZNR TYPE OF COLUMN ROPS1A.ZNR)
AS
begin
    FOR SELECT
        id, spid, did, DETE, nrx,
        doctyp, doctyp1, doctyp2, docst, docnr,
        clid, clid2, name, name2, regnr, regnr2,
        b0, descr, descr2, ac1, ac2, sac1, sac2,
        summc, cur, summ, pvn, rac, sdb, scr,
        rac2, rac3, rac4, rac5, qv, znr

    FROM
    (
        SELECT 
            gen_id(GEN_ROPS1A_ID, 1) AS id,
            current_connection as spid,
            OPSd.id AS did,
            OPSd.Dete,
            OPSd.NrX,
            OPSd.DocTyp,
            DocTyp.id1 AS DocTyp1,
            DocTyp.tpZ AS DocTyp2,
            OPSd.DocSt,
            OPSd.DocNr,
            OPSd.ClId,
            OPSd.ClId2,
            P1.Name AS Name,
            P2.Name AS Name2,
            P1.RegNr AS RegNr,
            P2.RegNr AS RegNr2,
            0 AS b0,
            OPSd.Descr,
            OPS.Descr AS Descr2,
            OPS.AC11 AS Ac1,
            null AS Ac2,
            null AS SAc1,
            null AS SAc2,
            OPS.SummC AS SummC,
            OPS.cur AS Cur,
            OPS.Summ AS Summ,
            0 AS PVN,
            OPS.AC21 AS RAC,
            OPS.Summ AS SDb,
            0.00 AS SCr,
            OPS.AC22 AS RAC2,
            OPS.AC23 AS RAC3,
            OPS.AC24 AS RAC4,
            OPS.AC25 AS RAC5,
            OPS.QV,
            OPSd.ZNR
        FROM
            OPSd
            INNER JOIN OPS ON OPSd.id = OPS.DocId
            LEFT JOIN Persons AS P1 ON OPSd.ClId = P1.ClId
            LEFT JOIN Persons AS P2 ON OPSd.ClId2 = P2.ClId
            LEFT JOIN DocTyp ON OPSd.DocTyp = DocTyp.id
        WHERE
            (OPSd.Dete BETWEEN :psd AND :ped) AND
            OPS.AC11 LIKE :pac AND
            OPSd.ClId = :pclid

        UNION ALL

        SELECT 
            gen_id(GEN_ROPS1A_ID, 1) AS id,
            current_connection as spid,
            OPSd.id AS did,
            OPSd.Dete,
            OPSd.NrX,
            OPSd.DocTyp,
            DocTyp.id1 AS DocTyp1,
            DocTyp.tpZ AS DocTyp2,
            OPSd.DocSt,
            OPSd.DocNr,
            OPSd.ClId,
            OPSd.ClId2,
            P1.Name AS Name,
            P2.Name AS Name2,
            P1.RegNr AS RegNr,
            P2.RegNr AS RegNr2,
            0 AS b0,
            OPSd.Descr,
            OPS.Descr AS Descr2,
            OPS.AC21 AS Ac1,
            null AS Ac2,
            null AS SAc1,
            null AS SAc2,
            OPS.SummC AS SummC,
            OPS.cur AS Cur,
            OPS.Summ AS Summ,
            0 AS PVN,
            OPS.AC11 AS RAC,
            0.00 AS SDb,
            OPS.Summ AS SCr,
            OPS.AC12 AS RAC2,
            OPS.AC13 AS RAC3,
            OPS.AC14 AS RAC4,
            OPS.AC15 AS RAC5,
            OPS.QV,
            OPSd.ZNR
        FROM
            OPSd
            INNER JOIN OPS ON OPSd.id = OPS.DocId
            LEFT JOIN Persons AS P1 ON OPSd.ClId = P1.ClId
            LEFT JOIN Persons AS P2 ON OPSd.ClId2 = P2.ClId
            LEFT JOIN DocTyp ON OPSd.DocTyp = DocTyp.id
        WHERE
            (OPSd.Dete BETWEEN :psd AND :ped) AND
            OPS.AC21 LIKE :pac AND
            OPSd.ClId = :pclid
    ) AS TT
    ORDER BY TT.Dete, TT.ZNR


    into
        :id, :spid, :did, :DETE, :nrx,
        :doctyp, :doctyp1, :doctyp2, :docst, :docnr,
        :clid, :clid2, :name, :name2, :regnr, :regnr2,
        :b0, :descr, :descr2, :ac1, :ac2, :sac1,:sac2,
        :summc, :cur, :summ, :pvn, :rac, :sdb, :scr,
        :rac2, :rac3, :rac4, :rac5, :qv, :znr
    do
    begin
        suspend;
    end
end^


ALTER PROCEDURE SP_REP_KORESP_11_CLID2 (
    PSD DATE,
    PED DATE,
    PAC VARCHAR(8),
    PCLID VARCHAR(15))
RETURNS (
    ID TYPE OF COLUMN ROPS1A.ID,
    SPID TYPE OF COLUMN ROPS1A.SPID,
    DID TYPE OF COLUMN ROPS1A.DID,
    DETE TYPE OF COLUMN ROPS1A.DETE,
    NRX TYPE OF COLUMN ROPS1A.NRX,
    DOCTYP TYPE OF COLUMN ROPS1A.DOCTYP,
    DOCTYP1 TYPE OF COLUMN ROPS1A.DOCTYP1,
    DOCTYP2 TYPE OF COLUMN ROPS1A.DOCTYP2,
    DOCST TYPE OF COLUMN ROPS1A.DOCST,
    DOCNR TYPE OF COLUMN ROPS1A.DOCNR,
    CLID TYPE OF COLUMN ROPS1A.CLID,
    CLID2 TYPE OF COLUMN ROPS1A.CLID2,
    NAME TYPE OF COLUMN ROPS1A.NAME,
    NAME2 TYPE OF COLUMN ROPS1A.NAME2,
    REGNR TYPE OF COLUMN ROPS1A.REGNR,
    REGNR2 TYPE OF COLUMN ROPS1A.REGNR2,
    B0 TYPE OF COLUMN ROPS1A.B0,
    DESCR TYPE OF COLUMN ROPS1A.DESCR,
    DESCR2 TYPE OF COLUMN ROPS1A.DESCR2,
    AC1 TYPE OF COLUMN ROPS1A.AC1,
    AC2 TYPE OF COLUMN ROPS1A.AC2,
    SAC1 TYPE OF COLUMN ROPS1A.SAC1,
    SAC2 TYPE OF COLUMN ROPS1A.SAC2,
    SUMMC TYPE OF COLUMN ROPS1A.SUMMC,
    CUR TYPE OF COLUMN ROPS1A.CUR,
    SUMM TYPE OF COLUMN ROPS1A.SUMM,
    PVN TYPE OF COLUMN ROPS1A.PVN,
    RAC TYPE OF COLUMN ROPS1A.RAC,
    SDB TYPE OF COLUMN ROPS1A.SDB,
    SCR TYPE OF COLUMN ROPS1A.SCR,
    RAC2 TYPE OF COLUMN ROPS1A.RAC2,
    RAC3 TYPE OF COLUMN ROPS1A.RAC3,
    RAC4 TYPE OF COLUMN ROPS1A.RAC4,
    RAC5 TYPE OF COLUMN ROPS1A.RAC5,
    QV TYPE OF COLUMN ROPS1A.QV,
    ZNR TYPE OF COLUMN ROPS1A.ZNR)
AS
begin
    FOR SELECT
        id, spid, did, DETE, nrx,
        doctyp, doctyp1, doctyp2, docst, docnr,
        clid, clid2, name, name2, regnr, regnr2,
        b0, descr, descr2, ac1, ac2, sac1, sac2,
        summc, cur, summ, pvn, rac, sdb, scr,
        rac2, rac3, rac4, rac5, qv, znr

    FROM
    (
        SELECT 
            gen_id(GEN_ROPS1A_ID, 1) AS id,
            current_connection as spid,
            OPSd.id AS did,
            OPSd.Dete,
            OPSd.NrX,
            OPSd.DocTyp,
            DocTyp.id1 AS DocTyp1,
            DocTyp.tpZ AS DocTyp2,
            OPSd.DocSt,
            OPSd.DocNr,
            OPSd.ClId,
            OPSd.ClId2,
            P1.Name AS Name,
            P2.Name AS Name2,
            P1.RegNr AS RegNr,
            P2.RegNr AS RegNr2,
            0 AS b0,
            OPSd.Descr,
            OPS.Descr AS Descr2,
            OPS.AC11 AS Ac1,
            null AS Ac2,
            null AS SAc1,
            null AS SAc2,
            OPS.SummC AS SummC,
            OPS.cur AS Cur,
            OPS.Summ AS Summ,
            0 AS PVN,
            OPS.AC21 AS RAC,
            OPS.Summ AS SDb,
            0.00 AS SCr,
            OPS.AC22 AS RAC2,
            OPS.AC23 AS RAC3,
            OPS.AC24 AS RAC4,
            OPS.AC25 AS RAC5,
            OPS.QV,
            OPSd.ZNR
        FROM
            OPSd
            INNER JOIN OPS ON OPSd.id = OPS.DocId
            LEFT JOIN Persons AS P1 ON OPSd.ClId = P1.ClId
            LEFT JOIN Persons AS P2 ON OPSd.ClId2 = P2.ClId
            LEFT JOIN DocTyp ON OPSd.DocTyp = DocTyp.id
        WHERE
            (OPSd.Dete BETWEEN :psd AND :ped) AND
            OPS.AC11 LIKE :pac AND
            OPSd.ClId2 = :pclid

        UNION ALL

        SELECT 
            gen_id(GEN_ROPS1A_ID, 1) AS id,
            current_connection as spid,
            OPSd.id AS did,
            OPSd.Dete,
            OPSd.NrX,
            OPSd.DocTyp,
            DocTyp.id1 AS DocTyp1,
            DocTyp.tpZ AS DocTyp2,
            OPSd.DocSt,
            OPSd.DocNr,
            OPSd.ClId,
            OPSd.ClId2,
            P1.Name AS Name,
            P2.Name AS Name2,
            P1.RegNr AS RegNr,
            P2.RegNr AS RegNr2,
            0 AS b0,
            OPSd.Descr,
            OPS.Descr AS Descr2,
            OPS.AC21 AS Ac1,
            null AS Ac2,
            null AS SAc1,
            null AS SAc2,
            OPS.SummC AS SummC,
            OPS.cur AS Cur,
            OPS.Summ AS Summ,
            0 AS PVN,
            OPS.AC11 AS RAC,
            0.00 AS SDb,
            OPS.Summ AS SCr,
            OPS.AC12 AS RAC2,
            OPS.AC13 AS RAC3,
            OPS.AC14 AS RAC4,
            OPS.AC15 AS RAC5,
            OPS.QV,
            OPSd.ZNR
        FROM
            OPSd
            INNER JOIN OPS ON OPSd.id = OPS.DocId
            LEFT JOIN Persons AS P1 ON OPSd.ClId = P1.ClId
            LEFT JOIN Persons AS P2 ON OPSd.ClId2 = P2.ClId
            LEFT JOIN DocTyp ON OPSd.DocTyp = DocTyp.id
        WHERE
            (OPSd.Dete BETWEEN :psd AND :ped) AND
            OPS.AC21 LIKE :pac AND
            OPSd.ClId2 = :pclid
    ) AS TT
    ORDER BY TT.Dete, TT.ZNR


    into
        :id, :spid, :did, :DETE, :nrx,
        :doctyp, :doctyp1, :doctyp2, :docst, :docnr,
        :clid, :clid2, :name, :name2, :regnr, :regnr2,
        :b0, :descr, :descr2, :ac1, :ac2, :sac1,:sac2,
        :summc, :cur, :summ, :pvn, :rac, :sdb, :scr,
        :rac2, :rac3, :rac4, :rac5, :qv, :znr
    do
    begin
        suspend;
    end
end^


ALTER PROCEDURE SP_REP_KORESP_11_CUR (
    PSD DATE,
    PED DATE,
    PAC VARCHAR(8),
    PCLID VARCHAR(15),
    PCUR VARCHAR(3))
RETURNS (
    ID TYPE OF COLUMN ROPS1A.ID,
    SPID TYPE OF COLUMN ROPS1A.SPID,
    DID TYPE OF COLUMN ROPS1A.DID,
    DETE TYPE OF COLUMN ROPS1A.DETE,
    NRX TYPE OF COLUMN ROPS1A.NRX,
    DOCTYP TYPE OF COLUMN ROPS1A.DOCTYP,
    DOCTYP1 TYPE OF COLUMN ROPS1A.DOCTYP1,
    DOCTYP2 TYPE OF COLUMN ROPS1A.DOCTYP2,
    DOCST TYPE OF COLUMN ROPS1A.DOCST,
    DOCNR TYPE OF COLUMN ROPS1A.DOCNR,
    CLID TYPE OF COLUMN ROPS1A.CLID,
    CLID2 TYPE OF COLUMN ROPS1A.CLID2,
    NAME TYPE OF COLUMN ROPS1A.NAME,
    NAME2 TYPE OF COLUMN ROPS1A.NAME2,
    REGNR TYPE OF COLUMN ROPS1A.REGNR,
    REGNR2 TYPE OF COLUMN ROPS1A.REGNR2,
    B0 TYPE OF COLUMN ROPS1A.B0,
    DESCR TYPE OF COLUMN ROPS1A.DESCR,
    DESCR2 TYPE OF COLUMN ROPS1A.DESCR2,
    AC1 TYPE OF COLUMN ROPS1A.AC1,
    AC2 TYPE OF COLUMN ROPS1A.AC2,
    SAC1 TYPE OF COLUMN ROPS1A.SAC1,
    SAC2 TYPE OF COLUMN ROPS1A.SAC2,
    SUMMC TYPE OF COLUMN ROPS1A.SUMMC,
    CUR TYPE OF COLUMN ROPS1A.CUR,
    SUMM TYPE OF COLUMN ROPS1A.SUMM,
    PVN TYPE OF COLUMN ROPS1A.PVN,
    RAC TYPE OF COLUMN ROPS1A.RAC,
    SDB TYPE OF COLUMN ROPS1A.SDB,
    SCR TYPE OF COLUMN ROPS1A.SCR,
    RAC2 TYPE OF COLUMN ROPS1A.RAC2,
    RAC3 TYPE OF COLUMN ROPS1A.RAC3,
    RAC4 TYPE OF COLUMN ROPS1A.RAC4,
    RAC5 TYPE OF COLUMN ROPS1A.RAC5,
    QV TYPE OF COLUMN ROPS1A.QV,
    ZNR TYPE OF COLUMN ROPS1A.ZNR)
AS
begin
    FOR SELECT
        id, spid, did, DETE, nrx,
        doctyp, doctyp1, doctyp2, docst, docnr,
        clid, clid2, name, name2, regnr, regnr2,
        b0, descr, descr2, ac1, ac2, sac1, sac2,
        summc, cur, summ, pvn, rac, sdb, scr,
        rac2, rac3, rac4, rac5, qv, znr

    FROM
    (
        SELECT 
            gen_id(GEN_ROPS1A_ID, 1) AS id,
            current_connection as spid,
            OPSd.id AS did,
            OPSd.Dete,
            OPSd.NrX,
            OPSd.DocTyp,
            DocTyp.id1 AS DocTyp1,
            DocTyp.tpZ AS DocTyp2,
            OPSd.DocSt,
            OPSd.DocNr,
            OPSd.ClId,
            OPSd.ClId2,
            P1.Name AS Name,
            P2.Name AS Name2,
            P1.RegNr AS RegNr,
            P2.RegNr AS RegNr2,
            0 AS b0,
            OPSd.Descr,
            OPS.Descr AS Descr2,
            OPS.AC11 AS Ac1,
            null AS Ac2,
            null AS SAc1,
            null AS SAc2,
            OPS.SummC AS SummC,
            OPS.cur AS Cur,
            OPS.SummC AS Summ,
            0 AS PVN,
            OPS.AC21 AS RAC,
            OPS.SummC AS SDb,
            0.00 AS SCr,
            OPS.AC22 AS RAC2,
            OPS.AC23 AS RAC3,
            OPS.AC24 AS RAC4,
            OPS.AC25 AS RAC5,
            OPS.QV,
            OPSd.ZNR
        FROM
            OPSd
            INNER JOIN OPS ON OPSd.id = OPS.DocId
            LEFT JOIN Persons AS P1 ON OPSd.ClId = P1.ClId
            LEFT JOIN Persons AS P2 ON OPSd.ClId2 = P2.ClId
            LEFT JOIN DocTyp ON OPSd.DocTyp = DocTyp.id
        WHERE
            (OPSd.Dete BETWEEN :psd AND :ped) AND
            OPS.AC11 LIKE :pac AND
            (:pclid IS NULL OR OPSd.ClId = :pclid) AND
            OPS.Cur = :pcur

        UNION ALL

        SELECT 
            gen_id(GEN_ROPS1A_ID, 1) AS id,
            current_connection as spid,
            OPSd.id AS did,
            OPSd.Dete,
            OPSd.NrX,
            OPSd.DocTyp,
            DocTyp.id1 AS DocTyp1,
            DocTyp.tpZ AS DocTyp2,
            OPSd.DocSt,
            OPSd.DocNr,
            OPSd.ClId,
            OPSd.ClId2,
            P1.Name AS Name,
            P2.Name AS Name2,
            P1.RegNr AS RegNr,
            P2.RegNr AS RegNr2,
            0 AS b0,
            OPSd.Descr,
            OPS.Descr AS Descr2,
            OPS.AC21 AS Ac1,
            null AS Ac2,
            null AS SAc1,
            null AS SAc2,
            OPS.SummC AS SummC,
            OPS.cur AS Cur,
            OPS.SummC AS Summ,
            0 AS PVN,
            OPS.AC11 AS RAC,
            0.00 AS SDb,
            OPS.SummC AS SCr,
            OPS.AC12 AS RAC2,
            OPS.AC13 AS RAC3,
            OPS.AC14 AS RAC4,
            OPS.AC15 AS RAC5,
            OPS.QV,
            OPSd.ZNR
        FROM
            OPSd
            INNER JOIN OPS ON OPSd.id = OPS.DocId
            LEFT JOIN Persons AS P1 ON OPSd.ClId = P1.ClId
            LEFT JOIN Persons AS P2 ON OPSd.ClId2 = P2.ClId
            LEFT JOIN DocTyp ON OPSd.DocTyp = DocTyp.id
        WHERE
            (OPSd.Dete BETWEEN :psd AND :ped) AND
            OPS.AC21 LIKE :pac AND
            (:pclid IS NULL OR OPSd.ClId = :pclid) AND
            OPS.Cur = :pcur
    ) AS TT
    ORDER BY TT.Dete, TT.ZNR


    into
        :id, :spid, :did, :DETE, :nrx,
        :doctyp, :doctyp1, :doctyp2, :docst, :docnr,
        :clid, :clid2, :name, :name2, :regnr, :regnr2,
        :b0, :descr, :descr2, :ac1, :ac2, :sac1,:sac2,
        :summc, :cur, :summ, :pvn, :rac, :sdb, :scr,
        :rac2, :rac3, :rac4, :rac5, :qv, :znr
    do
    begin
        suspend;
    end
end^


ALTER PROCEDURE SP_REP_NPMT_11 (
    SDT DATE,
    EDT DATE,
    PAD VARCHAR(3))
RETURNS (
    ID TYPE OF COLUMN TREPMT.ID,
    SPID TYPE OF COLUMN TREPMT.SPID,
    AD TYPE OF COLUMN TREPMT.AD,
    AC1 TYPE OF COLUMN TREPMT.AC1,
    AC2 TYPE OF COLUMN TREPMT.AC2,
    ACN1 TYPE OF COLUMN TREPMT.ACN1,
    ACN2 TYPE OF COLUMN TREPMT.ACN2,
    M1 TYPE OF COLUMN TREPMT.M1,
    M2 TYPE OF COLUMN TREPMT.M2,
    M3 TYPE OF COLUMN TREPMT.M3,
    M4 TYPE OF COLUMN TREPMT.M4,
    M5 TYPE OF COLUMN TREPMT.M5,
    M6 TYPE OF COLUMN TREPMT.M6,
    M7 TYPE OF COLUMN TREPMT.M7,
    M8 TYPE OF COLUMN TREPMT.M8,
    M9 TYPE OF COLUMN TREPMT.M9,
    M10 TYPE OF COLUMN TREPMT.M10,
    M11 TYPE OF COLUMN TREPMT.M11,
    M12 TYPE OF COLUMN TREPMT.M12,
    N1 TYPE OF COLUMN TREPMT.N1,
    N2 TYPE OF COLUMN TREPMT.N2,
    N3 TYPE OF COLUMN TREPMT.N3,
    N4 TYPE OF COLUMN TREPMT.N4,
    N5 TYPE OF COLUMN TREPMT.N5,
    N6 TYPE OF COLUMN TREPMT.N6,
    N7 TYPE OF COLUMN TREPMT.N7,
    N8 TYPE OF COLUMN TREPMT.N8,
    N9 TYPE OF COLUMN TREPMT.N9,
    N10 TYPE OF COLUMN TREPMT.N10,
    N11 TYPE OF COLUMN TREPMT.N11,
    N12 TYPE OF COLUMN TREPMT.N12,
    MT TYPE OF COLUMN TREPMT.MT,
    NT TYPE OF COLUMN TREPMT.NT)
AS
begin
-- summ√Ñ‚Äújam debeta AC12 (izdevumus)
-- uz TRepMT
    FOR SELECT
        gen_id(GEN_TREPMT_ID, 1) as ID,
        current_connection as SPID,
        :pad AS ad,
        T3.AC AS AC1,
        NULL AS AC2,
        AcP21.Name AS ACN1,
        NULL AS ACN2,
        M1,M2,M3,M4,M5,M6,M7,M8,M9,M10,M11,M12,
        0.0 AS N1, 0.0 AS N2, 0.0 AS N3, 0.0 AS N4, 0.0 AS N5, 0.0 AS N6,
        0.0 AS N7, 0.0 AS N8, 0.0 AS N9, 0.0 AS N10, 0.0 AS N11, 0.0 AS N12,
        0.0 AS MT, 0.0 AS NT
        
    FROM
    (
        SELECT 
            AC,
            SUM(CASE WHEN MT = 1 THEN ADb ELSE 0.00 END) AS M1,
            SUM(CASE WHEN MT = 2 THEN ADb ELSE 0.00 END) AS M2,
            SUM(CASE WHEN MT = 3 THEN ADb ELSE 0.00 END) AS M3,
            SUM(CASE WHEN MT = 4 THEN ADb ELSE 0.00 END) AS M4,
            SUM(CASE WHEN MT = 5 THEN ADb ELSE 0.00 END) AS M5,
            SUM(CASE WHEN MT = 6 THEN ADb ELSE 0.00 END) AS M6,
            SUM(CASE WHEN MT = 7 THEN ADb ELSE 0.00 END) AS M7,
            SUM(CASE WHEN MT = 8 THEN ADb ELSE 0.00 END) AS M8,
            SUM(CASE WHEN MT = 9 THEN ADb ELSE 0.00 END) AS M9,
            SUM(CASE WHEN MT = 10 THEN ADb ELSE 0.00 END) AS M10,
            SUM(CASE WHEN MT = 11 THEN ADb ELSE 0.00 END) AS M11,
            SUM(CASE WHEN MT = 12 THEN ADb ELSE 0.00 END) AS M12

        FROM
        (
            SELECT AC, MT, SUM(SDb) AS ADb, SUM(SCr) AS ACr
            FROM
            (
                SELECT 
                    OPS.AC12 AS AC,
                    EXTRACT(MONTH FROM OPSd.Dete) AS MT,
                    OPS.Summ AS SDb,
                    0.00 AS SCr

                FROM 
                    OPSd JOIN OPS ON OPSd.id = OPS.DocId
                    LEFT JOIN AcP21 ON OPS.AC12 = AcP21.AC
                WHERE 
                    OPSd.Dete BETWEEN :sdt AND :edt AND
                    OPS.AC12 IS NOT NULL AND
                    (AcP21.id1 IS NULL OR AcP21.id1 NOT IN ('KA','BA','CN'))

            ) AS T1

            GROUP BY T1.AC, T1.MT

        ) AS T2
        GROUP BY T2.AC
    ) AS T3

    LEFT JOIN AcP21 ON AcP21.AC = T3.AC
    ORDER BY AC1

    into
        :id, :spid, :ad, :ac1, :ac2, :acn1, :acn2,
        :m1, :m2, :m3, :m4, :m5, :m6, :m7, :m8, :m9, :m10, :m11, :m12,
        :n1, :n2, :n3, :n4, :n5, :n6, :n7, :n8, :n9, :n10, :n11, :n12,
        :mt, :nt
  do
  begin
    suspend;
  end
end^


ALTER PROCEDURE SP_REP_NPMT_12 (
    SDT DATE,
    EDT DATE,
    PAD VARCHAR(3))
RETURNS (
    ID TYPE OF COLUMN TREPMT.ID,
    SPID TYPE OF COLUMN TREPMT.SPID,
    AD TYPE OF COLUMN TREPMT.AD,
    AC1 TYPE OF COLUMN TREPMT.AC1,
    AC2 TYPE OF COLUMN TREPMT.AC2,
    ACN1 TYPE OF COLUMN TREPMT.ACN1,
    ACN2 TYPE OF COLUMN TREPMT.ACN2,
    M1 TYPE OF COLUMN TREPMT.M1,
    M2 TYPE OF COLUMN TREPMT.M2,
    M3 TYPE OF COLUMN TREPMT.M3,
    M4 TYPE OF COLUMN TREPMT.M4,
    M5 TYPE OF COLUMN TREPMT.M5,
    M6 TYPE OF COLUMN TREPMT.M6,
    M7 TYPE OF COLUMN TREPMT.M7,
    M8 TYPE OF COLUMN TREPMT.M8,
    M9 TYPE OF COLUMN TREPMT.M9,
    M10 TYPE OF COLUMN TREPMT.M10,
    M11 TYPE OF COLUMN TREPMT.M11,
    M12 TYPE OF COLUMN TREPMT.M12,
    N1 TYPE OF COLUMN TREPMT.N1,
    N2 TYPE OF COLUMN TREPMT.N2,
    N3 TYPE OF COLUMN TREPMT.N3,
    N4 TYPE OF COLUMN TREPMT.N4,
    N5 TYPE OF COLUMN TREPMT.N5,
    N6 TYPE OF COLUMN TREPMT.N6,
    N7 TYPE OF COLUMN TREPMT.N7,
    N8 TYPE OF COLUMN TREPMT.N8,
    N9 TYPE OF COLUMN TREPMT.N9,
    N10 TYPE OF COLUMN TREPMT.N10,
    N11 TYPE OF COLUMN TREPMT.N11,
    N12 TYPE OF COLUMN TREPMT.N12,
    MT TYPE OF COLUMN TREPMT.MT,
    NT TYPE OF COLUMN TREPMT.NT)
AS
begin
-- summ√Ñ‚Äújam debeta AC22 (ie√Ö‚Ä†√Ñ‚Äúmumi)
-- uz TRepMT
    FOR SELECT
        gen_id(GEN_TREPMT_ID, 1) as ID,
        current_connection as SPID,
        :pad AS ad,
        T3.AC AS AC1,
        NULL AS AC2,
        AcP21.Name AS ACN1,
        NULL AS ACN2,
        M1,M2,M3,M4,M5,M6,M7,M8,M9,M10,M11,M12,
        0.0 AS N1, 0.0 AS N2, 0.0 AS N3, 0.0 AS N4, 0.0 AS N5, 0.0 AS N6,
        0.0 AS N7, 0.0 AS N8, 0.0 AS N9, 0.0 AS N10, 0.0 AS N11, 0.0 AS N12,
        0.0 AS MT, 0.0 AS NT
        
    FROM
    (
        SELECT 
            AC,
            SUM(CASE WHEN MT = 1 THEN ACr ELSE 0.00 END) AS M1,
            SUM(CASE WHEN MT = 2 THEN ACr ELSE 0.00 END) AS M2,
            SUM(CASE WHEN MT = 3 THEN ACr ELSE 0.00 END) AS M3,
            SUM(CASE WHEN MT = 4 THEN ACr ELSE 0.00 END) AS M4,
            SUM(CASE WHEN MT = 5 THEN ACr ELSE 0.00 END) AS M5,
            SUM(CASE WHEN MT = 6 THEN ACr ELSE 0.00 END) AS M6,
            SUM(CASE WHEN MT = 7 THEN ACr ELSE 0.00 END) AS M7,
            SUM(CASE WHEN MT = 8 THEN ACr ELSE 0.00 END) AS M8,
            SUM(CASE WHEN MT = 9 THEN ACr ELSE 0.00 END) AS M9,
            SUM(CASE WHEN MT = 10 THEN ACr ELSE 0.00 END) AS M10,
            SUM(CASE WHEN MT = 11 THEN ACr ELSE 0.00 END) AS M11,
            SUM(CASE WHEN MT = 12 THEN ACr ELSE 0.00 END) AS M12

        FROM
        (
            SELECT AC, MT, SUM(SDb) AS ADb, SUM(SCr) AS ACr
            FROM
            (
                SELECT 
                    OPS.AC22 AS AC,
                    EXTRACT(MONTH FROM OPSd.Dete) AS MT,
                    0.00 AS SDb,
                    OPS.Summ AS SCr

                FROM 
                    OPSd JOIN OPS ON OPSd.id = OPS.DocId
                    LEFT JOIN AcP21 ON OPS.AC22 = AcP21.AC
                WHERE 
                    OPSd.Dete BETWEEN :sdt AND :edt AND
                    OPS.AC22 IS NOT NULL AND
                    (AcP21.id1 IS NULL OR AcP21.id1 NOT IN ('KA','BA','CN'))

            ) AS T1

            GROUP BY T1.AC, T1.MT

        ) AS T2
        GROUP BY T2.AC
    ) AS T3

    LEFT JOIN AcP21 ON AcP21.AC = T3.AC
    ORDER BY AC1

    into
        :id, :spid, :ad, :ac1, :ac2, :acn1, :acn2,
        :m1, :m2, :m3, :m4, :m5, :m6, :m7, :m8, :m9, :m10, :m11, :m12,
        :n1, :n2, :n3, :n4, :n5, :n6, :n7, :n8, :n9, :n10, :n11, :n12,
        :mt, :nt
  do
  begin
    suspend;
  end
end^


ALTER PROCEDURE SP_REP_NPMT_13 (
    SDT DATE,
    EDT DATE,
    PAD VARCHAR(3))
RETURNS (
    ID TYPE OF COLUMN TREPMT.ID,
    SPID TYPE OF COLUMN TREPMT.SPID,
    AD TYPE OF COLUMN TREPMT.AD,
    AC1 TYPE OF COLUMN TREPMT.AC1,
    AC2 TYPE OF COLUMN TREPMT.AC2,
    ACN1 TYPE OF COLUMN TREPMT.ACN1,
    ACN2 TYPE OF COLUMN TREPMT.ACN2,
    M1 TYPE OF COLUMN TREPMT.M1,
    M2 TYPE OF COLUMN TREPMT.M2,
    M3 TYPE OF COLUMN TREPMT.M3,
    M4 TYPE OF COLUMN TREPMT.M4,
    M5 TYPE OF COLUMN TREPMT.M5,
    M6 TYPE OF COLUMN TREPMT.M6,
    M7 TYPE OF COLUMN TREPMT.M7,
    M8 TYPE OF COLUMN TREPMT.M8,
    M9 TYPE OF COLUMN TREPMT.M9,
    M10 TYPE OF COLUMN TREPMT.M10,
    M11 TYPE OF COLUMN TREPMT.M11,
    M12 TYPE OF COLUMN TREPMT.M12,
    N1 TYPE OF COLUMN TREPMT.N1,
    N2 TYPE OF COLUMN TREPMT.N2,
    N3 TYPE OF COLUMN TREPMT.N3,
    N4 TYPE OF COLUMN TREPMT.N4,
    N5 TYPE OF COLUMN TREPMT.N5,
    N6 TYPE OF COLUMN TREPMT.N6,
    N7 TYPE OF COLUMN TREPMT.N7,
    N8 TYPE OF COLUMN TREPMT.N8,
    N9 TYPE OF COLUMN TREPMT.N9,
    N10 TYPE OF COLUMN TREPMT.N10,
    N11 TYPE OF COLUMN TREPMT.N11,
    N12 TYPE OF COLUMN TREPMT.N12,
    MT TYPE OF COLUMN TREPMT.MT,
    NT TYPE OF COLUMN TREPMT.NT)
AS
begin
-- summ√Ñ‚Äújam naudas apgrozijumu pa m√Ñ‚Äún√Ñ‚Äú√ÖÔ£ºiem
-- s√Ñ¬Åkuma atlikumi (pirms sdt) b√Ö¬´s iek√ÖÔ£º MT, NT
-- uz TRepMT
    FOR SELECT
        gen_id(GEN_TREPMT_ID, 1) as ID,
        current_connection as SPID,
        :pad AS ad,
        T3.AC AS AC1,
        NULL AS AC2,
        AcP21.Name AS ACN1,
        NULL AS ACN2,
        M1,M2,M3,M4,M5,M6,M7,M8,M9,M10,M11,M12,
        N1,N2,N3,N4,N5,N6,N7,N8,N9,N10,N11,N12,
        MT, NT
    FROM
    (
        SELECT 
            AC,
            SUM(CASE WHEN MT = 0 THEN ADb ELSE 0.00 END) AS MT,
            SUM(CASE WHEN MT = 0 THEN ACr ELSE 0.00 END) AS NT,

            SUM(CASE WHEN MT = 1 THEN ADb ELSE 0.00 END) AS M1,
            SUM(CASE WHEN MT = 2 THEN ADb ELSE 0.00 END) AS M2,
            SUM(CASE WHEN MT = 3 THEN ADb ELSE 0.00 END) AS M3,
            SUM(CASE WHEN MT = 4 THEN ADb ELSE 0.00 END) AS M4,
            SUM(CASE WHEN MT = 5 THEN ADb ELSE 0.00 END) AS M5,
            SUM(CASE WHEN MT = 6 THEN ADb ELSE 0.00 END) AS M6,
            SUM(CASE WHEN MT = 7 THEN ADb ELSE 0.00 END) AS M7,
            SUM(CASE WHEN MT = 8 THEN ADb ELSE 0.00 END) AS M8,
            SUM(CASE WHEN MT = 9 THEN ADb ELSE 0.00 END) AS M9,
            SUM(CASE WHEN MT = 10 THEN ADb ELSE 0.00 END) AS M10,
            SUM(CASE WHEN MT = 11 THEN ADb ELSE 0.00 END) AS M11,
            SUM(CASE WHEN MT = 12 THEN ADb ELSE 0.00 END) AS M12,

            SUM(CASE WHEN MT = 1 THEN ACr ELSE 0.00 END) AS N1,
            SUM(CASE WHEN MT = 2 THEN ACr ELSE 0.00 END) AS N2,
            SUM(CASE WHEN MT = 3 THEN ACr ELSE 0.00 END) AS N3,
            SUM(CASE WHEN MT = 4 THEN ACr ELSE 0.00 END) AS N4,
            SUM(CASE WHEN MT = 5 THEN ACr ELSE 0.00 END) AS N5,
            SUM(CASE WHEN MT = 6 THEN ACr ELSE 0.00 END) AS N6,
            SUM(CASE WHEN MT = 7 THEN ACr ELSE 0.00 END) AS N7,
            SUM(CASE WHEN MT = 8 THEN ACr ELSE 0.00 END) AS N8,
            SUM(CASE WHEN MT = 9 THEN ACr ELSE 0.00 END) AS N9,
            SUM(CASE WHEN MT = 10 THEN ACr ELSE 0.00 END) AS N10,
            SUM(CASE WHEN MT = 11 THEN ACr ELSE 0.00 END) AS N11,
            SUM(CASE WHEN MT = 12 THEN ACr ELSE 0.00 END) AS N12

        FROM
        (
            SELECT AC, MT, SUM(SDb) AS ADb, SUM(SCr) AS ACr
            FROM
            (
                SELECT 
                    OPS.AC11 AS AC,
                    CASE
                        WHEN OPSd.Dete < :sdt THEN 0
                        ELSE EXTRACT(MONTH FROM OPSd.Dete) END AS MT,
                    OPS.Summ AS SDb,
                    0.00 AS SCr

                FROM 
                    OPSd JOIN OPS ON OPSd.id = OPS.DocId
                    INNER JOIN AcP21 ON OPS.AC12 = AcP21.AC

                WHERE 
                    OPSd.Dete <= :edt AND
                    OPS.AC12 IS NOT NULL AND
                    AcP21.id1 IN ('KA','BA','CN')

                UNION ALL

                SELECT 
                    OPS.AC21 AS AC,
                    CASE
                        WHEN OPSd.Dete < :sdt THEN 0
                        ELSE EXTRACT(MONTH FROM OPSd.Dete) END AS MT,
                    0.00 AS SDb,
                    OPS.Summ AS SCr

                FROM 
                    OPSd JOIN OPS ON OPSd.id = OPS.DocId
                    INNER JOIN AcP21 ON OPS.AC22 = AcP21.AC

                WHERE 
                    OPSd.Dete <= :edt AND
                    OPS.AC22 IS NOT NULL AND
                    AcP21.id1 IN ('KA','BA','CN')

                UNION ALL

                    SELECT
                        Bal0.AC11 AS AC,
                        0 AS MT,
                        coalesce(Bal0.SummD, 0.00) AS SDb,
                        coalesce(Bal0.SummC, 0.00) AS SCr
                    FROM 
                        Bal0 JOIN AcP21 ON Bal0.AC11 = AcP21.AC
                    WHERE
                        AcP21.id1 IN ('KA','BA','CN')

            ) AS T1

            GROUP BY T1.AC, T1.MT

        ) AS T2
        GROUP BY T2.AC
    ) AS T3

    LEFT JOIN AcP21 ON AcP21.AC = T3.AC
    ORDER BY AC1


    into
        :id, :spid, :ad, :ac1, :ac2, :acn1, :acn2,
        :m1, :m2, :m3, :m4, :m5, :m6, :m7, :m8, :m9, :m10, :m11, :m12,
        :n1, :n2, :n3, :n4, :n5, :n6, :n7, :n8, :n9, :n10, :n11, :n12,
        :mt, :nt
    do
    begin
     suspend;
    end
end^


ALTER PROCEDURE SP_REP_NPMT_14 (
    SDT DATE,
    EDT DATE)
RETURNS (
    ID TYPE OF COLUMN TREPMT.ID,
    SPID TYPE OF COLUMN TREPMT.SPID,
    AD TYPE OF COLUMN TREPMT.AD,
    AC1 TYPE OF COLUMN TREPMT.AC1,
    AC2 TYPE OF COLUMN TREPMT.AC2,
    ACN1 TYPE OF COLUMN TREPMT.ACN1,
    ACN2 TYPE OF COLUMN TREPMT.ACN2,
    M1 TYPE OF COLUMN TREPMT.M1,
    M2 TYPE OF COLUMN TREPMT.M2,
    M3 TYPE OF COLUMN TREPMT.M3,
    M4 TYPE OF COLUMN TREPMT.M4,
    M5 TYPE OF COLUMN TREPMT.M5,
    M6 TYPE OF COLUMN TREPMT.M6,
    M7 TYPE OF COLUMN TREPMT.M7,
    M8 TYPE OF COLUMN TREPMT.M8,
    M9 TYPE OF COLUMN TREPMT.M9,
    M10 TYPE OF COLUMN TREPMT.M10,
    M11 TYPE OF COLUMN TREPMT.M11,
    M12 TYPE OF COLUMN TREPMT.M12,
    N1 TYPE OF COLUMN TREPMT.N1,
    N2 TYPE OF COLUMN TREPMT.N2,
    N3 TYPE OF COLUMN TREPMT.N3,
    N4 TYPE OF COLUMN TREPMT.N4,
    N5 TYPE OF COLUMN TREPMT.N5,
    N6 TYPE OF COLUMN TREPMT.N6,
    N7 TYPE OF COLUMN TREPMT.N7,
    N8 TYPE OF COLUMN TREPMT.N8,
    N9 TYPE OF COLUMN TREPMT.N9,
    N10 TYPE OF COLUMN TREPMT.N10,
    N11 TYPE OF COLUMN TREPMT.N11,
    N12 TYPE OF COLUMN TREPMT.N12,
    MT TYPE OF COLUMN TREPMT.MT,
    NT TYPE OF COLUMN TREPMT.NT)
AS
begin
    DELETE 
    FROM TRepMT
    WHERE TRepMT.spid = current_connection;
    
    INSERT INTO TRepMT(
        id, spid,  ad,
        ac1,  ac2, acn1, acn2,
        m1, m2, m3, m4, m5, m6, m7, m8, m9, m10, m11, m12,
        n1, n2, n3, n4, n5, n6, n7, n8, n9, n10, n11, n12,
        mt, nt)
    SELECT
        id, spid,  ad,
        ac1,  ac2, acn1, acn2,
        m1, m2, m3, m4, m5, m6, m7, m8, m9, m10, m11, m12,
        n1, n2, n3, n4, n5, n6, n7, n8, n9, n10, n11, n12,
        mt, nt
    FROM sp_rep_npmt_13(:sdt, :edt, 'A');

    INSERT INTO TRepMT(
        id, spid,  ad,
        ac1,  ac2, acn1, acn2,
        m1, m2, m3, m4, m5, m6, m7, m8, m9, m10, m11, m12,
        n1, n2, n3, n4, n5, n6, n7, n8, n9, n10, n11, n12,
        mt, nt)
    SELECT
        id, spid,  ad,
        ac1,  ac2, acn1, acn2,
        m1, m2, m3, m4, m5, m6, m7, m8, m9, m10, m11, m12,
        n1, n2, n3, n4, n5, n6, n7, n8, n9, n10, n11, n12,
        mt, nt
    FROM sp_rep_npmt_12(:sdt, :edt, 'B');
    
    INSERT INTO TRepMT(
        id, spid,  ad,
        ac1,  ac2, acn1, acn2,
        m1, m2, m3, m4, m5, m6, m7, m8, m9, m10, m11, m12,
        n1, n2, n3, n4, n5, n6, n7, n8, n9, n10, n11, n12,
        mt, nt)
    SELECT
        id, spid,  ad,
        ac1,  ac2, acn1, acn2,
        m1, m2, m3, m4, m5, m6, m7, m8, m9, m10, m11, m12,
        n1, n2, n3, n4, n5, n6, n7, n8, n9, n10, n11, n12,
        mt, nt
    FROM sp_rep_npmt_11(:sdt, :edt, 'C');

    INSERT INTO TRepMT(
        id, spid,  ad,
        ac1,  ac2, acn1, acn2,
        m1, m2, m3, m4, m5, m6, m7, m8, m9, m10, m11, m12,
        n1, n2, n3, n4, n5, n6, n7, n8, n9, n10, n11, n12,
        mt, nt)
    SELECT
        id, spid,  ad,
        ac1,  ac2, acn1, acn2,
        m1, m2, m3, m4, m5, m6, m7, m8, m9, m10, m11, m12,
        n1, n2, n3, n4, n5, n6, n7, n8, n9, n10, n11, n12,
        mt, nt
    FROM sp_rep_npmt_13(:sdt, :edt, 'D');

    FOR SELECT *
    FROM TRepMT
    WHERE TRepMT.spid = current_connection

    into
        :id, :spid, :ad, :ac1, :ac2, :acn1, :acn2,
        :m1, :m2, :m3, :m4, :m5, :m6, :m7, :m8, :m9, :m10, :m11, :m12,
        :n1, :n2, :n3, :n4, :n5, :n6, :n7, :n8, :n9, :n10, :n11, :n12,
        :mt, :nt
    do
    begin
        suspend;
    end
end^


ALTER PROCEDURE SP_REP_NPMT_21 (
    SDT DATE,
    EDT DATE,
    PAD VARCHAR(3))
RETURNS (
    ID TYPE OF COLUMN TREPMT.ID,
    SPID TYPE OF COLUMN TREPMT.SPID,
    AD TYPE OF COLUMN TREPMT.AD,
    AC1 TYPE OF COLUMN TREPMT.AC1,
    AC2 TYPE OF COLUMN TREPMT.AC2,
    ACN1 TYPE OF COLUMN TREPMT.ACN1,
    ACN2 TYPE OF COLUMN TREPMT.ACN2,
    M1 TYPE OF COLUMN TREPMT.M1,
    M2 TYPE OF COLUMN TREPMT.M2,
    M3 TYPE OF COLUMN TREPMT.M3,
    M4 TYPE OF COLUMN TREPMT.M4,
    M5 TYPE OF COLUMN TREPMT.M5,
    M6 TYPE OF COLUMN TREPMT.M6,
    M7 TYPE OF COLUMN TREPMT.M7,
    M8 TYPE OF COLUMN TREPMT.M8,
    M9 TYPE OF COLUMN TREPMT.M9,
    M10 TYPE OF COLUMN TREPMT.M10,
    M11 TYPE OF COLUMN TREPMT.M11,
    M12 TYPE OF COLUMN TREPMT.M12,
    N1 TYPE OF COLUMN TREPMT.N1,
    N2 TYPE OF COLUMN TREPMT.N2,
    N3 TYPE OF COLUMN TREPMT.N3,
    N4 TYPE OF COLUMN TREPMT.N4,
    N5 TYPE OF COLUMN TREPMT.N5,
    N6 TYPE OF COLUMN TREPMT.N6,
    N7 TYPE OF COLUMN TREPMT.N7,
    N8 TYPE OF COLUMN TREPMT.N8,
    N9 TYPE OF COLUMN TREPMT.N9,
    N10 TYPE OF COLUMN TREPMT.N10,
    N11 TYPE OF COLUMN TREPMT.N11,
    N12 TYPE OF COLUMN TREPMT.N12,
    MT TYPE OF COLUMN TREPMT.MT,
    NT TYPE OF COLUMN TREPMT.NT)
AS
begin
-- summ√Ñ‚Äújam debeta AC12 un AC14 (izdevumus)
-- uz TRepMT
    FOR SELECT
        gen_id(GEN_TREPMT_ID, 1) as ID,
        current_connection as SPID,
        :pad AS ad,
        T3.AC AS AC1,
        T3.AC2 AS AC2,
        AcP21.Name AS ACN1,
        AcP24.Name AS ACN2,
        M1,M2,M3,M4,M5,M6,M7,M8,M9,M10,M11,M12,
        0.0 AS N1, 0.0 AS N2, 0.0 AS N3, 0.0 AS N4, 0.0 AS N5, 0.0 AS N6,
        0.0 AS N7, 0.0 AS N8, 0.0 AS N9, 0.0 AS N10, 0.0 AS N11, 0.0 AS N12,
        0.0 AS MT, 0.0 AS NT
        
    FROM
    (
        SELECT 
            AC, AC2,
            SUM(CASE WHEN MT = 1 THEN ADb ELSE 0.00 END) AS M1,
            SUM(CASE WHEN MT = 2 THEN ADb ELSE 0.00 END) AS M2,
            SUM(CASE WHEN MT = 3 THEN ADb ELSE 0.00 END) AS M3,
            SUM(CASE WHEN MT = 4 THEN ADb ELSE 0.00 END) AS M4,
            SUM(CASE WHEN MT = 5 THEN ADb ELSE 0.00 END) AS M5,
            SUM(CASE WHEN MT = 6 THEN ADb ELSE 0.00 END) AS M6,
            SUM(CASE WHEN MT = 7 THEN ADb ELSE 0.00 END) AS M7,
            SUM(CASE WHEN MT = 8 THEN ADb ELSE 0.00 END) AS M8,
            SUM(CASE WHEN MT = 9 THEN ADb ELSE 0.00 END) AS M9,
            SUM(CASE WHEN MT = 10 THEN ADb ELSE 0.00 END) AS M10,
            SUM(CASE WHEN MT = 11 THEN ADb ELSE 0.00 END) AS M11,
            SUM(CASE WHEN MT = 12 THEN ADb ELSE 0.00 END) AS M12

        FROM
        (
            SELECT AC, AC2, MT, SUM(SDb) AS ADb, SUM(SCr) AS ACr
            FROM
            (
                SELECT 
                    OPS.AC12 AS AC,
                    OPS.AC14 AS AC2,
                    EXTRACT(MONTH FROM OPSd.Dete) AS MT,
                    OPS.Summ AS SDb,
                    0.00 AS SCr

                FROM 
                    OPSd JOIN OPS ON OPSd.id = OPS.DocId
                    LEFT JOIN AcP21 ON OPS.AC12 = AcP21.AC
                WHERE 
                    OPSd.Dete BETWEEN :sdt AND :edt AND
                    OPS.AC12 IS NOT NULL AND
                    (AcP21.id1 IS NULL OR AcP21.id1 NOT IN ('KA','BA','CN'))

            ) AS T1

            GROUP BY T1.AC, T1.AC2, T1.MT

        ) AS T2
        GROUP BY T2.AC, T2.AC2
    ) AS T3

    LEFT JOIN AcP21 ON AcP21.AC = T3.AC
    LEFT JOIN AcP24 ON AcP24.idx = T3.AC2

    ORDER BY AC1

    into
        :id, :spid, :ad, :ac1, :ac2, :acn1, :acn2,
        :m1, :m2, :m3, :m4, :m5, :m6, :m7, :m8, :m9, :m10, :m11, :m12,
        :n1, :n2, :n3, :n4, :n5, :n6, :n7, :n8, :n9, :n10, :n11, :n12,
        :mt, :nt
  do
  begin
    suspend;
  end
end^


ALTER PROCEDURE SP_REP_NPMT_22 (
    SDT DATE,
    EDT DATE,
    PAD VARCHAR(3))
RETURNS (
    ID TYPE OF COLUMN TREPMT.ID,
    SPID TYPE OF COLUMN TREPMT.SPID,
    AD TYPE OF COLUMN TREPMT.AD,
    AC1 TYPE OF COLUMN TREPMT.AC1,
    AC2 TYPE OF COLUMN TREPMT.AC2,
    ACN1 TYPE OF COLUMN TREPMT.ACN1,
    ACN2 TYPE OF COLUMN TREPMT.ACN2,
    M1 TYPE OF COLUMN TREPMT.M1,
    M2 TYPE OF COLUMN TREPMT.M2,
    M3 TYPE OF COLUMN TREPMT.M3,
    M4 TYPE OF COLUMN TREPMT.M4,
    M5 TYPE OF COLUMN TREPMT.M5,
    M6 TYPE OF COLUMN TREPMT.M6,
    M7 TYPE OF COLUMN TREPMT.M7,
    M8 TYPE OF COLUMN TREPMT.M8,
    M9 TYPE OF COLUMN TREPMT.M9,
    M10 TYPE OF COLUMN TREPMT.M10,
    M11 TYPE OF COLUMN TREPMT.M11,
    M12 TYPE OF COLUMN TREPMT.M12,
    N1 TYPE OF COLUMN TREPMT.N1,
    N2 TYPE OF COLUMN TREPMT.N2,
    N3 TYPE OF COLUMN TREPMT.N3,
    N4 TYPE OF COLUMN TREPMT.N4,
    N5 TYPE OF COLUMN TREPMT.N5,
    N6 TYPE OF COLUMN TREPMT.N6,
    N7 TYPE OF COLUMN TREPMT.N7,
    N8 TYPE OF COLUMN TREPMT.N8,
    N9 TYPE OF COLUMN TREPMT.N9,
    N10 TYPE OF COLUMN TREPMT.N10,
    N11 TYPE OF COLUMN TREPMT.N11,
    N12 TYPE OF COLUMN TREPMT.N12,
    MT TYPE OF COLUMN TREPMT.MT,
    NT TYPE OF COLUMN TREPMT.NT)
AS
begin
-- summ√Ñ‚Äújam debeta AC22 (ie√Ö‚Ä†√Ñ‚Äúmumi)
-- uz TRepMT
    FOR SELECT
        gen_id(GEN_TREPMT_ID, 1) as ID,
        current_connection as SPID,
        :pad AS ad,
        T3.AC AS AC1,
        T3.AC2 AS AC2,
        AcP21.Name AS ACN1,
        AcP24.Name AS ACN2,
        M1,M2,M3,M4,M5,M6,M7,M8,M9,M10,M11,M12,
        0.0 AS N1, 0.0 AS N2, 0.0 AS N3, 0.0 AS N4, 0.0 AS N5, 0.0 AS N6,
        0.0 AS N7, 0.0 AS N8, 0.0 AS N9, 0.0 AS N10, 0.0 AS N11, 0.0 AS N12,
        0.0 AS MT, 0.0 AS NT
        
    FROM
    (
        SELECT 
            AC, AC2,
            SUM(CASE WHEN MT = 1 THEN ACr ELSE 0.00 END) AS M1,
            SUM(CASE WHEN MT = 2 THEN ACr ELSE 0.00 END) AS M2,
            SUM(CASE WHEN MT = 3 THEN ACr ELSE 0.00 END) AS M3,
            SUM(CASE WHEN MT = 4 THEN ACr ELSE 0.00 END) AS M4,
            SUM(CASE WHEN MT = 5 THEN ACr ELSE 0.00 END) AS M5,
            SUM(CASE WHEN MT = 6 THEN ACr ELSE 0.00 END) AS M6,
            SUM(CASE WHEN MT = 7 THEN ACr ELSE 0.00 END) AS M7,
            SUM(CASE WHEN MT = 8 THEN ACr ELSE 0.00 END) AS M8,
            SUM(CASE WHEN MT = 9 THEN ACr ELSE 0.00 END) AS M9,
            SUM(CASE WHEN MT = 10 THEN ACr ELSE 0.00 END) AS M10,
            SUM(CASE WHEN MT = 11 THEN ACr ELSE 0.00 END) AS M11,
            SUM(CASE WHEN MT = 12 THEN ACr ELSE 0.00 END) AS M12

        FROM
        (
            SELECT AC, AC2, MT, SUM(SDb) AS ADb, SUM(SCr) AS ACr
            FROM
            (
                SELECT 
                    OPS.AC22 AS AC,
                    OPS.AC24 AS AC2,
                    EXTRACT(MONTH FROM OPSd.Dete) AS MT,
                    0.00 AS SDb,
                    OPS.Summ AS SCr

                FROM 
                    OPSd JOIN OPS ON OPSd.id = OPS.DocId
                    LEFT JOIN AcP21 ON OPS.AC22 = AcP21.AC
                WHERE 
                    OPSd.Dete BETWEEN :sdt AND :edt AND
                    OPS.AC22 IS NOT NULL AND
                    (AcP21.id1 IS NULL OR AcP21.id1 NOT IN ('KA','BA','CN'))

            ) AS T1

            GROUP BY T1.AC, T1.AC2, T1.MT

        ) AS T2
        GROUP BY T2.AC, T2.AC2
    ) AS T3

    LEFT JOIN AcP21 ON AcP21.AC = T3.AC
    LEFT JOIN AcP24    ON AcP24.idx = T3.AC2

    ORDER BY AC1, AC2

    into
        :id, :spid, :ad, :ac1, :ac2, :acn1, :acn2,
        :m1, :m2, :m3, :m4, :m5, :m6, :m7, :m8, :m9, :m10, :m11, :m12,
        :n1, :n2, :n3, :n4, :n5, :n6, :n7, :n8, :n9, :n10, :n11, :n12,
        :mt, :nt
    do
    begin
        suspend;
    end
end^


ALTER PROCEDURE SP_REP_NPMT_24 (
    SDT DATE,
    EDT DATE)
RETURNS (
    ID TYPE OF COLUMN TREPMT.ID,
    SPID TYPE OF COLUMN TREPMT.SPID,
    AD TYPE OF COLUMN TREPMT.AD,
    AC1 TYPE OF COLUMN TREPMT.AC1,
    AC2 TYPE OF COLUMN TREPMT.AC2,
    ACN1 TYPE OF COLUMN TREPMT.ACN1,
    ACN2 TYPE OF COLUMN TREPMT.ACN2,
    M1 TYPE OF COLUMN TREPMT.M1,
    M2 TYPE OF COLUMN TREPMT.M2,
    M3 TYPE OF COLUMN TREPMT.M3,
    M4 TYPE OF COLUMN TREPMT.M4,
    M5 TYPE OF COLUMN TREPMT.M5,
    M6 TYPE OF COLUMN TREPMT.M6,
    M7 TYPE OF COLUMN TREPMT.M7,
    M8 TYPE OF COLUMN TREPMT.M8,
    M9 TYPE OF COLUMN TREPMT.M9,
    M10 TYPE OF COLUMN TREPMT.M10,
    M11 TYPE OF COLUMN TREPMT.M11,
    M12 TYPE OF COLUMN TREPMT.M12,
    N1 TYPE OF COLUMN TREPMT.N1,
    N2 TYPE OF COLUMN TREPMT.N2,
    N3 TYPE OF COLUMN TREPMT.N3,
    N4 TYPE OF COLUMN TREPMT.N4,
    N5 TYPE OF COLUMN TREPMT.N5,
    N6 TYPE OF COLUMN TREPMT.N6,
    N7 TYPE OF COLUMN TREPMT.N7,
    N8 TYPE OF COLUMN TREPMT.N8,
    N9 TYPE OF COLUMN TREPMT.N9,
    N10 TYPE OF COLUMN TREPMT.N10,
    N11 TYPE OF COLUMN TREPMT.N11,
    N12 TYPE OF COLUMN TREPMT.N12,
    MT TYPE OF COLUMN TREPMT.MT,
    NT TYPE OF COLUMN TREPMT.NT)
AS
begin
    DELETE 
    FROM TRepMT
    WHERE TRepMT.spid = current_connection;

    INSERT INTO TRepMT(
        id, spid,  ad,
        ac1,  ac2, acn1, acn2,
        m1, m2, m3, m4, m5, m6, m7, m8, m9, m10, m11, m12,
        n1, n2, n3, n4, n5, n6, n7, n8, n9, n10, n11, n12,
        mt, nt)
    SELECT
        id, spid,  ad,
        ac1,  ac2, acn1, acn2,
        m1, m2, m3, m4, m5, m6, m7, m8, m9, m10, m11, m12,
        n1, n2, n3, n4, n5, n6, n7, n8, n9, n10, n11, n12,
        mt, nt
    FROM sp_rep_npmt_13(:sdt, :edt, 'A');

    INSERT INTO TRepMT(
        id, spid,  ad,
        ac1,  ac2, acn1, acn2,
        m1, m2, m3, m4, m5, m6, m7, m8, m9, m10, m11, m12,
        n1, n2, n3, n4, n5, n6, n7, n8, n9, n10, n11, n12,
        mt, nt)
    SELECT
        id, spid,  ad,
        ac1,  ac2, acn1, acn2,
        m1, m2, m3, m4, m5, m6, m7, m8, m9, m10, m11, m12,
        n1, n2, n3, n4, n5, n6, n7, n8, n9, n10, n11, n12,
        mt, nt
    FROM sp_rep_npmt_22(:sdt, :edt, 'B');

    INSERT INTO TRepMT(
        id, spid,  ad,
        ac1,  ac2, acn1, acn2,
        m1, m2, m3, m4, m5, m6, m7, m8, m9, m10, m11, m12,
        n1, n2, n3, n4, n5, n6, n7, n8, n9, n10, n11, n12,
        mt, nt)
    SELECT
        id, spid,  ad,
        ac1,  ac2, acn1, acn2,
        m1, m2, m3, m4, m5, m6, m7, m8, m9, m10, m11, m12,
        n1, n2, n3, n4, n5, n6, n7, n8, n9, n10, n11, n12,
        mt, nt
    FROM sp_rep_npmt_21(:sdt, :edt, 'C');

    INSERT INTO TRepMT(
        id, spid,  ad,
        ac1,  ac2, acn1, acn2,
        m1, m2, m3, m4, m5, m6, m7, m8, m9, m10, m11, m12,
        n1, n2, n3, n4, n5, n6, n7, n8, n9, n10, n11, n12,
        mt, nt)
    SELECT
        id, spid,  ad,
        ac1,  ac2, acn1, acn2,
        m1, m2, m3, m4, m5, m6, m7, m8, m9, m10, m11, m12,
        n1, n2, n3, n4, n5, n6, n7, n8, n9, n10, n11, n12,
        mt, nt
    FROM sp_rep_npmt_13(:sdt, :edt, 'D');

    FOR SELECT *
    FROM TRepMT
    WHERE TRepMT.spid = current_connection

    into
        :id, :spid, :ad, :ac1, :ac2, :acn1, :acn2,
        :m1, :m2, :m3, :m4, :m5, :m6, :m7, :m8, :m9, :m10, :m11, :m12,
        :n1, :n2, :n3, :n4, :n5, :n6, :n7, :n8, :n9, :n10, :n11, :n12,
        :mt, :nt
    do
    begin
        suspend;
    end
end^


ALTER PROCEDURE SP_REP_NPMT_31 (
    SDT DATE,
    EDT DATE)
RETURNS (
    ID TYPE OF COLUMN TREPMT.ID,
    SPID TYPE OF COLUMN TREPMT.SPID,
    AD TYPE OF COLUMN TREPMT.AD,
    AC1 TYPE OF COLUMN TREPMT.AC1,
    AC2 TYPE OF COLUMN TREPMT.AC2,
    ACN1 TYPE OF COLUMN TREPMT.ACN1,
    ACN2 TYPE OF COLUMN TREPMT.ACN2,
    M1 TYPE OF COLUMN TREPMT.M1,
    M2 TYPE OF COLUMN TREPMT.M2,
    M3 TYPE OF COLUMN TREPMT.M3,
    M4 TYPE OF COLUMN TREPMT.M4,
    M5 TYPE OF COLUMN TREPMT.M5,
    M6 TYPE OF COLUMN TREPMT.M6,
    M7 TYPE OF COLUMN TREPMT.M7,
    M8 TYPE OF COLUMN TREPMT.M8,
    M9 TYPE OF COLUMN TREPMT.M9,
    M10 TYPE OF COLUMN TREPMT.M10,
    M11 TYPE OF COLUMN TREPMT.M11,
    M12 TYPE OF COLUMN TREPMT.M12,
    N1 TYPE OF COLUMN TREPMT.N1,
    N2 TYPE OF COLUMN TREPMT.N2,
    N3 TYPE OF COLUMN TREPMT.N3,
    N4 TYPE OF COLUMN TREPMT.N4,
    N5 TYPE OF COLUMN TREPMT.N5,
    N6 TYPE OF COLUMN TREPMT.N6,
    N7 TYPE OF COLUMN TREPMT.N7,
    N8 TYPE OF COLUMN TREPMT.N8,
    N9 TYPE OF COLUMN TREPMT.N9,
    N10 TYPE OF COLUMN TREPMT.N10,
    N11 TYPE OF COLUMN TREPMT.N11,
    N12 TYPE OF COLUMN TREPMT.N12,
    MT TYPE OF COLUMN TREPMT.MT,
    NT TYPE OF COLUMN TREPMT.NT)
AS
begin
-- summ√Ñ‚Äújam p√Ñ‚Äúc 3. paz√Ñ¬´mes
-- uz TRepMT
    FOR SELECT
        gen_id(GEN_TREPMT_ID, 1) as ID,
        current_connection as SPID,
        null AS ad,
        T3.AC AS AC1,
        NULL AS AC2,
        Acp23.Name AS ACN1,
        NULL AS ACN2,
        M1,M2,M3,M4,M5,M6,M7,M8,M9,M10,M11,M12,
        N1,N2,N3,N4,N5,N6,N7,N8,N9,N10,N11,N12,
        0.0 AS MT, 0.0 AS NT

    FROM
    (
        SELECT 
            AC,
            SUM(CASE WHEN MT = 0 THEN ADb ELSE 0.00 END) AS MT,
            SUM(CASE WHEN MT = 0 THEN ACr ELSE 0.00 END) AS NT,

            SUM(CASE WHEN MT = 1 THEN ADb ELSE 0.00 END) AS M1,
            SUM(CASE WHEN MT = 2 THEN ADb ELSE 0.00 END) AS M2,
            SUM(CASE WHEN MT = 3 THEN ADb ELSE 0.00 END) AS M3,
            SUM(CASE WHEN MT = 4 THEN ADb ELSE 0.00 END) AS M4,
            SUM(CASE WHEN MT = 5 THEN ADb ELSE 0.00 END) AS M5,
            SUM(CASE WHEN MT = 6 THEN ADb ELSE 0.00 END) AS M6,
            SUM(CASE WHEN MT = 7 THEN ADb ELSE 0.00 END) AS M7,
            SUM(CASE WHEN MT = 8 THEN ADb ELSE 0.00 END) AS M8,
            SUM(CASE WHEN MT = 9 THEN ADb ELSE 0.00 END) AS M9,
            SUM(CASE WHEN MT = 10 THEN ADb ELSE 0.00 END) AS M10,
            SUM(CASE WHEN MT = 11 THEN ADb ELSE 0.00 END) AS M11,
            SUM(CASE WHEN MT = 12 THEN ADb ELSE 0.00 END) AS M12,

            SUM(CASE WHEN MT = 1 THEN ACr ELSE 0.00 END) AS N1,
            SUM(CASE WHEN MT = 2 THEN ACr ELSE 0.00 END) AS N2,
            SUM(CASE WHEN MT = 3 THEN ACr ELSE 0.00 END) AS N3,
            SUM(CASE WHEN MT = 4 THEN ACr ELSE 0.00 END) AS N4,
            SUM(CASE WHEN MT = 5 THEN ACr ELSE 0.00 END) AS N5,
            SUM(CASE WHEN MT = 6 THEN ACr ELSE 0.00 END) AS N6,
            SUM(CASE WHEN MT = 7 THEN ACr ELSE 0.00 END) AS N7,
            SUM(CASE WHEN MT = 8 THEN ACr ELSE 0.00 END) AS N8,
            SUM(CASE WHEN MT = 9 THEN ACr ELSE 0.00 END) AS N9,
            SUM(CASE WHEN MT = 10 THEN ACr ELSE 0.00 END) AS N10,
            SUM(CASE WHEN MT = 11 THEN ACr ELSE 0.00 END) AS N11,
            SUM(CASE WHEN MT = 12 THEN ACr ELSE 0.00 END) AS N12

        FROM
        (
            SELECT AC, MT, SUM(SDb) AS ADb, SUM(SCr) AS ACr
            FROM
            (
                SELECT 
                    OPS.AC13 AS AC,
                    EXTRACT(MONTH FROM OPSd.Dete) AS MT,
                    OPS.Summ AS SDb,
                    0.00 AS SCr
                FROM 
                    OPSd INNER JOIN OPS ON OPSd.id = OPS.DocId
                    INNER JOIN Acp23 AS AP3deb ON OPS.AC13 = AP3deb.idx
                WHERE 
                    OPSd.Dete BETWEEN :sdt AND :edt AND 
                    AP3deb.id2 IN (2,3)

                UNION ALL

                SELECT 
                    OPS.AC23 AS AC,
                    EXTRACT(MONTH FROM OPSd.Dete) AS MT,
                    0.00 AS SDb,
                    OPS.Summ AS SCr

                FROM 
                    OPSd INNER JOIN OPS ON OPSd.id = OPS.DocId
                    INNER JOIN Acp23 AS AP3cre ON OPS.AC23 = AP3cre.idx
                WHERE 
                    OPSd.Dete BETWEEN :sdt AND :edt AND 
                    AP3cre.id2 IN (2,3)

            ) AS T1

            GROUP BY T1.AC, T1.MT

        ) AS T2
        GROUP BY T2.AC
    ) AS T3

    LEFT JOIN Acp23    ON Acp23.idx = T3.AC

    ORDER BY AC1


    into
        :id, :spid, :ad, :ac1, :ac2, :acn1, :acn2,
        :m1, :m2, :m3, :m4, :m5, :m6, :m7, :m8, :m9, :m10, :m11, :m12,
        :n1, :n2, :n3, :n4, :n5, :n6, :n7, :n8, :n9, :n10, :n11, :n12,
        :mt, :nt
  do
  begin
    suspend;
  end
end^


ALTER PROCEDURE SP_REP_NPMT_41 (
    SDT DATE,
    EDT DATE,
    PAD VARCHAR(3))
RETURNS (
    ID TYPE OF COLUMN TREPMT.ID,
    SPID TYPE OF COLUMN TREPMT.SPID,
    AD TYPE OF COLUMN TREPMT.AD,
    AC1 TYPE OF COLUMN TREPMT.AC1,
    AC2 TYPE OF COLUMN TREPMT.AC2,
    ACN1 TYPE OF COLUMN TREPMT.ACN1,
    ACN2 TYPE OF COLUMN TREPMT.ACN2,
    M1 TYPE OF COLUMN TREPMT.M1,
    M2 TYPE OF COLUMN TREPMT.M2,
    M3 TYPE OF COLUMN TREPMT.M3,
    M4 TYPE OF COLUMN TREPMT.M4,
    M5 TYPE OF COLUMN TREPMT.M5,
    M6 TYPE OF COLUMN TREPMT.M6,
    M7 TYPE OF COLUMN TREPMT.M7,
    M8 TYPE OF COLUMN TREPMT.M8,
    M9 TYPE OF COLUMN TREPMT.M9,
    M10 TYPE OF COLUMN TREPMT.M10,
    M11 TYPE OF COLUMN TREPMT.M11,
    M12 TYPE OF COLUMN TREPMT.M12,
    N1 TYPE OF COLUMN TREPMT.N1,
    N2 TYPE OF COLUMN TREPMT.N2,
    N3 TYPE OF COLUMN TREPMT.N3,
    N4 TYPE OF COLUMN TREPMT.N4,
    N5 TYPE OF COLUMN TREPMT.N5,
    N6 TYPE OF COLUMN TREPMT.N6,
    N7 TYPE OF COLUMN TREPMT.N7,
    N8 TYPE OF COLUMN TREPMT.N8,
    N9 TYPE OF COLUMN TREPMT.N9,
    N10 TYPE OF COLUMN TREPMT.N10,
    N11 TYPE OF COLUMN TREPMT.N11,
    N12 TYPE OF COLUMN TREPMT.N12,
    MT TYPE OF COLUMN TREPMT.MT,
    NT TYPE OF COLUMN TREPMT.NT)
AS
begin
-- summ√Ñ‚Äújam debeta AC13 (izdevumus)
-- uz TRepMT
    FOR SELECT
        gen_id(GEN_TREPMT_ID, 1) as ID,
        current_connection as SPID,
        :pad AS ad,
        T3.AC AS AC1,
        NULL AS AC2,
        Acp23.Name AS ACN1,
        NULL AS ACN2,
        M1,M2,M3,M4,M5,M6,M7,M8,M9,M10,M11,M12,
        0.0 AS N1, 0.0 AS N2, 0.0 AS N3, 0.0 AS N4, 0.0 AS N5, 0.0 AS N6,
        0.0 AS N7, 0.0 AS N8, 0.0 AS N9, 0.0 AS N10, 0.0 AS N11, 0.0 AS N12,
        0.0 AS MT, 0.0 AS NT
        
    FROM
    (
        SELECT 
            AC,
            SUM(CASE WHEN MT = 1 THEN ADb ELSE 0.00 END) AS M1,
            SUM(CASE WHEN MT = 2 THEN ADb ELSE 0.00 END) AS M2,
            SUM(CASE WHEN MT = 3 THEN ADb ELSE 0.00 END) AS M3,
            SUM(CASE WHEN MT = 4 THEN ADb ELSE 0.00 END) AS M4,
            SUM(CASE WHEN MT = 5 THEN ADb ELSE 0.00 END) AS M5,
            SUM(CASE WHEN MT = 6 THEN ADb ELSE 0.00 END) AS M6,
            SUM(CASE WHEN MT = 7 THEN ADb ELSE 0.00 END) AS M7,
            SUM(CASE WHEN MT = 8 THEN ADb ELSE 0.00 END) AS M8,
            SUM(CASE WHEN MT = 9 THEN ADb ELSE 0.00 END) AS M9,
            SUM(CASE WHEN MT = 10 THEN ADb ELSE 0.00 END) AS M10,
            SUM(CASE WHEN MT = 11 THEN ADb ELSE 0.00 END) AS M11,
            SUM(CASE WHEN MT = 12 THEN ADb ELSE 0.00 END) AS M12

        FROM
        (
            SELECT AC, MT, SUM(SDb) AS ADb, SUM(SCr) AS ACr
            FROM
            (
                SELECT 
                    OPS.AC13 AS AC,
                    EXTRACT(MONTH FROM OPSd.Dete) AS MT,
                    OPS.Summ AS SDb,
                    0.00 AS SCr
                FROM
                    OPSd JOIN OPS ON OPSd.id = OPS.DocId
                WHERE
                    OPSd.Dete BETWEEN :sdt AND :edt AND
                    OPS.AC13 IS NOT NULL AND
                    OPS.AC13 NOT IN ('KA','BA','CN')

            ) AS T1

            GROUP BY T1.AC, T1.MT

        ) AS T2
        GROUP BY T2.AC
    ) AS T3

    INNER JOIN Acp23 ON Acp23.idx = T3.AC

    ORDER BY AC1

    into
        :id, :spid, :ad, :ac1, :ac2, :acn1, :acn2,
        :m1, :m2, :m3, :m4, :m5, :m6, :m7, :m8, :m9, :m10, :m11, :m12,
        :n1, :n2, :n3, :n4, :n5, :n6, :n7, :n8, :n9, :n10, :n11, :n12,
        :mt, :nt
    do
    begin
        suspend;
    end
end^


ALTER PROCEDURE SP_REP_NPMT_42 (
    SDT DATE,
    EDT DATE,
    PAD VARCHAR(3))
RETURNS (
    ID TYPE OF COLUMN TREPMT.ID,
    SPID TYPE OF COLUMN TREPMT.SPID,
    AD TYPE OF COLUMN TREPMT.AD,
    AC1 TYPE OF COLUMN TREPMT.AC1,
    AC2 TYPE OF COLUMN TREPMT.AC2,
    ACN1 TYPE OF COLUMN TREPMT.ACN1,
    ACN2 TYPE OF COLUMN TREPMT.ACN2,
    M1 TYPE OF COLUMN TREPMT.M1,
    M2 TYPE OF COLUMN TREPMT.M2,
    M3 TYPE OF COLUMN TREPMT.M3,
    M4 TYPE OF COLUMN TREPMT.M4,
    M5 TYPE OF COLUMN TREPMT.M5,
    M6 TYPE OF COLUMN TREPMT.M6,
    M7 TYPE OF COLUMN TREPMT.M7,
    M8 TYPE OF COLUMN TREPMT.M8,
    M9 TYPE OF COLUMN TREPMT.M9,
    M10 TYPE OF COLUMN TREPMT.M10,
    M11 TYPE OF COLUMN TREPMT.M11,
    M12 TYPE OF COLUMN TREPMT.M12,
    N1 TYPE OF COLUMN TREPMT.N1,
    N2 TYPE OF COLUMN TREPMT.N2,
    N3 TYPE OF COLUMN TREPMT.N3,
    N4 TYPE OF COLUMN TREPMT.N4,
    N5 TYPE OF COLUMN TREPMT.N5,
    N6 TYPE OF COLUMN TREPMT.N6,
    N7 TYPE OF COLUMN TREPMT.N7,
    N8 TYPE OF COLUMN TREPMT.N8,
    N9 TYPE OF COLUMN TREPMT.N9,
    N10 TYPE OF COLUMN TREPMT.N10,
    N11 TYPE OF COLUMN TREPMT.N11,
    N12 TYPE OF COLUMN TREPMT.N12,
    MT TYPE OF COLUMN TREPMT.MT,
    NT TYPE OF COLUMN TREPMT.NT)
AS
begin
-- summ√Ñ‚Äújam debeta AC23 (ie√Ö‚Ä†√Ñ‚Äúmumi)
-- uz TRepMT
    FOR SELECT
        gen_id(GEN_TREPMT_ID, 1) as ID,
        current_connection as SPID,
        :pad AS ad,
        T3.AC AS AC1,
        NULL AS AC2,
        Acp23.Name AS ACN1,
        NULL AS ACN2,
        M1,M2,M3,M4,M5,M6,M7,M8,M9,M10,M11,M12,
        0.0 AS N1, 0.0 AS N2, 0.0 AS N3, 0.0 AS N4, 0.0 AS N5, 0.0 AS N6,
        0.0 AS N7, 0.0 AS N8, 0.0 AS N9, 0.0 AS N10, 0.0 AS N11, 0.0 AS N12,
        0.0 AS MT, 0.0 AS NT
        
    FROM
    (
        SELECT 
            AC,
            SUM(CASE WHEN MT = 1 THEN ACr ELSE 0.00 END) AS M1,
            SUM(CASE WHEN MT = 2 THEN ACr ELSE 0.00 END) AS M2,
            SUM(CASE WHEN MT = 3 THEN ACr ELSE 0.00 END) AS M3,
            SUM(CASE WHEN MT = 4 THEN ACr ELSE 0.00 END) AS M4,
            SUM(CASE WHEN MT = 5 THEN ACr ELSE 0.00 END) AS M5,
            SUM(CASE WHEN MT = 6 THEN ACr ELSE 0.00 END) AS M6,
            SUM(CASE WHEN MT = 7 THEN ACr ELSE 0.00 END) AS M7,
            SUM(CASE WHEN MT = 8 THEN ACr ELSE 0.00 END) AS M8,
            SUM(CASE WHEN MT = 9 THEN ACr ELSE 0.00 END) AS M9,
            SUM(CASE WHEN MT = 10 THEN ACr ELSE 0.00 END) AS M10,
            SUM(CASE WHEN MT = 11 THEN ACr ELSE 0.00 END) AS M11,
            SUM(CASE WHEN MT = 12 THEN ACr ELSE 0.00 END) AS M12

        FROM
        (
            SELECT AC, MT, SUM(SDb) AS ADb, SUM(SCr) AS ACr
            FROM
            (
                SELECT 
                    OPS.AC23 AS AC,
                    EXTRACT(MONTH FROM OPSd.Dete) AS MT,
                    0.00 AS SDb,
                    OPS.Summ AS SCr

                FROM 
                    OPSd JOIN OPS ON OPSd.id = OPS.DocId
                WHERE
                    OPSd.Dete BETWEEN :sdt AND :edt AND
                    OPS.AC23 IS NOT NULL AND
                    OPS.AC23 NOT IN ('KA','BA','CN')

            ) AS T1

            GROUP BY T1.AC, T1.MT

        ) AS T2
        GROUP BY T2.AC
    ) AS T3

    LEFT JOIN Acp23 ON Acp23.idx = T3.AC

    ORDER BY AC1

    into
        :id, :spid, :ad, :ac1, :ac2, :acn1, :acn2,
        :m1, :m2, :m3, :m4, :m5, :m6, :m7, :m8, :m9, :m10, :m11, :m12,
        :n1, :n2, :n3, :n4, :n5, :n6, :n7, :n8, :n9, :n10, :n11, :n12,
        :mt, :nt
  do
  begin
    suspend;
  end
end^


ALTER PROCEDURE SP_REP_NPMT_43 (
    SDT DATE,
    EDT DATE,
    PAD VARCHAR(3))
RETURNS (
    ID TYPE OF COLUMN TREPMT.ID,
    SPID TYPE OF COLUMN TREPMT.SPID,
    AD TYPE OF COLUMN TREPMT.AD,
    AC1 TYPE OF COLUMN TREPMT.AC1,
    AC2 TYPE OF COLUMN TREPMT.AC2,
    ACN1 TYPE OF COLUMN TREPMT.ACN1,
    ACN2 TYPE OF COLUMN TREPMT.ACN2,
    M1 TYPE OF COLUMN TREPMT.M1,
    M2 TYPE OF COLUMN TREPMT.M2,
    M3 TYPE OF COLUMN TREPMT.M3,
    M4 TYPE OF COLUMN TREPMT.M4,
    M5 TYPE OF COLUMN TREPMT.M5,
    M6 TYPE OF COLUMN TREPMT.M6,
    M7 TYPE OF COLUMN TREPMT.M7,
    M8 TYPE OF COLUMN TREPMT.M8,
    M9 TYPE OF COLUMN TREPMT.M9,
    M10 TYPE OF COLUMN TREPMT.M10,
    M11 TYPE OF COLUMN TREPMT.M11,
    M12 TYPE OF COLUMN TREPMT.M12,
    N1 TYPE OF COLUMN TREPMT.N1,
    N2 TYPE OF COLUMN TREPMT.N2,
    N3 TYPE OF COLUMN TREPMT.N3,
    N4 TYPE OF COLUMN TREPMT.N4,
    N5 TYPE OF COLUMN TREPMT.N5,
    N6 TYPE OF COLUMN TREPMT.N6,
    N7 TYPE OF COLUMN TREPMT.N7,
    N8 TYPE OF COLUMN TREPMT.N8,
    N9 TYPE OF COLUMN TREPMT.N9,
    N10 TYPE OF COLUMN TREPMT.N10,
    N11 TYPE OF COLUMN TREPMT.N11,
    N12 TYPE OF COLUMN TREPMT.N12,
    MT TYPE OF COLUMN TREPMT.MT,
    NT TYPE OF COLUMN TREPMT.NT)
AS
begin
-- summ√Ñ‚Äújam naudas apgrozijumu pa m√Ñ‚Äún√Ñ‚Äú√ÖÔ£ºiem p√Ñ‚Äúc 3. paz√Ñ¬´mes
-- s√Ñ¬Åkuma atlikumi (pirms sdt) b√Ö¬´s iek√ÖÔ£º MT, NT
    FOR SELECT
        gen_id(GEN_TREPMT_ID, 1) as ID,
        current_connection as SPID,
        :pad AS ad,
        T3.AC AS AC1,
        NULL AS AC2,
        Acp23.Name AS ACN1,
        NULL AS ACN2,
        M1,M2,M3,M4,M5,M6,M7,M8,M9,M10,M11,M12,
        N1,N2,N3,N4,N5,N6,N7,N8,N9,N10,N11,N12,
        MT, NT
    FROM
    (
        SELECT 
            AC,
            SUM(CASE WHEN MT = 0 THEN ADb ELSE 0.00 END) AS MT,
            SUM(CASE WHEN MT = 0 THEN ACr ELSE 0.00 END) AS NT,

            SUM(CASE WHEN MT = 1 THEN ADb ELSE 0.00 END) AS M1,
            SUM(CASE WHEN MT = 2 THEN ADb ELSE 0.00 END) AS M2,
            SUM(CASE WHEN MT = 3 THEN ADb ELSE 0.00 END) AS M3,
            SUM(CASE WHEN MT = 4 THEN ADb ELSE 0.00 END) AS M4,
            SUM(CASE WHEN MT = 5 THEN ADb ELSE 0.00 END) AS M5,
            SUM(CASE WHEN MT = 6 THEN ADb ELSE 0.00 END) AS M6,
            SUM(CASE WHEN MT = 7 THEN ADb ELSE 0.00 END) AS M7,
            SUM(CASE WHEN MT = 8 THEN ADb ELSE 0.00 END) AS M8,
            SUM(CASE WHEN MT = 9 THEN ADb ELSE 0.00 END) AS M9,
            SUM(CASE WHEN MT = 10 THEN ADb ELSE 0.00 END) AS M10,
            SUM(CASE WHEN MT = 11 THEN ADb ELSE 0.00 END) AS M11,
            SUM(CASE WHEN MT = 12 THEN ADb ELSE 0.00 END) AS M12,

            SUM(CASE WHEN MT = 1 THEN ACr ELSE 0.00 END) AS N1,
            SUM(CASE WHEN MT = 2 THEN ACr ELSE 0.00 END) AS N2,
            SUM(CASE WHEN MT = 3 THEN ACr ELSE 0.00 END) AS N3,
            SUM(CASE WHEN MT = 4 THEN ACr ELSE 0.00 END) AS N4,
            SUM(CASE WHEN MT = 5 THEN ACr ELSE 0.00 END) AS N5,
            SUM(CASE WHEN MT = 6 THEN ACr ELSE 0.00 END) AS N6,
            SUM(CASE WHEN MT = 7 THEN ACr ELSE 0.00 END) AS N7,
            SUM(CASE WHEN MT = 8 THEN ACr ELSE 0.00 END) AS N8,
            SUM(CASE WHEN MT = 9 THEN ACr ELSE 0.00 END) AS N9,
            SUM(CASE WHEN MT = 10 THEN ACr ELSE 0.00 END) AS N10,
            SUM(CASE WHEN MT = 11 THEN ACr ELSE 0.00 END) AS N11,
            SUM(CASE WHEN MT = 12 THEN ACr ELSE 0.00 END) AS N12

        FROM
        (
            SELECT AC, MT, SUM(SDb) AS ADb, SUM(SCr) AS ACr
            FROM
            (
                SELECT 
                    OPS.AC13 AS AC,
                    CASE
                        WHEN OPSd.Dete < :sdt THEN 0
                        ELSE EXTRACT(MONTH FROM OPSd.Dete) END AS MT,
                    OPS.Summ AS SDb,
                    0.00 AS SCr

                FROM 
                    OPSd JOIN OPS ON OPSd.id = OPS.DocId
                    INNER JOIN Acp23 ON OPS.AC13 = Acp23.idx

                WHERE 
                    OPSd.Dete <= :edt AND
                    OPS.AC13 IN ('KA','BA','CN')

                UNION ALL

                SELECT 
                    OPS.AC23 AS AC,
                    CASE
                        WHEN OPSd.Dete < :sdt THEN 0
                        ELSE EXTRACT(MONTH FROM OPSd.Dete) END AS MT,
                    0.00 AS SDb,
                    OPS.Summ AS SCr

                FROM 
                    OPSd JOIN OPS ON OPSd.id = OPS.DocId
                    INNER JOIN Acp23 ON OPS.AC23 = Acp23.idx

                WHERE 
                    OPSd.Dete <= :edt AND
                    OPS.AC23 IN ('KA','BA','CN')

                UNION ALL

                    SELECT
                        AcP21.id1 AS AC,
                        0 AS MT,
                        coalesce(Bal0.SummD, 0.00) AS SDb,
                        coalesce(Bal0.SummC, 0.00) AS SCr
                    FROM 
                        Bal0 JOIN AcP21 ON Bal0.AC11 = AcP21.AC
                    WHERE
                        AcP21.id1 IN ('KA','BA','CN')

            ) AS T1

            GROUP BY T1.AC, T1.MT

        ) AS T2

        GROUP BY T2.AC
    ) AS T3

    INNER JOIN Acp23 ON Acp23.idx = T3.AC

    ORDER BY AC1


    into
        :id, :spid, :ad, :ac1, :ac2, :acn1, :acn2,
        :m1, :m2, :m3, :m4, :m5, :m6, :m7, :m8, :m9, :m10, :m11, :m12,
        :n1, :n2, :n3, :n4, :n5, :n6, :n7, :n8, :n9, :n10, :n11, :n12,
        :mt, :nt
    do
    begin
     suspend;
    end
end^


ALTER PROCEDURE SP_REP_NPMT_44 (
    SDT DATE,
    EDT DATE)
RETURNS (
    ID TYPE OF COLUMN TREPMT.ID,
    SPID TYPE OF COLUMN TREPMT.SPID,
    AD TYPE OF COLUMN TREPMT.AD,
    AC1 TYPE OF COLUMN TREPMT.AC1,
    AC2 TYPE OF COLUMN TREPMT.AC2,
    ACN1 TYPE OF COLUMN TREPMT.ACN1,
    ACN2 TYPE OF COLUMN TREPMT.ACN2,
    M1 TYPE OF COLUMN TREPMT.M1,
    M2 TYPE OF COLUMN TREPMT.M2,
    M3 TYPE OF COLUMN TREPMT.M3,
    M4 TYPE OF COLUMN TREPMT.M4,
    M5 TYPE OF COLUMN TREPMT.M5,
    M6 TYPE OF COLUMN TREPMT.M6,
    M7 TYPE OF COLUMN TREPMT.M7,
    M8 TYPE OF COLUMN TREPMT.M8,
    M9 TYPE OF COLUMN TREPMT.M9,
    M10 TYPE OF COLUMN TREPMT.M10,
    M11 TYPE OF COLUMN TREPMT.M11,
    M12 TYPE OF COLUMN TREPMT.M12,
    N1 TYPE OF COLUMN TREPMT.N1,
    N2 TYPE OF COLUMN TREPMT.N2,
    N3 TYPE OF COLUMN TREPMT.N3,
    N4 TYPE OF COLUMN TREPMT.N4,
    N5 TYPE OF COLUMN TREPMT.N5,
    N6 TYPE OF COLUMN TREPMT.N6,
    N7 TYPE OF COLUMN TREPMT.N7,
    N8 TYPE OF COLUMN TREPMT.N8,
    N9 TYPE OF COLUMN TREPMT.N9,
    N10 TYPE OF COLUMN TREPMT.N10,
    N11 TYPE OF COLUMN TREPMT.N11,
    N12 TYPE OF COLUMN TREPMT.N12,
    MT TYPE OF COLUMN TREPMT.MT,
    NT TYPE OF COLUMN TREPMT.NT)
AS
begin
    DELETE 
    FROM TRepMT
    WHERE TRepMT.spid = current_connection;
    
    INSERT INTO TRepMT(
        id, spid,  ad,
        ac1,  ac2, acn1, acn2,
        m1, m2, m3, m4, m5, m6, m7, m8, m9, m10, m11, m12,
        n1, n2, n3, n4, n5, n6, n7, n8, n9, n10, n11, n12,
        mt, nt)
    SELECT
        id, spid,  ad,
        ac1,  ac2, acn1, acn2,
        m1, m2, m3, m4, m5, m6, m7, m8, m9, m10, m11, m12,
        n1, n2, n3, n4, n5, n6, n7, n8, n9, n10, n11, n12,
        mt, nt
    FROM sp_rep_npmt_43(:sdt, :edt, 'A');

    INSERT INTO TRepMT(
        id, spid,  ad,
        ac1,  ac2, acn1, acn2,
        m1, m2, m3, m4, m5, m6, m7, m8, m9, m10, m11, m12,
        n1, n2, n3, n4, n5, n6, n7, n8, n9, n10, n11, n12,
        mt, nt)
    SELECT
        id, spid,  ad,
        ac1,  ac2, acn1, acn2,
        m1, m2, m3, m4, m5, m6, m7, m8, m9, m10, m11, m12,
        n1, n2, n3, n4, n5, n6, n7, n8, n9, n10, n11, n12,
        mt, nt
    FROM sp_rep_npmt_42(:sdt, :edt, 'B');
    
    INSERT INTO TRepMT(
        id, spid,  ad,
        ac1,  ac2, acn1, acn2,
        m1, m2, m3, m4, m5, m6, m7, m8, m9, m10, m11, m12,
        n1, n2, n3, n4, n5, n6, n7, n8, n9, n10, n11, n12,
        mt, nt)
    SELECT
        id, spid,  ad,
        ac1,  ac2, acn1, acn2,
        m1, m2, m3, m4, m5, m6, m7, m8, m9, m10, m11, m12,
        n1, n2, n3, n4, n5, n6, n7, n8, n9, n10, n11, n12,
        mt, nt
    FROM sp_rep_npmt_41(:sdt, :edt, 'C');

    INSERT INTO TRepMT(
        id, spid,  ad,
        ac1,  ac2, acn1, acn2,
        m1, m2, m3, m4, m5, m6, m7, m8, m9, m10, m11, m12,
        n1, n2, n3, n4, n5, n6, n7, n8, n9, n10, n11, n12,
        mt, nt)
    SELECT
        id, spid,  ad,
        ac1,  ac2, acn1, acn2,
        m1, m2, m3, m4, m5, m6, m7, m8, m9, m10, m11, m12,
        n1, n2, n3, n4, n5, n6, n7, n8, n9, n10, n11, n12,
        mt, nt
    FROM sp_rep_npmt_43(:sdt, :edt, 'D');

    FOR SELECT *
    FROM TRepMT
    WHERE TRepMT.spid = current_connection

    into
        :id, :spid, :ad, :ac1, :ac2, :acn1, :acn2,
        :m1, :m2, :m3, :m4, :m5, :m6, :m7, :m8, :m9, :m10, :m11, :m12,
        :n1, :n2, :n3, :n4, :n5, :n6, :n7, :n8, :n9, :n10, :n11, :n12,
        :mt, :nt
    do
    begin
        suspend;
    end
end^


ALTER PROCEDURE SP_REP_PERS_11 (
    SDT DATE,
    EDT DATE,
    PAC VARCHAR(8),
    PCLID VARCHAR(15))
RETURNS (
    ID TYPE OF COLUMN ROPS2A.ID,
    SPID TYPE OF COLUMN ROPS2A.SPID,
    AC TYPE OF COLUMN ROPS2A.AC,
    RAC TYPE OF COLUMN ROPS2A.RAC,
    NAME TYPE OF COLUMN ROPS2A.NAME,
    B0 TYPE OF COLUMN ROPS2A.B0,
    SDB TYPE OF COLUMN ROPS2A.SDB,
    SCR TYPE OF COLUMN ROPS2A.SCR,
    TDB TYPE OF COLUMN ROPS2A.TDB,
    TCR TYPE OF COLUMN ROPS2A.TCR,
    CLID TYPE OF COLUMN ROPS2A.CLID,
    NAME1 TYPE OF COLUMN ROPS2A.NAME1,
    REGNR TYPE OF COLUMN ROPS2A.REGNR,
    RNAME TYPE OF COLUMN ROPS2A.RNAME)
AS
begin
-- apgrozijums p√Ñ‚Äúc 1.paz. un clid
    FOR SELECT
        gen_id(GEN_ROPS2A_ID, 1) as ID,
        current_connection as SPID,
        T2.AC AS AC,
        null as RAC,
        AcP21.Name AS Name,
        T2.ADb - T2.ACr as b0,
        T2.ADb AS SDb,
        T2.ACr AS SCr,
        T2.BDb AS TDb,
        T2.BCr AS TCr,
        T2.ClId AS Clid,
        Persons.Name AS Name1,
        Persons.regnr as regnr,
        null as rname
    FROM
    (
        SELECT AC, ClId, SUM(SDb) AS ADb, SUM(SCr) AS ACr, SUM(TDb) AS BDb, SUM(TCr) AS BCr
        FROM
        (
            SELECT 
                OPS.AC11 AS AC,
                OPSd.ClId AS ClId,
                CASE
                    WHEN OPSd.Dete < :sdt THEN OPS.Summ
                    ELSE 0.00
                END AS SDb,
                0.00 AS SCr,
                CASE
                    WHEN OPSd.Dete >= :sdt THEN OPS.Summ
                    ELSE 0.00
                END AS TDb,
                0.00 AS TCr

            FROM 
                OPSd JOIN OPS ON OPSd.id = OPS.DocId
                INNER JOIN AcP21 ON OPS.AC11 = AcP21.AC
            WHERE 
                OPSd.Dete <= :edt AND 
                OPS.AC11 LIKE :pac AND
                AcP21.id2 IN ('DB','KR') AND
                (:pclid IS NULL OR OPSd.ClId = :pclid)

            UNION ALL

            SELECT 
                OPS.AC21 AS AC,
                OPSd.ClId AS ClId,
                0.00 AS SDb,
                CASE
                    WHEN OPSd.Dete < :sdt THEN OPS.Summ
                    ELSE 0.00
                END AS SCr,
                0.00 AS TDb,
                CASE
                    WHEN OPSd.Dete >= :sdt THEN OPS.Summ
                    ELSE 0.00
                END AS TCr

            FROM 
                OPSd JOIN OPS ON OPSd.id = OPS.DocId
                INNER JOIN AcP21 ON OPS.AC21 = AcP21.AC
            WHERE 
                OPSd.Dete <= :edt AND 
                OPS.AC21 LIKE :pac AND
                AcP21.id2 IN ('DB','KR') AND
                (:pclid IS NULL OR OPSd.ClId = :pclid)

            UNION ALL

            SELECT 
                Bal0.AC11 AS AC,
                Bal0.ClId AS ClId,
                Bal0.SummD AS SDb,
                Bal0.SummC AS SCr,
                0.00 AS TDb,
                0.00 AS TCr
            FROM 
                Bal0 INNER JOIN AcP21 ON Bal0.AC11 = AcP21.AC
            WHERE 
                Bal0.AC11 LIKE :pac AND
                AcP21.id2 IN ('DB','KR') AND
                (:pclid IS NULL OR Bal0.ClId = :pclid)

        ) AS T1

        GROUP BY T1.AC, T1.Clid
    ) AS T2    

    INNER JOIN AcP21 ON AcP21.AC = T2.AC
    INNER JOIN Persons ON Persons.ClId = T2.Clid
    
    WHERE (ADb - ACr) <> 0.00 OR BDb <> 0.00 OR BCr <> 0.00
    ORDER BY AC, Clid

    into
        :id, :spid, :ac, :rac, :name,
        :b0,
        :sdb, :scr, :tdb, :tcr,
        :clid, :name1, :regnr, :rname
    do
    begin
        suspend;
    end

end^


ALTER PROCEDURE SP_REP_PERS_12 (
    SDT DATE,
    EDT DATE,
    PAC VARCHAR(8),
    PCLID VARCHAR(15))
RETURNS (
    ID TYPE OF COLUMN ROPS2A.ID,
    SPID TYPE OF COLUMN ROPS2A.SPID,
    AC TYPE OF COLUMN ROPS2A.AC,
    RAC TYPE OF COLUMN ROPS2A.RAC,
    NAME TYPE OF COLUMN ROPS2A.NAME,
    B0 TYPE OF COLUMN ROPS2A.B0,
    SDB TYPE OF COLUMN ROPS2A.SDB,
    SCR TYPE OF COLUMN ROPS2A.SCR,
    TDB TYPE OF COLUMN ROPS2A.TDB,
    TCR TYPE OF COLUMN ROPS2A.TCR,
    CLID TYPE OF COLUMN ROPS2A.CLID,
    NAME1 TYPE OF COLUMN ROPS2A.NAME1,
    REGNR TYPE OF COLUMN ROPS2A.REGNR,
    RNAME TYPE OF COLUMN ROPS2A.RNAME)
AS
begin
-- apgrozijums p√Ñ‚Äúc clid
    FOR SELECT
        gen_id(GEN_ROPS2A_ID, 1) as ID,
        current_connection as SPID,
        null AS AC,
        null as RAC,
        null AS Name,
        T2.ADb - T2.ACr as b0,
        T2.ADb AS SDb,
        T2.ACr AS SCr,
        T2.BDb AS TDb,
        T2.BCr AS TCr,
        T2.ClId AS Clid,
        Persons.Name AS Name1,
        Persons.regnr as regnr,
        null as rname
    FROM
    (
        SELECT ClId, SUM(SDb) AS ADb, SUM(SCr) AS ACr, SUM(TDb) AS BDb, SUM(TCr) AS BCr
        FROM
        (
            SELECT 
                OPSd.ClId AS ClId,
                CASE
                    WHEN OPSd.Dete < :sdt THEN OPS.Summ
                    ELSE 0.00
                END AS SDb,
                0.00 AS SCr,
                CASE
                    WHEN OPSd.Dete >= :sdt THEN OPS.Summ
                    ELSE 0.00
                END AS TDb,
                0.00 AS TCr

            FROM 
                OPSd JOIN OPS ON OPSd.id = OPS.DocId
                INNER JOIN AcP21 ON OPS.AC11 = AcP21.AC
            WHERE 
                OPSd.Dete <= :edt AND 
                OPS.AC11 LIKE :pac AND
                AcP21.id2 IN ('DB','KR') AND
                (:pclid IS NULL OR OPSd.ClId = :pclid)

            UNION ALL

            SELECT 
                OPSd.ClId AS ClId,
                0.00 AS SDb,
                CASE
                    WHEN OPSd.Dete < :sdt THEN OPS.Summ
                    ELSE 0.00
                END AS SCr,
                0.00 AS TDb,
                CASE
                    WHEN OPSd.Dete >= :sdt THEN OPS.Summ
                    ELSE 0.00
                END AS TCr

            FROM 
                OPSd JOIN OPS ON OPSd.id = OPS.DocId
                INNER JOIN AcP21 ON OPS.AC21 = AcP21.AC
            WHERE 
                OPSd.Dete <= :edt AND 
                OPS.AC21 LIKE :pac AND
                AcP21.id2 IN ('DB','KR') AND
                (:pclid IS NULL OR OPSd.ClId = :pclid)

            UNION ALL

            SELECT 
                Bal0.ClId AS ClId,
                Bal0.SummD AS SDb,
                Bal0.SummC AS SCr,
                0.00 AS TDb,
                0.00 AS TCr
            FROM 
                Bal0 INNER JOIN AcP21 ON Bal0.AC11 = AcP21.AC
            WHERE 
                Bal0.AC11 LIKE :pac AND
                AcP21.id2 IN ('DB','KR') AND
                (:pclid IS NULL OR Bal0.ClId = :pclid)

        ) AS T1

        GROUP BY T1.Clid
    ) AS T2    

    INNER JOIN Persons ON Persons.ClId = T2.Clid
    
    WHERE (ADb - ACr) <> 0.00 OR BDb <> 0.00 OR BCr <> 0.00
    ORDER BY Clid

    into
        :id, :spid, :ac, :rac, :name,
        :b0,
        :sdb, :scr, :tdb, :tcr,
        :clid, :name1, :regnr, :rname
    do
    begin
        suspend;
    end

end^


ALTER PROCEDURE SP_REP_PERS_13 (
    SDT DATE,
    EDT DATE,
    PAC VARCHAR(8),
    PCLID VARCHAR(15))
RETURNS (
    ID TYPE OF COLUMN TREPA1.ID,
    SPID TYPE OF COLUMN TREPA1.SPID,
    I1 TYPE OF COLUMN TREPA1.I1,
    NM TYPE OF COLUMN TREPA1.NM,
    DT TYPE OF COLUMN TREPA1.DT,
    ST TYPE OF COLUMN TREPA1.ST,
    NR TYPE OF COLUMN TREPA1.NR,
    S1 TYPE OF COLUMN TREPA1.S1,
    S2 TYPE OF COLUMN TREPA1.S2,
    S3 TYPE OF COLUMN TREPA1.S3,
    S4 TYPE OF COLUMN TREPA1.S4)
AS
begin
-- neapmaksƒÅtƒÅs pavadzƒ´mess, kas izrakstƒ´tas pƒìc :sdt,
--        vai kur ir bijusi kustƒ´ba pƒìc :edt
    FOR SELECT
        gen_id(GEN_TREPA1_ID, 1) as ID,
        current_connection as SPID,
        T2.ClId AS i1,
        Persons.Name AS nm,
        T2.dt AS dt,
        T2.DocSt AS st,
        T2.DocNr AS nr,
        T2.BDb AS s1,
        T2.BCr AS s2,
        0.0 AS s3, 
        0.0 AS s4
    FROM
    (
        SELECT ClId, COALESCE(MAX(dtx), MIN(dt)) AS dt, DocSt, DocNr, SUM(TDb) AS BDb, SUM(TCr) AS BCr
        FROM
        (
            SELECT 
                OPSd.ClId AS ClId,
                OPSd.Dete AS dt,
                OPSd.DocSt AS DocSt,
                OPSd.DocNr AS DocNr,
                OPS.Summ AS TDb,
                0.00 AS TCr,
                iif(:pac starting '2', OPSd.Dete, null) as dtx

            FROM 
                OPSd JOIN OPS ON OPSd.id = OPS.DocId
                INNER JOIN AcP21 ON OPS.AC11 = AcP21.AC
            WHERE 
                OPS.AC11 LIKE :pac AND
                AcP21.id2 IN ('DB','KR') AND
                (:pclid IS NULL OR OPSd.ClId = :pclid)

            UNION ALL

            SELECT 
                OPSd.ClId AS ClId,
                OPSd.Dete AS dt,
                OPSd.DocSt AS DocSt,
                OPSd.DocNr AS DocNr,
                0.00 AS TDb,
                OPS.Summ AS TCr,
                iif(:pac starting '5', OPSd.Dete, null) as dtx

            FROM 
                OPSd JOIN OPS ON OPSd.id = OPS.DocId
                INNER JOIN AcP21 ON OPS.AC21 = AcP21.AC
            WHERE 
                OPS.AC21 LIKE :pac AND
                AcP21.id2 IN ('DB','KR') AND
                (:pclid IS NULL OR OPSd.ClId = :pclid)

            UNION ALL

            SELECT 
                DOCS0.ClId AS ClId,
                DOCS0.Dete AS dt,
                DOCS0.DocSt AS DocSt,
                DOCS0.DocNr AS DocNr,
                DOCS0.Summ AS TDb,
                0.00 AS TCr,
                iif(:pac starting '2', DOCS0.Dete, null) as dtx

            FROM 
                DOCS0
                INNER JOIN AcP21 ON DOCS0.AC = AcP21.AC
            WHERE 
                DOCS0.Summ > 0.0 AND
                DOCS0.AC LIKE :pac AND
                AcP21.id2 IN ('DB','KR') AND
                (:pclid IS NULL OR DOCS0.ClId = :pclid)

            UNION ALL

            SELECT 
                DOCS0.ClId AS ClId,
                DOCS0.Dete AS dt,
                DOCS0.DocSt AS DocSt,
                DOCS0.DocNr AS DocNr,
                0.00 AS TDb,
                -DOCS0.Summ AS TcR,
                iif(:pac starting '5', DOCS0.Dete, null) as dtx

            FROM 
                DOCS0
                INNER JOIN AcP21 ON DOCS0.AC = AcP21.AC
            WHERE 
                DOCS0.Summ < 0.0 AND
                DOCS0.AC LIKE :pac AND
                AcP21.id2 IN ('DB','KR') AND
                (:pclid IS NULL OR DOCS0.ClId = :pclid)

        ) AS T1

        GROUP BY T1.ClId, T1.DocSt, T1.DocNr
        HAVING MIN(T1.dt) >= :sdt OR MAX(T1.dt) >= :edt

    ) AS T2    
    
    INNER JOIN Persons ON Persons.ClId = T2.Clid
    
    WHERE BDb <> BCr
    ORDER BY i1, dt, nr

    into
        :id, :spid, :i1, :nm, :dt, :st, :nr,
        :s1, :s2, :s3, :s4
    do
    begin
        suspend;
    end
end^


ALTER PROCEDURE SP_REP_PERS_14 (
    SDT DATE,
    EDT DATE,
    PAC VARCHAR(8),
    PCLID VARCHAR(15))
RETURNS (
    ID TYPE OF COLUMN TREPA1.ID,
    SPID TYPE OF COLUMN TREPA1.SPID,
    I1 TYPE OF COLUMN TREPA1.I1,
    NM TYPE OF COLUMN TREPA1.NM,
    DT TYPE OF COLUMN TREPA1.DT,
    ST TYPE OF COLUMN TREPA1.ST,
    NR TYPE OF COLUMN TREPA1.NR,
    S1 TYPE OF COLUMN TREPA1.S1,
    S2 TYPE OF COLUMN TREPA1.S2,
    S3 TYPE OF COLUMN TREPA1.S3,
    S4 TYPE OF COLUMN TREPA1.S4)
AS
begin
-- pavadz√Ñ¬´mes
    FOR SELECT
        gen_id(GEN_TREPA1_ID, 1) as ID,
        current_connection as SPID,
        T2.ClId AS i1,
        Persons.Name AS nm,
        T2.dt AS dt,
        T2.DocSt AS st,
        T2.DocNr AS nr,
        T2.BDb AS s1,
        T2.BCr AS s2,
        0.0 AS s3,
        0.0 AS s4
    FROM
    (
        SELECT ClId, COALESCE(MAX(dtx), MIN(dt)) as dt, DocSt, DocNr, SUM(TDb) AS BDb, SUM(TCr) AS BCr
        FROM
        (
            SELECT 
                OPSd.ClId AS ClId,
                OPSd.Dete AS dt,
                OPSd.DocSt AS DocSt,
                OPSd.DocNr AS DocNr,
                OPS.Summ AS TDb,
                0.00 AS TCr,
                iif(:pac starting '2', OPSd.Dete, null) as dtx

            FROM 
                OPSd JOIN OPS ON OPSd.id = OPS.DocId
                INNER JOIN AcP21 ON OPS.AC11 = AcP21.AC
            WHERE 
                OPSd.Dete BETWEEN :sdt AND :edt AND 
                OPS.AC11 LIKE :pac AND
                AcP21.id2 IN ('DB','KR') AND
                (:pclid IS NULL OR OPSd.ClId = :pclid)

            UNION ALL

            SELECT 
                OPSd.ClId AS ClId,
                OPSd.Dete AS dt,
                OPSd.DocSt AS DocSt,
                OPSd.DocNr AS DocNr,
                0.00 AS TDb,
                OPS.Summ AS TCr,
                iif(:pac starting '5', OPSd.Dete, null) as dtx

            FROM 
                OPSd JOIN OPS ON OPSd.id = OPS.DocId
                INNER JOIN AcP21 ON OPS.AC21 = AcP21.AC
            WHERE 
                OPSd.Dete BETWEEN :sdt AND :edt AND 
                OPS.AC21 LIKE :pac AND
                AcP21.id2 IN ('DB','KR') AND
                (:pclid IS NULL OR OPSd.ClId = :pclid)

        ) AS T1

        GROUP BY T1.ClId, T1.DocSt, T1.DocNr

    ) AS T2    
    
    INNER JOIN Persons ON Persons.ClId = T2.Clid
    
    WHERE BDb <> 0.00 OR BCr <> 0.00
    ORDER BY i1, dt, nr


    into
        :id, :spid, :i1, :nm, :dt, :st, :nr,
        :s1, :s2, :s3, :s4
    do
    begin
        suspend;
    end
end^


ALTER PROCEDURE SP_REP_PERS_15 (
    SDT DATE,
    EDT DATE,
    PAC VARCHAR(8),
    PCLID VARCHAR(15))
RETURNS (
    ID TYPE OF COLUMN TREPA1.ID,
    SPID TYPE OF COLUMN TREPA1.SPID,
    I1 TYPE OF COLUMN TREPA1.I1,
    NM TYPE OF COLUMN TREPA1.NM,
    DT TYPE OF COLUMN TREPA1.DT,
    ST TYPE OF COLUMN TREPA1.ST,
    NR TYPE OF COLUMN TREPA1.NR,
    S1 TYPE OF COLUMN TREPA1.S1,
    S2 TYPE OF COLUMN TREPA1.S2,
    S3 TYPE OF COLUMN TREPA1.S3,
    S4 TYPE OF COLUMN TREPA1.S4)
AS
begin
-- pavadz√Ñ¬´mes
    FOR SELECT
        gen_id(GEN_TREPA1_ID, 1) as ID,
        current_connection as SPID,
        T2.ClId AS i1,
        Persons.Name AS nm,
        T2.dt AS dt,
        T2.DocSt AS st,
        T2.DocNr AS nr,
        T2.BDb AS s1,
        T2.BCr AS s2,
        0.0 AS s3, 
        0.0 AS s4
    FROM
    (
        SELECT ClId, dt, DocSt, DocNr, SUM(TDb) AS BDb, SUM(TCr) AS BCr
        FROM
        (
            SELECT 
                OPSd.ClId AS ClId,
                OPSd.Dete AS dt,
                OPSd.DocSt AS DocSt,
                OPSd.DocNr AS DocNr,
                OPS.Summ AS TDb,
                0.00 AS TCr

            FROM 
                OPSd JOIN OPS ON OPSd.id = OPS.DocId
                INNER JOIN AcP21 ON OPS.AC11 = AcP21.AC
            WHERE 
                OPSd.Dete BETWEEN :sdt AND :edt AND 
                OPS.AC11 LIKE :pac AND
                AcP21.id2 IN ('DB','KR') AND
                (:pclid IS NULL OR OPSd.ClId = :pclid)

            UNION ALL

            SELECT 
                OPSd.ClId AS ClId,
                OPSd.Dete AS dt,
                OPSd.DocSt AS DocSt,
                OPSd.DocNr AS DocNr,
                0.00 AS TDb,
                OPS.Summ AS TCr

            FROM 
                OPSd JOIN OPS ON OPSd.id = OPS.DocId
                INNER JOIN AcP21 ON OPS.AC21 = AcP21.AC
            WHERE 
                OPSd.Dete BETWEEN :sdt AND :edt AND 
                OPS.AC21 LIKE :pac AND
                AcP21.id2 IN ('DB','KR') AND
                (:pclid IS NULL OR OPSd.ClId = :pclid)

        ) AS T1

        GROUP BY T1.ClId, T1.dt, T1.DocSt, T1.DocNr

    ) AS T2    
    
    INNER JOIN Persons ON Persons.ClId = T2.Clid
    
    WHERE BDb <> 0.00 OR BCr <> 0.00
    ORDER BY i1, dt, nr

    into
        :id, :spid, :i1, :nm, :dt, :st, :nr,
        :s1, :s2, :s3, :s4
    do
    begin
        suspend;
    end
end^


ALTER PROCEDURE SP_REP_PERS_16 (
    SDT DATE,
    EDT DATE,
    PAC VARCHAR(8),
    PCLID VARCHAR(15))
RETURNS (
    ID TYPE OF COLUMN TREPA1.ID,
    SPID TYPE OF COLUMN TREPA1.SPID,
    I1 TYPE OF COLUMN TREPA1.I1,
    NM TYPE OF COLUMN TREPA1.NM,
    DT TYPE OF COLUMN TREPA1.DT,
    ST TYPE OF COLUMN TREPA1.ST,
    NR TYPE OF COLUMN TREPA1.NR,
    S1 TYPE OF COLUMN TREPA1.S1,
    S2 TYPE OF COLUMN TREPA1.S2,
    S3 TYPE OF COLUMN TREPA1.S3,
    S4 TYPE OF COLUMN TREPA1.S4)
AS
begin
-- neapmaksƒÅtƒÅs pavadzƒ´mess no :sdt lƒ´dz :edt

    FOR SELECT
        gen_id(GEN_TREPA1_ID, 1) as ID,
        current_connection as SPID,
        T2.ClId AS i1,
        Persons.Name AS nm,
        T2.dt AS dt,
        T2.DocSt AS st,
        T2.DocNr AS nr,
        T2.BDb AS s1,
        T2.BCr AS s2,
        0.0 AS s3, 
        0.0 AS s4
    FROM
    (
        SELECT ClId, COALESCE(MAX(dtx), MIN(dt)) AS dt, DocSt, DocNr, SUM(TDb) AS BDb, SUM(TCr) AS BCr
        FROM
        (
            SELECT 
                OPSd.ClId AS ClId,
                OPSd.Dete AS dt,
                OPSd.DocSt AS DocSt,
                OPSd.DocNr AS DocNr,
                OPS.Summ AS TDb,
                0.00 AS TCr,
                iif(:pac starting '2', OPSd.Dete, null) as dtx

            FROM 
                OPSd JOIN OPS ON OPSd.id = OPS.DocId
                INNER JOIN AcP21 ON OPS.AC11 = AcP21.AC
            WHERE 
                OPSD.dete BETWEEN :SDT AND :EDT AND
                OPS.AC11 LIKE :pac AND
                AcP21.id2 IN ('DB','KR') AND
                (:pclid IS NULL OR OPSd.ClId = :pclid)

            UNION ALL

            SELECT 
                OPSd.ClId AS ClId,
                OPSd.Dete AS dt,
                OPSd.DocSt AS DocSt,
                OPSd.DocNr AS DocNr,
                0.00 AS TDb,
                OPS.Summ AS TCr,
                iif(:pac starting '5', OPSd.Dete, null) as dtx

            FROM 
                OPSd JOIN OPS ON OPSd.id = OPS.DocId
                INNER JOIN AcP21 ON OPS.AC21 = AcP21.AC
            WHERE 
                OPSD.dete BETWEEN :SDT AND :EDT AND
                OPS.AC21 LIKE :pac AND
                AcP21.id2 IN ('DB','KR') AND
                (:pclid IS NULL OR OPSd.ClId = :pclid)

            UNION ALL

            SELECT 
                DOCS0.ClId AS ClId,
                DOCS0.Dete AS dt,
                DOCS0.DocSt AS DocSt,
                DOCS0.DocNr AS DocNr,
                DOCS0.Summ AS TDb,
                0.00 AS TCr,
                iif(:pac starting '2', DOCS0.Dete, null) as dtx

            FROM 
                DOCS0
                INNER JOIN AcP21 ON DOCS0.AC = AcP21.AC
            WHERE 
                DOCS0.Summ > 0.0 AND
                DOCS0.AC LIKE :pac AND
                AcP21.id2 IN ('DB','KR') AND
                (:pclid IS NULL OR DOCS0.ClId = :pclid)

            UNION ALL

            SELECT 
                DOCS0.ClId AS ClId,
                DOCS0.Dete AS dt,
                DOCS0.DocSt AS DocSt,
                DOCS0.DocNr AS DocNr,
                0.00 AS TDb,
                -DOCS0.Summ AS TcR,
                iif(:pac starting '5', DOCS0.Dete, null) as dtx

            FROM 
                DOCS0
                INNER JOIN AcP21 ON DOCS0.AC = AcP21.AC
            WHERE 
                DOCS0.Summ < 0.0 AND
                DOCS0.AC LIKE :pac AND
                AcP21.id2 IN ('DB','KR') AND
                (:pclid IS NULL OR DOCS0.ClId = :pclid)

        ) AS T1

        GROUP BY T1.ClId, T1.DocSt, T1.DocNr

    ) AS T2    
    
    INNER JOIN Persons ON Persons.ClId = T2.Clid
    
    WHERE BDb <> BCr
    ORDER BY i1, dt, nr

    into
        :id, :spid, :i1, :nm, :dt, :st, :nr,
        :s1, :s2, :s3, :s4
    do
    begin
        suspend;
    end
end^


ALTER PROCEDURE SP_REP_PVN_10 (
    SDT DATE,
    EDT DATE)
RETURNS (
    ID TYPE OF COLUMN ROPS2A.ID,
    SPID TYPE OF COLUMN ROPS2A.SPID,
    AC TYPE OF COLUMN ROPS2A.AC,
    RAC TYPE OF COLUMN ROPS2A.RAC,
    NAME TYPE OF COLUMN ROPS2A.NAME,
    B0 TYPE OF COLUMN ROPS2A.B0,
    SDB TYPE OF COLUMN ROPS2A.SDB,
    SCR TYPE OF COLUMN ROPS2A.SCR,
    TDB TYPE OF COLUMN ROPS2A.TDB,
    TCR TYPE OF COLUMN ROPS2A.TCR,
    CLID TYPE OF COLUMN ROPS2A.CLID,
    NAME1 TYPE OF COLUMN ROPS2A.NAME1,
    REGNR TYPE OF COLUMN ROPS2A.REGNR,
    RNAME TYPE OF COLUMN ROPS2A.RNAME)
AS
begin
    FOR SELECT
        gen_id(GEN_ROPS2A_ID, 1) as ID,
        current_connection as SPID,
        T2.AC AS AC,
        null as RAC,
        AcP25.Name AS Name,
        0.0 as b0,
        0.0 AS SDb,
        0.0 AS SCr,
        T2.BDb AS TDb,
        T2.BCr AS TCr,
        null AS Clid,
        null AS Name1,
        null as regnr,
        null as rname
    FROM
    (
        SELECT AC, SUM(TDb) AS BDb, SUM(TCr) AS BCr
        FROM
        (
            SELECT 
                OPS.AC15 AS AC,
                OPS.Summ AS TDb,
                0.00 AS TCr

            FROM OPSd JOIN OPS ON OPSd.id = OPS.DocId
            WHERE OPSd.Dete BETWEEN :sdt AND :edt AND OPS.AC15 IS NOT NULL

            UNION ALL

            SELECT 
                OPS.AC25 AS AC,
                0.00 AS TDb,
                OPS.Summ AS TCr

            FROM OPSd JOIN OPS ON OPSd.id = OPS.DocId
            WHERE OPSd.Dete BETWEEN :sdt AND :edt AND OPS.AC25 IS NOT NULL
        
        ) AS T1
        GROUP BY T1.AC

    ) AS T2    
    LEFT JOIN Acp25 ON Acp25.idx = T2.AC
    
    ORDER BY AC

    into
        :id, :spid, :ac, :rac, :name,
        :b0,
        :sdb, :scr, :tdb, :tcr,
        :clid, :name1, :regnr, :rname
    do
    begin
        suspend;
    end

end^


ALTER PROCEDURE SP_REP_PVN_21 (
    PSD DATE,
    PED DATE,
    RG1 MONEY,
    RG2 MONEY)
RETURNS (
    DID TYPE OF COLUMN TTEMP_PVN1.DID,
    CLID TYPE OF COLUMN TTEMP_PVN1.CLID,
    DOCTYP1 TYPE OF COLUMN TTEMP_PVN1.DOCTYP1,
    DOCTYP2 TYPE OF COLUMN TTEMP_PVN1.DOCTYP2,
    DOCTYPC TYPE OF COLUMN TTEMP_PVN1.DOCTYPC,
    RAC5 TYPE OF COLUMN TTEMP_PVN1.RAC5,
    SUMM TYPE OF COLUMN TTEMP_PVN1.SUMM,
    PVN TYPE OF COLUMN TTEMP_PVN1.PVN,
    SUMMC TYPE OF COLUMN TTEMP_PVN1.SUMMC,
    CUR TYPE OF COLUMN TTEMP_PVN1.CUR)
AS
begin
-- PVN piel 1.1 - izdevumiem
    FOR SELECT
        did,
        clid,
        null AS doctyp1,
        doctyp2,
        doctypc,
        rac5,
        summ,
        pvn,
        0.0 AS summc,
        null AS cur
    FROM
    (
        SELECT 
            T2.did,
            T2.ClId,
            T2.DocTyp2,
            T2.DocTypC,
            T2.RAC5,
            CASE
                WHEN t2.PVND <> 0.00
                THEN t2.SummD
                ELSE -t2.SummC
                END AS Summ,
            CASE
                WHEN t2.PVND <> 0.00
                THEN t2.PVND
                ELSE -t2.PVNC
                END AS PVN
        FROM
        (
            SELECT 
                T1.did,
                MAX(T1.ClId) AS ClId,
                T1.DocTyp2 AS DocTyp2,
                T1.DocTypC AS DocTypC,
                MAX(T1.RAC5) AS RAC5,
                SUM(T1.SummD) AS SummD,
                SUM(T1.PVND) AS PVND,
                SUM(T1.SummC) AS SummC,
                SUM(T1.PVNC) AS PVNC
            FROM
            (
                SELECT 
                    OPSd.id AS did, 
                    OPSd.ClId AS ClId,
                    AcPVN.pz1 AS DocTyp2,
                    AcPVN.pz4 AS DocTypC,
                    OPS.AC15 AS RAC5,
                    0.00 AS SummD,
                    OPS.Summ AS PVND,
                    0.00 AS SummC,
                    0.00 AS PVNC
                FROM
                    OPSd INNER JOIN OPS ON OPSd.id = OPS.DocId
                    INNER JOIN AcPVN ON OPS.AC15 = AcPVN.id
                WHERE
                    (OPSd.Dete BETWEEN :psd AND :ped) AND
                    AcPVN.pz3 IN ('4','5')


                UNION ALL


                SELECT 
                    OPSd.id AS did, 
                    OPSd.ClId AS ClId,
                    AcPVN.pz1 AS DocTyp2,
                    AcPVN.pz4 AS DocTypC,
                    OPS.AC15 AS RAC5,
                    OPS.Summ AS SummD,
                    0.00 AS PVND,
                    0.00 AS SummC,
                    0.00 AS PVNC
                FROM
                    OPSd INNER JOIN OPS ON OPSd.id = OPS.DocId
                    LEFT JOIN AcPVN ON OPS.AC15 = AcPVN.id
                WHERE
                    (OPSd.Dete BETWEEN :psd AND :ped) AND
                     AcPVN.pz3 IN ('8')


                UNION ALL


                SELECT
                    T1A.did AS did,
                    MAX(T1A.ClId) AS ClId,
                    MAX(T1A.DocTyp2) AS DocTyp2,
                    MAX(T1A.DocTypC) AS DocTypC,
                    MAX(T1A.RAC5) AS RAC5,
                    SUM(T1B.Summ) AS SummD,
                    0.00 AS PVND,
                    0.00 AS SummC,
                    0.00 AS PVNC
                FROM
                    (SELECT
                        OPSd.id AS did, 
                        MAX(OPSd.ClId) AS ClId,
                        MAX(AcPVN.pz1) AS DocTyp2,
                        MAX(AcPVN.pz4) AS DocTypC,
                        MAX(OPS.AC15) AS RAC5
                    FROM
                        OPSd INNER JOIN OPS ON OPSd.id = OPS.DocId
                        INNER JOIN AcPVN ON OPS.AC15 = AcPVN.id
                    WHERE
                        (OPSd.Dete BETWEEN :psd AND :ped) AND
                        AcPVN.pz3 IN ('4')
                    GROUP BY OPSd.id
                    ) AS T1A
                    INNER JOIN OPS AS T1B ON T1A.did = T1B.DocId
                WHERE
                    T1B.AC15 IS NULL
                GROUP BY T1A.did

            
                UNION ALL


                -- ATGRIEZTƒÄ PRECE
                SELECT 
                    OPSd.id AS did, 
                    OPSd.ClId AS ClId,
                    AcPVN.pz1 AS DocTyp2,
                    AcPVN.pz4 AS DocTypC,
                    OPS.AC25 AS RAC5,
                    0.00 AS SummD,
                    0.00 AS PVND,
                    0.00 AS SummC,
                    OPS.Summ AS PVNC
                FROM
                    OPSd INNER JOIN OPS ON OPSd.id = OPS.DocId
                    INNER JOIN AcPVN ON OPS.AC25 = AcPVN.id
                WHERE
                    (OPSd.Dete BETWEEN :psd AND :ped) AND
                    AcPVN.pz3 IN ('4','5')

                UNION ALL

                SELECT 
                    OPSd.id AS did, 
                    OPSd.ClId AS ClId,
                    AcPVN.pz1 AS DocTyp2,
                    AcPVN.pz4 AS DocTypC,
                    OPS.AC25 AS RAC5,
                    0.00 AS SummD,
                    0.00 AS PVND,
                    OPS.Summ AS SummC,
                    0.00 AS PVNC
                FROM
                    OPSd INNER JOIN OPS ON OPSd.id = OPS.DocId
                    LEFT JOIN AcPVN ON OPS.AC25 = AcPVN.id
                WHERE
                    (OPSd.Dete BETWEEN :psd AND :ped) AND
                     AcPVN.pz3 IN ('8')


                UNION ALL


                SELECT
                    T1A.did AS did,
                    MAX(T1A.ClId) AS ClId,
                    MAX(T1A.DocTyp2) AS DocTyp2,
                    MAX(T1A.DocTypC) AS DocTypC,
                    MAX(T1A.RAC5) AS RAC5,
                    0.00 AS SummD,
                    0.00 AS PVND,
                    SUM(T1B.Summ) AS SummC,
                    0.00 AS PVNC
                FROM
                    (SELECT
                        OPSd.id AS did, 
                        MAX(OPSd.ClId) AS ClId,
                        MAX(AcPVN.pz1) AS DocTyp2,
                        MAX(AcPVN.pz4) AS DocTypC,
                        MAX(OPS.AC25) AS RAC5
                    FROM
                        OPSd INNER JOIN OPS ON OPSd.id = OPS.DocId
                        INNER JOIN AcPVN ON OPS.AC25 = AcPVN.id
                    WHERE
                        (OPSd.Dete BETWEEN :psd AND :ped) AND
                        AcPVN.pz3 IN ('4')
                    GROUP BY OPSd.id
                    ) AS T1A
                    INNER JOIN OPS AS T1B ON T1A.did = T1B.DocId
                WHERE
                    T1B.AC25 IS NULL
                GROUP BY T1A.did


                UNION ALL
                --ATGRIEZTA PIEGADATA PRECE
                SELECT 
                    OPSd.id AS did, 
                    OPSd.ClId AS ClId,
                    'A' AS DocTyp2,
                    AcPVN.pz4 AS DocTypC,
                    OPS.AC15 AS RAC5,
                    0.00 AS SummD,
                    OPS.Summ AS PVND,
                    0.00 AS SummC,
                    0.00 AS PVNC
                FROM
                    OPSd INNER JOIN OPS ON OPSd.id = OPS.DocId
                    INNER JOIN AcPVN ON OPS.AC15 = AcPVN.id
                WHERE
                    (OPSd.Dete BETWEEN :psd AND :ped) AND
                    AcPVN.pz3 IS NOT NULL AND 
                    AcPVN.pz3 IN ('2') AND
                    AcPVN.pz1 IS NOT NULL AND
                    AcPVN.pz1 IN ('41', '42')
    
                UNION ALL
    
                SELECT 
                    OPSd.id AS did, 
                    OPSd.ClId AS ClId,
                    'A' AS DocTyp2,
                    AcPVN.pz4 AS DocTypC,
                    OPS.AC15 AS RAC5,
                    OPS.Summ AS SummD,
                    0.00 AS PVND,
                    0.00 AS SummC,
                    0.00 AS PVNC
                FROM
                    OPSd INNER JOIN OPS ON OPSd.id = OPS.DocId
                    LEFT JOIN AcPVN ON OPS.AC15 = AcPVN.id
                WHERE
                    OPSd.Dete BETWEEN :psd AND :ped AND
                    AcPVN.pz3 IS NOT NULL AND 
                    AcPVN.pz3 IN ('1') AND
                    AcPVN.pz1 IS NOT NULL AND
                    AcPVN.pz1 IN ('41', '42')


            ) AS T1
            GROUP BY T1.did, T1.DocTyp2, T1.DocTypC
        ) AS T2
    ) AS T3
        
    WHERE 
        T3.Summ <> 0.00 AND
        T3.DocTyp2 IS NOT NULL

    into
        :did, :clid, :doctyp1, :doctyp2, :doctypc,
        :rac5, :summ, :pvn, :summc, :cur
    do
    begin
        suspend;
    end

end^


ALTER PROCEDURE SP_REP_PVN_22 (
    PSD DATE,
    PED DATE,
    RG1 MONEY,
    RG2 MONEY)
RETURNS (
    ID TYPE OF COLUMN ROPS1A.ID,
    SPID TYPE OF COLUMN ROPS1A.SPID,
    DID TYPE OF COLUMN ROPS1A.DID,
    DETE TYPE OF COLUMN ROPS1A.DETE,
    NRX TYPE OF COLUMN ROPS1A.NRX,
    DOCTYP TYPE OF COLUMN ROPS1A.DOCTYP,
    DOCTYP1 TYPE OF COLUMN ROPS1A.DOCTYP1,
    DOCTYP2 TYPE OF COLUMN ROPS1A.DOCTYP2,
    DOCST TYPE OF COLUMN ROPS1A.DOCST,
    DOCNR TYPE OF COLUMN ROPS1A.DOCNR,
    CLID TYPE OF COLUMN ROPS1A.CLID,
    CLID2 TYPE OF COLUMN ROPS1A.CLID2,
    NAME TYPE OF COLUMN ROPS1A.NAME,
    NAME2 TYPE OF COLUMN ROPS1A.NAME2,
    REGNR TYPE OF COLUMN ROPS1A.REGNR,
    REGNR2 TYPE OF COLUMN ROPS1A.REGNR2,
    B0 TYPE OF COLUMN ROPS1A.B0,
    DESCR TYPE OF COLUMN ROPS1A.DESCR,
    DESCR2 TYPE OF COLUMN ROPS1A.DESCR2,
    AC1 TYPE OF COLUMN ROPS1A.AC1,
    AC2 TYPE OF COLUMN ROPS1A.AC2,
    SAC1 TYPE OF COLUMN ROPS1A.SAC1,
    SAC2 TYPE OF COLUMN ROPS1A.SAC2,
    SUMMC TYPE OF COLUMN ROPS1A.SUMMC,
    CUR TYPE OF COLUMN ROPS1A.CUR,
    SUMM TYPE OF COLUMN ROPS1A.SUMM,
    PVN TYPE OF COLUMN ROPS1A.PVN,
    RAC TYPE OF COLUMN ROPS1A.RAC,
    SDB TYPE OF COLUMN ROPS1A.SDB,
    SCR TYPE OF COLUMN ROPS1A.SCR,
    RAC2 TYPE OF COLUMN ROPS1A.RAC2,
    RAC3 TYPE OF COLUMN ROPS1A.RAC3,
    RAC4 TYPE OF COLUMN ROPS1A.RAC4,
    RAC5 TYPE OF COLUMN ROPS1A.RAC5,
    QV TYPE OF COLUMN ROPS1A.QV,
    ZNR TYPE OF COLUMN ROPS1A.ZNR)
AS
begin
-- PVN piel 1.1 - izdevumiem
    
    DELETE FROM ttemp_pvn1 WHERE Did IS NOT NULL;

    INSERT INTO ttemp_pvn1(
        did, clid, doctyp1, doctyp2, doctypc,
        rac5, summ, pvn, summc, cur)
    SELECT
        did, clid, doctyp1, doctyp2, doctypc,
        rac5, summ, pvn, summc, cur
    FROM SP_REP_PVN_21(:PSD, :PED, :RG1, :RG2);


    UPDATE ttemp_pvn1
    SET ttemp_pvn1.summdoc =
        (
            SELECT SUM(ST2.summ)
            FROM
                OPSD AS DT1
                INNER JOIN OPSD AS DT2 ON
                    (DT1.id = ttemp_pvn1.did AND
                     DT1.DETE = DT2.DETE AND
                     DT1.CLID = DT2.CLID AND
                     DT1.DOCTYP = DT2.DOCTYP AND
                     DT1.DOCNR = DT2.DOCNR)
                INNER JOIN ttemp_pvn1 AS ST2 ON ST2.did = DT2.id
        )
    WHERE EXISTS(
            SELECT ID
            FROM OPSD AS DW1
            WHERE
                DW1.id = ttemp_pvn1.did AND
                DW1.CLID IS NOT NULL AND
                DW1.DOCTYP IS NOT NULL AND
                DW1.DOCNR IS NOT NULL);


    UPDATE ttemp_pvn1
    SET ttemp_pvn1.summdoc = ttemp_pvn1.summ
    WHERE NOT EXISTS(
            SELECT ID
            FROM OPSD AS DW1
            WHERE
                DW1.id = ttemp_pvn1.did AND
                DW1.CLID IS NOT NULL AND
                DW1.DOCTYP IS NOT NULL AND
                DW1.DOCNR IS NOT NULL);



    INSERT INTO ttemp_pvn2(clid)
    SELECT TT1.ClId
    FROM ttemp_pvn1 AS TT1
    WHERE 
        TT1.ClId IS NOT NULL AND
        ABS(TT1.SummDoc) < :rg1 AND
        TT1.DocTypC = 0
    GROUP BY TT1.ClId
    HAVING SUM(ABS(TT1.Summ)) < :rg1;


    FOR SELECT
        gen_id(GEN_ROPS1A_ID, 1) as ID,
        current_connection as SPID,
        T4.did,
        CASE
            WHEN OPSd.DT2 IS NULL
            THEN OPSd.Dete
            ELSE OPSd.DT2
            END AS Dete,
        null AS nrx,
        null AS DocTyp,
        DocTyp.pvnpaz AS DocTyp1,
        T4.DocTyp2 AS DocTyp2,
        OPSd.DocSt,
        OPSd.DocNr,
        OPSd.clid AS clid,
        null AS clid2,
        Persons.Name AS Name,
        null AS Name2,
        Persons.PVNRegNr AS RegNr,
        null AS RegNr2,
        0.0 AS b0,
        null AS descr,
        null AS descr2,
        null AS AC1,
        null AS AC2,
        null AS SAC1,
        null AS SAC2,
        0.0 AS SummC,
        'EUR' AS Cur,
        T4.Summ AS Summ,
        T4.PVN AS PVN,
        null AS RAC,
        0.0 AS SDb,
        0.0 AS SCr,
        null AS RAC2,
        null AS RAC3,
        null AS RAC4,
        null AS RAC5,
        0.0 AS QV,
        OPSd.znr AS ZNR

    FROM
    (
        SELECT
            T3.did,
            T3.ClId,
            T3.DocTyp2,
            SUM(T3.Summ) AS Summ,
            SUM(T3.PVN) AS PVN
        FROM
        (    
            SELECT
                -1 AS did,
                NULL AS ClId,
                'T' AS DocTyp2,
                T2.Summ AS Summ,
                T2.PVN AS PVN

            FROM TTEMP_PVN1 AS T2 LEFT JOIN TTEMP_PVN2 AS T21 ON T2.ClId = T21.ClId
            WHERE 
                ((ABS(T2.SummDoc) < :rg1 AND
                T2.DocTypC = 0 AND
                (T2.ClId IS NOT NULL AND T21.ClId IS NOT NULL)))
                OR
                (T2.ClId IS NULL)

            UNION ALL

            SELECT
                -1 AS did,
                T2.ClId AS ClId,
                'V' AS DocTyp2,
                T2.Summ AS Summ,
                T2.PVN AS PVN

            FROM TTEMP_PVN1 AS T2 LEFT JOIN TTEMP_PVN2 AS T21 ON T2.ClId = T21.ClId
            WHERE 
                ABS(T2.SummDoc) < :rg1 AND
                T2.DocTypC = 0 AND
                (T2.ClId IS NOT NULL AND T21.ClId IS NULL)
            
            UNION ALL

            SELECT
                T2.did AS did,
                T2.ClId AS ClId,
                T2.DocTyp2 AS DocTyp2,
                T2.Summ AS Summ,
                T2.PVN AS PVN

            FROM TTEMP_PVN1 AS T2 LEFT JOIN TTEMP_PVN2 AS T21 ON T2.ClId = T21.ClId
            WHERE 
                T2.ClId IS NOT NULL AND
                (ABS(T2.SummDoc) >= :rg1 OR
                T2.DocTypC = 1)

        ) AS T3
        GROUP BY T3.did, T3.ClId, T3.DocTyp2

    ) AS T4 

        LEFT JOIN OPSd ON T4.did = OPSd.id
        LEFT JOIN DocTyp ON OPSd.DocTyp = DocTyp.id
        LEFT JOIN Persons ON T4.ClId = Persons.ClId

    ORDER BY OPSd.Dete


    into
        :id, :spid, :did, :DETE, :nrx,
        :doctyp, :doctyp1, :doctyp2, :docst, :docnr,
        :clid, :clid2, :name, :name2, :regnr, :regnr2,
        :b0, :descr, :descr2, :ac1, :ac2, :sac1,:sac2,
        :summc, :cur, :summ, :pvn, :rac, :sdb, :scr,
        :rac2, :rac3, :rac4, :rac5, :qv, :znr
    do
    begin
        suspend;
    end
end^


ALTER PROCEDURE SP_REP_PVN_31 (
    PSD DATE,
    PED DATE,
    RG1 MONEY,
    RG2 MONEY)
RETURNS (
    DID TYPE OF COLUMN TTEMP_PVN1.DID,
    CLID TYPE OF COLUMN TTEMP_PVN1.CLID,
    DOCTYP1 TYPE OF COLUMN TTEMP_PVN1.DOCTYP1,
    DOCTYP2 TYPE OF COLUMN TTEMP_PVN1.DOCTYP2,
    DOCTYPC TYPE OF COLUMN TTEMP_PVN1.DOCTYPC,
    RAC5 TYPE OF COLUMN TTEMP_PVN1.RAC5,
    SUMM TYPE OF COLUMN TTEMP_PVN1.SUMM,
    PVN TYPE OF COLUMN TTEMP_PVN1.PVN,
    SUMMC TYPE OF COLUMN TTEMP_PVN1.SUMMC,
    CUR TYPE OF COLUMN TTEMP_PVN1.CUR)
AS
begin
-- PVN 1.3. pielikums     (ie≈Üƒìmumi)
    FOR SELECT
        did,
        T2.Clid,
        CASE
            WHEN Summ > :rg1 AND
                (DocTyp.pvnpaz IS NULL OR
                    T2.ClId IS NULL OR
                    Persons.TP3 = 'Nav') THEN 'X'
            ELSE DocTyp.pvnpaz
        END AS DocTyp1,
        DocTyp2, 
        DocTypC, 
        RAC5,
        Summ, 
        PVN,
        0.0 AS summc,
        null AS cur
    FROM
    (
        SELECT 
            T1.did,
            MAX(T1.ClId) AS ClId,
            MAX(T1.DocTyp1) AS DocTyp1,
            MAX(T1.DocTyp2) AS DocTyp2,
            MAX(T1.DocTypC) AS DocTypC,
            MAX(T1.RAC5) AS RAC5,
            SUM(T1.SummC - T1.SummD) AS Summ,
            SUM(T1.PVNC - T1.PVND) AS PVN
        FROM
        (
            SELECT 
                OPSd.id AS did, 
                OPSd.ClId AS ClId,
                OPSd.DocTyp AS DocTyp1,
                AcPVN.pz1 AS DocTyp2,
                AcPVN.pz4 AS DocTypC,
                OPS.AC25 AS RAC5,
                0.00 AS SummD,
                0.00 AS PVND,
                0.00 AS SummC,
                OPS.Summ AS PVNC
            FROM
                OPSd INNER JOIN OPS ON OPSd.id = OPS.DocId
                INNER JOIN AcPVN ON OPS.AC25 = AcPVN.id
            WHERE
                (OPSd.Dete BETWEEN :psd AND :ped) AND
                AcPVN.pz3 IS NOT NULL AND 
                AcPVN.pz3 IN ('2') 

            UNION ALL

            SELECT 
                OPSd.id AS did, 
                OPSd.ClId AS ClId,
                OPSd.DocTyp AS DocTyp1,
                AcPVN.pz1 AS DocTyp2,
                AcPVN.pz4 AS DocTypC,
                OPS.AC25 AS RAC5,
                0.00 AS SummD,
                0.00 AS PVND,
                OPS.Summ AS SummC,
                0.00 AS PVNC
            FROM
                OPSd INNER JOIN OPS ON OPSd.id = OPS.DocId
                LEFT JOIN AcPVN ON OPS.AC25 = AcPVN.id
            WHERE
                OPSd.Dete BETWEEN :psd AND :ped AND
                AcPVN.pz3 IS NOT NULL AND 
                AcPVN.pz3 IN ('1') 

            UNION ALL

            --ATGRIEZTA PRECE
            SELECT 
                OPSd.id AS did, 
                OPSd.ClId AS ClId,
                OPSd.DocTyp AS DocTyp1,
                AcPVN.pz1 AS DocTyp2,
                AcPVN.pz4 AS DocTypC,
                OPS.AC15 AS RAC5,
                0.00 AS SummD,
                OPS.Summ AS PVND,
                0.00 AS SummC,
                0.00 AS PVNC
            FROM
                OPSd INNER JOIN OPS ON OPSd.id = OPS.DocId
                INNER JOIN AcPVN ON OPS.AC15 = AcPVN.id
            WHERE
                (OPSd.Dete BETWEEN :psd AND :ped) AND
                AcPVN.pz3 IS NOT NULL AND 
                AcPVN.pz3 IN ('2') AND
                AcPVN.pz1 IS NOT NULL AND
                AcPVN.pz1 NOT IN ('41', '42')

            UNION ALL

            SELECT 
                OPSd.id AS did, 
                OPSd.ClId AS ClId,
                OPSd.DocTyp AS DocTyp1,
                AcPVN.pz1 AS DocTyp2,
                AcPVN.pz4 AS DocTypC,
                OPS.AC15 AS RAC5,
                OPS.Summ AS SummD,
                0.00 AS PVND,
                0.00 AS SummC,
                0.00 AS PVNC
            FROM
                OPSd INNER JOIN OPS ON OPSd.id = OPS.DocId
                LEFT JOIN AcPVN ON OPS.AC15 = AcPVN.id
            WHERE
                OPSd.Dete BETWEEN :psd AND :ped AND
                AcPVN.pz3 IS NOT NULL AND 
                AcPVN.pz3 IN ('1') AND
                AcPVN.pz1 IS NOT NULL AND
                AcPVN.pz1 NOT IN ('41', '42')



        ) AS T1

        GROUP BY T1.did

    ) AS T2
        LEFT JOIN Persons ON T2.ClId = Persons.clid
        LEFT JOIN DocTyp ON T2.DocTyp1 = DocTyp.id

    WHERE 
        T2.Summ <> 0.00 AND
        T2.DocTyp2 IS NOT NULL

    into
        :did, :clid, :doctyp1, :doctyp2, :doctypc,
        :rac5, :summ, :pvn, :summc, :cur
    do
    begin
        suspend;
    end


end^


ALTER PROCEDURE SP_REP_PVN_32 (
    PSD DATE,
    PED DATE,
    RG1 MONEY,
    RG2 MONEY)
RETURNS (
    ID TYPE OF COLUMN ROPS1A.ID,
    SPID TYPE OF COLUMN ROPS1A.SPID,
    DID TYPE OF COLUMN ROPS1A.DID,
    DETE TYPE OF COLUMN ROPS1A.DETE,
    NRX TYPE OF COLUMN ROPS1A.NRX,
    DOCTYP TYPE OF COLUMN ROPS1A.DOCTYP,
    DOCTYP1 TYPE OF COLUMN ROPS1A.DOCTYP1,
    DOCTYP2 TYPE OF COLUMN ROPS1A.DOCTYP2,
    DOCST TYPE OF COLUMN ROPS1A.DOCST,
    DOCNR TYPE OF COLUMN ROPS1A.DOCNR,
    CLID TYPE OF COLUMN ROPS1A.CLID,
    CLID2 TYPE OF COLUMN ROPS1A.CLID2,
    NAME TYPE OF COLUMN ROPS1A.NAME,
    NAME2 TYPE OF COLUMN ROPS1A.NAME2,
    REGNR TYPE OF COLUMN ROPS1A.REGNR,
    REGNR2 TYPE OF COLUMN ROPS1A.REGNR2,
    B0 TYPE OF COLUMN ROPS1A.B0,
    DESCR TYPE OF COLUMN ROPS1A.DESCR,
    DESCR2 TYPE OF COLUMN ROPS1A.DESCR2,
    AC1 TYPE OF COLUMN ROPS1A.AC1,
    AC2 TYPE OF COLUMN ROPS1A.AC2,
    SAC1 TYPE OF COLUMN ROPS1A.SAC1,
    SAC2 TYPE OF COLUMN ROPS1A.SAC2,
    SUMMC TYPE OF COLUMN ROPS1A.SUMMC,
    CUR TYPE OF COLUMN ROPS1A.CUR,
    SUMM TYPE OF COLUMN ROPS1A.SUMM,
    PVN TYPE OF COLUMN ROPS1A.PVN,
    RAC TYPE OF COLUMN ROPS1A.RAC,
    SDB TYPE OF COLUMN ROPS1A.SDB,
    SCR TYPE OF COLUMN ROPS1A.SCR,
    RAC2 TYPE OF COLUMN ROPS1A.RAC2,
    RAC3 TYPE OF COLUMN ROPS1A.RAC3,
    RAC4 TYPE OF COLUMN ROPS1A.RAC4,
    RAC5 TYPE OF COLUMN ROPS1A.RAC5,
    QV TYPE OF COLUMN ROPS1A.QV,
    ZNR TYPE OF COLUMN ROPS1A.ZNR)
AS
begin
-- PVN 3. pielikums     (ie≈Üƒìmumi)

    
    DELETE FROM ttemp_pvn1 WHERE Did IS NOT NULL;

    INSERT INTO ttemp_pvn1(
        did, clid, doctyp1, doctyp2, doctypc,
        rac5, summ, pvn, summc, cur)
    SELECT
        did, clid, doctyp1, doctyp2, doctypc,
        rac5, summ, pvn, summc, cur
    FROM SP_REP_PVN_31(:PSD, :PED, :RG1, :RG2);


    INSERT INTO ttemp_pvn2(clid)
    SELECT TT1.ClId
    FROM ttemp_pvn1 AS TT1
    WHERE 
        TT1.ClId IS NOT NULL AND
        ABS(TT1.Summ) < :rg1 AND
        TT1.DocTypC = 0
    GROUP BY TT1.ClId
    HAVING SUM(ABS(TT1.Summ)) < :rg1;


    FOR SELECT
        gen_id(GEN_ROPS1A_ID, 1) as ID,
        current_connection as SPID,
        T4.did,
        CASE
            WHEN OPSd.DT2 IS NULL
            THEN OPSd.Dete
            ELSE OPSd.DT2
            END AS Dete,
        null AS nrx,
        null AS DocTyp,
        T4.DocTyp1 AS DocTyp1,
        T4.DocTyp2 AS DocTyp2,
        OPSd.DocSt,
        OPSd.DocNr,
        OPSd.clid AS clid,
        null AS clid2,
        Persons.Name AS Name,
        null AS Name2,
        Persons.PVNRegNr AS RegNr,
        null AS RegNr2,
        0.0 AS b0,
        null AS descr,
        null AS descr2,
        null AS AC1,
        null AS AC2,
        null AS SAC1,
        null AS SAC2,
        0.0 AS SummC,
        'EUR' AS Cur,
        T4.Summ AS Summ,
        T4.PVN AS PVN,
        null AS RAC,
        0.0 AS SDb,
        0.0 AS SCr,
        null AS RAC2,
        null AS RAC3,
        null AS RAC4,
        null AS RAC5,
        0.0 AS QV,
        OPSd.znr AS ZNR
    
    FROM
    (
        SELECT
            T3.did,
            T3.ClId,
            T3.DocTyp1,
            T3.DocTyp2,
            SUM(T3.Summ) AS Summ,
            SUM(T3.PVN) AS PVN
        FROM
        (    
            SELECT
                -1 AS did,
                NULL AS ClId,
                'X' AS DocTyp1,
                T2.DocTyp2 AS DocTyp2,
                T2.Summ AS Summ,
                T2.PVN AS PVN

            FROM TTEMP_PVN1 AS T2
            WHERE 
                T2.DocTyp1 = 'X'

            UNION ALL

            SELECT
                -1 AS did,
                NULL AS ClId,
                'T' AS DocTyp1,
                T2.DocTyp2 AS DocTyp2,
                T2.Summ AS Summ,
                T2.PVN AS PVN

            FROM TTEMP_PVN1 AS T2 LEFT JOIN TTEMP_PVN2 AS T21 ON T2.ClId = T21.ClId
            WHERE 
                (
                    ABS(T2.Summ) < :rg1 AND 
                    T2.DocTypC = 0 AND
                    T21.ClId IS NOT NULL AND
                    T2.DocTyp1 <> 'X'
                ) OR (
                    T2.ClId IS NULL AND
                    T2.DocTyp1 <> 'X'
                )

            UNION ALL

            SELECT
                -1 AS did,
                T2.ClId AS ClId,
                'V' AS DocTyp1,
                T2.DocTyp2 AS DocTyp2,
                T2.Summ AS Summ,
                T2.PVN AS PVN

            FROM TTEMP_PVN1 AS T2 LEFT JOIN TTEMP_PVN2 AS T21 ON T2.ClId = T21.ClId
            WHERE 
                ABS(T2.Summ) < :rg1 AND 
                T2.DocTypC = 0 AND
                T2.ClId IS NOT NULL AND
                T21.ClId IS NULL
            
            UNION ALL

            SELECT
                T2.did AS did,
                T2.ClId AS ClId,
                T2.DocTyp1 AS DocTyp1,
                T2.DocTyp2 AS DocTyp2,
                T2.Summ AS Summ,
                T2.PVN AS PVN

            FROM TTEMP_PVN1 AS T2 LEFT JOIN TTEMP_PVN2 AS T21 ON T2.ClId = T21.ClId
            WHERE 
                (
                    ABS(T2.Summ) >= :rg1 OR
                    T2.DocTypC = 1
                ) AND
                    T2.DocTyp1 <> 'X' AND
                    T2.ClId IS NOT NULL

        ) AS T3
        GROUP BY T3.did, T3.ClId, T3.DocTyp1, T3.DocTyp2

    ) AS T4 

        LEFT JOIN OPSd ON T4.did = OPSd.id
        LEFT JOIN Persons ON T4.ClId = Persons.ClId

    ORDER BY OPSd.Dete


    into
        :id, :spid, :did, :DETE, :nrx,
        :doctyp, :doctyp1, :doctyp2, :docst, :docnr,
        :clid, :clid2, :name, :name2, :regnr, :regnr2,
        :b0, :descr, :descr2, :ac1, :ac2, :sac1,:sac2,
        :summc, :cur, :summ, :pvn, :rac, :sdb, :scr,
        :rac2, :rac3, :rac4, :rac5, :qv, :znr
    do
    begin
        suspend;
    end
end^


ALTER PROCEDURE SP_REP_PVN_41 (
    PSD DATE,
    PED DATE,
    RG1 MONEY,
    RG2 MONEY)
RETURNS (
    ID TYPE OF COLUMN ROPS1A.ID,
    SPID TYPE OF COLUMN ROPS1A.SPID,
    DID TYPE OF COLUMN ROPS1A.DID,
    DETE TYPE OF COLUMN ROPS1A.DETE,
    NRX TYPE OF COLUMN ROPS1A.NRX,
    DOCTYP TYPE OF COLUMN ROPS1A.DOCTYP,
    DOCTYP1 TYPE OF COLUMN ROPS1A.DOCTYP1,
    DOCTYP2 TYPE OF COLUMN ROPS1A.DOCTYP2,
    DOCST TYPE OF COLUMN ROPS1A.DOCST,
    DOCNR TYPE OF COLUMN ROPS1A.DOCNR,
    CLID TYPE OF COLUMN ROPS1A.CLID,
    CLID2 TYPE OF COLUMN ROPS1A.CLID2,
    NAME TYPE OF COLUMN ROPS1A.NAME,
    NAME2 TYPE OF COLUMN ROPS1A.NAME2,
    REGNR TYPE OF COLUMN ROPS1A.REGNR,
    REGNR2 TYPE OF COLUMN ROPS1A.REGNR2,
    B0 TYPE OF COLUMN ROPS1A.B0,
    DESCR TYPE OF COLUMN ROPS1A.DESCR,
    DESCR2 TYPE OF COLUMN ROPS1A.DESCR2,
    AC1 TYPE OF COLUMN ROPS1A.AC1,
    AC2 TYPE OF COLUMN ROPS1A.AC2,
    SAC1 TYPE OF COLUMN ROPS1A.SAC1,
    SAC2 TYPE OF COLUMN ROPS1A.SAC2,
    SUMMC TYPE OF COLUMN ROPS1A.SUMMC,
    CUR TYPE OF COLUMN ROPS1A.CUR,
    SUMM TYPE OF COLUMN ROPS1A.SUMM,
    PVN TYPE OF COLUMN ROPS1A.PVN,
    RAC TYPE OF COLUMN ROPS1A.RAC,
    SDB TYPE OF COLUMN ROPS1A.SDB,
    SCR TYPE OF COLUMN ROPS1A.SCR,
    RAC2 TYPE OF COLUMN ROPS1A.RAC2,
    RAC3 TYPE OF COLUMN ROPS1A.RAC3,
    RAC4 TYPE OF COLUMN ROPS1A.RAC4,
    RAC5 TYPE OF COLUMN ROPS1A.RAC5,
    QV TYPE OF COLUMN ROPS1A.QV,
    ZNR TYPE OF COLUMN ROPS1A.ZNR)
AS
begin
-- PVN2 uz ES pieg√Ñ¬Åd√Ñ¬Åt√Ñ¬Å prece vai pakalpojumi (ie√Ö‚Ä†√Ñ‚Äúmumi)
    FOR SELECT
        gen_id(GEN_ROPS1A_ID, 1) as ID,
        current_connection as SPID,
        did,
        CASE
            WHEN OPSd.DT2 IS NULL
            THEN OPSd.Dete
            ELSE OPSd.DT2
            END AS Dete,
        null AS nrx,
        null AS DocTyp,
        DocTyp.pvnpaz AS DocTyp1,
        T2.DocTyp2, 
        OPSd.DocSt,
        OPSd.DocNr,
        OPSd.clid AS clid,
        null AS clid2,
        Persons.Name AS Name,
        null AS Name2,
        Persons.PVNRegNr AS RegNr,
        null AS RegNr2,
        0.0 AS b0,
        null AS descr,
        null AS descr2,
        null AS AC1,
        null AS AC2,
        null AS SAC1,
        null AS SAC2,
        0.0 AS SummC,
        'EUR' AS Cur,
        T2.Summ AS Summ,  
        T2.PVN AS PVN,
        null AS RAC,
        0.0 AS SDb,
        0.0 AS SCr,
        null AS RAC2,
        null AS RAC3,
        null AS RAC4,
        null AS RAC5,
        0.0 AS QV,
        OPSd.znr AS ZNR

    FROM
    (
        SELECT 
            T1.did,
            T1.ClId,
            T1.DocTyp1,
            MAX(T1.DocTyp2) AS DocTyp2,
            MAX(T1.RAC5) AS RAC5,
            SUM(T1.Summ) AS Summ,
            SUM(T1.PVN) AS PVN
        FROM
        (
            SELECT 
                OPSd.id AS did, 
                OPSd.ClId AS ClId,
                OPSd.DocTyp AS DocTyp1,
                AcPVN.pz1 AS DocTyp2,
                OPS.AC25 AS RAC5,
                OPS.Summ AS Summ,
                0.00 AS PVN
            FROM
                OPSd INNER JOIN OPS ON OPSd.id = OPS.DocId
                LEFT JOIN AcPVN ON OPS.AC25 = AcPVN.id
            WHERE
                OPSd.Dete BETWEEN :psd AND :ped AND
                AcPVN.pz3 IN ('71', '72') 

        ) AS T1

        GROUP BY T1.did, T1.ClId, T1.DocTyp1

    ) AS T2
        INNER JOIN OPSd ON T2.did = OPSd.id
        LEFT JOIN DocTyp ON T2.DocTyp1 = DocTyp.id
        LEFT JOIN Persons ON T2.ClId = Persons.ClId

    WHERE 
        T2.Summ <> 0.00 AND
        T2.DocTyp2 IS NOT NULL

    ORDER BY OPSd.Dete

    into
        :id, :spid, :did, :DETE, :nrx,
        :doctyp, :doctyp1, :doctyp2, :docst, :docnr,
        :clid, :clid2, :name, :name2, :regnr, :regnr2,
        :b0, :descr, :descr2, :ac1, :ac2, :sac1,:sac2,
        :summc, :cur, :summ, :pvn, :rac, :sdb, :scr,
        :rac2, :rac3, :rac4, :rac5, :qv, :znr
    do
    begin
        suspend;
    end
end^


ALTER PROCEDURE SP_REP_PVN_42 (
    PSD DATE,
    PED DATE,
    RG1 MONEY,
    RG2 MONEY)
RETURNS (
    ID TYPE OF COLUMN ROPS1A.ID,
    SPID TYPE OF COLUMN ROPS1A.SPID,
    DID TYPE OF COLUMN ROPS1A.DID,
    DETE TYPE OF COLUMN ROPS1A.DETE,
    NRX TYPE OF COLUMN ROPS1A.NRX,
    DOCTYP TYPE OF COLUMN ROPS1A.DOCTYP,
    DOCTYP1 TYPE OF COLUMN ROPS1A.DOCTYP1,
    DOCTYP2 TYPE OF COLUMN ROPS1A.DOCTYP2,
    DOCST TYPE OF COLUMN ROPS1A.DOCST,
    DOCNR TYPE OF COLUMN ROPS1A.DOCNR,
    CLID TYPE OF COLUMN ROPS1A.CLID,
    CLID2 TYPE OF COLUMN ROPS1A.CLID2,
    NAME TYPE OF COLUMN ROPS1A.NAME,
    NAME2 TYPE OF COLUMN ROPS1A.NAME2,
    REGNR TYPE OF COLUMN ROPS1A.REGNR,
    REGNR2 TYPE OF COLUMN ROPS1A.REGNR2,
    B0 TYPE OF COLUMN ROPS1A.B0,
    DESCR TYPE OF COLUMN ROPS1A.DESCR,
    DESCR2 TYPE OF COLUMN ROPS1A.DESCR2,
    AC1 TYPE OF COLUMN ROPS1A.AC1,
    AC2 TYPE OF COLUMN ROPS1A.AC2,
    SAC1 TYPE OF COLUMN ROPS1A.SAC1,
    SAC2 TYPE OF COLUMN ROPS1A.SAC2,
    SUMMC TYPE OF COLUMN ROPS1A.SUMMC,
    CUR TYPE OF COLUMN ROPS1A.CUR,
    SUMM TYPE OF COLUMN ROPS1A.SUMM,
    PVN TYPE OF COLUMN ROPS1A.PVN,
    RAC TYPE OF COLUMN ROPS1A.RAC,
    SDB TYPE OF COLUMN ROPS1A.SDB,
    SCR TYPE OF COLUMN ROPS1A.SCR,
    RAC2 TYPE OF COLUMN ROPS1A.RAC2,
    RAC3 TYPE OF COLUMN ROPS1A.RAC3,
    RAC4 TYPE OF COLUMN ROPS1A.RAC4,
    RAC5 TYPE OF COLUMN ROPS1A.RAC5,
    QV TYPE OF COLUMN ROPS1A.QV,
    ZNR TYPE OF COLUMN ROPS1A.ZNR)
AS
begin
-- PVN2 uz ES pieg√Ñ¬Åd√Ñ¬Åt√Ñ¬Å prece vai pakalpojumi (ie√Ö‚Ä†√Ñ‚Äúmumi)
    FOR SELECT
        gen_id(GEN_ROPS1A_ID, 1) as ID,
        current_connection as SPID,
        null,
        null AS Dete,
        null AS nrx,
        null AS DocTyp,
        null AS DocTyp1,
        T2.DocTyp2, 
        null AS DocSt,
        null AS DocNr,
        null AS clid,
        null AS clid2,
        Persons.Name AS Name,
        null AS Name2,
        Persons.PVNRegNr AS RegNr,
        null AS RegNr2,
        0.0 AS b0,
        null AS descr,
        null AS descr2,
        null AS AC1,
        null AS AC2,
        null AS SAC1,
        null AS SAC2,
        0.0 AS SummC,
        'EUR' AS Cur,
        T2.Summ AS Summ,
        T2.PVN AS PVN,
        null AS RAC,
        0.0 AS SDb,
        0.0 AS SCr,
        null AS RAC2,
        null AS RAC3,
        null AS RAC4,
        null AS RAC5,
        0.0 AS QV,
        null AS ZNR

    FROM
    (
        SELECT 
            T1.ClId,
            T1.DocTyp2,
            SUM(T1.Summ) AS Summ,
            SUM(T1.PVN) AS PVN
        FROM
        (
            SELECT 
                OPSd.id AS did, 
                OPSd.ClId AS ClId,
                OPSd.DocTyp AS DocTyp1,
                AcPVN.pz1 AS DocTyp2,
                OPS.AC25 AS RAC5,
                OPS.Summ AS Summ,
                0.00 AS PVN
            FROM
                OPSd INNER JOIN OPS ON OPSd.id = OPS.DocId
                LEFT JOIN AcPVN ON OPS.AC25 = AcPVN.id
            WHERE
                OPSd.Dete BETWEEN :psd AND :ped AND
                AcPVN.pz3 IN ('71', '72') 

        ) AS T1

        GROUP BY T1.ClId, T1.DocTyp2

    ) AS T2
        LEFT JOIN Persons ON T2.ClId = Persons.ClId

    WHERE 
        T2.Summ <> 0.00 AND
        T2.DocTyp2 IS NOT NULL


    into
        :id, :spid, :did, :DETE, :nrx,
        :doctyp, :doctyp1, :doctyp2, :docst, :docnr,
        :clid, :clid2, :name, :name2, :regnr, :regnr2,
        :b0, :descr, :descr2, :ac1, :ac2, :sac1,:sac2,
        :summc, :cur, :summ, :pvn, :rac, :sdb, :scr,
        :rac2, :rac3, :rac4, :rac5, :qv, :znr
    do
    begin
        suspend;
    end
end^


ALTER PROCEDURE SP_REP_PVN_51 (
    PSD DATE,
    PED DATE,
    RG1 MONEY,
    RG2 MONEY)
RETURNS (
    DID TYPE OF COLUMN TTEMP_PVN1.DID,
    CLID TYPE OF COLUMN TTEMP_PVN1.CLID,
    DOCTYP1 TYPE OF COLUMN TTEMP_PVN1.DOCTYP1,
    DOCTYP2 TYPE OF COLUMN TTEMP_PVN1.DOCTYP2,
    DOCTYPC TYPE OF COLUMN TTEMP_PVN1.DOCTYPC,
    RAC5 TYPE OF COLUMN TTEMP_PVN1.RAC5,
    SUMM TYPE OF COLUMN TTEMP_PVN1.SUMM,
    PVN TYPE OF COLUMN TTEMP_PVN1.PVN,
    SUMMC TYPE OF COLUMN TTEMP_PVN1.SUMMC,
    CUR TYPE OF COLUMN TTEMP_PVN1.CUR)
AS
begin
-- PVN piel 1.2 - no ES sa√Ö‚Ä†emt√Ñ¬Ås preces, pakalpojumi
    FOR SELECT
        did,
        clid,
        null AS doctyp1,
        doctyp2,
        null AS doctypc,
        rac5,
        summ,
        pvn,
        summc,
        curr AS CUR
    FROM
    (
        SELECT 
            T2.did,
            T2.ClId,
            T2.DocTyp2,
            T2.RAC5,
            T2.SummD AS Summ,
            T2.PVND AS PVN,
            T2.SummC,
            T2.Curr
        FROM
        (
            SELECT 
                T1.did,
                MAX(T1.ClId) AS ClId,
                MAX(T1.DocTyp2) AS DocTyp2,
                MAX(T1.RAC5) AS RAC5,
                SUM(T1.SummD) AS SummD,
                SUM(T1.PVND) AS PVND,
                SUM(T1.SummC) AS SummC,
                MAX(T1.Curr) AS Curr
            FROM
            (
                SELECT 
                    OPSd.id AS did, 
                    OPSd.ClId AS ClId,
                    AcPVN.pz1 AS DocTyp2,
                    OPS.AC15 AS RAC5,
                    0.00 AS SummD,
                    -OPS.Summ AS PVND,
                    0.00 AS SummC,
                    '' AS Curr
                FROM
                    OPSd INNER JOIN OPS ON OPSd.id = OPS.DocId
                    INNER JOIN AcPVN ON OPS.AC15 = AcPVN.id
                WHERE
                    (OPSd.Dete BETWEEN :psd AND :ped) AND
                    AcPVN.pz3 IS NOT NULL AND 
                    AcPVN.pz3 IN ('13') 

                UNION ALL

                SELECT 
                    OPSd.id AS did, 
                    OPSd.ClId AS ClId,
                    AcPVN.pz1 AS DocTyp2,
                    OPS.AC15 AS RAC5,
                    -OPS.Summ AS SummD,
                    0.00 AS PVND,
                    -OPS.SummC AS SummC,
                    OPS.Cur AS Curr
                FROM
                    OPSd INNER JOIN OPS ON OPSd.id = OPS.DocId
                    LEFT JOIN AcPVN ON OPS.AC15 = AcPVN.id
                WHERE
                    (OPSd.Dete BETWEEN :psd AND :ped) AND
                    AcPVN.pz3 IS NOT NULL AND 
                    AcPVN.pz3 IN ('12') 

                UNION ALL
            
                -- ATGRIEZT√Ñ‚Ç¨ PRECE 
                SELECT 
                    OPSd.id AS did, 
                    OPSd.ClId AS ClId,
                    AcPVN.pz1 AS DocTyp2,
                    OPS.AC25 AS RAC5,
                    0.00 AS SummD,
                    OPS.Summ AS PVND,
                    0.00 AS SummC,
                    '' AS Curr
                FROM
                    OPSd INNER JOIN OPS ON OPSd.id = OPS.DocId
                    INNER JOIN AcPVN ON OPS.AC25 = AcPVN.id
                WHERE
                    (OPSd.Dete BETWEEN :psd AND :ped) AND
                    AcPVN.pz3 IS NOT NULL AND 
                    AcPVN.pz3 IN ('13') 

                UNION ALL

                SELECT 
                    OPSd.id AS did, 
                    OPSd.ClId AS ClId,
                    AcPVN.pz1 AS DocTyp2,
                    OPS.AC25 AS RAC5,
                    OPS.Summ AS SummD,
                    0.00 AS PVND,
                    OPS.Summ AS SummC,
                    OPS.Cur AS Curr
                FROM
                    OPSd INNER JOIN OPS ON OPSd.id = OPS.DocId
                    LEFT JOIN AcPVN ON OPS.AC25 = AcPVN.id
                WHERE
                    (OPSd.Dete BETWEEN :psd AND :ped) AND
                    AcPVN.pz3 IS NOT NULL AND 
                    AcPVN.pz3 IN ('12') 


            ) AS T1
            GROUP BY T1.did
        ) AS T2
    ) AS T3
        
    WHERE 
        T3.Summ <> 0.00 AND
        T3.DocTyp2 IS NOT NULL

    into
        :did, :clid, :doctyp1, :doctyp2, :doctypc,
        :rac5, :summ, :pvn, :summc, :cur
    do
    begin
        suspend;
    end



end^


ALTER PROCEDURE SP_REP_PVN_52 (
    PSD DATE,
    PED DATE,
    RG1 MONEY,
    RG2 MONEY)
RETURNS (
    ID TYPE OF COLUMN ROPS1A.ID,
    SPID TYPE OF COLUMN ROPS1A.SPID,
    DID TYPE OF COLUMN ROPS1A.DID,
    DETE TYPE OF COLUMN ROPS1A.DETE,
    NRX TYPE OF COLUMN ROPS1A.NRX,
    DOCTYP TYPE OF COLUMN ROPS1A.DOCTYP,
    DOCTYP1 TYPE OF COLUMN ROPS1A.DOCTYP1,
    DOCTYP2 TYPE OF COLUMN ROPS1A.DOCTYP2,
    DOCST TYPE OF COLUMN ROPS1A.DOCST,
    DOCNR TYPE OF COLUMN ROPS1A.DOCNR,
    CLID TYPE OF COLUMN ROPS1A.CLID,
    CLID2 TYPE OF COLUMN ROPS1A.CLID2,
    NAME TYPE OF COLUMN ROPS1A.NAME,
    NAME2 TYPE OF COLUMN ROPS1A.NAME2,
    REGNR TYPE OF COLUMN ROPS1A.REGNR,
    REGNR2 TYPE OF COLUMN ROPS1A.REGNR2,
    B0 TYPE OF COLUMN ROPS1A.B0,
    DESCR TYPE OF COLUMN ROPS1A.DESCR,
    DESCR2 TYPE OF COLUMN ROPS1A.DESCR2,
    AC1 TYPE OF COLUMN ROPS1A.AC1,
    AC2 TYPE OF COLUMN ROPS1A.AC2,
    SAC1 TYPE OF COLUMN ROPS1A.SAC1,
    SAC2 TYPE OF COLUMN ROPS1A.SAC2,
    SUMMC TYPE OF COLUMN ROPS1A.SUMMC,
    CUR TYPE OF COLUMN ROPS1A.CUR,
    SUMM TYPE OF COLUMN ROPS1A.SUMM,
    PVN TYPE OF COLUMN ROPS1A.PVN,
    RAC TYPE OF COLUMN ROPS1A.RAC,
    SDB TYPE OF COLUMN ROPS1A.SDB,
    SCR TYPE OF COLUMN ROPS1A.SCR,
    RAC2 TYPE OF COLUMN ROPS1A.RAC2,
    RAC3 TYPE OF COLUMN ROPS1A.RAC3,
    RAC4 TYPE OF COLUMN ROPS1A.RAC4,
    RAC5 TYPE OF COLUMN ROPS1A.RAC5,
    QV TYPE OF COLUMN ROPS1A.QV,
    ZNR TYPE OF COLUMN ROPS1A.ZNR)
AS
begin
-- PVN piel 1.2 - no ES sa√Ö‚Ä†emt√Ñ¬Ås preces, pakalpojumi
    
    DELETE FROM ttemp_pvn1 WHERE Did IS NOT NULL;

    INSERT INTO ttemp_pvn1(
        did, clid, doctyp1, doctyp2, doctypc,
        rac5, summ, pvn, summc, cur)
    SELECT
        did, clid, doctyp1, doctyp2, doctypc,
        rac5, summ, pvn, summc, cur
    FROM SP_REP_PVN_51(:PSD, :PED, :RG1, :RG2);

    FOR SELECT
        gen_id(GEN_ROPS1A_ID, 1) as ID,
        current_connection as SPID,
        T4.did,
        CASE
            WHEN OPSd.DT2 IS NULL
            THEN OPSd.Dete
            ELSE OPSd.DT2
            END AS Dete,
        null AS nrx,
        null AS DocTyp,
        DocTyp.pvnpaz AS DocTyp1,
        T4.DocTyp2 AS DocTyp2,
        OPSd.DocSt,
        OPSd.DocNr,
        OPSd.clid AS clid,
        null AS clid2,
        Persons.Name AS Name,
        null AS Name2,
        Persons.PVNRegNr AS RegNr,
        null AS RegNr2,
        0.0 AS b0,
        null AS descr,
        null AS descr2,
        null AS AC1,
        null AS AC2,
        null AS SAC1,
        null AS SAC2,
        T4.SummC AS SummC,
        T4.Curr AS Cur,
        T4.Summ AS Summ,
        T4.PVN AS PVN,
        null AS RAC,
        0.0 AS SDb,
        0.0 AS SCr,
        null AS RAC2,
        null AS RAC3,
        null AS RAC4,
        null AS RAC5,
        0.0 AS QV,
        OPSd.znr AS ZNR

    FROM
    (
        SELECT
            T2.did AS did,
            T2.ClId AS ClId,
            T2.DocTyp2 AS DocTyp2,
            T2.Summ AS Summ,
            T2.PVN AS PVN,
            T2.SummC AS SummC,
            T2.Cur AS Curr

        FROM ttemp_pvn1 AS T2

    ) AS T4 

        LEFT JOIN OPSd ON T4.did = OPSd.id
        LEFT JOIN DocTyp ON OPSd.DocTyp = DocTyp.id
        LEFT JOIN Persons ON T4.ClId = Persons.ClId

    ORDER BY OPSd.Dete


    into
        :id, :spid, :did, :DETE, :nrx,
        :doctyp, :doctyp1, :doctyp2, :docst, :docnr,
        :clid, :clid2, :name, :name2, :regnr, :regnr2,
        :b0, :descr, :descr2, :ac1, :ac2, :sac1,:sac2,
        :summc, :cur, :summ, :pvn, :rac, :sdb, :scr,
        :rac2, :rac3, :rac4, :rac5, :qv, :znr
    do
    begin
        suspend;
    end
end^


ALTER PROCEDURE SP_REP_PVN_CHECK_01 (
    PSD DATE,
    PED DATE,
    RG1 MONEY,
    LIKME MONEY)
RETURNS (
    ID TYPE OF COLUMN ROPS1A.ID,
    SPID TYPE OF COLUMN ROPS1A.SPID,
    DID TYPE OF COLUMN ROPS1A.DID,
    DETE TYPE OF COLUMN ROPS1A.DETE,
    NRX TYPE OF COLUMN ROPS1A.NRX,
    DOCTYP TYPE OF COLUMN ROPS1A.DOCTYP,
    DOCTYP1 TYPE OF COLUMN ROPS1A.DOCTYP1,
    DOCTYP2 TYPE OF COLUMN ROPS1A.DOCTYP2,
    DOCST TYPE OF COLUMN ROPS1A.DOCST,
    DOCNR TYPE OF COLUMN ROPS1A.DOCNR,
    CLID TYPE OF COLUMN ROPS1A.CLID,
    CLID2 TYPE OF COLUMN ROPS1A.CLID2,
    NAME TYPE OF COLUMN ROPS1A.NAME,
    NAME2 TYPE OF COLUMN ROPS1A.NAME2,
    REGNR TYPE OF COLUMN ROPS1A.REGNR,
    REGNR2 TYPE OF COLUMN ROPS1A.REGNR2,
    B0 TYPE OF COLUMN ROPS1A.B0,
    DESCR TYPE OF COLUMN ROPS1A.DESCR,
    DESCR2 TYPE OF COLUMN ROPS1A.DESCR2,
    AC1 TYPE OF COLUMN ROPS1A.AC1,
    AC2 TYPE OF COLUMN ROPS1A.AC2,
    SAC1 TYPE OF COLUMN ROPS1A.SAC1,
    SAC2 TYPE OF COLUMN ROPS1A.SAC2,
    SUMMC TYPE OF COLUMN ROPS1A.SUMMC,
    CUR TYPE OF COLUMN ROPS1A.CUR,
    SUMM TYPE OF COLUMN ROPS1A.SUMM,
    PVN TYPE OF COLUMN ROPS1A.PVN,
    RAC TYPE OF COLUMN ROPS1A.RAC,
    SDB TYPE OF COLUMN ROPS1A.SDB,
    SCR TYPE OF COLUMN ROPS1A.SCR,
    RAC2 TYPE OF COLUMN ROPS1A.RAC2,
    RAC3 TYPE OF COLUMN ROPS1A.RAC3,
    RAC4 TYPE OF COLUMN ROPS1A.RAC4,
    RAC5 TYPE OF COLUMN ROPS1A.RAC5,
    QV TYPE OF COLUMN ROPS1A.QV,
    ZNR TYPE OF COLUMN ROPS1A.ZNR)
AS
begin
-- PVN summu kontrole izdevumiem
    
    FOR SELECT
        gen_id(GEN_ROPS1A_ID, 1) as ID,
        current_connection as SPID,
        T4.did,
        OPSd.Dete AS Dete,
        null AS nrx,
        null AS DocTyp,
        DocTyp.pvnpaz AS DocTyp1,
        T4.DocTyp2 AS DocTyp2,
        OPSd.DocSt,
        OPSd.DocNr,
        OPSd.clid AS clid,
        null AS clid2,
        Persons.Name AS Name,
        null AS Name2,
        Persons.PVNRegNr AS RegNr,
        null AS RegNr2,
        0.0 AS b0,
        null AS descr,
        null AS descr2,
        null AS AC1,
        null AS AC2,
        null AS SAC1,
        null AS SAC2,
        0.0 AS SummC,
        'EUR' AS Cur,
        T4.Summ AS Summ,
        T4.PVN AS PVN,
        null AS RAC,
        0.0 AS SDb,
        0.0 AS SCr,
        null AS RAC2,
        null AS RAC3,
        null AS RAC4,
        null AS RAC5,
        0.0 AS QV,
        OPSd.znr AS ZNR

    FROM
    (
        SELECT
            did, clid, doctyp1, doctyp2, doctypc,
            rac5, summ, pvn, summc, cur
        FROM SP_REP_PVN_21(:PSD, :PED, 0.0, 0.0)
        WHERE ABS(ABS(summ * :LIKME) - ABS(pvn)) >= :RG1

    ) AS T4 

        LEFT JOIN OPSd ON T4.did = OPSd.id
        LEFT JOIN DocTyp ON OPSd.DocTyp = DocTyp.id
        LEFT JOIN Persons ON T4.ClId = Persons.ClId

    ORDER BY OPSd.Dete


    into
        :id, :spid, :did, :DETE, :nrx,
        :doctyp, :doctyp1, :doctyp2, :docst, :docnr,
        :clid, :clid2, :name, :name2, :regnr, :regnr2,
        :b0, :descr, :descr2, :ac1, :ac2, :sac1,:sac2,
        :summc, :cur, :summ, :pvn, :rac, :sdb, :scr,
        :rac2, :rac3, :rac4, :rac5, :qv, :znr
    do
    begin
        suspend;
    end
end^


ALTER PROCEDURE SP_REP_PVN_CHECK_02 (
    PSD DATE,
    PED DATE,
    RG1 MONEY,
    LIKME MONEY)
RETURNS (
    ID TYPE OF COLUMN ROPS1A.ID,
    SPID TYPE OF COLUMN ROPS1A.SPID,
    DID TYPE OF COLUMN ROPS1A.DID,
    DETE TYPE OF COLUMN ROPS1A.DETE,
    NRX TYPE OF COLUMN ROPS1A.NRX,
    DOCTYP TYPE OF COLUMN ROPS1A.DOCTYP,
    DOCTYP1 TYPE OF COLUMN ROPS1A.DOCTYP1,
    DOCTYP2 TYPE OF COLUMN ROPS1A.DOCTYP2,
    DOCST TYPE OF COLUMN ROPS1A.DOCST,
    DOCNR TYPE OF COLUMN ROPS1A.DOCNR,
    CLID TYPE OF COLUMN ROPS1A.CLID,
    CLID2 TYPE OF COLUMN ROPS1A.CLID2,
    NAME TYPE OF COLUMN ROPS1A.NAME,
    NAME2 TYPE OF COLUMN ROPS1A.NAME2,
    REGNR TYPE OF COLUMN ROPS1A.REGNR,
    REGNR2 TYPE OF COLUMN ROPS1A.REGNR2,
    B0 TYPE OF COLUMN ROPS1A.B0,
    DESCR TYPE OF COLUMN ROPS1A.DESCR,
    DESCR2 TYPE OF COLUMN ROPS1A.DESCR2,
    AC1 TYPE OF COLUMN ROPS1A.AC1,
    AC2 TYPE OF COLUMN ROPS1A.AC2,
    SAC1 TYPE OF COLUMN ROPS1A.SAC1,
    SAC2 TYPE OF COLUMN ROPS1A.SAC2,
    SUMMC TYPE OF COLUMN ROPS1A.SUMMC,
    CUR TYPE OF COLUMN ROPS1A.CUR,
    SUMM TYPE OF COLUMN ROPS1A.SUMM,
    PVN TYPE OF COLUMN ROPS1A.PVN,
    RAC TYPE OF COLUMN ROPS1A.RAC,
    SDB TYPE OF COLUMN ROPS1A.SDB,
    SCR TYPE OF COLUMN ROPS1A.SCR,
    RAC2 TYPE OF COLUMN ROPS1A.RAC2,
    RAC3 TYPE OF COLUMN ROPS1A.RAC3,
    RAC4 TYPE OF COLUMN ROPS1A.RAC4,
    RAC5 TYPE OF COLUMN ROPS1A.RAC5,
    QV TYPE OF COLUMN ROPS1A.QV,
    ZNR TYPE OF COLUMN ROPS1A.ZNR)
AS
begin
-- PVN summu kontrole ienemumiem
    
    FOR SELECT
        gen_id(GEN_ROPS1A_ID, 1) as ID,
        current_connection as SPID,
        T4.did,
        OPSd.Dete AS Dete,
        null AS nrx,
        null AS DocTyp,
        DocTyp.pvnpaz AS DocTyp1,
        T4.DocTyp2 AS DocTyp2,
        OPSd.DocSt,
        OPSd.DocNr,
        OPSd.clid AS clid,
        null AS clid2,
        Persons.Name AS Name,
        null AS Name2,
        Persons.PVNRegNr AS RegNr,
        null AS RegNr2,
        0.0 AS b0,
        null AS descr,
        null AS descr2,
        null AS AC1,
        null AS AC2,
        null AS SAC1,
        null AS SAC2,
        0.0 AS SummC,
        'EUR' AS Cur,
        T4.Summ AS Summ,
        T4.PVN AS PVN,
        null AS RAC,
        0.0 AS SDb,
        0.0 AS SCr,
        null AS RAC2,
        null AS RAC3,
        null AS RAC4,
        null AS RAC5,
        0.0 AS QV,
        OPSd.znr AS ZNR

    FROM
    (
        SELECT
            did, clid, doctyp1, doctyp2, doctypc,
            rac5, summ, pvn, summc, cur
        FROM SP_REP_PVN_31(:PSD, :PED, 0.0, 0.0)
        WHERE ABS(ABS(summ * :LIKME) - ABS(pvn)) >= :RG1

    ) AS T4 

        LEFT JOIN OPSd ON T4.did = OPSd.id
        LEFT JOIN DocTyp ON OPSd.DocTyp = DocTyp.id
        LEFT JOIN Persons ON T4.ClId = Persons.ClId

    ORDER BY OPSd.Dete


    into
        :id, :spid, :did, :DETE, :nrx,
        :doctyp, :doctyp1, :doctyp2, :docst, :docnr,
        :clid, :clid2, :name, :name2, :regnr, :regnr2,
        :b0, :descr, :descr2, :ac1, :ac2, :sac1,:sac2,
        :summc, :cur, :summ, :pvn, :rac, :sdb, :scr,
        :rac2, :rac3, :rac4, :rac5, :qv, :znr
    do
    begin
        suspend;
    end
end^


ALTER PROCEDURE SP_REP_PVNZ_01 (
    SDT DATE,
    EDT DATE)
RETURNS (
    ID TYPE OF COLUMN TREPPVNZ1.ID,
    SPID TYPE OF COLUMN TREPPVNZ1.SPID,
    DID TYPE OF COLUMN TREPPVNZ1.DID,
    RID TYPE OF COLUMN TREPPVNZ1.RID,
    DETE TYPE OF COLUMN TREPPVNZ1.DETE,
    NRX TYPE OF COLUMN TREPPVNZ1.NRX,
    DOCTYP TYPE OF COLUMN TREPPVNZ1.DOCTYP,
    DOCST TYPE OF COLUMN TREPPVNZ1.DOCST,
    DOCNR TYPE OF COLUMN TREPPVNZ1.DOCNR,
    DOCSTR TYPE OF COLUMN TREPPVNZ1.DOCSTR,
    CLID TYPE OF COLUMN TREPPVNZ1.CLID,
    NAME TYPE OF COLUMN TREPPVNZ1.NAME,
    REGNR TYPE OF COLUMN TREPPVNZ1.REGNR,
    DESCR TYPE OF COLUMN TREPPVNZ1.DESCR,
    AA TYPE OF COLUMN TREPPVNZ1.AA,
    A8 TYPE OF COLUMN TREPPVNZ1.A8,
    A9 TYPE OF COLUMN TREPPVNZ1.A9,
    A10 TYPE OF COLUMN TREPPVNZ1.A10,
    A11 TYPE OF COLUMN TREPPVNZ1.A11,
    A12 TYPE OF COLUMN TREPPVNZ1.A12,
    A13 TYPE OF COLUMN TREPPVNZ1.A13,
    A14 TYPE OF COLUMN TREPPVNZ1.A14,
    A15 TYPE OF COLUMN TREPPVNZ1.A15,
    A16 TYPE OF COLUMN TREPPVNZ1.A16,
    A17 TYPE OF COLUMN TREPPVNZ1.A17,
    A18 TYPE OF COLUMN TREPPVNZ1.A18,
    A19 TYPE OF COLUMN TREPPVNZ1.A19,
    A20 TYPE OF COLUMN TREPPVNZ1.A20,
    A21 TYPE OF COLUMN TREPPVNZ1.A21,
    A22 TYPE OF COLUMN TREPPVNZ1.A22,
    A23 TYPE OF COLUMN TREPPVNZ1.A23,
    A24 TYPE OF COLUMN TREPPVNZ1.A24,
    A25 TYPE OF COLUMN TREPPVNZ1.A25,
    A26 TYPE OF COLUMN TREPPVNZ1.A26,
    A27 TYPE OF COLUMN TREPPVNZ1.A27,
    A28 TYPE OF COLUMN TREPPVNZ1.A28,
    A29 TYPE OF COLUMN TREPPVNZ1.A29,
    A30 TYPE OF COLUMN TREPPVNZ1.A30,
    A31 TYPE OF COLUMN TREPPVNZ1.A31)
AS
declare variable a23a type of column TREPPVNZ1.A23;
    declare variable xrid integer;
    declare variable xdt2 date;

begin
  xrid = 1;

  for select
        gen_id(GEN_TREPDARZ1_ID, 1) AS id,
        current_connection AS spid,
        TD1.ID AS did,
        0 AS rid,
        MAX(TD1.Dete) AS Dete,
        MAX(TD1.ZNR) AS NrX,
        MAX(DocTyp.id1) AS DocTyp,
        MAX(TD1.DocSt) AS DocSt,
        MAX(TD1.DocNr) AS DocNr,
        NULL AS docstr,
        MAX(TD1.clid) AS clid,
        MAX(Persons.name) AS Name,
        MAX(Persons.pvnregnr) AS RegNr,
        MAX(TD1.descr) AS Descr,
        0 AS aa,

        SUM(
            CASE WHEN TP11.PZ2 = 8 THEN -TO1.Summ ELSE 0.00 END +
            CASE WHEN TP12.PZ2 = 8 THEN TO1.Summ ELSE 0.00 END
            ) AS A8,
        SUM(
            CASE WHEN TP11.PZ2 = 9 THEN -TO1.Summ ELSE 0.00 END +
            CASE WHEN TP12.PZ2 = 9 THEN TO1.Summ ELSE 0.00 END
            ) AS A9,
        SUM(
            CASE WHEN (TP11.PZ2 >= 100) AND (TP11.PZ2 < 110) THEN -TO1.Summ ELSE 0.00 END +
            CASE WHEN (TP12.PZ2 >= 100) AND (TP12.PZ2 < 110) THEN TO1.Summ ELSE 0.00 END
            ) AS A10,

        MAX(
            CASE WHEN (TP11.PZ2 >= 100) AND (TP11.PZ2 < 110)
            THEN TP11.PZ1
            ELSE
                CASE WHEN (TP12.PZ2 >= 100) AND (TP12.PZ2 < 110) THEN TP12.PZ1 ELSE NULL END
            END
            ) AS A11,

        SUM(
            CASE WHEN TP11.PZ2 = 12 THEN -TO1.Summ ELSE 0.00 END +
            CASE WHEN TP12.PZ2 = 12 THEN TO1.Summ ELSE 0.00 END
            ) AS A12,

        SUM(
            CASE WHEN TP11.PZ2 = 13 THEN -TO1.Summ ELSE 0.00 END +
            CASE WHEN TP12.PZ2 = 13 THEN TO1.Summ ELSE 0.00 END
            ) AS A13,

        SUM(
            CASE WHEN TP11.PZ2 = 14 THEN -TO1.Summ ELSE 0.00 END +
            CASE WHEN TP12.PZ2 = 14 THEN TO1.Summ ELSE 0.00 END
            ) AS A14,

        SUM(
            CASE WHEN TP11.PZ2 = 15 THEN -TO1.Summ ELSE 0.00 END +
            CASE WHEN TP12.PZ2 = 15 THEN TO1.Summ ELSE 0.00 END
            ) AS A15,
        SUM(
            CASE WHEN TP11.PZ2 = 16 THEN -TO1.Summ ELSE 0.00 END +
            CASE WHEN TP12.PZ2 = 16 THEN TO1.Summ ELSE 0.00 END +

            CASE WHEN TP11.PZ2 = 201 THEN TO1.Summ ELSE 0.00 END +
            CASE WHEN TP12.PZ2 = 201 THEN -TO1.Summ ELSE 0.00 END
            ) AS A16,
        SUM(
            CASE WHEN TP11.PZ2 = 17 THEN -TO1.Summ ELSE 0.00 END +
            CASE WHEN TP12.PZ2 = 17 THEN TO1.Summ ELSE 0.00 END
            ) AS A17,
        SUM(
            CASE WHEN TP11.PZ2 = 18 THEN -TO1.Summ ELSE 0.00 END +
            CASE WHEN TP12.PZ2 = 18 THEN TO1.Summ ELSE 0.00 END
            ) AS A18,
        SUM(
            CASE WHEN TP11.PZ2 = 19 THEN -TO1.Summ ELSE 0.00 END +
            CASE WHEN TP12.PZ2 = 19 THEN TO1.Summ ELSE 0.00 END
            ) AS A19,
        SUM(
            CASE WHEN TP11.PZ2 = 20 THEN -TO1.Summ ELSE 0.00 END +
            CASE WHEN TP12.PZ2 = 20 THEN TO1.Summ ELSE 0.00 END
            ) AS A20,
    
        0 AS a21,

        SUM(
            CASE WHEN TP11.PZ2 = 22 THEN TO1.Summ ELSE 0.00 END +
            CASE WHEN TP12.PZ2 = 22 THEN -TO1.Summ ELSE 0.00 END
            ) AS A22,
        SUM(
            CASE WHEN TP11.PZ2 = 23 THEN TO1.Summ ELSE 0.00 END +
            CASE WHEN TP12.PZ2 = 23 THEN -TO1.Summ ELSE 0.00 END
            ) AS A23,


        SUM(
            CASE WHEN TO1.AC15 IS NULL AND TO1.AC25 IS NULL THEN TO1.Summ ELSE 0.00 END
            ) AS A23a,

        SUM(
            CASE WHEN TP11.PZ2 = 24 THEN TO1.Summ ELSE 0.00 END +
            CASE WHEN TP12.PZ2 = 24 THEN -TO1.Summ ELSE 0.00 END
            ) AS A24,
        SUM(
            CASE WHEN TP11.PZ2 = 25 THEN TO1.Summ ELSE 0.00 END +
            CASE WHEN TP12.PZ2 = 25 THEN -TO1.Summ ELSE 0.00 END
            ) AS A25,
        SUM(
            CASE WHEN TP11.PZ2 = 26 THEN TO1.Summ ELSE 0.00 END +
            CASE WHEN TP12.PZ2 = 26 THEN -TO1.Summ ELSE 0.00 END
            ) AS A26,
        SUM(
            CASE WHEN TP11.PZ2 = 27 THEN TO1.Summ ELSE 0.00 END +
            CASE WHEN TP12.PZ2 = 27 THEN -TO1.Summ ELSE 0.00 END +

            CASE WHEN TP11.PZ2 = 201 THEN TO1.Summ ELSE 0.00 END +
            CASE WHEN TP12.PZ2 = 201 THEN -TO1.Summ ELSE 0.00 END

            ) AS A27,
        SUM(
            CASE WHEN TP11.PZ2 = 28 THEN TO1.Summ ELSE 0.00 END +
            CASE WHEN TP12.PZ2 = 28 THEN -TO1.Summ ELSE 0.00 END
            ) AS A28,
        SUM(
            CASE WHEN TP11.PZ2 = 29 THEN TO1.Summ ELSE 0.00 END +
            CASE WHEN TP12.PZ2 = 29 THEN -TO1.Summ ELSE 0.00 END
            ) AS A29,
        SUM(
            CASE WHEN TP11.PZ2 = 30 THEN TO1.Summ ELSE 0.00 END +
            CASE WHEN TP12.PZ2 = 30 THEN -TO1.Summ ELSE 0.00 END
            ) AS A30,

        0 AS a31,

        MAX(TD1.DT2) AS DT2

    FROM
        OPSd AS TD1
        JOIN OPS AS TO1 ON TD1.id = TO1.DocId
        LEFT JOIN persons ON TD1.clid = Persons.clid
        LEFT JOIN doctyp ON TD1.doctyp = doctyp.id
        LEFT JOIN ACPvN AS TP11 ON TO1.AC15 = TP11.ID
        LEFT JOIN ACPvN AS TP12 ON TO1.AC25 = TP12.ID
    WHERE
        TD1.Dete BETWEEN :sdt AND :edt AND
        EXISTS
        (
            SELECT TO2.ID
            FROM
                OPS AS TO2
                LEFT JOIN ACPvN AS TP21 ON TO2.AC15 = TP21.ID
                LEFT JOIN ACPvN AS TP22 ON TO2.AC25 = TP22.ID
            WHERE
                (TO2.docid = TD1.ID) AND
                (
                    (TP21.ID IS NOT NULL) AND (TP21.PZ2 <> 0) OR
                    (TP22.ID IS NOT NULL) AND (TP22.PZ2 <> 0)
                )
        )

    GROUP BY DID
    ORDER BY Dete, did

    into :id,
        :spid,
        :did,
        :rid,
        :dete,
        :nrx,
        :doctyp,
        :docst,
        :docnr,
        :docstr,
        :clid,
        :name,
        :regnr,
        :descr,
        :aa,
        :a8,
        :a9,
        :a10,
        :a11,
        :a12,
        :a13,
        :a14,
        :a15,
        :a16,
        :a17,
        :a18,
        :a19,
        :a20,
        :a21,
        :a22,
        :a23,
        :a23a,
        :a24,
        :a25,
        :a26,
        :a27,
        :a28,
        :a29,
        :a30,
        :a31,
        :xdt2
  do
  begin
    rid = xrid;
    xrid = xrid + 1;

    docstr = DocTyp;

    if (docst is not null)
    then
        if (docstr is null)
        then docstr = docst;
        else docstr = docstr || ' ' || docst;

    if (docnr is not null)
    then
        if (docstr is null)
        then docstr = docnr;
        else docstr = docstr || ' ' ||  docnr;

    if (xdt2 is not null)
    then
        if (docstr is null)
        then docstr = xdt2;
        else docstr = docstr || ', ' ||  xdt2;


    if (a27 > 0.0) then
    begin
        a23 = a23 + a23a;
    end
    else
    begin
        a23 = a23 - a23a;
    end

    a21 = a8 + a9 + a10 + a12 + a13 + a14 +
            a15 + a16 + a17 + a18 + a19 + a20;

    a31 = a22 + a23 + a24 + a25 + a26 + a27 +
            a28 + a29 + a30;

    suspend;
  end
end^


ALTER PROCEDURE SP_REP_SKAIDRA_01 (
    SDT DATE,
    EDT DATE,
    PSUMM NUMERIC(14,5),
    PPERTYP VARCHAR(5))
RETURNS (
    ID TYPE OF COLUMN ROPS1A.ID,
    SPID TYPE OF COLUMN ROPS1A.SPID,
    DID TYPE OF COLUMN ROPS1A.DID,
    DETE TYPE OF COLUMN ROPS1A.DETE,
    NRX TYPE OF COLUMN ROPS1A.NRX,
    DOCTYP TYPE OF COLUMN ROPS1A.DOCTYP,
    DOCTYP1 TYPE OF COLUMN ROPS1A.DOCTYP1,
    DOCTYP2 TYPE OF COLUMN ROPS1A.DOCTYP2,
    DOCST TYPE OF COLUMN ROPS1A.DOCST,
    DOCNR TYPE OF COLUMN ROPS1A.DOCNR,
    CLID TYPE OF COLUMN ROPS1A.CLID,
    CLID2 TYPE OF COLUMN ROPS1A.CLID2,
    NAME TYPE OF COLUMN ROPS1A.NAME,
    NAME2 TYPE OF COLUMN ROPS1A.NAME2,
    REGNR TYPE OF COLUMN ROPS1A.REGNR,
    REGNR2 TYPE OF COLUMN ROPS1A.REGNR2,
    B0 TYPE OF COLUMN ROPS1A.B0,
    DESCR TYPE OF COLUMN ROPS1A.DESCR,
    DESCR2 TYPE OF COLUMN ROPS1A.DESCR2,
    AC1 TYPE OF COLUMN ROPS1A.AC1,
    AC2 TYPE OF COLUMN ROPS1A.AC2,
    SAC1 TYPE OF COLUMN ROPS1A.SAC1,
    SAC2 TYPE OF COLUMN ROPS1A.SAC2,
    SUMMC TYPE OF COLUMN ROPS1A.SUMMC,
    CUR TYPE OF COLUMN ROPS1A.CUR,
    SUMM TYPE OF COLUMN ROPS1A.SUMM,
    PVN TYPE OF COLUMN ROPS1A.PVN,
    RAC TYPE OF COLUMN ROPS1A.RAC,
    SDB TYPE OF COLUMN ROPS1A.SDB,
    SCR TYPE OF COLUMN ROPS1A.SCR,
    RAC2 TYPE OF COLUMN ROPS1A.RAC2,
    RAC3 TYPE OF COLUMN ROPS1A.RAC3,
    RAC4 TYPE OF COLUMN ROPS1A.RAC4,
    RAC5 TYPE OF COLUMN ROPS1A.RAC5,
    QV TYPE OF COLUMN ROPS1A.QV,
    ZNR TYPE OF COLUMN ROPS1A.ZNR)
AS
begin
    FOR SELECT
        gen_id(GEN_ROPS1A_ID, 1) as ID,
        current_connection as SPID,
        0 as did,
        null AS Dete,
        null AS nrx,
        null AS DocTyp,
        null AS DocTyp1,
        null AS DocTyp2,
        null AS DocSt,
        null AS DocNr,
        T2.clid AS clid,
        null AS clid2,
        Persons.Name AS Name,
        null AS Name2,
        Persons.RegNr AS RegNr,
        null AS RegNr2,
        0.0 AS b0,
        null AS descr,
        null AS descr2,
        null AS AC1,
        null AS AC2,
        null AS SAC1,
        null AS SAC2,
        0.0 AS SummC,
        'EUR' AS Cur,
        0.0 AS Summ,
        0.0 AS PVN,
        null AS RAC,
        T2.ADb AS SDb,
        T2.ACr AS SCr,
        null AS RAC2,
        null AS RAC3,
        null AS RAC4,
        null AS RAC5,
        0.0 AS QV,
        0.0 AS ZNR

    FROM
    (
        SELECT ClId, SUM(SDb) AS ADb, SUM(SCr) AS ACr
        FROM
        (
            SELECT 
                OPSd.ClId AS ClId,
                OPS.Summ AS SDb,
                0.00 AS SCr

            FROM 
                OPSd INNER JOIN OPS ON OPSd.id = OPS.DocId
                INNER JOIN Persons ON OPSd.ClId = Persons.ClId
                INNER JOIN AcP21 ON OPS.AC11 = AcP21.AC
            WHERE 
                OPSd.Dete BETWEEN :sdt AND :edt AND
                Persons.TP2 = :ppertyp AND
                AcP21.id1 IN ('KA','CN')

            UNION ALL

            SELECT 
                OPSd.ClId AS ClId,
                0.00 AS SDb,
                OPS.Summ AS SCr

            FROM 
                OPSd INNER JOIN OPS ON OPSd.id = OPS.DocId
                INNER JOIN Persons ON OPSd.ClId = Persons.ClId
                INNER JOIN AcP21 ON OPS.AC21 = AcP21.AC
            WHERE 
                OPSd.Dete BETWEEN :sdt AND :edt AND
                Persons.TP2 = :ppertyp AND
                AcP21.id1 IN ('KA','CN')

        ) AS T1
        GROUP BY ClId

    ) AS T2    
    LEFT JOIN Persons ON T2.ClId = Persons.ClId

    WHERE 
        (ABS(T2.ADb) + ABS(T2.ACr)) >= :psumm
    ORDER BY ClId

    into
        :id, :spid, :did, :DETE, :nrx,
        :doctyp, :doctyp1, :doctyp2, :docst, :docnr,
        :clid, :clid2, :name, :name2, :regnr, :regnr2,
        :b0, :descr, :descr2, :ac1, :ac2, :sac1,:sac2,
        :summc, :cur, :summ, :pvn, :rac, :sdb, :scr,
        :rac2, :rac3, :rac4, :rac5, :qv, :znr
    do
    begin
        suspend;
    end
end^


ALTER PROCEDURE SP_REP_SKAIDRA_02 (
    SDT DATE,
    EDT DATE,
    PSUMM NUMERIC(14,5),
    PPERTYP VARCHAR(5))
RETURNS (
    ID TYPE OF COLUMN ROPS1A.ID,
    SPID TYPE OF COLUMN ROPS1A.SPID,
    DID TYPE OF COLUMN ROPS1A.DID,
    DETE TYPE OF COLUMN ROPS1A.DETE,
    NRX TYPE OF COLUMN ROPS1A.NRX,
    DOCTYP TYPE OF COLUMN ROPS1A.DOCTYP,
    DOCTYP1 TYPE OF COLUMN ROPS1A.DOCTYP1,
    DOCTYP2 TYPE OF COLUMN ROPS1A.DOCTYP2,
    DOCST TYPE OF COLUMN ROPS1A.DOCST,
    DOCNR TYPE OF COLUMN ROPS1A.DOCNR,
    CLID TYPE OF COLUMN ROPS1A.CLID,
    CLID2 TYPE OF COLUMN ROPS1A.CLID2,
    NAME TYPE OF COLUMN ROPS1A.NAME,
    NAME2 TYPE OF COLUMN ROPS1A.NAME2,
    REGNR TYPE OF COLUMN ROPS1A.REGNR,
    REGNR2 TYPE OF COLUMN ROPS1A.REGNR2,
    B0 TYPE OF COLUMN ROPS1A.B0,
    DESCR TYPE OF COLUMN ROPS1A.DESCR,
    DESCR2 TYPE OF COLUMN ROPS1A.DESCR2,
    AC1 TYPE OF COLUMN ROPS1A.AC1,
    AC2 TYPE OF COLUMN ROPS1A.AC2,
    SAC1 TYPE OF COLUMN ROPS1A.SAC1,
    SAC2 TYPE OF COLUMN ROPS1A.SAC2,
    SUMMC TYPE OF COLUMN ROPS1A.SUMMC,
    CUR TYPE OF COLUMN ROPS1A.CUR,
    SUMM TYPE OF COLUMN ROPS1A.SUMM,
    PVN TYPE OF COLUMN ROPS1A.PVN,
    RAC TYPE OF COLUMN ROPS1A.RAC,
    SDB TYPE OF COLUMN ROPS1A.SDB,
    SCR TYPE OF COLUMN ROPS1A.SCR,
    RAC2 TYPE OF COLUMN ROPS1A.RAC2,
    RAC3 TYPE OF COLUMN ROPS1A.RAC3,
    RAC4 TYPE OF COLUMN ROPS1A.RAC4,
    RAC5 TYPE OF COLUMN ROPS1A.RAC5,
    QV TYPE OF COLUMN ROPS1A.QV,
    ZNR TYPE OF COLUMN ROPS1A.ZNR)
AS
begin
--Skaidras naudas darijumi FP
    FOR SELECT
        gen_id(GEN_ROPS1A_ID, 1) as ID,
        current_connection as SPID,
        0 as did,
        null AS Dete,
        null AS nrx,
        null AS DocTyp,
        null AS DocTyp1,
        null AS DocTyp2,
        null AS DocSt,
        null AS DocNr,
        T2.clid AS clid,
        null AS clid2,
        Persons.Name AS Name,
        null AS Name2,
        Persons.RegNr AS RegNr,
        null AS RegNr2,
        0.0 AS b0,
        null AS descr,
        null AS descr2,
        null AS AC1,
        null AS AC2,
        null AS SAC1,
        null AS SAC2,
        0.0 AS SummC,
        'EUR' AS Cur,
        0.0 AS Summ,
        0.0 AS PVN,
        null AS RAC,
        T2.ADb AS SDb,
        T2.ACr AS SCr,
        null AS RAC2,
        null AS RAC3,
        null AS RAC4,
        null AS RAC5,
        0.0 AS QV,
        0.0 AS ZNR
    FROM
    (
        SELECT ClId, SUM(ADb) AS ADb, SUM(ACr) AS ACr
        FROM
        (
            SELECT did, ClId, SUM(SDb) AS ADb, SUM(SCr) AS ACr
            FROM
            (
                SELECT 
                    OPSd.id AS did,
                    OPSd.ClId AS ClId,
                    OPS.Summ AS SDb,
                    0.00 AS SCr

                FROM 
                    OPSd INNER JOIN OPS ON OPSd.id = OPS.DocId
                    INNER JOIN Persons ON OPSd.ClId = Persons.ClId
                    INNER JOIN AcP21 ON OPS.AC11 = AcP21.AC
                WHERE 
                    OPSd.Dete BETWEEN :sdt AND :edt AND
                    Persons.TP2 = :ppertyp AND
                    AcP21.id1 IN ('KA','CN')

                UNION ALL

                SELECT 
                    OPSd.id AS did,
                    OPSd.ClId AS ClId,
                    0.00 AS SDb,
                    OPS.Summ AS SCr

                FROM 
                    OPSd INNER JOIN OPS ON OPSd.id = OPS.DocId
                    INNER JOIN Persons ON OPSd.ClId = Persons.ClId
                    INNER JOIN AcP21 ON OPS.AC21 = AcP21.AC
                WHERE 
                    OPSd.Dete BETWEEN :sdt AND :edt AND
                    Persons.TP2 = :ppertyp AND
                    AcP21.id1 IN ('KA','CN')

            ) AS T1
            GROUP BY did, ClId
        ) AS T12

        WHERE (ABS(T12.ACr) + ABS(T12.ADb)) >= :psumm
        GROUP BY ClId

    ) AS T2    
    LEFT JOIN Persons ON T2.ClId = Persons.ClId

    ORDER BY ClId
    

    into
        :id, :spid, :did, :DETE, :nrx,
        :doctyp, :doctyp1, :doctyp2, :docst, :docnr,
        :clid, :clid2, :name, :name2, :regnr, :regnr2,
        :b0, :descr, :descr2, :ac1, :ac2, :sac1,:sac2,
        :summc, :cur, :summ, :pvn, :rac, :sdb, :scr,
        :rac2, :rac3, :rac4, :rac5, :qv, :znr
    do
    begin
        suspend;
    end
end^


ALTER PROCEDURE SP_RESET_YEAR_GEN
AS
declare variable I INT;
declare variable s varchar(100);
begin
    i = 0;
    WHILE(i<33) do
    begin
        s = cast(i as varchar(3));
        if (i < 10) then s = '0' || s;
        s = 'ALTER SEQUENCE YEAR' || s ||  ' RESTART WITH 0;';
        if ((i <> 4) and (i <> 5)) then
        EXECUTE STATEMENT s;
        i = i + 1;
    end
end^


ALTER PROCEDURE SP_SET_KIEONR (
    SDT DATE,
    EDT DATE,
    PAC VARCHAR(8),
    PNR INTEGER)
AS
declare variable ID INT;
    declare variable Nr2 INT;
begin
    Nr2 = pnr;
    FOR SELECT
        id
    FROM OPSd
    WHERE
        EXISTS
        (
            SELECT NULL
            FROM OPS
            WHERE 
                OPSd.id = OPS.DocId AND
                OPS.AC11 = :pac
        ) AND
        OPSd.Dete BETWEEN :sdt AND :edt

    ORDER BY Dete, id

    INTO :ID
    DO
    BEGIN

        UPDATE OPSd
        SET NrX = :Nr2
        WHERE OPSd.id = :ID;

        nr2 = nr2 + 1;
    END
end^


ALTER PROCEDURE SP_SET_KIZONR (
    SDT DATE,
    EDT DATE,
    PAC VARCHAR(8),
    PNR INTEGER)
AS
declare variable ID INT;
    declare variable Nr2 INT;
begin
    Nr2 = pnr;
    FOR SELECT
        id
    FROM OPSd
    WHERE
        EXISTS
        (
            SELECT NULL
            FROM OPS
            WHERE 
                OPSd.id = OPS.DocId AND
                OPS.AC21 = :pac
        ) AND
        OPSd.Dete BETWEEN :sdt AND :edt

    ORDER BY Dete, id

    INTO :ID
    DO
    BEGIN

        UPDATE OPSd
        SET NrX = :Nr2
        WHERE OPSd.id = :ID;

        nr2 = nr2 + 1;
    END
end^


ALTER PROCEDURE SP_SET_USERNAME (
    USERNAME VARCHAR(15))
AS
begin
    rdb$set_context('USER_SESSION', 'UserName', :username);
end^


ALTER PROCEDURE SP_VWOPS_FILTER_AND (
    PDATE1 DATE,
    PDATE2 DATE,
    PTEXT VARCHAR(50),
    PCLID VARCHAR(15),
    PAC11 VARCHAR(8),
    PAC12 VARCHAR(8),
    PAC13 VARCHAR(5),
    PAC14 VARCHAR(8),
    PAC15 VARCHAR(5),
    PAC21 VARCHAR(8),
    PAC22 VARCHAR(8),
    PAC23 VARCHAR(5),
    PAC24 VARCHAR(8),
    PAC25 VARCHAR(5),
    PDOCGR VARCHAR(10))
RETURNS (
    ID TYPE OF COLUMN OPS.ID,
    DOCID TYPE OF COLUMN OPS.DOCID,
    DETE TYPE OF COLUMN OPSD.DETE,
    NRX TYPE OF COLUMN OPSD.NRX,
    ZNR TYPE OF COLUMN OPSD.ZNR,
    DOCTYP TYPE OF COLUMN OPSD.DOCTYP,
    DOCST TYPE OF COLUMN OPSD.DOCST,
    DOCNR TYPE OF COLUMN OPSD.DOCNR,
    DOCTYP2 TYPE OF COLUMN DOCTYP.ID1,
    CLID TYPE OF COLUMN OPSD.CLID,
    NAME TYPE OF COLUMN PERSONS.NAME,
    REGNR TYPE OF COLUMN PERSONS.REGNR,
    PVNREGNR TYPE OF COLUMN PERSONS.PVNREGNR,
    CLID2 TYPE OF COLUMN OPSD.CLID2,
    NAME2 TYPE OF COLUMN PERSONS.NAME,
    REGNR2 TYPE OF COLUMN PERSONS.REGNR,
    DESCR TYPE OF COLUMN OPSD.DESCR,
    AC11 TYPE OF COLUMN OPS.AC11,
    AC12 TYPE OF COLUMN OPS.AC12,
    AC13 TYPE OF COLUMN OPS.AC13,
    AC14 TYPE OF COLUMN OPS.AC14,
    AC15 TYPE OF COLUMN OPS.AC15,
    AC21 TYPE OF COLUMN OPS.AC21,
    AC22 TYPE OF COLUMN OPS.AC22,
    AC23 TYPE OF COLUMN OPS.AC23,
    AC24 TYPE OF COLUMN OPS.AC24,
    AC25 TYPE OF COLUMN OPS.AC25,
    SUMMC TYPE OF COLUMN OPS.SUMMC,
    CUR TYPE OF COLUMN OPS.CUR,
    SUMM TYPE OF COLUMN OPS.SUMM,
    QV TYPE OF COLUMN OPS.QV,
    DESCR2 TYPE OF COLUMN OPS.DESCR)
AS
begin

    for select
        ops.id,
        ops.docid,
        opsd.DETE,
        opsd.nrx,
        opsd.znr,
        opsd.doctyp,
        opsd.docst,
        opsd.docnr,
        DOCTYP.id1 as DOCTYP2,
        opsd.clid,
        persons.name,
        persons.regnr,
        persons.pvnregnr,
        opsd.clid2,
        Persons2.name as NAME2,
        Persons2.regnr AS regnr2,
        opsd.descr,

        ops.ac11,
        ops.ac12,
        ops.ac13,
        ops.ac14,
        ops.ac15,
        ops.ac21,
        ops.ac22,
        ops.ac23,
        ops.ac24,
        ops.ac25,
        ops.summc,
        ops.cur,
        ops.summ,
        ops.qv,
        ops.descr AS descr2

    FROM
        OPSd JOIN OPS ON OPSd.id = OPS.DocId
        LEFT JOIN DocTyp ON OPSd.DocTyp = DocTyp.id
        LEFT JOIN Persons ON OPSd.ClId = Persons.ClId
        LEFT JOIN Persons AS Persons2 ON OPSd.ClId2 = Persons2.ClId

    WHERE
        (:pdate1 IS NULL OR opsd.DETE >= :pdate1) AND
        (:pdate2 IS NULL OR opsd.DETE <= :pdate2) AND
        (:pclid IS NULL OR opsd.ClId = :pclid OR ClId2 = :pclid) AND
        (:ptext IS NULL OR OPSd.Descr LIKE :ptext) AND
        (
            :PDOCGR IS NULL OR EXISTS(
                SELECT DTA.ID
                FROM doctypb AS DTB inner join doctypa AS DTA on DTB.ida = DTA.id
                WHERE DTB.ID = OPSD.doctyp AND DTA.ID = :PDOCGR
            )
        )
        AND
        (
            (:pac11 IS NULL OR OPS.AC11 LIKE :pac11) AND
            (:pac12 IS NULL OR OPS.AC12 LIKE :pac12) AND
            (:pac13 IS NULL OR OPS.AC13 LIKE :pac13) AND
            (:pac14 IS NULL OR OPS.AC14 LIKE :pac14) AND
            (:pac15 IS NULL OR OPS.AC15 LIKE :pac15)
        )
        AND
        (
            (:pac21 IS NULL OR OPS.AC21 LIKE :pac21) AND
            (:pac22 IS NULL OR OPS.AC22 LIKE :pac22) AND
            (:pac23 IS NULL OR OPS.AC23 LIKE :pac23) AND
            (:pac24 IS NULL OR OPS.AC24 LIKE :pac24) AND
            (:pac25 IS NULL OR OPS.AC25 LIKE :pac25)
        )
        ORDER BY DETE, opsd.id, ops.id
        into
            :ID, :docid, :DETE, :nrx, :znr,
            :doctyp, :docst, :docnr, :doctyp2,
            :clid, :name, :regnr, :pvnregnr, 
            :clid2, :name2, :regnr2,
            :descr,
            :ac11, :ac12, :ac13, :ac14, :ac15,
            :ac21, :ac22, :ac23, :ac24, :ac25,
            :summc, :cur, :summ, :qv, :descr2
        do
        begin
            suspend;
        end
end^


ALTER PROCEDURE SP_VWOPS_FILTER_OR (
    PDATE1 DATE,
    PDATE2 DATE,
    PTEXT VARCHAR(50),
    PCLID VARCHAR(15),
    PAC11 VARCHAR(8),
    PAC12 VARCHAR(8),
    PAC13 VARCHAR(5),
    PAC14 VARCHAR(8),
    PAC15 VARCHAR(5),
    PAC21 VARCHAR(8),
    PAC22 VARCHAR(8),
    PAC23 VARCHAR(5),
    PAC24 VARCHAR(8),
    PAC25 VARCHAR(5),
    PDOCGR VARCHAR(10))
RETURNS (
    ID TYPE OF COLUMN OPS.ID,
    DOCID TYPE OF COLUMN OPS.DOCID,
    DETE TYPE OF COLUMN OPSD.DETE,
    NRX TYPE OF COLUMN OPSD.NRX,
    ZNR TYPE OF COLUMN OPSD.ZNR,
    DOCTYP TYPE OF COLUMN OPSD.DOCTYP,
    DOCST TYPE OF COLUMN OPSD.DOCST,
    DOCNR TYPE OF COLUMN OPSD.DOCNR,
    DOCTYP2 TYPE OF COLUMN DOCTYP.ID1,
    CLID TYPE OF COLUMN OPSD.CLID,
    NAME TYPE OF COLUMN PERSONS.NAME,
    REGNR TYPE OF COLUMN PERSONS.REGNR,
    PVNREGNR TYPE OF COLUMN PERSONS.PVNREGNR,
    CLID2 TYPE OF COLUMN OPSD.CLID2,
    NAME2 TYPE OF COLUMN PERSONS.NAME,
    REGNR2 TYPE OF COLUMN PERSONS.REGNR,
    DESCR TYPE OF COLUMN OPSD.DESCR,
    AC11 TYPE OF COLUMN OPS.AC11,
    AC12 TYPE OF COLUMN OPS.AC12,
    AC13 TYPE OF COLUMN OPS.AC13,
    AC14 TYPE OF COLUMN OPS.AC14,
    AC15 TYPE OF COLUMN OPS.AC15,
    AC21 TYPE OF COLUMN OPS.AC21,
    AC22 TYPE OF COLUMN OPS.AC22,
    AC23 TYPE OF COLUMN OPS.AC23,
    AC24 TYPE OF COLUMN OPS.AC24,
    AC25 TYPE OF COLUMN OPS.AC25,
    SUMMC TYPE OF COLUMN OPS.SUMMC,
    CUR TYPE OF COLUMN OPS.CUR,
    SUMM TYPE OF COLUMN OPS.SUMM,
    QV TYPE OF COLUMN OPS.QV,
    DESCR2 TYPE OF COLUMN OPS.DESCR)
AS
begin

    for select
        ops.id,
        ops.docid,
        opsd.DETE,
        opsd.nrx,
        opsd.znr,
        opsd.doctyp,
        opsd.docst,
        opsd.docnr,
        DOCTYP.id1 as DOCTYP2,
        opsd.clid,
        persons.name,
        persons.regnr,
        persons.pvnregnr,
        opsd.clid2,
        Persons2.name as NAME2,
        Persons2.regnr AS regnr2,
        opsd.descr,

        ops.ac11,
        ops.ac12,
        ops.ac13,
        ops.ac14,
        ops.ac15,
        ops.ac21,
        ops.ac22,
        ops.ac23,
        ops.ac24,
        ops.ac25,
        ops.summc,
        ops.cur,
        ops.summ,
        ops.qv,
        ops.descr AS descr2

    FROM
        OPSd JOIN OPS ON OPSd.id = OPS.DocId
        LEFT JOIN DocTyp ON OPSd.DocTyp = DocTyp.id
        LEFT JOIN Persons ON OPSd.ClId = Persons.ClId
        LEFT JOIN Persons AS Persons2 ON OPSd.ClId2 = Persons2.ClId

    WHERE
        (:pdate1 IS NULL OR opsd.DETE >= :pdate1) AND
        (:pdate2 IS NULL OR opsd.DETE <= :pdate2) AND
        (:pclid IS NULL OR opsd.ClId = :pclid OR ClId2 = :pclid) AND
        (:ptext IS NULL OR OPSd.Descr LIKE :ptext) AND
        (
            :PDOCGR IS NULL OR EXISTS(
                SELECT DTA.ID
                FROM doctypb AS DTB inner join doctypa AS DTA on DTB.ida = DTA.id
                WHERE DTB.ID = OPSD.doctyp AND DTA.ID = :PDOCGR
            )
        ) AND
        (
            (
                (:pac11 IS NULL OR OPS.AC11 LIKE :pac11) AND
                (:pac12 IS NULL OR OPS.AC12 LIKE :pac12) AND
                (:pac13 IS NULL OR OPS.AC13 LIKE :pac13) AND
                (:pac14 IS NULL OR OPS.AC14 LIKE :pac14) AND
                (:pac15 IS NULL OR OPS.AC15 LIKE :pac15)
            )
            OR
            (
                (:pac21 IS NULL OR OPS.AC21 LIKE :pac21) AND
                (:pac22 IS NULL OR OPS.AC22 LIKE :pac22) AND
                (:pac23 IS NULL OR OPS.AC23 LIKE :pac23) AND
                (:pac24 IS NULL OR OPS.AC24 LIKE :pac24) AND
                (:pac25 IS NULL OR OPS.AC25 LIKE :pac25)
            )
        )
        ORDER BY DETE, opsd.id, ops.id
        into
            :ID, :docid, :DETE, :nrx, :znr,
            :doctyp, :docst, :docnr, :doctyp2,
            :clid, :name, :regnr, :pvnregnr,
            :clid2, :name2, :regnr2,
            :descr,
            :ac11, :ac12, :ac13, :ac14, :ac15,
            :ac21, :ac22, :ac23, :ac24, :ac25,
            :summc, :cur, :summ, :qv, :descr2
        do
        begin
            suspend;
        end
end^


ALTER PROCEDURE SP1
RETURNS (
    RET INTEGER)
AS
    declare variable vid integer;
begin
    ret = 0;

    select sum(id)
    from m_items
    where id = -2
    into :ret;

    suspend;
end^


ALTER PROCEDURE TEST
RETURNS (
    V1 INTEGER,
    V2 INTEGER)
AS
begin
    delete from ttemp_diff2;
    insert into ttemp_diff2 (idl1, idl2)
    values (1, 1);
    insert into ttemp_diff2 (idl1, idl2)
    values (2, 5);
    insert into ttemp_diff2 (idl1, idl2)
    values (3, 2);
    insert into ttemp_diff2 (idl1, idl2)
    values (4, 3);
    insert into ttemp_diff2 (idl1, idl2)
    values (5, 4);

    for select idl1, idl2
    from ttemp_diff2
    where idl1 > 1
    order by idl2, idl1
    into :v1, :v2 as cursor C1
    do
    begin
        v2 = v2 + 10;
        update ttemp_diff2
        set idl2 = :v2
        where current of C1;
    end

    for select idl1, idl2
    from ttemp_diff2
    order by idl1
    into :v1, :v2
    do
    begin
      suspend;
    end
    delete from ttemp_diff2;
end^



SET TERM ; ^



/******************************************************************************/
/***                              Descriptions                              ***/
/******************************************************************************/

