/******************************************************************************/
/****                 Deactivating dependencies of objects                 ****/
/******************************************************************************/
SET TERM ^ ;

ALTER PROCEDURE SP_MAKE_SALARY_SHEET_R_HIST(
  PID INTEGER,
  PDTCUR TIMESTAMP,
  PSKIP_INTERVAL FLOAT)
AS
BEGIN
  EXIT;
END
^

ALTER PROCEDURE SP_MAKE_SALARY_SHEET_R_HIST_2(
  PIDSX INTEGER,
  PDTCUR TIMESTAMP,
  PSKIP_INTERVAL FLOAT)
AS
BEGIN
  EXIT;
END
^

ALTER PROCEDURE SP_REP_AGGREGATE_01(
  PDT1 DATE,
  PDT2 DATE,
  PIDP INTEGER,
  PIDAM INTEGER,
  PRETYRMT INTEGER,
  PRETIDP INTEGER,
  PRETIDAM INTEGER)
RETURNS (
  IDP /* TYPE OF COLUMN SALARY_SHEETS_R.IDP */ INTEGER,
  IDAM /* TYPE OF COLUMN SALARY_SHEETS_R.IDAM */ INTEGER,
  IDDEP /* TYPE OF COLUMN DEPARTMENTS.ID */ VARCHAR(15) /* COLLATE UTF8 - default */,
  YR /* TYPE OF COLUMN SALARY_SHEETS.YR */ INTEGER,
  MT /* TYPE OF COLUMN SALARY_SHEETS.MT */ INTEGER,
  WORKHOURS /* TYPE OF COLUMN SALARY_SHEETS_R.FACT_HOURS */ FLOAT,
  WORKDAYS /* TYPE OF COLUMN SALARY_SHEETS_R.FACT_DAYS */ INTEGER,
  FREEAVPAYDAYS /* TYPE OF COLUMN SALARY_SHEETS_R.FACT_DAYS */ INTEGER,
  VACATIONDAYS /* TYPE OF COLUMN SALARY_SHEETS_R.VACATION_DAYS_CURRENT */ FLOAT,
  SICKDAYS /* TYPE OF COLUMN SALARY_SHEETS_R.FACT_DAYS */ INTEGER,
  WORKPAY /* TYPE OF COLUMN SALARY_SHEETS_R.SALARY */ NUMERIC(15,2),
  SICKPAY /* TYPE OF COLUMN SALARY_SHEETS_R.SALARY */ NUMERIC(15,2),
  VACATIONPAY /* TYPE OF COLUMN SALARY_SHEETS_R.SALARY */ NUMERIC(15,2),
  FREEAVPAY /* TYPE OF COLUMN SALARY_SHEETS_R.SALARY */ NUMERIC(15,2),
  WORKAVPAY /* TYPE OF COLUMN SALARY_SHEETS_R.SALARY */ NUMERIC(15,2),
  PLUS_TAXED /* TYPE OF COLUMN SALARY_SHEETS_R.PLUS_TAXED */ NUMERIC(15,2),
  PLUS_NOTTAXED /* TYPE OF COLUMN SALARY_SHEETS_R.PLUS_NOTTAXED */ NUMERIC(15,2),
  PLUS_AUTHORS_FEES /* TYPE OF COLUMN SALARY_SHEETS_R.PLUS_AUTHORS_FEES */ NUMERIC(15,2),
  PLUS_NOSAI /* TYPE OF COLUMN SALARY_SHEETS_R.PLUS_NOSAI */ NUMERIC(15,2),
  TOTALPAY /* TYPE OF COLUMN SALARY_SHEETS_R.SALARY */ NUMERIC(15,2),
  FORSAI /* TYPE OF COLUMN SALARY_SHEETS_R.AMOUNT_BEFORE_SN */ NUMERIC(15,2),
  DNSN_AMOUNT /* TYPE OF COLUMN SALARY_SHEETS_R.DNSN_AMOUNT */ NUMERIC(15,2),
  DDSN_AMOUNT /* TYPE OF COLUMN SALARY_SHEETS_R.DDSN_AMOUNT */ NUMERIC(15,2),
  UNTAXED_MINIMUM /* TYPE OF COLUMN SALARY_SHEETS_R.IIN_EXEMPT_UNTAXED_MINIMUM */ NUMERIC(15,2),
  IIN_EXEMPT_DEPENDANTS /* TYPE OF COLUMN SALARY_SHEETS_R.IIN_EXEMPT_DEPENDANTS */ NUMERIC(15,2),
  IIN_EXEMPT_INVALIDITY /* TYPE OF COLUMN SALARY_SHEETS_R.IIN_EXEMPT_INVALIDITY */ NUMERIC(15,2),
  IIN_EXEMPT_NATIONAL_MOVEMENT /* TYPE OF COLUMN SALARY_SHEETS_R.IIN_EXEMPT_NATIONAL_MOVEMENT */ NUMERIC(15,2),
  IIN_EXEMPT_RETALIATION /* TYPE OF COLUMN SALARY_SHEETS_R.IIN_EXEMPT_RETALIATION */ NUMERIC(15,2),
  IIN_EXEMPT_EXPENSES /* TYPE OF COLUMN SALARY_SHEETS_R.IIN_EXEMPT_EXPENSES */ NUMERIC(15,2),
  PLUS_PF_NOTTAXED /* TYPE OF COLUMN SALARY_SHEETS_R.PLUS_PF_NOTTAXED */ NUMERIC(15,2),
  PLUS_LI_NOTTAXED /* TYPE OF COLUMN SALARY_SHEETS_R.PLUS_LI_NOTTAXED */ NUMERIC(15,2),
  PLUS_HI_NOTTAXED /* TYPE OF COLUMN SALARY_SHEETS_R.PLUS_HI_NOTTAXED */ NUMERIC(15,2),
  IIN_AMOUNT /* TYPE OF COLUMN SALARY_SHEETS_R.IIN_AMOUNT */ NUMERIC(15,2),
  MINUS_BEFORE_IIN /* TYPE OF COLUMN SALARY_SHEETS_R.MINUS_BEFORE_IIN */ NUMERIC(15,2),
  MINUS_AFTER_IIN /* TYPE OF COLUMN SALARY_SHEETS_R.MINUS_AFTER_IIN */ NUMERIC(15,2),
  PAY /* TYPE OF COLUMN SALARY_SHEETS_R.PAY */ NUMERIC(15,2),
  ADVANCE /* TYPE OF COLUMN SALARY_SHEETS_R.ADVANCE */ NUMERIC(15,2),
  PAYT /* TYPE OF COLUMN SALARY_SHEETS_R.PAYT */ NUMERIC(15,2),
  PAID /* TYPE OF COLUMN PAYLISTS_R.TPAY */ NUMERIC(15,2))
AS
BEGIN
  SUSPEND;
END
^

ALTER PROCEDURE SP_REP_AGGREGATE_02(
  PDT1 DATE,
  PDT2 DATE,
  PIDDEP /* TYPE OF COLUMN DEPARTMENTS.ID */ VARCHAR(15) /* COLLATE UTF8 - default */,
  PRETYRMT INTEGER,
  PRETIDP INTEGER,
  PRETIDAM INTEGER,
  PRETIDDEP INTEGER)
RETURNS (
  IDP /* TYPE OF COLUMN SALARY_SHEETS_R.IDP */ INTEGER,
  IDAM /* TYPE OF COLUMN SALARY_SHEETS_R.IDAM */ INTEGER,
  IDDEP /* TYPE OF COLUMN DEPARTMENTS.ID */ VARCHAR(15) /* COLLATE UTF8 - default */,
  YR /* TYPE OF COLUMN SALARY_SHEETS.YR */ INTEGER,
  MT /* TYPE OF COLUMN SALARY_SHEETS.MT */ INTEGER,
  WORKHOURS /* TYPE OF COLUMN SALARY_SHEETS_R.FACT_HOURS */ FLOAT,
  WORKDAYS /* TYPE OF COLUMN SALARY_SHEETS_R.FACT_DAYS */ INTEGER,
  FREEAVPAYDAYS /* TYPE OF COLUMN SALARY_SHEETS_R.FACT_DAYS */ INTEGER,
  VACATIONDAYS /* TYPE OF COLUMN SALARY_SHEETS_R.VACATION_DAYS_CURRENT */ FLOAT,
  SICKDAYS /* TYPE OF COLUMN SALARY_SHEETS_R.FACT_DAYS */ INTEGER,
  WORKPAY /* TYPE OF COLUMN SALARY_SHEETS_R.SALARY */ NUMERIC(15,2),
  SICKPAY /* TYPE OF COLUMN SALARY_SHEETS_R.SALARY */ NUMERIC(15,2),
  VACATIONPAY /* TYPE OF COLUMN SALARY_SHEETS_R.SALARY */ NUMERIC(15,2),
  FREEAVPAY /* TYPE OF COLUMN SALARY_SHEETS_R.SALARY */ NUMERIC(15,2),
  WORKAVPAY /* TYPE OF COLUMN SALARY_SHEETS_R.SALARY */ NUMERIC(15,2),
  PLUS_TAXED /* TYPE OF COLUMN SALARY_SHEETS_R.PLUS_TAXED */ NUMERIC(15,2),
  PLUS_NOTTAXED /* TYPE OF COLUMN SALARY_SHEETS_R.PLUS_NOTTAXED */ NUMERIC(15,2),
  PLUS_AUTHORS_FEES /* TYPE OF COLUMN SALARY_SHEETS_R.PLUS_AUTHORS_FEES */ NUMERIC(15,2),
  PLUS_NOSAI /* TYPE OF COLUMN SALARY_SHEETS_R.PLUS_NOSAI */ NUMERIC(15,2),
  TOTALPAY /* TYPE OF COLUMN SALARY_SHEETS_R.SALARY */ NUMERIC(15,2),
  FORSAI /* TYPE OF COLUMN SALARY_SHEETS_R.AMOUNT_BEFORE_SN */ NUMERIC(15,2),
  DNSN_AMOUNT /* TYPE OF COLUMN SALARY_SHEETS_R.DNSN_AMOUNT */ NUMERIC(15,2),
  DDSN_AMOUNT /* TYPE OF COLUMN SALARY_SHEETS_R.DDSN_AMOUNT */ NUMERIC(15,2),
  UNTAXED_MINIMUM /* TYPE OF COLUMN SALARY_SHEETS_R.IIN_EXEMPT_UNTAXED_MINIMUM */ NUMERIC(15,2),
  IIN_EXEMPT_DEPENDANTS /* TYPE OF COLUMN SALARY_SHEETS_R.IIN_EXEMPT_DEPENDANTS */ NUMERIC(15,2),
  IIN_EXEMPT_INVALIDITY /* TYPE OF COLUMN SALARY_SHEETS_R.IIN_EXEMPT_INVALIDITY */ NUMERIC(15,2),
  IIN_EXEMPT_NATIONAL_MOVEMENT /* TYPE OF COLUMN SALARY_SHEETS_R.IIN_EXEMPT_NATIONAL_MOVEMENT */ NUMERIC(15,2),
  IIN_EXEMPT_RETALIATION /* TYPE OF COLUMN SALARY_SHEETS_R.IIN_EXEMPT_RETALIATION */ NUMERIC(15,2),
  IIN_EXEMPT_EXPENSES /* TYPE OF COLUMN SALARY_SHEETS_R.IIN_EXEMPT_EXPENSES */ NUMERIC(15,2),
  PLUS_PF_NOTTAXED /* TYPE OF COLUMN SALARY_SHEETS_R.PLUS_PF_NOTTAXED */ NUMERIC(15,2),
  PLUS_LI_NOTTAXED /* TYPE OF COLUMN SALARY_SHEETS_R.PLUS_LI_NOTTAXED */ NUMERIC(15,2),
  PLUS_HI_NOTTAXED /* TYPE OF COLUMN SALARY_SHEETS_R.PLUS_HI_NOTTAXED */ NUMERIC(15,2),
  IIN_AMOUNT /* TYPE OF COLUMN SALARY_SHEETS_R.IIN_AMOUNT */ NUMERIC(15,2),
  MINUS_BEFORE_IIN /* TYPE OF COLUMN SALARY_SHEETS_R.MINUS_BEFORE_IIN */ NUMERIC(15,2),
  MINUS_AFTER_IIN /* TYPE OF COLUMN SALARY_SHEETS_R.MINUS_AFTER_IIN */ NUMERIC(15,2),
  PAY /* TYPE OF COLUMN SALARY_SHEETS_R.PAY */ NUMERIC(15,2),
  ADVANCE /* TYPE OF COLUMN SALARY_SHEETS_R.ADVANCE */ NUMERIC(15,2),
  PAYT /* TYPE OF COLUMN SALARY_SHEETS_R.PAYT */ NUMERIC(15,2),
  PAID /* TYPE OF COLUMN PAYLISTS_R.TPAY */ NUMERIC(15,2))
AS
BEGIN
  SUSPEND;
END
^

ALTER PROCEDURE SP_SALARY_SHEETS_R_HIST_01(
  PID INTEGER)
RETURNS (
  IDH /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.ID */ INTEGER,
  ID /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.ID */ INTEGER,
  IDS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IDS */ INTEGER,
  IDSX /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IDSX */ INTEGER,
  IDST /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IDST */ INTEGER,
  IS_TEMP /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IS_TEMP */ SMALLINT,
  TYPE_TAG /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.TYPE_TAG */ SMALLINT,
  IDP /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IDP */ INTEGER,
  IDAM /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IDAM */ INTEGER,
  SNR /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.SNR */ SMALLINT,
  FNAME /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FNAME */ VARCHAR(20) /* COLLATE UTF8 - default */,
  LNAME /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.LNAME */ VARCHAR(20) /* COLLATE UTF8 - default */,
  POSITION_TITLE /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.POSITION_TITLE */ VARCHAR(50) /* COLLATE UTF8 - default */,
  TERRITORIAL_CODE /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.TERRITORIAL_CODE */ VARCHAR(20) /* COLLATE UTF8 - default */,
  CALENDAR_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.CALENDAR_DAYS */ INTEGER,
  CALENDAR_DAYS_USE /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.CALENDAR_DAYS_USE */ INTEGER,
  MONTH_WORKDAYS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.MONTH_WORKDAYS */ INTEGER,
  MONTH_WORKHOURS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.MONTH_WORKHOURS */ FLOAT,
  PLAN_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLAN_DAYS */ INTEGER,
  PLAN_HOURS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLAN_HOURS */ FLOAT,
  PLAN_HOURS_NIGHT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLAN_HOURS_NIGHT */ FLOAT,
  PLAN_HOURS_OVERTIME /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLAN_HOURS_OVERTIME */ FLOAT,
  FACT_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_DAYS */ INTEGER,
  FACT_HOURS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_HOURS */ FLOAT,
  FACT_HOURS_NIGHT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_HOURS_NIGHT */ FLOAT,
  FACT_HOURS_OVERTIME /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_HOURS_OVERTIME */ FLOAT,
  PLAN_WORK_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLAN_WORK_DAYS */ INTEGER,
  PLAN_WORK_HOURS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLAN_WORK_HOURS */ FLOAT,
  PLAN_WORK_HOURS_NIGHT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLAN_WORK_HOURS_NIGHT */ FLOAT,
  PLAN_WORK_HOURS_OVERTIME /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLAN_WORK_HOURS_OVERTIME */ FLOAT,
  FACT_WORK_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_WORK_DAYS */ INTEGER,
  FACT_WORK_HOURS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_WORK_HOURS */ FLOAT,
  FACT_WORK_HOURS_NIGHT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_WORK_HOURS_NIGHT */ FLOAT,
  FACT_WORK_HOURS_OVERTIME /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_WORK_HOURS_OVERTIME */ FLOAT,
  PLAN_HOLIDAYS_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLAN_HOLIDAYS_DAYS */ INTEGER,
  PLAN_HOLIDAYS_HOURS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLAN_HOLIDAYS_HOURS */ FLOAT,
  PLAN_HOLIDAYS_HOURS_NIGHT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLAN_HOLIDAYS_HOURS_NIGHT */ FLOAT,
  PLAN_HOLIDAYS_HOURS_OVERTIME /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLAN_HOLIDAYS_HOURS_OVERTIME */ FLOAT,
  FACT_HOLIDAYS_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_HOLIDAYS_DAYS */ INTEGER,
  FACT_HOLIDAYS_HOURS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_HOLIDAYS_HOURS */ FLOAT,
  FACT_HOLIDAYS_HOURS_NIGHT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_HOLIDAYS_HOURS_NIGHT */ FLOAT,
  FACT_HOLIDAYS_HOURS_OVERTIME /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_HOLIDAYS_HOURS_OVERTIME */ FLOAT,
  SALARY /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY */ NUMERIC(15,2),
  SALARY_DAY /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY_DAY */ NUMERIC(15,2),
  SALARY_NIGHT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY_NIGHT */ NUMERIC(15,2),
  SALARY_OVERTIME /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY_OVERTIME */ NUMERIC(15,2),
  SALARY_HOLIDAYS_DAY /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY_HOLIDAYS_DAY */ NUMERIC(15,2),
  SALARY_HOLIDAYS_NIGHT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY_HOLIDAYS_NIGHT */ NUMERIC(15,2),
  SALARY_HOLIDAYS_OVERTIME /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY_HOLIDAYS_OVERTIME */ NUMERIC(15,2),
  SALARY_PAID_HOLIDAYS_DAY /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY_PAID_HOLIDAYS_DAY */ NUMERIC(15,2),
  SALARY_PAID_HOLIDAYS_NIGHT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY_PAID_HOLIDAYS_NIGHT */ NUMERIC(15,2),
  SALARY_PIECEWORK /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY_PIECEWORK */ NUMERIC(15,2),
  SICKDAYS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.SICKDAYS */ INTEGER,
  SICKDAYS_PAY /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.SICKDAYS_PAY */ NUMERIC(15,2),
  ACCIDENT_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.ACCIDENT_DAYS */ INTEGER,
  ACCIDENT_PAY /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.ACCIDENT_PAY */ NUMERIC(15,2),
  AVERAGE_INCOME_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.AVERAGE_INCOME_DAYS */ INTEGER,
  AVERAGE_INCOME_PAY /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.AVERAGE_INCOME_PAY */ NUMERIC(15,2),
  FACT_AVPAY_FREE_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_AVPAY_FREE_DAYS */ INTEGER,
  FACT_AVPAY_FREE_HOURS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_AVPAY_FREE_HOURS */ FLOAT,
  FACT_AVPAY_WORK_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_AVPAY_WORK_DAYS */ INTEGER,
  FACT_AVPAY_WORKINHOLIDAYS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_AVPAY_WORKINHOLIDAYS */ INTEGER,
  FACT_AVPAY_HOURS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_AVPAY_HOURS */ FLOAT,
  FACT_AVPAY_HOURS_OVERTIME /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_AVPAY_HOURS_OVERTIME */ FLOAT,
  FACT_AVPAY_HOLIDAYS_HOURS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_AVPAY_HOLIDAYS_HOURS */ FLOAT,
  FACT_AVPAY_HOLIDAYS_HOURS_OVERT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_AVPAY_HOLIDAYS_HOURS_OVERT */ FLOAT,
  SALARY_AVPAY_FREE_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY_AVPAY_FREE_DAYS */ NUMERIC(15,2),
  SALARY_AVPAY_WORK_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY_AVPAY_WORK_DAYS */ NUMERIC(15,2),
  SALARY_AVPAY_WORK_DAYS_OVERTIME /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY_AVPAY_WORK_DAYS_OVERTIME */ NUMERIC(15,2),
  SALARY_AVPAY_HOLIDAYS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY_AVPAY_HOLIDAYS */ NUMERIC(15,2),
  SALARY_AVPAY_HOLIDAYS_OVERTIME /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY_AVPAY_HOLIDAYS_OVERTIME */ NUMERIC(15,2),
  BUSINESS_TRIP_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.BUSINESS_TRIP_DAYS */ INTEGER,
  BUSINESS_TRIP_PAY /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.BUSINESS_TRIP_PAY */ NUMERIC(15,2),
  PAID_HOLIDAYS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PAID_HOLIDAYS */ INTEGER,
  PAID_HOLIDAYS_PAY /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PAID_HOLIDAYS_PAY */ NUMERIC(15,2),
  VACATION_DAYS_CURRENT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_DAYS_CURRENT */ FLOAT,
  VACATION_DAYS_NEXT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_DAYS_NEXT */ FLOAT,
  VACATION_HOURS_CURRENT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_HOURS_CURRENT */ FLOAT,
  VACATION_HOURS_NEXT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_HOURS_NEXT */ FLOAT,
  VACATION_PAY_CURRENT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_PAY_CURRENT */ NUMERIC(15,2),
  VACATION_PAY_NEXT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_PAY_NEXT */ NUMERIC(15,2),
  VACATION_DNS_NEXT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_DNS_NEXT */ NUMERIC(15,2),
  VACATION_DDS_NEXT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_DDS_NEXT */ NUMERIC(15,2),
  VACATION_IIN_NEXT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_IIN_NEXT */ NUMERIC(15,2),
  VACATION_IIN_REDUCE_NEXT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_IIN_REDUCE_NEXT */ NUMERIC(15,2),
  VACATION_CASH_NEXT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_CASH_NEXT */ NUMERIC(15,2),
  VACATION_PAY_PREV /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_PAY_PREV */ NUMERIC(15,2),
  VACATION_DNS_PREV /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_DNS_PREV */ NUMERIC(15,2),
  VACATION_DDS_PREV /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_DDS_PREV */ NUMERIC(15,2),
  VACATION_IIN_PREV /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_IIN_PREV */ NUMERIC(15,2),
  PLUS_TAXED /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLUS_TAXED */ NUMERIC(15,2),
  PLUS_NOTTAXED /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLUS_NOTTAXED */ NUMERIC(15,2),
  PLUS_NOSAI /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLUS_NOSAI */ NUMERIC(15,2),
  PLUS_AUTHORS_FEES /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLUS_AUTHORS_FEES */ NUMERIC(15,2),
  MINUS_BEFORE_IIN /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.MINUS_BEFORE_IIN */ NUMERIC(15,2),
  MINUS_AFTER_IIN /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.MINUS_AFTER_IIN */ NUMERIC(15,2),
  PLUS_PF_NOTTAXED /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLUS_PF_NOTTAXED */ NUMERIC(15,2),
  PLUS_PF_TAXED /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLUS_PF_TAXED */ NUMERIC(15,2),
  PLUS_LI_NOTTAXED /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLUS_LI_NOTTAXED */ NUMERIC(15,2),
  PLUS_LI_TAXED /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLUS_LI_TAXED */ NUMERIC(15,2),
  PLUS_HI_NOTTAXED /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLUS_HI_NOTTAXED */ NUMERIC(15,2),
  PLUS_HI_TAXED /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLUS_HI_TAXED */ NUMERIC(15,2),
  PLUS_NP_TAXED /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLUS_NP_TAXED */ NUMERIC(15,2),
  PLUS_NP_NOTTAXED /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLUS_NP_NOTTAXED */ NUMERIC(15,2),
  PLUS_NP_NOSAI /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLUS_NP_NOSAI */ NUMERIC(15,2),
  TOTAL_BEFORE_TAXES /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.TOTAL_BEFORE_TAXES */ NUMERIC(15,2),
  ADJUSTED_AMOUNT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.ADJUSTED_AMOUNT */ NUMERIC(15,2),
  AMOUNT_BEFORE_SN /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.AMOUNT_BEFORE_SN */ NUMERIC(15,2),
  AMOUNT_BEFORE_SN_REVERSE /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.AMOUNT_BEFORE_SN_REVERSE */ NUMERIC(15,2),
  RATE_DNSN /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.RATE_DNSN */ NUMERIC(15,2),
  RATE_DDSN /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.RATE_DDSN */ NUMERIC(15,2),
  DNSN_AMOUNT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.DNSN_AMOUNT */ NUMERIC(15,2),
  DDSN_AMOUNT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.DDSN_AMOUNT */ NUMERIC(15,2),
  SN_AMOUNT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.SN_AMOUNT */ NUMERIC(15,2),
  DNSN_AMOUNT_REVERSE /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.DNSN_AMOUNT_REVERSE */ NUMERIC(15,2),
  DDSN_AMOUNT_REVERSE /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.DDSN_AMOUNT_REVERSE */ NUMERIC(15,2),
  SN_MAX_AMOUNT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.SN_MAX_AMOUNT */ NUMERIC(15,2),
  IIN_EXEMPT_UNTAXED_MINIMUM0 /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_EXEMPT_UNTAXED_MINIMUM0 */ NUMERIC(15,2),
  IIN_EXEMPT_DEPENDANTS0 /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_EXEMPT_DEPENDANTS0 */ NUMERIC(15,2),
  IIN_EXEMPT_RETALIATION0 /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_EXEMPT_RETALIATION0 */ NUMERIC(15,2),
  IIN_EXEMPT_INVALIDITY0 /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_EXEMPT_INVALIDITY0 */ NUMERIC(15,2),
  IIN_EXEMPT_NATIONAL_MOVEMENT0 /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_EXEMPT_NATIONAL_MOVEMENT0 */ NUMERIC(15,2),
  IIN_EXEMPT_UNTAXED_MINIMUM /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_EXEMPT_UNTAXED_MINIMUM */ NUMERIC(15,2),
  IIN_EXEMPT_DEPENDANTS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_EXEMPT_DEPENDANTS */ NUMERIC(15,2),
  IIN_EXEMPT_RETALIATION /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_EXEMPT_RETALIATION */ NUMERIC(15,2),
  IIN_EXEMPT_INVALIDITY /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_EXEMPT_INVALIDITY */ NUMERIC(15,2),
  IIN_EXEMPT_NATIONAL_MOVEMENT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_EXEMPT_NATIONAL_MOVEMENT */ NUMERIC(15,2),
  IIN_EXEMPT_EXPENSES /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_EXEMPT_EXPENSES */ NUMERIC(15,2),
  IIN_EXEMPT_2TP /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_EXEMPT_2TP */ SMALLINT,
  IIN_EXEMPT_20 /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_EXEMPT_20 */ NUMERIC(15,2),
  IIN_EXEMPT_2 /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_EXEMPT_2 */ NUMERIC(15,2),
  AMOUNT_BEFORE_IIN /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.AMOUNT_BEFORE_IIN */ NUMERIC(15,2),
  AMOUNT_BEFORE_IIN_REVERSE /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.AMOUNT_BEFORE_IIN_REVERSE */ NUMERIC(15,2),
  RATE_IIN /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.RATE_IIN */ NUMERIC(15,2),
  RATE_IIN2 /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.RATE_IIN2 */ NUMERIC(15,2),
  IIN_AMOUNT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_AMOUNT */ NUMERIC(15,2),
  IIN_AMOUNT_REVERSE /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_AMOUNT_REVERSE */ NUMERIC(15,2),
  URVN_AMAOUNT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.URVN_AMAOUNT */ NUMERIC(15,2),
  PLUS_NOT_PAID /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLUS_NOT_PAID */ NUMERIC(15,2),
  VACATION_ADVANCE_CURRENT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_ADVANCE_CURRENT */ NUMERIC(15,2),
  VACATION_ADVANCE_NEXT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_ADVANCE_NEXT */ NUMERIC(15,2),
  VACATION_ADVANCE_PREV /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_ADVANCE_PREV */ NUMERIC(15,2),
  ADVANCE /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.ADVANCE */ NUMERIC(15,2),
  PAY0 /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PAY0 */ NUMERIC(15,2),
  PAY /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PAY */ NUMERIC(15,2),
  PAYT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PAYT */ NUMERIC(15,2),
  PAY_DATE /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PAY_DATE */ DATE,
  COMMENTS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.COMMENTS */ VARCHAR(255) /* COLLATE UTF8 - default */,
  WITHHOLD_FROM_PAY /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.WITHHOLD_FROM_PAY */ NUMERIC(15,2),
  FORAVPAYCALC_BRUTO /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FORAVPAYCALC_BRUTO */ NUMERIC(15,2),
  FORAVPAYCALC_PAYOUT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FORAVPAYCALC_PAYOUT */ NUMERIC(15,2),
  FORAVPAYCALC_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FORAVPAYCALC_DAYS */ INTEGER,
  FORAVPAYCALC_HOURS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FORAVPAYCALC_HOURS */ FLOAT,
  AVPAYCALC_CALDAY /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.AVPAYCALC_CALDAY */ NUMERIC(13,4),
  AVPAYCALC_DAY /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.AVPAYCALC_DAY */ NUMERIC(13,4),
  AVPAYCALC_HOUR /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.AVPAYCALC_HOUR */ NUMERIC(13,4),
  DT_EDITED /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.DT_EDITED */ TIMESTAMP,
  CALC_VER /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.CALC_VER */ INTEGER)
AS
BEGIN
  SUSPEND;
END
^

ALTER PROCEDURE SP_SALARY_SHEETS_R_HIST_02(
  PIDSX INTEGER,
  PTIME1 TIMESTAMP,
  PTIME2 TIMESTAMP)
RETURNS (
  IDH /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.ID */ INTEGER,
  ID /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.ID */ INTEGER,
  IDS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IDS */ INTEGER,
  IDSX /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IDSX */ INTEGER,
  IDST /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IDST */ INTEGER,
  IS_TEMP /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IS_TEMP */ SMALLINT,
  TYPE_TAG /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.TYPE_TAG */ SMALLINT,
  IDP /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IDP */ INTEGER,
  IDAM /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IDAM */ INTEGER,
  SNR /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.SNR */ SMALLINT,
  FNAME /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FNAME */ VARCHAR(20) /* COLLATE UTF8 - default */,
  LNAME /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.LNAME */ VARCHAR(20) /* COLLATE UTF8 - default */,
  POSITION_TITLE /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.POSITION_TITLE */ VARCHAR(50) /* COLLATE UTF8 - default */,
  TERRITORIAL_CODE /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.TERRITORIAL_CODE */ VARCHAR(20) /* COLLATE UTF8 - default */,
  CALENDAR_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.CALENDAR_DAYS */ INTEGER,
  CALENDAR_DAYS_USE /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.CALENDAR_DAYS_USE */ INTEGER,
  MONTH_WORKDAYS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.MONTH_WORKDAYS */ INTEGER,
  MONTH_WORKHOURS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.MONTH_WORKHOURS */ FLOAT,
  PLAN_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLAN_DAYS */ INTEGER,
  PLAN_HOURS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLAN_HOURS */ FLOAT,
  PLAN_HOURS_NIGHT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLAN_HOURS_NIGHT */ FLOAT,
  PLAN_HOURS_OVERTIME /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLAN_HOURS_OVERTIME */ FLOAT,
  FACT_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_DAYS */ INTEGER,
  FACT_HOURS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_HOURS */ FLOAT,
  FACT_HOURS_NIGHT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_HOURS_NIGHT */ FLOAT,
  FACT_HOURS_OVERTIME /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_HOURS_OVERTIME */ FLOAT,
  PLAN_WORK_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLAN_WORK_DAYS */ INTEGER,
  PLAN_WORK_HOURS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLAN_WORK_HOURS */ FLOAT,
  PLAN_WORK_HOURS_NIGHT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLAN_WORK_HOURS_NIGHT */ FLOAT,
  PLAN_WORK_HOURS_OVERTIME /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLAN_WORK_HOURS_OVERTIME */ FLOAT,
  FACT_WORK_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_WORK_DAYS */ INTEGER,
  FACT_WORK_HOURS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_WORK_HOURS */ FLOAT,
  FACT_WORK_HOURS_NIGHT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_WORK_HOURS_NIGHT */ FLOAT,
  FACT_WORK_HOURS_OVERTIME /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_WORK_HOURS_OVERTIME */ FLOAT,
  PLAN_HOLIDAYS_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLAN_HOLIDAYS_DAYS */ INTEGER,
  PLAN_HOLIDAYS_HOURS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLAN_HOLIDAYS_HOURS */ FLOAT,
  PLAN_HOLIDAYS_HOURS_NIGHT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLAN_HOLIDAYS_HOURS_NIGHT */ FLOAT,
  PLAN_HOLIDAYS_HOURS_OVERTIME /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLAN_HOLIDAYS_HOURS_OVERTIME */ FLOAT,
  FACT_HOLIDAYS_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_HOLIDAYS_DAYS */ INTEGER,
  FACT_HOLIDAYS_HOURS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_HOLIDAYS_HOURS */ FLOAT,
  FACT_HOLIDAYS_HOURS_NIGHT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_HOLIDAYS_HOURS_NIGHT */ FLOAT,
  FACT_HOLIDAYS_HOURS_OVERTIME /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_HOLIDAYS_HOURS_OVERTIME */ FLOAT,
  SALARY /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY */ NUMERIC(15,2),
  SALARY_DAY /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY_DAY */ NUMERIC(15,2),
  SALARY_NIGHT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY_NIGHT */ NUMERIC(15,2),
  SALARY_OVERTIME /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY_OVERTIME */ NUMERIC(15,2),
  SALARY_HOLIDAYS_DAY /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY_HOLIDAYS_DAY */ NUMERIC(15,2),
  SALARY_HOLIDAYS_NIGHT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY_HOLIDAYS_NIGHT */ NUMERIC(15,2),
  SALARY_HOLIDAYS_OVERTIME /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY_HOLIDAYS_OVERTIME */ NUMERIC(15,2),
  SALARY_PAID_HOLIDAYS_DAY /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY_PAID_HOLIDAYS_DAY */ NUMERIC(15,2),
  SALARY_PAID_HOLIDAYS_NIGHT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY_PAID_HOLIDAYS_NIGHT */ NUMERIC(15,2),
  SALARY_PIECEWORK /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY_PIECEWORK */ NUMERIC(15,2),
  SICKDAYS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.SICKDAYS */ INTEGER,
  SICKDAYS_PAY /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.SICKDAYS_PAY */ NUMERIC(15,2),
  ACCIDENT_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.ACCIDENT_DAYS */ INTEGER,
  ACCIDENT_PAY /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.ACCIDENT_PAY */ NUMERIC(15,2),
  AVERAGE_INCOME_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.AVERAGE_INCOME_DAYS */ INTEGER,
  AVERAGE_INCOME_PAY /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.AVERAGE_INCOME_PAY */ NUMERIC(15,2),
  FACT_AVPAY_FREE_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_AVPAY_FREE_DAYS */ INTEGER,
  FACT_AVPAY_FREE_HOURS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_AVPAY_FREE_HOURS */ FLOAT,
  FACT_AVPAY_WORK_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_AVPAY_WORK_DAYS */ INTEGER,
  FACT_AVPAY_WORKINHOLIDAYS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_AVPAY_WORKINHOLIDAYS */ INTEGER,
  FACT_AVPAY_HOURS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_AVPAY_HOURS */ FLOAT,
  FACT_AVPAY_HOURS_OVERTIME /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_AVPAY_HOURS_OVERTIME */ FLOAT,
  FACT_AVPAY_HOLIDAYS_HOURS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_AVPAY_HOLIDAYS_HOURS */ FLOAT,
  FACT_AVPAY_HOLIDAYS_HOURS_OVERT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_AVPAY_HOLIDAYS_HOURS_OVERT */ FLOAT,
  SALARY_AVPAY_FREE_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY_AVPAY_FREE_DAYS */ NUMERIC(15,2),
  SALARY_AVPAY_WORK_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY_AVPAY_WORK_DAYS */ NUMERIC(15,2),
  SALARY_AVPAY_WORK_DAYS_OVERTIME /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY_AVPAY_WORK_DAYS_OVERTIME */ NUMERIC(15,2),
  SALARY_AVPAY_HOLIDAYS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY_AVPAY_HOLIDAYS */ NUMERIC(15,2),
  SALARY_AVPAY_HOLIDAYS_OVERTIME /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY_AVPAY_HOLIDAYS_OVERTIME */ NUMERIC(15,2),
  BUSINESS_TRIP_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.BUSINESS_TRIP_DAYS */ INTEGER,
  BUSINESS_TRIP_PAY /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.BUSINESS_TRIP_PAY */ NUMERIC(15,2),
  PAID_HOLIDAYS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PAID_HOLIDAYS */ INTEGER,
  PAID_HOLIDAYS_PAY /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PAID_HOLIDAYS_PAY */ NUMERIC(15,2),
  VACATION_DAYS_CURRENT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_DAYS_CURRENT */ FLOAT,
  VACATION_DAYS_NEXT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_DAYS_NEXT */ FLOAT,
  VACATION_HOURS_CURRENT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_HOURS_CURRENT */ FLOAT,
  VACATION_HOURS_NEXT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_HOURS_NEXT */ FLOAT,
  VACATION_PAY_CURRENT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_PAY_CURRENT */ NUMERIC(15,2),
  VACATION_PAY_NEXT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_PAY_NEXT */ NUMERIC(15,2),
  VACATION_DNS_NEXT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_DNS_NEXT */ NUMERIC(15,2),
  VACATION_DDS_NEXT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_DDS_NEXT */ NUMERIC(15,2),
  VACATION_IIN_NEXT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_IIN_NEXT */ NUMERIC(15,2),
  VACATION_IIN_REDUCE_NEXT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_IIN_REDUCE_NEXT */ NUMERIC(15,2),
  VACATION_CASH_NEXT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_CASH_NEXT */ NUMERIC(15,2),
  VACATION_PAY_PREV /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_PAY_PREV */ NUMERIC(15,2),
  VACATION_DNS_PREV /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_DNS_PREV */ NUMERIC(15,2),
  VACATION_DDS_PREV /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_DDS_PREV */ NUMERIC(15,2),
  VACATION_IIN_PREV /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_IIN_PREV */ NUMERIC(15,2),
  PLUS_TAXED /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLUS_TAXED */ NUMERIC(15,2),
  PLUS_NOTTAXED /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLUS_NOTTAXED */ NUMERIC(15,2),
  PLUS_NOSAI /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLUS_NOSAI */ NUMERIC(15,2),
  PLUS_AUTHORS_FEES /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLUS_AUTHORS_FEES */ NUMERIC(15,2),
  MINUS_BEFORE_IIN /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.MINUS_BEFORE_IIN */ NUMERIC(15,2),
  MINUS_AFTER_IIN /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.MINUS_AFTER_IIN */ NUMERIC(15,2),
  PLUS_PF_NOTTAXED /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLUS_PF_NOTTAXED */ NUMERIC(15,2),
  PLUS_PF_TAXED /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLUS_PF_TAXED */ NUMERIC(15,2),
  PLUS_LI_NOTTAXED /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLUS_LI_NOTTAXED */ NUMERIC(15,2),
  PLUS_LI_TAXED /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLUS_LI_TAXED */ NUMERIC(15,2),
  PLUS_HI_NOTTAXED /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLUS_HI_NOTTAXED */ NUMERIC(15,2),
  PLUS_HI_TAXED /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLUS_HI_TAXED */ NUMERIC(15,2),
  PLUS_NP_TAXED /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLUS_NP_TAXED */ NUMERIC(15,2),
  PLUS_NP_NOTTAXED /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLUS_NP_NOTTAXED */ NUMERIC(15,2),
  PLUS_NP_NOSAI /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLUS_NP_NOSAI */ NUMERIC(15,2),
  TOTAL_BEFORE_TAXES /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.TOTAL_BEFORE_TAXES */ NUMERIC(15,2),
  ADJUSTED_AMOUNT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.ADJUSTED_AMOUNT */ NUMERIC(15,2),
  AMOUNT_BEFORE_SN /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.AMOUNT_BEFORE_SN */ NUMERIC(15,2),
  AMOUNT_BEFORE_SN_REVERSE /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.AMOUNT_BEFORE_SN_REVERSE */ NUMERIC(15,2),
  RATE_DNSN /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.RATE_DNSN */ NUMERIC(15,2),
  RATE_DDSN /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.RATE_DDSN */ NUMERIC(15,2),
  DNSN_AMOUNT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.DNSN_AMOUNT */ NUMERIC(15,2),
  DDSN_AMOUNT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.DDSN_AMOUNT */ NUMERIC(15,2),
  SN_AMOUNT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.SN_AMOUNT */ NUMERIC(15,2),
  DNSN_AMOUNT_REVERSE /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.DNSN_AMOUNT_REVERSE */ NUMERIC(15,2),
  DDSN_AMOUNT_REVERSE /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.DDSN_AMOUNT_REVERSE */ NUMERIC(15,2),
  SN_MAX_AMOUNT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.SN_MAX_AMOUNT */ NUMERIC(15,2),
  IIN_EXEMPT_UNTAXED_MINIMUM0 /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_EXEMPT_UNTAXED_MINIMUM0 */ NUMERIC(15,2),
  IIN_EXEMPT_DEPENDANTS0 /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_EXEMPT_DEPENDANTS0 */ NUMERIC(15,2),
  IIN_EXEMPT_RETALIATION0 /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_EXEMPT_RETALIATION0 */ NUMERIC(15,2),
  IIN_EXEMPT_INVALIDITY0 /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_EXEMPT_INVALIDITY0 */ NUMERIC(15,2),
  IIN_EXEMPT_NATIONAL_MOVEMENT0 /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_EXEMPT_NATIONAL_MOVEMENT0 */ NUMERIC(15,2),
  IIN_EXEMPT_UNTAXED_MINIMUM /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_EXEMPT_UNTAXED_MINIMUM */ NUMERIC(15,2),
  IIN_EXEMPT_DEPENDANTS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_EXEMPT_DEPENDANTS */ NUMERIC(15,2),
  IIN_EXEMPT_RETALIATION /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_EXEMPT_RETALIATION */ NUMERIC(15,2),
  IIN_EXEMPT_INVALIDITY /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_EXEMPT_INVALIDITY */ NUMERIC(15,2),
  IIN_EXEMPT_NATIONAL_MOVEMENT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_EXEMPT_NATIONAL_MOVEMENT */ NUMERIC(15,2),
  IIN_EXEMPT_EXPENSES /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_EXEMPT_EXPENSES */ NUMERIC(15,2),
  IIN_EXEMPT_2TP /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_EXEMPT_2TP */ SMALLINT,
  IIN_EXEMPT_20 /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_EXEMPT_20 */ NUMERIC(15,2),
  IIN_EXEMPT_2 /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_EXEMPT_2 */ NUMERIC(15,2),
  AMOUNT_BEFORE_IIN /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.AMOUNT_BEFORE_IIN */ NUMERIC(15,2),
  AMOUNT_BEFORE_IIN_REVERSE /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.AMOUNT_BEFORE_IIN_REVERSE */ NUMERIC(15,2),
  RATE_IIN /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.RATE_IIN */ NUMERIC(15,2),
  RATE_IIN2 /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.RATE_IIN2 */ NUMERIC(15,2),
  IIN_AMOUNT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_AMOUNT */ NUMERIC(15,2),
  IIN_AMOUNT_REVERSE /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_AMOUNT_REVERSE */ NUMERIC(15,2),
  URVN_AMAOUNT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.URVN_AMAOUNT */ NUMERIC(15,2),
  PLUS_NOT_PAID /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLUS_NOT_PAID */ NUMERIC(15,2),
  VACATION_ADVANCE_CURRENT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_ADVANCE_CURRENT */ NUMERIC(15,2),
  VACATION_ADVANCE_NEXT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_ADVANCE_NEXT */ NUMERIC(15,2),
  VACATION_ADVANCE_PREV /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_ADVANCE_PREV */ NUMERIC(15,2),
  ADVANCE /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.ADVANCE */ NUMERIC(15,2),
  PAY0 /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PAY0 */ NUMERIC(15,2),
  PAY /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PAY */ NUMERIC(15,2),
  PAYT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PAYT */ NUMERIC(15,2),
  PAY_DATE /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PAY_DATE */ DATE,
  COMMENTS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.COMMENTS */ VARCHAR(255) /* COLLATE UTF8 - default */,
  WITHHOLD_FROM_PAY /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.WITHHOLD_FROM_PAY */ NUMERIC(15,2),
  FORAVPAYCALC_BRUTO /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FORAVPAYCALC_BRUTO */ NUMERIC(15,2),
  FORAVPAYCALC_PAYOUT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FORAVPAYCALC_PAYOUT */ NUMERIC(15,2),
  FORAVPAYCALC_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FORAVPAYCALC_DAYS */ INTEGER,
  FORAVPAYCALC_HOURS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FORAVPAYCALC_HOURS */ FLOAT,
  AVPAYCALC_CALDAY /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.AVPAYCALC_CALDAY */ NUMERIC(13,4),
  AVPAYCALC_DAY /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.AVPAYCALC_DAY */ NUMERIC(13,4),
  AVPAYCALC_HOUR /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.AVPAYCALC_HOUR */ NUMERIC(13,4),
  DT_EDITED /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.DT_EDITED */ TIMESTAMP,
  CALC_VER /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.CALC_VER */ INTEGER)
AS
BEGIN
  SUSPEND;
END
^

ALTER PROCEDURE SP_SALARY_SHEETS_R_PER_01(
  PYR1 INTEGER,
  PMT1 INTEGER,
  PYR2 INTEGER,
  PMT2 INTEGER)
RETURNS (
  ID /* TYPE OF COLUMN SALARY_SHEETS_R.ID */ INTEGER,
  IDS /* TYPE OF COLUMN SALARY_SHEETS_R.IDS */ INTEGER,
  IDSX /* TYPE OF COLUMN SALARY_SHEETS_R.IDSX */ INTEGER,
  IDST /* TYPE OF COLUMN SALARY_SHEETS_R.IDST */ INTEGER,
  IS_TEMP /* TYPE OF COLUMN SALARY_SHEETS_R.IS_TEMP */ SMALLINT,
  TYPE_TAG /* TYPE OF COLUMN SALARY_SHEETS_R.TYPE_TAG */ SMALLINT,
  IDP /* TYPE OF COLUMN SALARY_SHEETS_R.IDP */ INTEGER,
  IDAM /* TYPE OF COLUMN SALARY_SHEETS_R.IDAM */ INTEGER,
  SNR /* TYPE OF COLUMN SALARY_SHEETS_R.SNR */ SMALLINT,
  FNAME /* TYPE OF COLUMN SALARY_SHEETS_R.FNAME */ VARCHAR(20) /* COLLATE UTF8 - default */,
  LNAME /* TYPE OF COLUMN SALARY_SHEETS_R.LNAME */ VARCHAR(20) /* COLLATE UTF8 - default */,
  POSITION_TITLE /* TYPE OF COLUMN SALARY_SHEETS_R.POSITION_TITLE */ VARCHAR(50) /* COLLATE UTF8 - default */,
  TERRITORIAL_CODE /* TYPE OF COLUMN SALARY_SHEETS_R.TERRITORIAL_CODE */ VARCHAR(20) /* COLLATE UTF8 - default */,
  CALENDAR_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R.CALENDAR_DAYS */ INTEGER,
  CALENDAR_DAYS_USE /* TYPE OF COLUMN SALARY_SHEETS_R.CALENDAR_DAYS_USE */ INTEGER,
  MONTH_WORKDAYS /* TYPE OF COLUMN SALARY_SHEETS_R.MONTH_WORKDAYS */ INTEGER,
  MONTH_WORKHOURS /* TYPE OF COLUMN SALARY_SHEETS_R.MONTH_WORKHOURS */ FLOAT,
  PLAN_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R.PLAN_DAYS */ INTEGER,
  PLAN_HOURS /* TYPE OF COLUMN SALARY_SHEETS_R.PLAN_HOURS */ FLOAT,
  PLAN_HOURS_NIGHT /* TYPE OF COLUMN SALARY_SHEETS_R.PLAN_HOURS_NIGHT */ FLOAT,
  PLAN_HOURS_OVERTIME /* TYPE OF COLUMN SALARY_SHEETS_R.PLAN_HOURS_OVERTIME */ FLOAT,
  FACT_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R.FACT_DAYS */ INTEGER,
  FACT_HOURS /* TYPE OF COLUMN SALARY_SHEETS_R.FACT_HOURS */ FLOAT,
  FACT_HOURS_NIGHT /* TYPE OF COLUMN SALARY_SHEETS_R.FACT_HOURS_NIGHT */ FLOAT,
  FACT_HOURS_OVERTIME /* TYPE OF COLUMN SALARY_SHEETS_R.FACT_HOURS_OVERTIME */ FLOAT,
  PLAN_WORK_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R.PLAN_WORK_DAYS */ INTEGER,
  PLAN_WORK_HOURS /* TYPE OF COLUMN SALARY_SHEETS_R.PLAN_WORK_HOURS */ FLOAT,
  PLAN_WORK_HOURS_NIGHT /* TYPE OF COLUMN SALARY_SHEETS_R.PLAN_WORK_HOURS_NIGHT */ FLOAT,
  PLAN_WORK_HOURS_OVERTIME /* TYPE OF COLUMN SALARY_SHEETS_R.PLAN_WORK_HOURS_OVERTIME */ FLOAT,
  FACT_WORK_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R.FACT_WORK_DAYS */ INTEGER,
  FACT_WORK_HOURS /* TYPE OF COLUMN SALARY_SHEETS_R.FACT_WORK_HOURS */ FLOAT,
  FACT_WORK_HOURS_NIGHT /* TYPE OF COLUMN SALARY_SHEETS_R.FACT_WORK_HOURS_NIGHT */ FLOAT,
  FACT_WORK_HOURS_OVERTIME /* TYPE OF COLUMN SALARY_SHEETS_R.FACT_WORK_HOURS_OVERTIME */ FLOAT,
  PLAN_HOLIDAYS_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R.PLAN_HOLIDAYS_DAYS */ INTEGER,
  PLAN_HOLIDAYS_HOURS /* TYPE OF COLUMN SALARY_SHEETS_R.PLAN_HOLIDAYS_HOURS */ FLOAT,
  PLAN_HOLIDAYS_HOURS_NIGHT /* TYPE OF COLUMN SALARY_SHEETS_R.PLAN_HOLIDAYS_HOURS_NIGHT */ FLOAT,
  PLAN_HOLIDAYS_HOURS_OVERTIME /* TYPE OF COLUMN SALARY_SHEETS_R.PLAN_HOLIDAYS_HOURS_OVERTIME */ FLOAT,
  FACT_HOLIDAYS_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R.FACT_HOLIDAYS_DAYS */ INTEGER,
  FACT_HOLIDAYS_HOURS /* TYPE OF COLUMN SALARY_SHEETS_R.FACT_HOLIDAYS_HOURS */ FLOAT,
  FACT_HOLIDAYS_HOURS_NIGHT /* TYPE OF COLUMN SALARY_SHEETS_R.FACT_HOLIDAYS_HOURS_NIGHT */ FLOAT,
  FACT_HOLIDAYS_HOURS_OVERTIME /* TYPE OF COLUMN SALARY_SHEETS_R.FACT_HOLIDAYS_HOURS_OVERTIME */ FLOAT,
  SALARY /* TYPE OF COLUMN SALARY_SHEETS_R.SALARY */ NUMERIC(15,2),
  SALARY_DAY /* TYPE OF COLUMN SALARY_SHEETS_R.SALARY_DAY */ NUMERIC(15,2),
  SALARY_NIGHT /* TYPE OF COLUMN SALARY_SHEETS_R.SALARY_NIGHT */ NUMERIC(15,2),
  SALARY_OVERTIME /* TYPE OF COLUMN SALARY_SHEETS_R.SALARY_OVERTIME */ NUMERIC(15,2),
  SALARY_HOLIDAYS_DAY /* TYPE OF COLUMN SALARY_SHEETS_R.SALARY_HOLIDAYS_DAY */ NUMERIC(15,2),
  SALARY_HOLIDAYS_NIGHT /* TYPE OF COLUMN SALARY_SHEETS_R.SALARY_HOLIDAYS_NIGHT */ NUMERIC(15,2),
  SALARY_HOLIDAYS_OVERTIME /* TYPE OF COLUMN SALARY_SHEETS_R.SALARY_HOLIDAYS_OVERTIME */ NUMERIC(15,2),
  SALARY_PAID_HOLIDAYS_DAY /* TYPE OF COLUMN SALARY_SHEETS_R.SALARY_PAID_HOLIDAYS_DAY */ NUMERIC(15,2),
  SALARY_PAID_HOLIDAYS_NIGHT /* TYPE OF COLUMN SALARY_SHEETS_R.SALARY_PAID_HOLIDAYS_NIGHT */ NUMERIC(15,2),
  SALARY_PIECEWORK /* TYPE OF COLUMN SALARY_SHEETS_R.SALARY_PIECEWORK */ NUMERIC(15,2),
  SICKDAYS /* TYPE OF COLUMN SALARY_SHEETS_R.SICKDAYS */ INTEGER,
  SICKDAYS_PAY /* TYPE OF COLUMN SALARY_SHEETS_R.SICKDAYS_PAY */ NUMERIC(15,2),
  ACCIDENT_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R.ACCIDENT_DAYS */ INTEGER,
  ACCIDENT_PAY /* TYPE OF COLUMN SALARY_SHEETS_R.ACCIDENT_PAY */ NUMERIC(15,2),
  AVERAGE_INCOME_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R.AVERAGE_INCOME_DAYS */ INTEGER,
  AVERAGE_INCOME_PAY /* TYPE OF COLUMN SALARY_SHEETS_R.AVERAGE_INCOME_PAY */ NUMERIC(15,2),
  FACT_AVPAY_FREE_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R.FACT_AVPAY_FREE_DAYS */ INTEGER,
  FACT_AVPAY_FREE_HOURS /* TYPE OF COLUMN SALARY_SHEETS_R.FACT_AVPAY_FREE_HOURS */ FLOAT,
  FACT_AVPAY_WORK_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R.FACT_AVPAY_WORK_DAYS */ INTEGER,
  FACT_AVPAY_WORKINHOLIDAYS /* TYPE OF COLUMN SALARY_SHEETS_R.FACT_AVPAY_WORKINHOLIDAYS */ INTEGER,
  FACT_AVPAY_HOURS /* TYPE OF COLUMN SALARY_SHEETS_R.FACT_AVPAY_HOURS */ FLOAT,
  FACT_AVPAY_HOURS_OVERTIME /* TYPE OF COLUMN SALARY_SHEETS_R.FACT_AVPAY_HOURS_OVERTIME */ FLOAT,
  FACT_AVPAY_HOLIDAYS_HOURS /* TYPE OF COLUMN SALARY_SHEETS_R.FACT_AVPAY_HOLIDAYS_HOURS */ FLOAT,
  FACT_AVPAY_HOLIDAYS_HOURS_OVERT /* TYPE OF COLUMN SALARY_SHEETS_R.FACT_AVPAY_HOLIDAYS_HOURS_OVERT */ FLOAT,
  SALARY_AVPAY_FREE_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R.SALARY_AVPAY_FREE_DAYS */ NUMERIC(15,2),
  SALARY_AVPAY_WORK_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R.SALARY_AVPAY_WORK_DAYS */ NUMERIC(15,2),
  SALARY_AVPAY_WORK_DAYS_OVERTIME /* TYPE OF COLUMN SALARY_SHEETS_R.SALARY_AVPAY_WORK_DAYS_OVERTIME */ NUMERIC(15,2),
  SALARY_AVPAY_HOLIDAYS /* TYPE OF COLUMN SALARY_SHEETS_R.SALARY_AVPAY_HOLIDAYS */ NUMERIC(15,2),
  SALARY_AVPAY_HOLIDAYS_OVERTIME /* TYPE OF COLUMN SALARY_SHEETS_R.SALARY_AVPAY_HOLIDAYS_OVERTIME */ NUMERIC(15,2),
  BUSINESS_TRIP_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R.BUSINESS_TRIP_DAYS */ INTEGER,
  BUSINESS_TRIP_PAY /* TYPE OF COLUMN SALARY_SHEETS_R.BUSINESS_TRIP_PAY */ NUMERIC(15,2),
  PAID_HOLIDAYS /* TYPE OF COLUMN SALARY_SHEETS_R.PAID_HOLIDAYS */ INTEGER,
  PAID_HOLIDAYS_PAY /* TYPE OF COLUMN SALARY_SHEETS_R.PAID_HOLIDAYS_PAY */ NUMERIC(15,2),
  VACATION_DAYS_CURRENT /* TYPE OF COLUMN SALARY_SHEETS_R.VACATION_DAYS_CURRENT */ FLOAT,
  VACATION_DAYS_NEXT /* TYPE OF COLUMN SALARY_SHEETS_R.VACATION_DAYS_NEXT */ FLOAT,
  VACATION_HOURS_CURRENT /* TYPE OF COLUMN SALARY_SHEETS_R.VACATION_HOURS_CURRENT */ FLOAT,
  VACATION_HOURS_NEXT /* TYPE OF COLUMN SALARY_SHEETS_R.VACATION_HOURS_NEXT */ FLOAT,
  VACATION_PAY_CURRENT /* TYPE OF COLUMN SALARY_SHEETS_R.VACATION_PAY_CURRENT */ NUMERIC(15,2),
  VACATION_PAY_NEXT /* TYPE OF COLUMN SALARY_SHEETS_R.VACATION_PAY_NEXT */ NUMERIC(15,2),
  VACATION_DNS_NEXT /* TYPE OF COLUMN SALARY_SHEETS_R.VACATION_DNS_NEXT */ NUMERIC(15,2),
  VACATION_DDS_NEXT /* TYPE OF COLUMN SALARY_SHEETS_R.VACATION_DDS_NEXT */ NUMERIC(15,2),
  VACATION_IIN_NEXT /* TYPE OF COLUMN SALARY_SHEETS_R.VACATION_IIN_NEXT */ NUMERIC(15,2),
  VACATION_IIN_REDUCE_NEXT /* TYPE OF COLUMN SALARY_SHEETS_R.VACATION_IIN_REDUCE_NEXT */ NUMERIC(15,2),
  VACATION_CASH_NEXT /* TYPE OF COLUMN SALARY_SHEETS_R.VACATION_CASH_NEXT */ NUMERIC(15,2),
  VACATION_PAY_PREV /* TYPE OF COLUMN SALARY_SHEETS_R.VACATION_PAY_PREV */ NUMERIC(15,2),
  VACATION_DNS_PREV /* TYPE OF COLUMN SALARY_SHEETS_R.VACATION_DNS_PREV */ NUMERIC(15,2),
  VACATION_DDS_PREV /* TYPE OF COLUMN SALARY_SHEETS_R.VACATION_DDS_PREV */ NUMERIC(15,2),
  VACATION_IIN_PREV /* TYPE OF COLUMN SALARY_SHEETS_R.VACATION_IIN_PREV */ NUMERIC(15,2),
  PLUS_TAXED /* TYPE OF COLUMN SALARY_SHEETS_R.PLUS_TAXED */ NUMERIC(15,2),
  PLUS_NOTTAXED /* TYPE OF COLUMN SALARY_SHEETS_R.PLUS_NOTTAXED */ NUMERIC(15,2),
  PLUS_NOSAI /* TYPE OF COLUMN SALARY_SHEETS_R.PLUS_NOSAI */ NUMERIC(15,2),
  PLUS_AUTHORS_FEES /* TYPE OF COLUMN SALARY_SHEETS_R.PLUS_AUTHORS_FEES */ NUMERIC(15,2),
  MINUS_BEFORE_IIN /* TYPE OF COLUMN SALARY_SHEETS_R.MINUS_BEFORE_IIN */ NUMERIC(15,2),
  MINUS_AFTER_IIN /* TYPE OF COLUMN SALARY_SHEETS_R.MINUS_AFTER_IIN */ NUMERIC(15,2),
  PLUS_PF_NOTTAXED /* TYPE OF COLUMN SALARY_SHEETS_R.PLUS_PF_NOTTAXED */ NUMERIC(15,2),
  PLUS_PF_TAXED /* TYPE OF COLUMN SALARY_SHEETS_R.PLUS_PF_TAXED */ NUMERIC(15,2),
  PLUS_LI_NOTTAXED /* TYPE OF COLUMN SALARY_SHEETS_R.PLUS_LI_NOTTAXED */ NUMERIC(15,2),
  PLUS_LI_TAXED /* TYPE OF COLUMN SALARY_SHEETS_R.PLUS_LI_TAXED */ NUMERIC(15,2),
  PLUS_HI_NOTTAXED /* TYPE OF COLUMN SALARY_SHEETS_R.PLUS_HI_NOTTAXED */ NUMERIC(15,2),
  PLUS_HI_TAXED /* TYPE OF COLUMN SALARY_SHEETS_R.PLUS_HI_TAXED */ NUMERIC(15,2),
  PLUS_NP_TAXED /* TYPE OF COLUMN SALARY_SHEETS_R.PLUS_NP_TAXED */ NUMERIC(15,2),
  PLUS_NP_NOTTAXED /* TYPE OF COLUMN SALARY_SHEETS_R.PLUS_NP_NOTTAXED */ NUMERIC(15,2),
  PLUS_NP_NOSAI /* TYPE OF COLUMN SALARY_SHEETS_R.PLUS_NP_NOSAI */ NUMERIC(15,2),
  TOTAL_BEFORE_TAXES /* TYPE OF COLUMN SALARY_SHEETS_R.TOTAL_BEFORE_TAXES */ NUMERIC(15,2),
  ADJUSTED_AMOUNT /* TYPE OF COLUMN SALARY_SHEETS_R.ADJUSTED_AMOUNT */ NUMERIC(15,2),
  AMOUNT_BEFORE_SN /* TYPE OF COLUMN SALARY_SHEETS_R.AMOUNT_BEFORE_SN */ NUMERIC(15,2),
  AMOUNT_BEFORE_SN_REVERSE /* TYPE OF COLUMN SALARY_SHEETS_R.AMOUNT_BEFORE_SN_REVERSE */ NUMERIC(15,2),
  RATE_DNSN /* TYPE OF COLUMN SALARY_SHEETS_R.RATE_DNSN */ NUMERIC(15,2),
  RATE_DDSN /* TYPE OF COLUMN SALARY_SHEETS_R.RATE_DDSN */ NUMERIC(15,2),
  DNSN_AMOUNT /* TYPE OF COLUMN SALARY_SHEETS_R.DNSN_AMOUNT */ NUMERIC(15,2),
  DDSN_AMOUNT /* TYPE OF COLUMN SALARY_SHEETS_R.DDSN_AMOUNT */ NUMERIC(15,2),
  SN_AMOUNT /* TYPE OF COLUMN SALARY_SHEETS_R.SN_AMOUNT */ NUMERIC(15,2),
  DNSN_AMOUNT_REVERSE /* TYPE OF COLUMN SALARY_SHEETS_R.DNSN_AMOUNT_REVERSE */ NUMERIC(15,2),
  DDSN_AMOUNT_REVERSE /* TYPE OF COLUMN SALARY_SHEETS_R.DDSN_AMOUNT_REVERSE */ NUMERIC(15,2),
  SN_MAX_AMOUNT /* TYPE OF COLUMN SALARY_SHEETS_R.SN_MAX_AMOUNT */ NUMERIC(15,2),
  IIN_EXEMPT_UNTAXED_MINIMUM0 /* TYPE OF COLUMN SALARY_SHEETS_R.IIN_EXEMPT_UNTAXED_MINIMUM0 */ NUMERIC(15,2),
  IIN_EXEMPT_DEPENDANTS0 /* TYPE OF COLUMN SALARY_SHEETS_R.IIN_EXEMPT_DEPENDANTS0 */ NUMERIC(15,2),
  IIN_EXEMPT_RETALIATION0 /* TYPE OF COLUMN SALARY_SHEETS_R.IIN_EXEMPT_RETALIATION0 */ NUMERIC(15,2),
  IIN_EXEMPT_INVALIDITY0 /* TYPE OF COLUMN SALARY_SHEETS_R.IIN_EXEMPT_INVALIDITY0 */ NUMERIC(15,2),
  IIN_EXEMPT_NATIONAL_MOVEMENT0 /* TYPE OF COLUMN SALARY_SHEETS_R.IIN_EXEMPT_NATIONAL_MOVEMENT0 */ NUMERIC(15,2),
  IIN_EXEMPT_UNTAXED_MINIMUM /* TYPE OF COLUMN SALARY_SHEETS_R.IIN_EXEMPT_UNTAXED_MINIMUM */ NUMERIC(15,2),
  IIN_EXEMPT_DEPENDANTS /* TYPE OF COLUMN SALARY_SHEETS_R.IIN_EXEMPT_DEPENDANTS */ NUMERIC(15,2),
  IIN_EXEMPT_RETALIATION /* TYPE OF COLUMN SALARY_SHEETS_R.IIN_EXEMPT_RETALIATION */ NUMERIC(15,2),
  IIN_EXEMPT_INVALIDITY /* TYPE OF COLUMN SALARY_SHEETS_R.IIN_EXEMPT_INVALIDITY */ NUMERIC(15,2),
  IIN_EXEMPT_NATIONAL_MOVEMENT /* TYPE OF COLUMN SALARY_SHEETS_R.IIN_EXEMPT_NATIONAL_MOVEMENT */ NUMERIC(15,2),
  IIN_EXEMPT_EXPENSES /* TYPE OF COLUMN SALARY_SHEETS_R.IIN_EXEMPT_EXPENSES */ NUMERIC(15,2),
  IIN_EXEMPT_2TP /* TYPE OF COLUMN SALARY_SHEETS_R.IIN_EXEMPT_2TP */ SMALLINT,
  IIN_EXEMPT_20 /* TYPE OF COLUMN SALARY_SHEETS_R.IIN_EXEMPT_20 */ NUMERIC(15,2),
  IIN_EXEMPT_2 /* TYPE OF COLUMN SALARY_SHEETS_R.IIN_EXEMPT_2 */ NUMERIC(15,2),
  AMOUNT_BEFORE_IIN /* TYPE OF COLUMN SALARY_SHEETS_R.AMOUNT_BEFORE_IIN */ NUMERIC(15,2),
  AMOUNT_BEFORE_IIN_REVERSE /* TYPE OF COLUMN SALARY_SHEETS_R.AMOUNT_BEFORE_IIN_REVERSE */ NUMERIC(15,2),
  RATE_IIN /* TYPE OF COLUMN SALARY_SHEETS_R.RATE_IIN */ NUMERIC(15,2),
  RATE_IIN2 /* TYPE OF COLUMN SALARY_SHEETS_R.RATE_IIN2 */ NUMERIC(15,2),
  IIN_AMOUNT /* TYPE OF COLUMN SALARY_SHEETS_R.IIN_AMOUNT */ NUMERIC(15,2),
  IIN_AMOUNT_REVERSE /* TYPE OF COLUMN SALARY_SHEETS_R.IIN_AMOUNT_REVERSE */ NUMERIC(15,2),
  URVN_AMAOUNT /* TYPE OF COLUMN SALARY_SHEETS_R.URVN_AMAOUNT */ NUMERIC(15,2),
  PLUS_NOT_PAID /* TYPE OF COLUMN SALARY_SHEETS_R.PLUS_NOT_PAID */ NUMERIC(15,2),
  VACATION_ADVANCE_CURRENT /* TYPE OF COLUMN SALARY_SHEETS_R.VACATION_ADVANCE_CURRENT */ NUMERIC(15,2),
  VACATION_ADVANCE_NEXT /* TYPE OF COLUMN SALARY_SHEETS_R.VACATION_ADVANCE_NEXT */ NUMERIC(15,2),
  VACATION_ADVANCE_PREV /* TYPE OF COLUMN SALARY_SHEETS_R.VACATION_ADVANCE_PREV */ NUMERIC(15,2),
  ADVANCE /* TYPE OF COLUMN SALARY_SHEETS_R.ADVANCE */ NUMERIC(15,2),
  PAY0 /* TYPE OF COLUMN SALARY_SHEETS_R.PAY0 */ NUMERIC(15,2),
  PAY /* TYPE OF COLUMN SALARY_SHEETS_R.PAY */ NUMERIC(15,2),
  PAYT /* TYPE OF COLUMN SALARY_SHEETS_R.PAYT */ NUMERIC(15,2),
  PAY_DATE /* TYPE OF COLUMN SALARY_SHEETS_R.PAY_DATE */ DATE,
  COMMENTS /* TYPE OF COLUMN SALARY_SHEETS_R.COMMENTS */ VARCHAR(255) /* COLLATE UTF8 - default */,
  WITHHOLD_FROM_PAY /* TYPE OF COLUMN SALARY_SHEETS_R.WITHHOLD_FROM_PAY */ NUMERIC(15,2),
  FORAVPAYCALC_BRUTO /* TYPE OF COLUMN SALARY_SHEETS_R.FORAVPAYCALC_BRUTO */ NUMERIC(15,2),
  FORAVPAYCALC_PAYOUT /* TYPE OF COLUMN SALARY_SHEETS_R.FORAVPAYCALC_PAYOUT */ NUMERIC(15,2),
  FORAVPAYCALC_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R.FORAVPAYCALC_DAYS */ INTEGER,
  FORAVPAYCALC_HOURS /* TYPE OF COLUMN SALARY_SHEETS_R.FORAVPAYCALC_HOURS */ FLOAT,
  AVPAYCALC_CALDAY /* TYPE OF COLUMN SALARY_SHEETS_R.AVPAYCALC_CALDAY */ NUMERIC(13,4),
  AVPAYCALC_DAY /* TYPE OF COLUMN SALARY_SHEETS_R.AVPAYCALC_DAY */ NUMERIC(13,4),
  AVPAYCALC_HOUR /* TYPE OF COLUMN SALARY_SHEETS_R.AVPAYCALC_HOUR */ NUMERIC(13,4),
  DT_EDITED /* TYPE OF COLUMN SALARY_SHEETS_R.DT_EDITED */ TIMESTAMP,
  CALC_VER /* TYPE OF COLUMN SALARY_SHEETS_R.CALC_VER */ INTEGER)
AS
BEGIN
  SUSPEND;
END
^


/******************************************************************************/
/****                           Altering tables                            ****/
/******************************************************************************/
SET TERM ; ^

ALTER TABLE SALARY_SHEETS_R
  ADD VACATION_DAYS_COMP FLOAT DEFAULT 0 NOT NULL;

ALTER TABLE SALARY_SHEETS_R
  ADD VACATION_PAY_COMP DOM_MONEY DEFAULT 0 NOT NULL;

ALTER TABLE SALARY_SHEETS_R_HIST
  ADD VACATION_DAYS_COMP FLOAT DEFAULT 0 NOT NULL;

ALTER TABLE SALARY_SHEETS_R_HIST
  ADD VACATION_PAY_COMP DOM_MONEY DEFAULT 0 NOT NULL;


/******************************************************************************/
/****            Altering stored procedures (with empty bodies)            ****/
/******************************************************************************/
SET TERM ^ ;

ALTER PROCEDURE SP_REP_AGGREGATE_01(
  PDT1 DATE,
  PDT2 DATE,
  PIDP INTEGER,
  PIDAM INTEGER,
  PRETYRMT INTEGER,
  PRETIDP INTEGER,
  PRETIDAM INTEGER)
RETURNS (
  IDP /* TYPE OF COLUMN SALARY_SHEETS_R.IDP */ INTEGER,
  IDAM /* TYPE OF COLUMN SALARY_SHEETS_R.IDAM */ INTEGER,
  IDDEP /* TYPE OF COLUMN DEPARTMENTS.ID */ VARCHAR(15) /* COLLATE UTF8 - default */,
  YR /* TYPE OF COLUMN SALARY_SHEETS.YR */ INTEGER,
  MT /* TYPE OF COLUMN SALARY_SHEETS.MT */ INTEGER,
  WORKHOURS /* TYPE OF COLUMN SALARY_SHEETS_R.FACT_HOURS */ FLOAT,
  WORKDAYS /* TYPE OF COLUMN SALARY_SHEETS_R.FACT_DAYS */ INTEGER,
  FREEAVPAYDAYS /* TYPE OF COLUMN SALARY_SHEETS_R.FACT_DAYS */ INTEGER,
  VACATIONDAYS /* TYPE OF COLUMN SALARY_SHEETS_R.VACATION_DAYS_CURRENT */ FLOAT,
  VACATIONDAYSCOMP /* TYPE OF COLUMN SALARY_SHEETS_R.VACATION_DAYS_COMP */ FLOAT,
  SICKDAYS /* TYPE OF COLUMN SALARY_SHEETS_R.FACT_DAYS */ INTEGER,
  WORKPAY /* TYPE OF COLUMN SALARY_SHEETS_R.SALARY */ NUMERIC(15,2),
  SICKPAY /* TYPE OF COLUMN SALARY_SHEETS_R.SALARY */ NUMERIC(15,2),
  VACATIONPAY /* TYPE OF COLUMN SALARY_SHEETS_R.SALARY */ NUMERIC(15,2),
  VACATIONPAYCOMP /* TYPE OF COLUMN SALARY_SHEETS_R.VACATION_PAY_COMP */ NUMERIC(15,2),
  FREEAVPAY /* TYPE OF COLUMN SALARY_SHEETS_R.SALARY */ NUMERIC(15,2),
  WORKAVPAY /* TYPE OF COLUMN SALARY_SHEETS_R.SALARY */ NUMERIC(15,2),
  PLUS_TAXED /* TYPE OF COLUMN SALARY_SHEETS_R.PLUS_TAXED */ NUMERIC(15,2),
  PLUS_NOTTAXED /* TYPE OF COLUMN SALARY_SHEETS_R.PLUS_NOTTAXED */ NUMERIC(15,2),
  PLUS_AUTHORS_FEES /* TYPE OF COLUMN SALARY_SHEETS_R.PLUS_AUTHORS_FEES */ NUMERIC(15,2),
  PLUS_NOSAI /* TYPE OF COLUMN SALARY_SHEETS_R.PLUS_NOSAI */ NUMERIC(15,2),
  TOTALPAY /* TYPE OF COLUMN SALARY_SHEETS_R.SALARY */ NUMERIC(15,2),
  FORSAI /* TYPE OF COLUMN SALARY_SHEETS_R.AMOUNT_BEFORE_SN */ NUMERIC(15,2),
  DNSN_AMOUNT /* TYPE OF COLUMN SALARY_SHEETS_R.DNSN_AMOUNT */ NUMERIC(15,2),
  DDSN_AMOUNT /* TYPE OF COLUMN SALARY_SHEETS_R.DDSN_AMOUNT */ NUMERIC(15,2),
  UNTAXED_MINIMUM /* TYPE OF COLUMN SALARY_SHEETS_R.IIN_EXEMPT_UNTAXED_MINIMUM */ NUMERIC(15,2),
  IIN_EXEMPT_DEPENDANTS /* TYPE OF COLUMN SALARY_SHEETS_R.IIN_EXEMPT_DEPENDANTS */ NUMERIC(15,2),
  IIN_EXEMPT_INVALIDITY /* TYPE OF COLUMN SALARY_SHEETS_R.IIN_EXEMPT_INVALIDITY */ NUMERIC(15,2),
  IIN_EXEMPT_NATIONAL_MOVEMENT /* TYPE OF COLUMN SALARY_SHEETS_R.IIN_EXEMPT_NATIONAL_MOVEMENT */ NUMERIC(15,2),
  IIN_EXEMPT_RETALIATION /* TYPE OF COLUMN SALARY_SHEETS_R.IIN_EXEMPT_RETALIATION */ NUMERIC(15,2),
  IIN_EXEMPT_EXPENSES /* TYPE OF COLUMN SALARY_SHEETS_R.IIN_EXEMPT_EXPENSES */ NUMERIC(15,2),
  PLUS_PF_NOTTAXED /* TYPE OF COLUMN SALARY_SHEETS_R.PLUS_PF_NOTTAXED */ NUMERIC(15,2),
  PLUS_LI_NOTTAXED /* TYPE OF COLUMN SALARY_SHEETS_R.PLUS_LI_NOTTAXED */ NUMERIC(15,2),
  PLUS_HI_NOTTAXED /* TYPE OF COLUMN SALARY_SHEETS_R.PLUS_HI_NOTTAXED */ NUMERIC(15,2),
  IIN_AMOUNT /* TYPE OF COLUMN SALARY_SHEETS_R.IIN_AMOUNT */ NUMERIC(15,2),
  MINUS_BEFORE_IIN /* TYPE OF COLUMN SALARY_SHEETS_R.MINUS_BEFORE_IIN */ NUMERIC(15,2),
  MINUS_AFTER_IIN /* TYPE OF COLUMN SALARY_SHEETS_R.MINUS_AFTER_IIN */ NUMERIC(15,2),
  PAY /* TYPE OF COLUMN SALARY_SHEETS_R.PAY */ NUMERIC(15,2),
  ADVANCE /* TYPE OF COLUMN SALARY_SHEETS_R.ADVANCE */ NUMERIC(15,2),
  PAYT /* TYPE OF COLUMN SALARY_SHEETS_R.PAYT */ NUMERIC(15,2),
  PAID /* TYPE OF COLUMN PAYLISTS_R.TPAY */ NUMERIC(15,2))
AS
BEGIN
  SUSPEND;
END
^

ALTER PROCEDURE SP_REP_AGGREGATE_02(
  PDT1 DATE,
  PDT2 DATE,
  PIDDEP /* TYPE OF COLUMN DEPARTMENTS.ID */ VARCHAR(15) /* COLLATE UTF8 - default */,
  PRETYRMT INTEGER,
  PRETIDP INTEGER,
  PRETIDAM INTEGER,
  PRETIDDEP INTEGER)
RETURNS (
  IDP /* TYPE OF COLUMN SALARY_SHEETS_R.IDP */ INTEGER,
  IDAM /* TYPE OF COLUMN SALARY_SHEETS_R.IDAM */ INTEGER,
  IDDEP /* TYPE OF COLUMN DEPARTMENTS.ID */ VARCHAR(15) /* COLLATE UTF8 - default */,
  YR /* TYPE OF COLUMN SALARY_SHEETS.YR */ INTEGER,
  MT /* TYPE OF COLUMN SALARY_SHEETS.MT */ INTEGER,
  WORKHOURS /* TYPE OF COLUMN SALARY_SHEETS_R.FACT_HOURS */ FLOAT,
  WORKDAYS /* TYPE OF COLUMN SALARY_SHEETS_R.FACT_DAYS */ INTEGER,
  FREEAVPAYDAYS /* TYPE OF COLUMN SALARY_SHEETS_R.FACT_DAYS */ INTEGER,
  VACATIONDAYS /* TYPE OF COLUMN SALARY_SHEETS_R.VACATION_DAYS_CURRENT */ FLOAT,
  VACATIONDAYSCOMP /* TYPE OF COLUMN SALARY_SHEETS_R.VACATION_DAYS_COMP */ FLOAT,
  SICKDAYS /* TYPE OF COLUMN SALARY_SHEETS_R.FACT_DAYS */ INTEGER,
  WORKPAY /* TYPE OF COLUMN SALARY_SHEETS_R.SALARY */ NUMERIC(15,2),
  SICKPAY /* TYPE OF COLUMN SALARY_SHEETS_R.SALARY */ NUMERIC(15,2),
  VACATIONPAY /* TYPE OF COLUMN SALARY_SHEETS_R.SALARY */ NUMERIC(15,2),
  VACATIONPAYCOMP /* TYPE OF COLUMN SALARY_SHEETS_R.VACATION_PAY_COMP */ NUMERIC(15,2),
  FREEAVPAY /* TYPE OF COLUMN SALARY_SHEETS_R.SALARY */ NUMERIC(15,2),
  WORKAVPAY /* TYPE OF COLUMN SALARY_SHEETS_R.SALARY */ NUMERIC(15,2),
  PLUS_TAXED /* TYPE OF COLUMN SALARY_SHEETS_R.PLUS_TAXED */ NUMERIC(15,2),
  PLUS_NOTTAXED /* TYPE OF COLUMN SALARY_SHEETS_R.PLUS_NOTTAXED */ NUMERIC(15,2),
  PLUS_AUTHORS_FEES /* TYPE OF COLUMN SALARY_SHEETS_R.PLUS_AUTHORS_FEES */ NUMERIC(15,2),
  PLUS_NOSAI /* TYPE OF COLUMN SALARY_SHEETS_R.PLUS_NOSAI */ NUMERIC(15,2),
  TOTALPAY /* TYPE OF COLUMN SALARY_SHEETS_R.SALARY */ NUMERIC(15,2),
  FORSAI /* TYPE OF COLUMN SALARY_SHEETS_R.AMOUNT_BEFORE_SN */ NUMERIC(15,2),
  DNSN_AMOUNT /* TYPE OF COLUMN SALARY_SHEETS_R.DNSN_AMOUNT */ NUMERIC(15,2),
  DDSN_AMOUNT /* TYPE OF COLUMN SALARY_SHEETS_R.DDSN_AMOUNT */ NUMERIC(15,2),
  UNTAXED_MINIMUM /* TYPE OF COLUMN SALARY_SHEETS_R.IIN_EXEMPT_UNTAXED_MINIMUM */ NUMERIC(15,2),
  IIN_EXEMPT_DEPENDANTS /* TYPE OF COLUMN SALARY_SHEETS_R.IIN_EXEMPT_DEPENDANTS */ NUMERIC(15,2),
  IIN_EXEMPT_INVALIDITY /* TYPE OF COLUMN SALARY_SHEETS_R.IIN_EXEMPT_INVALIDITY */ NUMERIC(15,2),
  IIN_EXEMPT_NATIONAL_MOVEMENT /* TYPE OF COLUMN SALARY_SHEETS_R.IIN_EXEMPT_NATIONAL_MOVEMENT */ NUMERIC(15,2),
  IIN_EXEMPT_RETALIATION /* TYPE OF COLUMN SALARY_SHEETS_R.IIN_EXEMPT_RETALIATION */ NUMERIC(15,2),
  IIN_EXEMPT_EXPENSES /* TYPE OF COLUMN SALARY_SHEETS_R.IIN_EXEMPT_EXPENSES */ NUMERIC(15,2),
  PLUS_PF_NOTTAXED /* TYPE OF COLUMN SALARY_SHEETS_R.PLUS_PF_NOTTAXED */ NUMERIC(15,2),
  PLUS_LI_NOTTAXED /* TYPE OF COLUMN SALARY_SHEETS_R.PLUS_LI_NOTTAXED */ NUMERIC(15,2),
  PLUS_HI_NOTTAXED /* TYPE OF COLUMN SALARY_SHEETS_R.PLUS_HI_NOTTAXED */ NUMERIC(15,2),
  IIN_AMOUNT /* TYPE OF COLUMN SALARY_SHEETS_R.IIN_AMOUNT */ NUMERIC(15,2),
  MINUS_BEFORE_IIN /* TYPE OF COLUMN SALARY_SHEETS_R.MINUS_BEFORE_IIN */ NUMERIC(15,2),
  MINUS_AFTER_IIN /* TYPE OF COLUMN SALARY_SHEETS_R.MINUS_AFTER_IIN */ NUMERIC(15,2),
  PAY /* TYPE OF COLUMN SALARY_SHEETS_R.PAY */ NUMERIC(15,2),
  ADVANCE /* TYPE OF COLUMN SALARY_SHEETS_R.ADVANCE */ NUMERIC(15,2),
  PAYT /* TYPE OF COLUMN SALARY_SHEETS_R.PAYT */ NUMERIC(15,2),
  PAID /* TYPE OF COLUMN PAYLISTS_R.TPAY */ NUMERIC(15,2))
AS
BEGIN
  SUSPEND;
END
^

ALTER PROCEDURE SP_SALARY_SHEETS_R_HIST_01(
  PID INTEGER)
RETURNS (
  IDH /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.ID */ INTEGER,
  ID /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.ID */ INTEGER,
  IDS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IDS */ INTEGER,
  IDSX /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IDSX */ INTEGER,
  IDST /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IDST */ INTEGER,
  IS_TEMP /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IS_TEMP */ SMALLINT,
  TYPE_TAG /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.TYPE_TAG */ SMALLINT,
  IDP /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IDP */ INTEGER,
  IDAM /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IDAM */ INTEGER,
  SNR /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.SNR */ SMALLINT,
  FNAME /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FNAME */ VARCHAR(20) /* COLLATE UTF8 - default */,
  LNAME /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.LNAME */ VARCHAR(20) /* COLLATE UTF8 - default */,
  POSITION_TITLE /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.POSITION_TITLE */ VARCHAR(50) /* COLLATE UTF8 - default */,
  TERRITORIAL_CODE /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.TERRITORIAL_CODE */ VARCHAR(20) /* COLLATE UTF8 - default */,
  CALENDAR_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.CALENDAR_DAYS */ INTEGER,
  CALENDAR_DAYS_USE /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.CALENDAR_DAYS_USE */ INTEGER,
  MONTH_WORKDAYS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.MONTH_WORKDAYS */ INTEGER,
  MONTH_WORKHOURS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.MONTH_WORKHOURS */ FLOAT,
  PLAN_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLAN_DAYS */ INTEGER,
  PLAN_HOURS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLAN_HOURS */ FLOAT,
  PLAN_HOURS_NIGHT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLAN_HOURS_NIGHT */ FLOAT,
  PLAN_HOURS_OVERTIME /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLAN_HOURS_OVERTIME */ FLOAT,
  FACT_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_DAYS */ INTEGER,
  FACT_HOURS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_HOURS */ FLOAT,
  FACT_HOURS_NIGHT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_HOURS_NIGHT */ FLOAT,
  FACT_HOURS_OVERTIME /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_HOURS_OVERTIME */ FLOAT,
  PLAN_WORK_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLAN_WORK_DAYS */ INTEGER,
  PLAN_WORK_HOURS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLAN_WORK_HOURS */ FLOAT,
  PLAN_WORK_HOURS_NIGHT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLAN_WORK_HOURS_NIGHT */ FLOAT,
  PLAN_WORK_HOURS_OVERTIME /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLAN_WORK_HOURS_OVERTIME */ FLOAT,
  FACT_WORK_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_WORK_DAYS */ INTEGER,
  FACT_WORK_HOURS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_WORK_HOURS */ FLOAT,
  FACT_WORK_HOURS_NIGHT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_WORK_HOURS_NIGHT */ FLOAT,
  FACT_WORK_HOURS_OVERTIME /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_WORK_HOURS_OVERTIME */ FLOAT,
  PLAN_HOLIDAYS_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLAN_HOLIDAYS_DAYS */ INTEGER,
  PLAN_HOLIDAYS_HOURS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLAN_HOLIDAYS_HOURS */ FLOAT,
  PLAN_HOLIDAYS_HOURS_NIGHT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLAN_HOLIDAYS_HOURS_NIGHT */ FLOAT,
  PLAN_HOLIDAYS_HOURS_OVERTIME /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLAN_HOLIDAYS_HOURS_OVERTIME */ FLOAT,
  FACT_HOLIDAYS_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_HOLIDAYS_DAYS */ INTEGER,
  FACT_HOLIDAYS_HOURS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_HOLIDAYS_HOURS */ FLOAT,
  FACT_HOLIDAYS_HOURS_NIGHT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_HOLIDAYS_HOURS_NIGHT */ FLOAT,
  FACT_HOLIDAYS_HOURS_OVERTIME /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_HOLIDAYS_HOURS_OVERTIME */ FLOAT,
  SALARY /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY */ NUMERIC(15,2),
  SALARY_DAY /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY_DAY */ NUMERIC(15,2),
  SALARY_NIGHT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY_NIGHT */ NUMERIC(15,2),
  SALARY_OVERTIME /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY_OVERTIME */ NUMERIC(15,2),
  SALARY_HOLIDAYS_DAY /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY_HOLIDAYS_DAY */ NUMERIC(15,2),
  SALARY_HOLIDAYS_NIGHT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY_HOLIDAYS_NIGHT */ NUMERIC(15,2),
  SALARY_HOLIDAYS_OVERTIME /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY_HOLIDAYS_OVERTIME */ NUMERIC(15,2),
  SALARY_PAID_HOLIDAYS_DAY /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY_PAID_HOLIDAYS_DAY */ NUMERIC(15,2),
  SALARY_PAID_HOLIDAYS_NIGHT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY_PAID_HOLIDAYS_NIGHT */ NUMERIC(15,2),
  SALARY_PIECEWORK /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY_PIECEWORK */ NUMERIC(15,2),
  SICKDAYS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.SICKDAYS */ INTEGER,
  SICKDAYS_PAY /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.SICKDAYS_PAY */ NUMERIC(15,2),
  ACCIDENT_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.ACCIDENT_DAYS */ INTEGER,
  ACCIDENT_PAY /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.ACCIDENT_PAY */ NUMERIC(15,2),
  AVERAGE_INCOME_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.AVERAGE_INCOME_DAYS */ INTEGER,
  AVERAGE_INCOME_PAY /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.AVERAGE_INCOME_PAY */ NUMERIC(15,2),
  FACT_AVPAY_FREE_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_AVPAY_FREE_DAYS */ INTEGER,
  FACT_AVPAY_FREE_HOURS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_AVPAY_FREE_HOURS */ FLOAT,
  FACT_AVPAY_WORK_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_AVPAY_WORK_DAYS */ INTEGER,
  FACT_AVPAY_WORKINHOLIDAYS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_AVPAY_WORKINHOLIDAYS */ INTEGER,
  FACT_AVPAY_HOURS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_AVPAY_HOURS */ FLOAT,
  FACT_AVPAY_HOURS_OVERTIME /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_AVPAY_HOURS_OVERTIME */ FLOAT,
  FACT_AVPAY_HOLIDAYS_HOURS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_AVPAY_HOLIDAYS_HOURS */ FLOAT,
  FACT_AVPAY_HOLIDAYS_HOURS_OVERT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_AVPAY_HOLIDAYS_HOURS_OVERT */ FLOAT,
  SALARY_AVPAY_FREE_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY_AVPAY_FREE_DAYS */ NUMERIC(15,2),
  SALARY_AVPAY_WORK_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY_AVPAY_WORK_DAYS */ NUMERIC(15,2),
  SALARY_AVPAY_WORK_DAYS_OVERTIME /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY_AVPAY_WORK_DAYS_OVERTIME */ NUMERIC(15,2),
  SALARY_AVPAY_HOLIDAYS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY_AVPAY_HOLIDAYS */ NUMERIC(15,2),
  SALARY_AVPAY_HOLIDAYS_OVERTIME /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY_AVPAY_HOLIDAYS_OVERTIME */ NUMERIC(15,2),
  BUSINESS_TRIP_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.BUSINESS_TRIP_DAYS */ INTEGER,
  BUSINESS_TRIP_PAY /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.BUSINESS_TRIP_PAY */ NUMERIC(15,2),
  PAID_HOLIDAYS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PAID_HOLIDAYS */ INTEGER,
  PAID_HOLIDAYS_PAY /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PAID_HOLIDAYS_PAY */ NUMERIC(15,2),
  VACATION_DAYS_CURRENT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_DAYS_CURRENT */ FLOAT,
  VACATION_DAYS_NEXT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_DAYS_NEXT */ FLOAT,
  VACATION_HOURS_CURRENT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_HOURS_CURRENT */ FLOAT,
  VACATION_HOURS_NEXT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_HOURS_NEXT */ FLOAT,
  VACATION_PAY_CURRENT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_PAY_CURRENT */ NUMERIC(15,2),
  VACATION_PAY_NEXT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_PAY_NEXT */ NUMERIC(15,2),
  VACATION_DNS_NEXT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_DNS_NEXT */ NUMERIC(15,2),
  VACATION_DDS_NEXT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_DDS_NEXT */ NUMERIC(15,2),
  VACATION_IIN_NEXT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_IIN_NEXT */ NUMERIC(15,2),
  VACATION_IIN_REDUCE_NEXT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_IIN_REDUCE_NEXT */ NUMERIC(15,2),
  VACATION_CASH_NEXT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_CASH_NEXT */ NUMERIC(15,2),
  VACATION_PAY_PREV /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_PAY_PREV */ NUMERIC(15,2),
  VACATION_DNS_PREV /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_DNS_PREV */ NUMERIC(15,2),
  VACATION_DDS_PREV /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_DDS_PREV */ NUMERIC(15,2),
  VACATION_IIN_PREV /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_IIN_PREV */ NUMERIC(15,2),
  VACATION_DAYS_COMP /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_DAYS_COMP */ FLOAT,
  VACATION_PAY_COMP /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_PAY_COMP */ NUMERIC(15,2),
  PLUS_TAXED /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLUS_TAXED */ NUMERIC(15,2),
  PLUS_NOTTAXED /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLUS_NOTTAXED */ NUMERIC(15,2),
  PLUS_NOSAI /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLUS_NOSAI */ NUMERIC(15,2),
  PLUS_AUTHORS_FEES /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLUS_AUTHORS_FEES */ NUMERIC(15,2),
  MINUS_BEFORE_IIN /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.MINUS_BEFORE_IIN */ NUMERIC(15,2),
  MINUS_AFTER_IIN /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.MINUS_AFTER_IIN */ NUMERIC(15,2),
  PLUS_PF_NOTTAXED /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLUS_PF_NOTTAXED */ NUMERIC(15,2),
  PLUS_PF_TAXED /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLUS_PF_TAXED */ NUMERIC(15,2),
  PLUS_LI_NOTTAXED /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLUS_LI_NOTTAXED */ NUMERIC(15,2),
  PLUS_LI_TAXED /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLUS_LI_TAXED */ NUMERIC(15,2),
  PLUS_HI_NOTTAXED /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLUS_HI_NOTTAXED */ NUMERIC(15,2),
  PLUS_HI_TAXED /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLUS_HI_TAXED */ NUMERIC(15,2),
  PLUS_NP_TAXED /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLUS_NP_TAXED */ NUMERIC(15,2),
  PLUS_NP_NOTTAXED /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLUS_NP_NOTTAXED */ NUMERIC(15,2),
  PLUS_NP_NOSAI /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLUS_NP_NOSAI */ NUMERIC(15,2),
  TOTAL_BEFORE_TAXES /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.TOTAL_BEFORE_TAXES */ NUMERIC(15,2),
  ADJUSTED_AMOUNT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.ADJUSTED_AMOUNT */ NUMERIC(15,2),
  AMOUNT_BEFORE_SN /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.AMOUNT_BEFORE_SN */ NUMERIC(15,2),
  AMOUNT_BEFORE_SN_REVERSE /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.AMOUNT_BEFORE_SN_REVERSE */ NUMERIC(15,2),
  RATE_DNSN /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.RATE_DNSN */ NUMERIC(15,2),
  RATE_DDSN /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.RATE_DDSN */ NUMERIC(15,2),
  DNSN_AMOUNT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.DNSN_AMOUNT */ NUMERIC(15,2),
  DDSN_AMOUNT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.DDSN_AMOUNT */ NUMERIC(15,2),
  SN_AMOUNT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.SN_AMOUNT */ NUMERIC(15,2),
  DNSN_AMOUNT_REVERSE /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.DNSN_AMOUNT_REVERSE */ NUMERIC(15,2),
  DDSN_AMOUNT_REVERSE /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.DDSN_AMOUNT_REVERSE */ NUMERIC(15,2),
  SN_MAX_AMOUNT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.SN_MAX_AMOUNT */ NUMERIC(15,2),
  IIN_EXEMPT_UNTAXED_MINIMUM0 /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_EXEMPT_UNTAXED_MINIMUM0 */ NUMERIC(15,2),
  IIN_EXEMPT_DEPENDANTS0 /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_EXEMPT_DEPENDANTS0 */ NUMERIC(15,2),
  IIN_EXEMPT_RETALIATION0 /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_EXEMPT_RETALIATION0 */ NUMERIC(15,2),
  IIN_EXEMPT_INVALIDITY0 /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_EXEMPT_INVALIDITY0 */ NUMERIC(15,2),
  IIN_EXEMPT_NATIONAL_MOVEMENT0 /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_EXEMPT_NATIONAL_MOVEMENT0 */ NUMERIC(15,2),
  IIN_EXEMPT_UNTAXED_MINIMUM /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_EXEMPT_UNTAXED_MINIMUM */ NUMERIC(15,2),
  IIN_EXEMPT_DEPENDANTS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_EXEMPT_DEPENDANTS */ NUMERIC(15,2),
  IIN_EXEMPT_RETALIATION /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_EXEMPT_RETALIATION */ NUMERIC(15,2),
  IIN_EXEMPT_INVALIDITY /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_EXEMPT_INVALIDITY */ NUMERIC(15,2),
  IIN_EXEMPT_NATIONAL_MOVEMENT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_EXEMPT_NATIONAL_MOVEMENT */ NUMERIC(15,2),
  IIN_EXEMPT_EXPENSES /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_EXEMPT_EXPENSES */ NUMERIC(15,2),
  IIN_EXEMPT_2TP /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_EXEMPT_2TP */ SMALLINT,
  IIN_EXEMPT_20 /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_EXEMPT_20 */ NUMERIC(15,2),
  IIN_EXEMPT_2 /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_EXEMPT_2 */ NUMERIC(15,2),
  AMOUNT_BEFORE_IIN /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.AMOUNT_BEFORE_IIN */ NUMERIC(15,2),
  AMOUNT_BEFORE_IIN_REVERSE /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.AMOUNT_BEFORE_IIN_REVERSE */ NUMERIC(15,2),
  RATE_IIN /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.RATE_IIN */ NUMERIC(15,2),
  RATE_IIN2 /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.RATE_IIN2 */ NUMERIC(15,2),
  IIN_AMOUNT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_AMOUNT */ NUMERIC(15,2),
  IIN_AMOUNT_REVERSE /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_AMOUNT_REVERSE */ NUMERIC(15,2),
  URVN_AMAOUNT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.URVN_AMAOUNT */ NUMERIC(15,2),
  PLUS_NOT_PAID /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLUS_NOT_PAID */ NUMERIC(15,2),
  VACATION_ADVANCE_CURRENT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_ADVANCE_CURRENT */ NUMERIC(15,2),
  VACATION_ADVANCE_NEXT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_ADVANCE_NEXT */ NUMERIC(15,2),
  VACATION_ADVANCE_PREV /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_ADVANCE_PREV */ NUMERIC(15,2),
  ADVANCE /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.ADVANCE */ NUMERIC(15,2),
  PAY0 /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PAY0 */ NUMERIC(15,2),
  PAY /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PAY */ NUMERIC(15,2),
  PAYT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PAYT */ NUMERIC(15,2),
  PAY_DATE /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PAY_DATE */ DATE,
  COMMENTS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.COMMENTS */ VARCHAR(255) /* COLLATE UTF8 - default */,
  WITHHOLD_FROM_PAY /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.WITHHOLD_FROM_PAY */ NUMERIC(15,2),
  FORAVPAYCALC_BRUTO /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FORAVPAYCALC_BRUTO */ NUMERIC(15,2),
  FORAVPAYCALC_PAYOUT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FORAVPAYCALC_PAYOUT */ NUMERIC(15,2),
  FORAVPAYCALC_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FORAVPAYCALC_DAYS */ INTEGER,
  FORAVPAYCALC_HOURS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FORAVPAYCALC_HOURS */ FLOAT,
  AVPAYCALC_CALDAY /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.AVPAYCALC_CALDAY */ NUMERIC(13,4),
  AVPAYCALC_DAY /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.AVPAYCALC_DAY */ NUMERIC(13,4),
  AVPAYCALC_HOUR /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.AVPAYCALC_HOUR */ NUMERIC(13,4),
  DT_EDITED /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.DT_EDITED */ TIMESTAMP,
  CALC_VER /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.CALC_VER */ INTEGER)
AS
BEGIN
  SUSPEND;
END
^

ALTER PROCEDURE SP_SALARY_SHEETS_R_HIST_02(
  PIDSX INTEGER,
  PTIME1 TIMESTAMP,
  PTIME2 TIMESTAMP)
RETURNS (
  IDH /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.ID */ INTEGER,
  ID /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.ID */ INTEGER,
  IDS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IDS */ INTEGER,
  IDSX /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IDSX */ INTEGER,
  IDST /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IDST */ INTEGER,
  IS_TEMP /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IS_TEMP */ SMALLINT,
  TYPE_TAG /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.TYPE_TAG */ SMALLINT,
  IDP /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IDP */ INTEGER,
  IDAM /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IDAM */ INTEGER,
  SNR /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.SNR */ SMALLINT,
  FNAME /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FNAME */ VARCHAR(20) /* COLLATE UTF8 - default */,
  LNAME /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.LNAME */ VARCHAR(20) /* COLLATE UTF8 - default */,
  POSITION_TITLE /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.POSITION_TITLE */ VARCHAR(50) /* COLLATE UTF8 - default */,
  TERRITORIAL_CODE /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.TERRITORIAL_CODE */ VARCHAR(20) /* COLLATE UTF8 - default */,
  CALENDAR_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.CALENDAR_DAYS */ INTEGER,
  CALENDAR_DAYS_USE /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.CALENDAR_DAYS_USE */ INTEGER,
  MONTH_WORKDAYS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.MONTH_WORKDAYS */ INTEGER,
  MONTH_WORKHOURS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.MONTH_WORKHOURS */ FLOAT,
  PLAN_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLAN_DAYS */ INTEGER,
  PLAN_HOURS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLAN_HOURS */ FLOAT,
  PLAN_HOURS_NIGHT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLAN_HOURS_NIGHT */ FLOAT,
  PLAN_HOURS_OVERTIME /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLAN_HOURS_OVERTIME */ FLOAT,
  FACT_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_DAYS */ INTEGER,
  FACT_HOURS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_HOURS */ FLOAT,
  FACT_HOURS_NIGHT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_HOURS_NIGHT */ FLOAT,
  FACT_HOURS_OVERTIME /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_HOURS_OVERTIME */ FLOAT,
  PLAN_WORK_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLAN_WORK_DAYS */ INTEGER,
  PLAN_WORK_HOURS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLAN_WORK_HOURS */ FLOAT,
  PLAN_WORK_HOURS_NIGHT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLAN_WORK_HOURS_NIGHT */ FLOAT,
  PLAN_WORK_HOURS_OVERTIME /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLAN_WORK_HOURS_OVERTIME */ FLOAT,
  FACT_WORK_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_WORK_DAYS */ INTEGER,
  FACT_WORK_HOURS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_WORK_HOURS */ FLOAT,
  FACT_WORK_HOURS_NIGHT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_WORK_HOURS_NIGHT */ FLOAT,
  FACT_WORK_HOURS_OVERTIME /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_WORK_HOURS_OVERTIME */ FLOAT,
  PLAN_HOLIDAYS_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLAN_HOLIDAYS_DAYS */ INTEGER,
  PLAN_HOLIDAYS_HOURS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLAN_HOLIDAYS_HOURS */ FLOAT,
  PLAN_HOLIDAYS_HOURS_NIGHT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLAN_HOLIDAYS_HOURS_NIGHT */ FLOAT,
  PLAN_HOLIDAYS_HOURS_OVERTIME /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLAN_HOLIDAYS_HOURS_OVERTIME */ FLOAT,
  FACT_HOLIDAYS_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_HOLIDAYS_DAYS */ INTEGER,
  FACT_HOLIDAYS_HOURS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_HOLIDAYS_HOURS */ FLOAT,
  FACT_HOLIDAYS_HOURS_NIGHT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_HOLIDAYS_HOURS_NIGHT */ FLOAT,
  FACT_HOLIDAYS_HOURS_OVERTIME /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_HOLIDAYS_HOURS_OVERTIME */ FLOAT,
  SALARY /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY */ NUMERIC(15,2),
  SALARY_DAY /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY_DAY */ NUMERIC(15,2),
  SALARY_NIGHT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY_NIGHT */ NUMERIC(15,2),
  SALARY_OVERTIME /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY_OVERTIME */ NUMERIC(15,2),
  SALARY_HOLIDAYS_DAY /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY_HOLIDAYS_DAY */ NUMERIC(15,2),
  SALARY_HOLIDAYS_NIGHT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY_HOLIDAYS_NIGHT */ NUMERIC(15,2),
  SALARY_HOLIDAYS_OVERTIME /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY_HOLIDAYS_OVERTIME */ NUMERIC(15,2),
  SALARY_PAID_HOLIDAYS_DAY /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY_PAID_HOLIDAYS_DAY */ NUMERIC(15,2),
  SALARY_PAID_HOLIDAYS_NIGHT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY_PAID_HOLIDAYS_NIGHT */ NUMERIC(15,2),
  SALARY_PIECEWORK /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY_PIECEWORK */ NUMERIC(15,2),
  SICKDAYS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.SICKDAYS */ INTEGER,
  SICKDAYS_PAY /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.SICKDAYS_PAY */ NUMERIC(15,2),
  ACCIDENT_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.ACCIDENT_DAYS */ INTEGER,
  ACCIDENT_PAY /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.ACCIDENT_PAY */ NUMERIC(15,2),
  AVERAGE_INCOME_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.AVERAGE_INCOME_DAYS */ INTEGER,
  AVERAGE_INCOME_PAY /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.AVERAGE_INCOME_PAY */ NUMERIC(15,2),
  FACT_AVPAY_FREE_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_AVPAY_FREE_DAYS */ INTEGER,
  FACT_AVPAY_FREE_HOURS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_AVPAY_FREE_HOURS */ FLOAT,
  FACT_AVPAY_WORK_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_AVPAY_WORK_DAYS */ INTEGER,
  FACT_AVPAY_WORKINHOLIDAYS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_AVPAY_WORKINHOLIDAYS */ INTEGER,
  FACT_AVPAY_HOURS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_AVPAY_HOURS */ FLOAT,
  FACT_AVPAY_HOURS_OVERTIME /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_AVPAY_HOURS_OVERTIME */ FLOAT,
  FACT_AVPAY_HOLIDAYS_HOURS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_AVPAY_HOLIDAYS_HOURS */ FLOAT,
  FACT_AVPAY_HOLIDAYS_HOURS_OVERT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_AVPAY_HOLIDAYS_HOURS_OVERT */ FLOAT,
  SALARY_AVPAY_FREE_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY_AVPAY_FREE_DAYS */ NUMERIC(15,2),
  SALARY_AVPAY_WORK_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY_AVPAY_WORK_DAYS */ NUMERIC(15,2),
  SALARY_AVPAY_WORK_DAYS_OVERTIME /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY_AVPAY_WORK_DAYS_OVERTIME */ NUMERIC(15,2),
  SALARY_AVPAY_HOLIDAYS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY_AVPAY_HOLIDAYS */ NUMERIC(15,2),
  SALARY_AVPAY_HOLIDAYS_OVERTIME /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY_AVPAY_HOLIDAYS_OVERTIME */ NUMERIC(15,2),
  BUSINESS_TRIP_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.BUSINESS_TRIP_DAYS */ INTEGER,
  BUSINESS_TRIP_PAY /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.BUSINESS_TRIP_PAY */ NUMERIC(15,2),
  PAID_HOLIDAYS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PAID_HOLIDAYS */ INTEGER,
  PAID_HOLIDAYS_PAY /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PAID_HOLIDAYS_PAY */ NUMERIC(15,2),
  VACATION_DAYS_CURRENT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_DAYS_CURRENT */ FLOAT,
  VACATION_DAYS_NEXT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_DAYS_NEXT */ FLOAT,
  VACATION_HOURS_CURRENT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_HOURS_CURRENT */ FLOAT,
  VACATION_HOURS_NEXT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_HOURS_NEXT */ FLOAT,
  VACATION_PAY_CURRENT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_PAY_CURRENT */ NUMERIC(15,2),
  VACATION_PAY_NEXT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_PAY_NEXT */ NUMERIC(15,2),
  VACATION_DNS_NEXT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_DNS_NEXT */ NUMERIC(15,2),
  VACATION_DDS_NEXT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_DDS_NEXT */ NUMERIC(15,2),
  VACATION_IIN_NEXT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_IIN_NEXT */ NUMERIC(15,2),
  VACATION_IIN_REDUCE_NEXT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_IIN_REDUCE_NEXT */ NUMERIC(15,2),
  VACATION_CASH_NEXT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_CASH_NEXT */ NUMERIC(15,2),
  VACATION_PAY_PREV /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_PAY_PREV */ NUMERIC(15,2),
  VACATION_DNS_PREV /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_DNS_PREV */ NUMERIC(15,2),
  VACATION_DDS_PREV /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_DDS_PREV */ NUMERIC(15,2),
  VACATION_IIN_PREV /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_IIN_PREV */ NUMERIC(15,2),
  VACATION_DAYS_COMP /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_DAYS_COMP */ FLOAT,
  VACATION_PAY_COMP /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_PAY_COMP */ NUMERIC(15,2),
  PLUS_TAXED /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLUS_TAXED */ NUMERIC(15,2),
  PLUS_NOTTAXED /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLUS_NOTTAXED */ NUMERIC(15,2),
  PLUS_NOSAI /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLUS_NOSAI */ NUMERIC(15,2),
  PLUS_AUTHORS_FEES /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLUS_AUTHORS_FEES */ NUMERIC(15,2),
  MINUS_BEFORE_IIN /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.MINUS_BEFORE_IIN */ NUMERIC(15,2),
  MINUS_AFTER_IIN /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.MINUS_AFTER_IIN */ NUMERIC(15,2),
  PLUS_PF_NOTTAXED /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLUS_PF_NOTTAXED */ NUMERIC(15,2),
  PLUS_PF_TAXED /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLUS_PF_TAXED */ NUMERIC(15,2),
  PLUS_LI_NOTTAXED /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLUS_LI_NOTTAXED */ NUMERIC(15,2),
  PLUS_LI_TAXED /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLUS_LI_TAXED */ NUMERIC(15,2),
  PLUS_HI_NOTTAXED /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLUS_HI_NOTTAXED */ NUMERIC(15,2),
  PLUS_HI_TAXED /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLUS_HI_TAXED */ NUMERIC(15,2),
  PLUS_NP_TAXED /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLUS_NP_TAXED */ NUMERIC(15,2),
  PLUS_NP_NOTTAXED /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLUS_NP_NOTTAXED */ NUMERIC(15,2),
  PLUS_NP_NOSAI /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLUS_NP_NOSAI */ NUMERIC(15,2),
  TOTAL_BEFORE_TAXES /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.TOTAL_BEFORE_TAXES */ NUMERIC(15,2),
  ADJUSTED_AMOUNT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.ADJUSTED_AMOUNT */ NUMERIC(15,2),
  AMOUNT_BEFORE_SN /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.AMOUNT_BEFORE_SN */ NUMERIC(15,2),
  AMOUNT_BEFORE_SN_REVERSE /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.AMOUNT_BEFORE_SN_REVERSE */ NUMERIC(15,2),
  RATE_DNSN /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.RATE_DNSN */ NUMERIC(15,2),
  RATE_DDSN /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.RATE_DDSN */ NUMERIC(15,2),
  DNSN_AMOUNT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.DNSN_AMOUNT */ NUMERIC(15,2),
  DDSN_AMOUNT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.DDSN_AMOUNT */ NUMERIC(15,2),
  SN_AMOUNT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.SN_AMOUNT */ NUMERIC(15,2),
  DNSN_AMOUNT_REVERSE /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.DNSN_AMOUNT_REVERSE */ NUMERIC(15,2),
  DDSN_AMOUNT_REVERSE /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.DDSN_AMOUNT_REVERSE */ NUMERIC(15,2),
  SN_MAX_AMOUNT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.SN_MAX_AMOUNT */ NUMERIC(15,2),
  IIN_EXEMPT_UNTAXED_MINIMUM0 /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_EXEMPT_UNTAXED_MINIMUM0 */ NUMERIC(15,2),
  IIN_EXEMPT_DEPENDANTS0 /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_EXEMPT_DEPENDANTS0 */ NUMERIC(15,2),
  IIN_EXEMPT_RETALIATION0 /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_EXEMPT_RETALIATION0 */ NUMERIC(15,2),
  IIN_EXEMPT_INVALIDITY0 /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_EXEMPT_INVALIDITY0 */ NUMERIC(15,2),
  IIN_EXEMPT_NATIONAL_MOVEMENT0 /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_EXEMPT_NATIONAL_MOVEMENT0 */ NUMERIC(15,2),
  IIN_EXEMPT_UNTAXED_MINIMUM /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_EXEMPT_UNTAXED_MINIMUM */ NUMERIC(15,2),
  IIN_EXEMPT_DEPENDANTS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_EXEMPT_DEPENDANTS */ NUMERIC(15,2),
  IIN_EXEMPT_RETALIATION /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_EXEMPT_RETALIATION */ NUMERIC(15,2),
  IIN_EXEMPT_INVALIDITY /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_EXEMPT_INVALIDITY */ NUMERIC(15,2),
  IIN_EXEMPT_NATIONAL_MOVEMENT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_EXEMPT_NATIONAL_MOVEMENT */ NUMERIC(15,2),
  IIN_EXEMPT_EXPENSES /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_EXEMPT_EXPENSES */ NUMERIC(15,2),
  IIN_EXEMPT_2TP /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_EXEMPT_2TP */ SMALLINT,
  IIN_EXEMPT_20 /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_EXEMPT_20 */ NUMERIC(15,2),
  IIN_EXEMPT_2 /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_EXEMPT_2 */ NUMERIC(15,2),
  AMOUNT_BEFORE_IIN /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.AMOUNT_BEFORE_IIN */ NUMERIC(15,2),
  AMOUNT_BEFORE_IIN_REVERSE /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.AMOUNT_BEFORE_IIN_REVERSE */ NUMERIC(15,2),
  RATE_IIN /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.RATE_IIN */ NUMERIC(15,2),
  RATE_IIN2 /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.RATE_IIN2 */ NUMERIC(15,2),
  IIN_AMOUNT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_AMOUNT */ NUMERIC(15,2),
  IIN_AMOUNT_REVERSE /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_AMOUNT_REVERSE */ NUMERIC(15,2),
  URVN_AMAOUNT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.URVN_AMAOUNT */ NUMERIC(15,2),
  PLUS_NOT_PAID /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLUS_NOT_PAID */ NUMERIC(15,2),
  VACATION_ADVANCE_CURRENT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_ADVANCE_CURRENT */ NUMERIC(15,2),
  VACATION_ADVANCE_NEXT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_ADVANCE_NEXT */ NUMERIC(15,2),
  VACATION_ADVANCE_PREV /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_ADVANCE_PREV */ NUMERIC(15,2),
  ADVANCE /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.ADVANCE */ NUMERIC(15,2),
  PAY0 /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PAY0 */ NUMERIC(15,2),
  PAY /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PAY */ NUMERIC(15,2),
  PAYT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PAYT */ NUMERIC(15,2),
  PAY_DATE /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.PAY_DATE */ DATE,
  COMMENTS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.COMMENTS */ VARCHAR(255) /* COLLATE UTF8 - default */,
  WITHHOLD_FROM_PAY /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.WITHHOLD_FROM_PAY */ NUMERIC(15,2),
  FORAVPAYCALC_BRUTO /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FORAVPAYCALC_BRUTO */ NUMERIC(15,2),
  FORAVPAYCALC_PAYOUT /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FORAVPAYCALC_PAYOUT */ NUMERIC(15,2),
  FORAVPAYCALC_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FORAVPAYCALC_DAYS */ INTEGER,
  FORAVPAYCALC_HOURS /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.FORAVPAYCALC_HOURS */ FLOAT,
  AVPAYCALC_CALDAY /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.AVPAYCALC_CALDAY */ NUMERIC(13,4),
  AVPAYCALC_DAY /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.AVPAYCALC_DAY */ NUMERIC(13,4),
  AVPAYCALC_HOUR /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.AVPAYCALC_HOUR */ NUMERIC(13,4),
  DT_EDITED /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.DT_EDITED */ TIMESTAMP,
  CALC_VER /* TYPE OF COLUMN SALARY_SHEETS_R_HIST.CALC_VER */ INTEGER)
AS
BEGIN
  SUSPEND;
END
^

ALTER PROCEDURE SP_SALARY_SHEETS_R_PER_01(
  PYR1 INTEGER,
  PMT1 INTEGER,
  PYR2 INTEGER,
  PMT2 INTEGER)
RETURNS (
  ID /* TYPE OF COLUMN SALARY_SHEETS_R.ID */ INTEGER,
  IDS /* TYPE OF COLUMN SALARY_SHEETS_R.IDS */ INTEGER,
  IDSX /* TYPE OF COLUMN SALARY_SHEETS_R.IDSX */ INTEGER,
  IDST /* TYPE OF COLUMN SALARY_SHEETS_R.IDST */ INTEGER,
  IS_TEMP /* TYPE OF COLUMN SALARY_SHEETS_R.IS_TEMP */ SMALLINT,
  TYPE_TAG /* TYPE OF COLUMN SALARY_SHEETS_R.TYPE_TAG */ SMALLINT,
  IDP /* TYPE OF COLUMN SALARY_SHEETS_R.IDP */ INTEGER,
  IDAM /* TYPE OF COLUMN SALARY_SHEETS_R.IDAM */ INTEGER,
  SNR /* TYPE OF COLUMN SALARY_SHEETS_R.SNR */ SMALLINT,
  FNAME /* TYPE OF COLUMN SALARY_SHEETS_R.FNAME */ VARCHAR(20) /* COLLATE UTF8 - default */,
  LNAME /* TYPE OF COLUMN SALARY_SHEETS_R.LNAME */ VARCHAR(20) /* COLLATE UTF8 - default */,
  POSITION_TITLE /* TYPE OF COLUMN SALARY_SHEETS_R.POSITION_TITLE */ VARCHAR(50) /* COLLATE UTF8 - default */,
  TERRITORIAL_CODE /* TYPE OF COLUMN SALARY_SHEETS_R.TERRITORIAL_CODE */ VARCHAR(20) /* COLLATE UTF8 - default */,
  CALENDAR_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R.CALENDAR_DAYS */ INTEGER,
  CALENDAR_DAYS_USE /* TYPE OF COLUMN SALARY_SHEETS_R.CALENDAR_DAYS_USE */ INTEGER,
  MONTH_WORKDAYS /* TYPE OF COLUMN SALARY_SHEETS_R.MONTH_WORKDAYS */ INTEGER,
  MONTH_WORKHOURS /* TYPE OF COLUMN SALARY_SHEETS_R.MONTH_WORKHOURS */ FLOAT,
  PLAN_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R.PLAN_DAYS */ INTEGER,
  PLAN_HOURS /* TYPE OF COLUMN SALARY_SHEETS_R.PLAN_HOURS */ FLOAT,
  PLAN_HOURS_NIGHT /* TYPE OF COLUMN SALARY_SHEETS_R.PLAN_HOURS_NIGHT */ FLOAT,
  PLAN_HOURS_OVERTIME /* TYPE OF COLUMN SALARY_SHEETS_R.PLAN_HOURS_OVERTIME */ FLOAT,
  FACT_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R.FACT_DAYS */ INTEGER,
  FACT_HOURS /* TYPE OF COLUMN SALARY_SHEETS_R.FACT_HOURS */ FLOAT,
  FACT_HOURS_NIGHT /* TYPE OF COLUMN SALARY_SHEETS_R.FACT_HOURS_NIGHT */ FLOAT,
  FACT_HOURS_OVERTIME /* TYPE OF COLUMN SALARY_SHEETS_R.FACT_HOURS_OVERTIME */ FLOAT,
  PLAN_WORK_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R.PLAN_WORK_DAYS */ INTEGER,
  PLAN_WORK_HOURS /* TYPE OF COLUMN SALARY_SHEETS_R.PLAN_WORK_HOURS */ FLOAT,
  PLAN_WORK_HOURS_NIGHT /* TYPE OF COLUMN SALARY_SHEETS_R.PLAN_WORK_HOURS_NIGHT */ FLOAT,
  PLAN_WORK_HOURS_OVERTIME /* TYPE OF COLUMN SALARY_SHEETS_R.PLAN_WORK_HOURS_OVERTIME */ FLOAT,
  FACT_WORK_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R.FACT_WORK_DAYS */ INTEGER,
  FACT_WORK_HOURS /* TYPE OF COLUMN SALARY_SHEETS_R.FACT_WORK_HOURS */ FLOAT,
  FACT_WORK_HOURS_NIGHT /* TYPE OF COLUMN SALARY_SHEETS_R.FACT_WORK_HOURS_NIGHT */ FLOAT,
  FACT_WORK_HOURS_OVERTIME /* TYPE OF COLUMN SALARY_SHEETS_R.FACT_WORK_HOURS_OVERTIME */ FLOAT,
  PLAN_HOLIDAYS_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R.PLAN_HOLIDAYS_DAYS */ INTEGER,
  PLAN_HOLIDAYS_HOURS /* TYPE OF COLUMN SALARY_SHEETS_R.PLAN_HOLIDAYS_HOURS */ FLOAT,
  PLAN_HOLIDAYS_HOURS_NIGHT /* TYPE OF COLUMN SALARY_SHEETS_R.PLAN_HOLIDAYS_HOURS_NIGHT */ FLOAT,
  PLAN_HOLIDAYS_HOURS_OVERTIME /* TYPE OF COLUMN SALARY_SHEETS_R.PLAN_HOLIDAYS_HOURS_OVERTIME */ FLOAT,
  FACT_HOLIDAYS_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R.FACT_HOLIDAYS_DAYS */ INTEGER,
  FACT_HOLIDAYS_HOURS /* TYPE OF COLUMN SALARY_SHEETS_R.FACT_HOLIDAYS_HOURS */ FLOAT,
  FACT_HOLIDAYS_HOURS_NIGHT /* TYPE OF COLUMN SALARY_SHEETS_R.FACT_HOLIDAYS_HOURS_NIGHT */ FLOAT,
  FACT_HOLIDAYS_HOURS_OVERTIME /* TYPE OF COLUMN SALARY_SHEETS_R.FACT_HOLIDAYS_HOURS_OVERTIME */ FLOAT,
  SALARY /* TYPE OF COLUMN SALARY_SHEETS_R.SALARY */ NUMERIC(15,2),
  SALARY_DAY /* TYPE OF COLUMN SALARY_SHEETS_R.SALARY_DAY */ NUMERIC(15,2),
  SALARY_NIGHT /* TYPE OF COLUMN SALARY_SHEETS_R.SALARY_NIGHT */ NUMERIC(15,2),
  SALARY_OVERTIME /* TYPE OF COLUMN SALARY_SHEETS_R.SALARY_OVERTIME */ NUMERIC(15,2),
  SALARY_HOLIDAYS_DAY /* TYPE OF COLUMN SALARY_SHEETS_R.SALARY_HOLIDAYS_DAY */ NUMERIC(15,2),
  SALARY_HOLIDAYS_NIGHT /* TYPE OF COLUMN SALARY_SHEETS_R.SALARY_HOLIDAYS_NIGHT */ NUMERIC(15,2),
  SALARY_HOLIDAYS_OVERTIME /* TYPE OF COLUMN SALARY_SHEETS_R.SALARY_HOLIDAYS_OVERTIME */ NUMERIC(15,2),
  SALARY_PAID_HOLIDAYS_DAY /* TYPE OF COLUMN SALARY_SHEETS_R.SALARY_PAID_HOLIDAYS_DAY */ NUMERIC(15,2),
  SALARY_PAID_HOLIDAYS_NIGHT /* TYPE OF COLUMN SALARY_SHEETS_R.SALARY_PAID_HOLIDAYS_NIGHT */ NUMERIC(15,2),
  SALARY_PIECEWORK /* TYPE OF COLUMN SALARY_SHEETS_R.SALARY_PIECEWORK */ NUMERIC(15,2),
  SICKDAYS /* TYPE OF COLUMN SALARY_SHEETS_R.SICKDAYS */ INTEGER,
  SICKDAYS_PAY /* TYPE OF COLUMN SALARY_SHEETS_R.SICKDAYS_PAY */ NUMERIC(15,2),
  ACCIDENT_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R.ACCIDENT_DAYS */ INTEGER,
  ACCIDENT_PAY /* TYPE OF COLUMN SALARY_SHEETS_R.ACCIDENT_PAY */ NUMERIC(15,2),
  AVERAGE_INCOME_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R.AVERAGE_INCOME_DAYS */ INTEGER,
  AVERAGE_INCOME_PAY /* TYPE OF COLUMN SALARY_SHEETS_R.AVERAGE_INCOME_PAY */ NUMERIC(15,2),
  FACT_AVPAY_FREE_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R.FACT_AVPAY_FREE_DAYS */ INTEGER,
  FACT_AVPAY_FREE_HOURS /* TYPE OF COLUMN SALARY_SHEETS_R.FACT_AVPAY_FREE_HOURS */ FLOAT,
  FACT_AVPAY_WORK_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R.FACT_AVPAY_WORK_DAYS */ INTEGER,
  FACT_AVPAY_WORKINHOLIDAYS /* TYPE OF COLUMN SALARY_SHEETS_R.FACT_AVPAY_WORKINHOLIDAYS */ INTEGER,
  FACT_AVPAY_HOURS /* TYPE OF COLUMN SALARY_SHEETS_R.FACT_AVPAY_HOURS */ FLOAT,
  FACT_AVPAY_HOURS_OVERTIME /* TYPE OF COLUMN SALARY_SHEETS_R.FACT_AVPAY_HOURS_OVERTIME */ FLOAT,
  FACT_AVPAY_HOLIDAYS_HOURS /* TYPE OF COLUMN SALARY_SHEETS_R.FACT_AVPAY_HOLIDAYS_HOURS */ FLOAT,
  FACT_AVPAY_HOLIDAYS_HOURS_OVERT /* TYPE OF COLUMN SALARY_SHEETS_R.FACT_AVPAY_HOLIDAYS_HOURS_OVERT */ FLOAT,
  SALARY_AVPAY_FREE_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R.SALARY_AVPAY_FREE_DAYS */ NUMERIC(15,2),
  SALARY_AVPAY_WORK_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R.SALARY_AVPAY_WORK_DAYS */ NUMERIC(15,2),
  SALARY_AVPAY_WORK_DAYS_OVERTIME /* TYPE OF COLUMN SALARY_SHEETS_R.SALARY_AVPAY_WORK_DAYS_OVERTIME */ NUMERIC(15,2),
  SALARY_AVPAY_HOLIDAYS /* TYPE OF COLUMN SALARY_SHEETS_R.SALARY_AVPAY_HOLIDAYS */ NUMERIC(15,2),
  SALARY_AVPAY_HOLIDAYS_OVERTIME /* TYPE OF COLUMN SALARY_SHEETS_R.SALARY_AVPAY_HOLIDAYS_OVERTIME */ NUMERIC(15,2),
  BUSINESS_TRIP_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R.BUSINESS_TRIP_DAYS */ INTEGER,
  BUSINESS_TRIP_PAY /* TYPE OF COLUMN SALARY_SHEETS_R.BUSINESS_TRIP_PAY */ NUMERIC(15,2),
  PAID_HOLIDAYS /* TYPE OF COLUMN SALARY_SHEETS_R.PAID_HOLIDAYS */ INTEGER,
  PAID_HOLIDAYS_PAY /* TYPE OF COLUMN SALARY_SHEETS_R.PAID_HOLIDAYS_PAY */ NUMERIC(15,2),
  VACATION_DAYS_CURRENT /* TYPE OF COLUMN SALARY_SHEETS_R.VACATION_DAYS_CURRENT */ FLOAT,
  VACATION_DAYS_NEXT /* TYPE OF COLUMN SALARY_SHEETS_R.VACATION_DAYS_NEXT */ FLOAT,
  VACATION_HOURS_CURRENT /* TYPE OF COLUMN SALARY_SHEETS_R.VACATION_HOURS_CURRENT */ FLOAT,
  VACATION_HOURS_NEXT /* TYPE OF COLUMN SALARY_SHEETS_R.VACATION_HOURS_NEXT */ FLOAT,
  VACATION_PAY_CURRENT /* TYPE OF COLUMN SALARY_SHEETS_R.VACATION_PAY_CURRENT */ NUMERIC(15,2),
  VACATION_PAY_NEXT /* TYPE OF COLUMN SALARY_SHEETS_R.VACATION_PAY_NEXT */ NUMERIC(15,2),
  VACATION_DNS_NEXT /* TYPE OF COLUMN SALARY_SHEETS_R.VACATION_DNS_NEXT */ NUMERIC(15,2),
  VACATION_DDS_NEXT /* TYPE OF COLUMN SALARY_SHEETS_R.VACATION_DDS_NEXT */ NUMERIC(15,2),
  VACATION_IIN_NEXT /* TYPE OF COLUMN SALARY_SHEETS_R.VACATION_IIN_NEXT */ NUMERIC(15,2),
  VACATION_IIN_REDUCE_NEXT /* TYPE OF COLUMN SALARY_SHEETS_R.VACATION_IIN_REDUCE_NEXT */ NUMERIC(15,2),
  VACATION_CASH_NEXT /* TYPE OF COLUMN SALARY_SHEETS_R.VACATION_CASH_NEXT */ NUMERIC(15,2),
  VACATION_PAY_PREV /* TYPE OF COLUMN SALARY_SHEETS_R.VACATION_PAY_PREV */ NUMERIC(15,2),
  VACATION_DNS_PREV /* TYPE OF COLUMN SALARY_SHEETS_R.VACATION_DNS_PREV */ NUMERIC(15,2),
  VACATION_DDS_PREV /* TYPE OF COLUMN SALARY_SHEETS_R.VACATION_DDS_PREV */ NUMERIC(15,2),
  VACATION_IIN_PREV /* TYPE OF COLUMN SALARY_SHEETS_R.VACATION_IIN_PREV */ NUMERIC(15,2),
  VACATION_DAYS_COMP /* TYPE OF COLUMN SALARY_SHEETS_R.VACATION_DAYS_COMP */ FLOAT,
  VACATION_PAY_COMP /* TYPE OF COLUMN SALARY_SHEETS_R.VACATION_PAY_COMP */ NUMERIC(15,2),
  PLUS_TAXED /* TYPE OF COLUMN SALARY_SHEETS_R.PLUS_TAXED */ NUMERIC(15,2),
  PLUS_NOTTAXED /* TYPE OF COLUMN SALARY_SHEETS_R.PLUS_NOTTAXED */ NUMERIC(15,2),
  PLUS_NOSAI /* TYPE OF COLUMN SALARY_SHEETS_R.PLUS_NOSAI */ NUMERIC(15,2),
  PLUS_AUTHORS_FEES /* TYPE OF COLUMN SALARY_SHEETS_R.PLUS_AUTHORS_FEES */ NUMERIC(15,2),
  MINUS_BEFORE_IIN /* TYPE OF COLUMN SALARY_SHEETS_R.MINUS_BEFORE_IIN */ NUMERIC(15,2),
  MINUS_AFTER_IIN /* TYPE OF COLUMN SALARY_SHEETS_R.MINUS_AFTER_IIN */ NUMERIC(15,2),
  PLUS_PF_NOTTAXED /* TYPE OF COLUMN SALARY_SHEETS_R.PLUS_PF_NOTTAXED */ NUMERIC(15,2),
  PLUS_PF_TAXED /* TYPE OF COLUMN SALARY_SHEETS_R.PLUS_PF_TAXED */ NUMERIC(15,2),
  PLUS_LI_NOTTAXED /* TYPE OF COLUMN SALARY_SHEETS_R.PLUS_LI_NOTTAXED */ NUMERIC(15,2),
  PLUS_LI_TAXED /* TYPE OF COLUMN SALARY_SHEETS_R.PLUS_LI_TAXED */ NUMERIC(15,2),
  PLUS_HI_NOTTAXED /* TYPE OF COLUMN SALARY_SHEETS_R.PLUS_HI_NOTTAXED */ NUMERIC(15,2),
  PLUS_HI_TAXED /* TYPE OF COLUMN SALARY_SHEETS_R.PLUS_HI_TAXED */ NUMERIC(15,2),
  PLUS_NP_TAXED /* TYPE OF COLUMN SALARY_SHEETS_R.PLUS_NP_TAXED */ NUMERIC(15,2),
  PLUS_NP_NOTTAXED /* TYPE OF COLUMN SALARY_SHEETS_R.PLUS_NP_NOTTAXED */ NUMERIC(15,2),
  PLUS_NP_NOSAI /* TYPE OF COLUMN SALARY_SHEETS_R.PLUS_NP_NOSAI */ NUMERIC(15,2),
  TOTAL_BEFORE_TAXES /* TYPE OF COLUMN SALARY_SHEETS_R.TOTAL_BEFORE_TAXES */ NUMERIC(15,2),
  ADJUSTED_AMOUNT /* TYPE OF COLUMN SALARY_SHEETS_R.ADJUSTED_AMOUNT */ NUMERIC(15,2),
  AMOUNT_BEFORE_SN /* TYPE OF COLUMN SALARY_SHEETS_R.AMOUNT_BEFORE_SN */ NUMERIC(15,2),
  AMOUNT_BEFORE_SN_REVERSE /* TYPE OF COLUMN SALARY_SHEETS_R.AMOUNT_BEFORE_SN_REVERSE */ NUMERIC(15,2),
  RATE_DNSN /* TYPE OF COLUMN SALARY_SHEETS_R.RATE_DNSN */ NUMERIC(15,2),
  RATE_DDSN /* TYPE OF COLUMN SALARY_SHEETS_R.RATE_DDSN */ NUMERIC(15,2),
  DNSN_AMOUNT /* TYPE OF COLUMN SALARY_SHEETS_R.DNSN_AMOUNT */ NUMERIC(15,2),
  DDSN_AMOUNT /* TYPE OF COLUMN SALARY_SHEETS_R.DDSN_AMOUNT */ NUMERIC(15,2),
  SN_AMOUNT /* TYPE OF COLUMN SALARY_SHEETS_R.SN_AMOUNT */ NUMERIC(15,2),
  DNSN_AMOUNT_REVERSE /* TYPE OF COLUMN SALARY_SHEETS_R.DNSN_AMOUNT_REVERSE */ NUMERIC(15,2),
  DDSN_AMOUNT_REVERSE /* TYPE OF COLUMN SALARY_SHEETS_R.DDSN_AMOUNT_REVERSE */ NUMERIC(15,2),
  SN_MAX_AMOUNT /* TYPE OF COLUMN SALARY_SHEETS_R.SN_MAX_AMOUNT */ NUMERIC(15,2),
  IIN_EXEMPT_UNTAXED_MINIMUM0 /* TYPE OF COLUMN SALARY_SHEETS_R.IIN_EXEMPT_UNTAXED_MINIMUM0 */ NUMERIC(15,2),
  IIN_EXEMPT_DEPENDANTS0 /* TYPE OF COLUMN SALARY_SHEETS_R.IIN_EXEMPT_DEPENDANTS0 */ NUMERIC(15,2),
  IIN_EXEMPT_RETALIATION0 /* TYPE OF COLUMN SALARY_SHEETS_R.IIN_EXEMPT_RETALIATION0 */ NUMERIC(15,2),
  IIN_EXEMPT_INVALIDITY0 /* TYPE OF COLUMN SALARY_SHEETS_R.IIN_EXEMPT_INVALIDITY0 */ NUMERIC(15,2),
  IIN_EXEMPT_NATIONAL_MOVEMENT0 /* TYPE OF COLUMN SALARY_SHEETS_R.IIN_EXEMPT_NATIONAL_MOVEMENT0 */ NUMERIC(15,2),
  IIN_EXEMPT_UNTAXED_MINIMUM /* TYPE OF COLUMN SALARY_SHEETS_R.IIN_EXEMPT_UNTAXED_MINIMUM */ NUMERIC(15,2),
  IIN_EXEMPT_DEPENDANTS /* TYPE OF COLUMN SALARY_SHEETS_R.IIN_EXEMPT_DEPENDANTS */ NUMERIC(15,2),
  IIN_EXEMPT_RETALIATION /* TYPE OF COLUMN SALARY_SHEETS_R.IIN_EXEMPT_RETALIATION */ NUMERIC(15,2),
  IIN_EXEMPT_INVALIDITY /* TYPE OF COLUMN SALARY_SHEETS_R.IIN_EXEMPT_INVALIDITY */ NUMERIC(15,2),
  IIN_EXEMPT_NATIONAL_MOVEMENT /* TYPE OF COLUMN SALARY_SHEETS_R.IIN_EXEMPT_NATIONAL_MOVEMENT */ NUMERIC(15,2),
  IIN_EXEMPT_EXPENSES /* TYPE OF COLUMN SALARY_SHEETS_R.IIN_EXEMPT_EXPENSES */ NUMERIC(15,2),
  IIN_EXEMPT_2TP /* TYPE OF COLUMN SALARY_SHEETS_R.IIN_EXEMPT_2TP */ SMALLINT,
  IIN_EXEMPT_20 /* TYPE OF COLUMN SALARY_SHEETS_R.IIN_EXEMPT_20 */ NUMERIC(15,2),
  IIN_EXEMPT_2 /* TYPE OF COLUMN SALARY_SHEETS_R.IIN_EXEMPT_2 */ NUMERIC(15,2),
  AMOUNT_BEFORE_IIN /* TYPE OF COLUMN SALARY_SHEETS_R.AMOUNT_BEFORE_IIN */ NUMERIC(15,2),
  AMOUNT_BEFORE_IIN_REVERSE /* TYPE OF COLUMN SALARY_SHEETS_R.AMOUNT_BEFORE_IIN_REVERSE */ NUMERIC(15,2),
  RATE_IIN /* TYPE OF COLUMN SALARY_SHEETS_R.RATE_IIN */ NUMERIC(15,2),
  RATE_IIN2 /* TYPE OF COLUMN SALARY_SHEETS_R.RATE_IIN2 */ NUMERIC(15,2),
  IIN_AMOUNT /* TYPE OF COLUMN SALARY_SHEETS_R.IIN_AMOUNT */ NUMERIC(15,2),
  IIN_AMOUNT_REVERSE /* TYPE OF COLUMN SALARY_SHEETS_R.IIN_AMOUNT_REVERSE */ NUMERIC(15,2),
  URVN_AMAOUNT /* TYPE OF COLUMN SALARY_SHEETS_R.URVN_AMAOUNT */ NUMERIC(15,2),
  PLUS_NOT_PAID /* TYPE OF COLUMN SALARY_SHEETS_R.PLUS_NOT_PAID */ NUMERIC(15,2),
  VACATION_ADVANCE_CURRENT /* TYPE OF COLUMN SALARY_SHEETS_R.VACATION_ADVANCE_CURRENT */ NUMERIC(15,2),
  VACATION_ADVANCE_NEXT /* TYPE OF COLUMN SALARY_SHEETS_R.VACATION_ADVANCE_NEXT */ NUMERIC(15,2),
  VACATION_ADVANCE_PREV /* TYPE OF COLUMN SALARY_SHEETS_R.VACATION_ADVANCE_PREV */ NUMERIC(15,2),
  ADVANCE /* TYPE OF COLUMN SALARY_SHEETS_R.ADVANCE */ NUMERIC(15,2),
  PAY0 /* TYPE OF COLUMN SALARY_SHEETS_R.PAY0 */ NUMERIC(15,2),
  PAY /* TYPE OF COLUMN SALARY_SHEETS_R.PAY */ NUMERIC(15,2),
  PAYT /* TYPE OF COLUMN SALARY_SHEETS_R.PAYT */ NUMERIC(15,2),
  PAY_DATE /* TYPE OF COLUMN SALARY_SHEETS_R.PAY_DATE */ DATE,
  COMMENTS /* TYPE OF COLUMN SALARY_SHEETS_R.COMMENTS */ VARCHAR(255) /* COLLATE UTF8 - default */,
  WITHHOLD_FROM_PAY /* TYPE OF COLUMN SALARY_SHEETS_R.WITHHOLD_FROM_PAY */ NUMERIC(15,2),
  FORAVPAYCALC_BRUTO /* TYPE OF COLUMN SALARY_SHEETS_R.FORAVPAYCALC_BRUTO */ NUMERIC(15,2),
  FORAVPAYCALC_PAYOUT /* TYPE OF COLUMN SALARY_SHEETS_R.FORAVPAYCALC_PAYOUT */ NUMERIC(15,2),
  FORAVPAYCALC_DAYS /* TYPE OF COLUMN SALARY_SHEETS_R.FORAVPAYCALC_DAYS */ INTEGER,
  FORAVPAYCALC_HOURS /* TYPE OF COLUMN SALARY_SHEETS_R.FORAVPAYCALC_HOURS */ FLOAT,
  AVPAYCALC_CALDAY /* TYPE OF COLUMN SALARY_SHEETS_R.AVPAYCALC_CALDAY */ NUMERIC(13,4),
  AVPAYCALC_DAY /* TYPE OF COLUMN SALARY_SHEETS_R.AVPAYCALC_DAY */ NUMERIC(13,4),
  AVPAYCALC_HOUR /* TYPE OF COLUMN SALARY_SHEETS_R.AVPAYCALC_HOUR */ NUMERIC(13,4),
  DT_EDITED /* TYPE OF COLUMN SALARY_SHEETS_R.DT_EDITED */ TIMESTAMP,
  CALC_VER /* TYPE OF COLUMN SALARY_SHEETS_R.CALC_VER */ INTEGER)
AS
BEGIN
  SUSPEND;
END
^


/******************************************************************************/
/****                      Altering stored procedures                      ****/
/******************************************************************************/
ALTER PROCEDURE SP_MAKE_SALARY_SHEET_R_HIST(
  PID INTEGER,
  PDTCUR TIMESTAMP,
  PSKIP_INTERVAL FLOAT)
AS
declare variable V_LAST_DT TIMESTAMP;
    declare variable V_DIFF_DT FLOAT;
    declare variable V_ID INTEGER;
    declare variable V_IDH INTEGER;
    declare variable V_EQ INTEGER;
begin
    select salary_sheets_r.id
    from salary_sheets_r
    where salary_sheets_r.id = :PID
    into :V_ID;
    
    if(V_ID is null) then exit;

    select max(salary_sheets_r_hist.dt_edited)
    from salary_sheets_r_hist
    where salary_sheets_r_hist.id = :PID
    into :V_LAST_DT;

    if(V_LAST_DT is not null) then
    begin
        if(pdtcur < V_LAST_DT) then exit;
        V_DIFF_DT = pdtcur - V_LAST_DT;
        if(V_DIFF_DT < PSKIP_INTERVAL) then exit;
    end

    if(V_LAST_DT is not null) then
    begin
        select max(salary_sheets_r_hist.idh)
        from salary_sheets_r_hist
        where (salary_sheets_r_hist.id = :PID) and
            (salary_sheets_r_hist.dt_edited = :V_LAST_DT)
        into :V_IDH;
        
        select case when
            (salary_sheets_r.IDS is null and salary_sheets_r_hist.IDS is null or salary_sheets_r.IDS = salary_sheets_r_hist.IDS) and
            (salary_sheets_r.IDSX is null and salary_sheets_r_hist.IDSX is null or salary_sheets_r.IDSX = salary_sheets_r_hist.IDSX) and
            (salary_sheets_r.IDST is null and salary_sheets_r_hist.IDST is null or salary_sheets_r.IDST = salary_sheets_r_hist.IDST) and
            (salary_sheets_r.IS_TEMP is null and salary_sheets_r_hist.IS_TEMP is null or salary_sheets_r.IS_TEMP = salary_sheets_r_hist.IS_TEMP) and
            (salary_sheets_r.TYPE_TAG is null and salary_sheets_r_hist.TYPE_TAG is null or salary_sheets_r.TYPE_TAG = salary_sheets_r_hist.TYPE_TAG) and
            (salary_sheets_r.IDP is null and salary_sheets_r_hist.IDP is null or salary_sheets_r.IDP = salary_sheets_r_hist.IDP) and
            (salary_sheets_r.IDAM is null and salary_sheets_r_hist.IDAM is null or salary_sheets_r.IDAM = salary_sheets_r_hist.IDAM) and
            (salary_sheets_r.SNR = salary_sheets_r_hist.SNR) and
            (salary_sheets_r.FNAME is null and salary_sheets_r_hist.FNAME is null or salary_sheets_r.FNAME = salary_sheets_r_hist.FNAME) and
            (salary_sheets_r.LNAME is null and salary_sheets_r_hist.LNAME is null or salary_sheets_r.LNAME = salary_sheets_r_hist.LNAME) and
            (salary_sheets_r.POSITION_TITLE is null and salary_sheets_r_hist.POSITION_TITLE is null or salary_sheets_r.POSITION_TITLE = salary_sheets_r_hist.POSITION_TITLE) and
            (salary_sheets_r.TERRITORIAL_CODE is null and salary_sheets_r_hist.TERRITORIAL_CODE is null or salary_sheets_r.TERRITORIAL_CODE = salary_sheets_r_hist.TERRITORIAL_CODE) and
            (salary_sheets_r.CALENDAR_DAYS = salary_sheets_r_hist.CALENDAR_DAYS) and
            (salary_sheets_r.CALENDAR_DAYS_USE = salary_sheets_r_hist.CALENDAR_DAYS_USE) and
            (salary_sheets_r.MONTH_WORKDAYS = salary_sheets_r_hist.MONTH_WORKDAYS) and
            (salary_sheets_r.MONTH_WORKHOURS = salary_sheets_r_hist.MONTH_WORKHOURS) and
            (salary_sheets_r.PLAN_DAYS = salary_sheets_r_hist.PLAN_DAYS) and
            (salary_sheets_r.PLAN_HOURS = salary_sheets_r_hist.PLAN_HOURS) and
            (salary_sheets_r.PLAN_HOURS_NIGHT = salary_sheets_r_hist.PLAN_HOURS_NIGHT) and
            (salary_sheets_r.PLAN_HOURS_OVERTIME = salary_sheets_r_hist.PLAN_HOURS_OVERTIME) and
            (salary_sheets_r.FACT_DAYS = salary_sheets_r_hist.FACT_DAYS) and
            (salary_sheets_r.FACT_HOURS = salary_sheets_r_hist.FACT_HOURS) and
            (salary_sheets_r.FACT_HOURS_NIGHT = salary_sheets_r_hist.FACT_HOURS_NIGHT) and
            (salary_sheets_r.FACT_HOURS_OVERTIME = salary_sheets_r_hist.FACT_HOURS_OVERTIME) and
            (salary_sheets_r.PLAN_WORK_DAYS = salary_sheets_r_hist.PLAN_WORK_DAYS) and
            (salary_sheets_r.PLAN_WORK_HOURS = salary_sheets_r_hist.PLAN_WORK_HOURS) and
            (salary_sheets_r.PLAN_WORK_HOURS_NIGHT = salary_sheets_r_hist.PLAN_WORK_HOURS_NIGHT) and
            (salary_sheets_r.PLAN_WORK_HOURS_OVERTIME = salary_sheets_r_hist.PLAN_WORK_HOURS_OVERTIME) and
            (salary_sheets_r.FACT_WORK_DAYS = salary_sheets_r_hist.FACT_WORK_DAYS) and
            (salary_sheets_r.FACT_WORK_HOURS = salary_sheets_r_hist.FACT_WORK_HOURS) and
            (salary_sheets_r.FACT_WORK_HOURS_NIGHT = salary_sheets_r_hist.FACT_WORK_HOURS_NIGHT) and
            (salary_sheets_r.FACT_WORK_HOURS_OVERTIME = salary_sheets_r_hist.FACT_WORK_HOURS_OVERTIME) and
            (salary_sheets_r.PLAN_HOLIDAYS_DAYS = salary_sheets_r_hist.PLAN_HOLIDAYS_DAYS) and
            (salary_sheets_r.PLAN_HOLIDAYS_HOURS = salary_sheets_r_hist.PLAN_HOLIDAYS_HOURS) and
            (salary_sheets_r.PLAN_HOLIDAYS_HOURS_NIGHT = salary_sheets_r_hist.PLAN_HOLIDAYS_HOURS_NIGHT) and
            (salary_sheets_r.PLAN_HOLIDAYS_HOURS_OVERTIME = salary_sheets_r_hist.PLAN_HOLIDAYS_HOURS_OVERTIME) and
            (salary_sheets_r.FACT_HOLIDAYS_DAYS = salary_sheets_r_hist.FACT_HOLIDAYS_DAYS) and
            (salary_sheets_r.FACT_HOLIDAYS_HOURS = salary_sheets_r_hist.FACT_HOLIDAYS_HOURS) and
            (salary_sheets_r.FACT_HOLIDAYS_HOURS_NIGHT = salary_sheets_r_hist.FACT_HOLIDAYS_HOURS_NIGHT) and
            (salary_sheets_r.FACT_HOLIDAYS_HOURS_OVERTIME = salary_sheets_r_hist.FACT_HOLIDAYS_HOURS_OVERTIME) and
            (salary_sheets_r.SALARY = salary_sheets_r_hist.SALARY) and
            (salary_sheets_r.SALARY_DAY = salary_sheets_r_hist.SALARY_DAY) and
            (salary_sheets_r.SALARY_NIGHT = salary_sheets_r_hist.SALARY_NIGHT) and
            (salary_sheets_r.SALARY_OVERTIME = salary_sheets_r_hist.SALARY_OVERTIME) and
            (salary_sheets_r.SALARY_HOLIDAYS_DAY = salary_sheets_r_hist.SALARY_HOLIDAYS_DAY) and
            (salary_sheets_r.SALARY_HOLIDAYS_NIGHT = salary_sheets_r_hist.SALARY_HOLIDAYS_NIGHT) and
            (salary_sheets_r.SALARY_HOLIDAYS_OVERTIME = salary_sheets_r_hist.SALARY_HOLIDAYS_OVERTIME) and
            (salary_sheets_r.SALARY_PAID_HOLIDAYS_DAY = salary_sheets_r_hist.SALARY_PAID_HOLIDAYS_DAY) and
            (salary_sheets_r.SALARY_PAID_HOLIDAYS_NIGHT = salary_sheets_r_hist.SALARY_PAID_HOLIDAYS_NIGHT) and
            (salary_sheets_r.SALARY_PIECEWORK = salary_sheets_r_hist.SALARY_PIECEWORK) and
            (salary_sheets_r.SICKDAYS = salary_sheets_r_hist.SICKDAYS) and
            (salary_sheets_r.SICKDAYS_PAY = salary_sheets_r_hist.SICKDAYS_PAY) and
            (salary_sheets_r.ACCIDENT_DAYS = salary_sheets_r_hist.ACCIDENT_DAYS) and
            (salary_sheets_r.ACCIDENT_PAY = salary_sheets_r_hist.ACCIDENT_PAY) and
            (salary_sheets_r.AVERAGE_INCOME_DAYS = salary_sheets_r_hist.AVERAGE_INCOME_DAYS) and
            (salary_sheets_r.AVERAGE_INCOME_PAY = salary_sheets_r_hist.AVERAGE_INCOME_PAY) and
            (salary_sheets_r.FACT_AVPAY_FREE_DAYS = salary_sheets_r_hist.FACT_AVPAY_FREE_DAYS) and
            (salary_sheets_r.FACT_AVPAY_FREE_HOURS = salary_sheets_r_hist.FACT_AVPAY_FREE_HOURS) and
            (salary_sheets_r.FACT_AVPAY_WORK_DAYS = salary_sheets_r_hist.FACT_AVPAY_WORK_DAYS) and
            (salary_sheets_r.FACT_AVPAY_WORKINHOLIDAYS = salary_sheets_r_hist.FACT_AVPAY_WORKINHOLIDAYS) and
            (salary_sheets_r.FACT_AVPAY_HOURS = salary_sheets_r_hist.FACT_AVPAY_HOURS) and
            (salary_sheets_r.FACT_AVPAY_HOURS_OVERTIME = salary_sheets_r_hist.FACT_AVPAY_HOURS_OVERTIME) and
            (salary_sheets_r.FACT_AVPAY_HOLIDAYS_HOURS = salary_sheets_r_hist.FACT_AVPAY_HOLIDAYS_HOURS) and
            (salary_sheets_r.FACT_AVPAY_HOLIDAYS_HOURS_OVERT = salary_sheets_r_hist.FACT_AVPAY_HOLIDAYS_HOURS_OVERT) and
            (salary_sheets_r.SALARY_AVPAY_FREE_DAYS = salary_sheets_r_hist.SALARY_AVPAY_FREE_DAYS) and
            (salary_sheets_r.SALARY_AVPAY_WORK_DAYS = salary_sheets_r_hist.SALARY_AVPAY_WORK_DAYS) and
            (salary_sheets_r.SALARY_AVPAY_WORK_DAYS_OVERTIME = salary_sheets_r_hist.SALARY_AVPAY_WORK_DAYS_OVERTIME) and
            (salary_sheets_r.SALARY_AVPAY_HOLIDAYS = salary_sheets_r_hist.SALARY_AVPAY_HOLIDAYS) and
            (salary_sheets_r.SALARY_AVPAY_HOLIDAYS_OVERTIME = salary_sheets_r_hist.SALARY_AVPAY_HOLIDAYS_OVERTIME) and
            (salary_sheets_r.BUSINESS_TRIP_DAYS = salary_sheets_r_hist.BUSINESS_TRIP_DAYS) and
            (salary_sheets_r.BUSINESS_TRIP_PAY = salary_sheets_r_hist.BUSINESS_TRIP_PAY) and
            (salary_sheets_r.PAID_HOLIDAYS = salary_sheets_r_hist.PAID_HOLIDAYS) and
            (salary_sheets_r.PAID_HOLIDAYS_PAY = salary_sheets_r_hist.PAID_HOLIDAYS_PAY) and
            (salary_sheets_r.VACATION_DAYS_CURRENT = salary_sheets_r_hist.VACATION_DAYS_CURRENT) and
            (salary_sheets_r.VACATION_DAYS_NEXT = salary_sheets_r_hist.VACATION_DAYS_NEXT) and
            (salary_sheets_r.VACATION_HOURS_CURRENT = salary_sheets_r_hist.VACATION_HOURS_CURRENT) and
            (salary_sheets_r.VACATION_HOURS_NEXT = salary_sheets_r_hist.VACATION_HOURS_NEXT) and
            (salary_sheets_r.VACATION_PAY_CURRENT = salary_sheets_r_hist.VACATION_PAY_CURRENT) and
            (salary_sheets_r.VACATION_PAY_NEXT = salary_sheets_r_hist.VACATION_PAY_NEXT) and
            (salary_sheets_r.VACATION_DNS_NEXT = salary_sheets_r_hist.VACATION_DNS_NEXT) and
            (salary_sheets_r.VACATION_DDS_NEXT = salary_sheets_r_hist.VACATION_DDS_NEXT) and
            (salary_sheets_r.VACATION_IIN_NEXT = salary_sheets_r_hist.VACATION_IIN_NEXT) and
            (salary_sheets_r.VACATION_IIN_REDUCE_NEXT = salary_sheets_r_hist.VACATION_IIN_REDUCE_NEXT) and
            (salary_sheets_r.VACATION_CASH_NEXT = salary_sheets_r_hist.VACATION_CASH_NEXT) and
            (salary_sheets_r.VACATION_PAY_PREV = salary_sheets_r_hist.VACATION_PAY_PREV) and
            (salary_sheets_r.VACATION_DNS_PREV = salary_sheets_r_hist.VACATION_DNS_PREV) and
            (salary_sheets_r.VACATION_DDS_PREV = salary_sheets_r_hist.VACATION_DDS_PREV) and
            (salary_sheets_r.VACATION_IIN_PREV = salary_sheets_r_hist.VACATION_IIN_PREV) and
            (salary_sheets_r.VACATION_DAYS_COMP = salary_sheets_r_hist.VACATION_DAYS_COMP) and
            (salary_sheets_r.VACATION_PAY_COMP = salary_sheets_r_hist.VACATION_PAY_COMP) and
            (salary_sheets_r.PLUS_TAXED = salary_sheets_r_hist.PLUS_TAXED) and
            (salary_sheets_r.PLUS_NOTTAXED = salary_sheets_r_hist.PLUS_NOTTAXED) and
            (salary_sheets_r.PLUS_NOSAI = salary_sheets_r_hist.PLUS_NOSAI) and
            (salary_sheets_r.PLUS_AUTHORS_FEES = salary_sheets_r_hist.PLUS_AUTHORS_FEES) and
            (salary_sheets_r.MINUS_BEFORE_IIN = salary_sheets_r_hist.MINUS_BEFORE_IIN) and
            (salary_sheets_r.MINUS_AFTER_IIN = salary_sheets_r_hist.MINUS_AFTER_IIN) and
            (salary_sheets_r.PLUS_PF_NOTTAXED = salary_sheets_r_hist.PLUS_PF_NOTTAXED) and
            (salary_sheets_r.PLUS_PF_TAXED = salary_sheets_r_hist.PLUS_PF_TAXED) and
            (salary_sheets_r.PLUS_LI_NOTTAXED = salary_sheets_r_hist.PLUS_LI_NOTTAXED) and
            (salary_sheets_r.PLUS_LI_TAXED = salary_sheets_r_hist.PLUS_LI_TAXED) and
            (salary_sheets_r.PLUS_HI_NOTTAXED = salary_sheets_r_hist.PLUS_HI_NOTTAXED) and
            (salary_sheets_r.PLUS_HI_TAXED = salary_sheets_r_hist.PLUS_HI_TAXED) and
            (salary_sheets_r.PLUS_NP_TAXED = salary_sheets_r_hist.PLUS_NP_TAXED) and
            (salary_sheets_r.PLUS_NP_NOSAI = salary_sheets_r_hist.PLUS_NP_NOSAI) and
            (salary_sheets_r.PLUS_NP_NOTTAXED = salary_sheets_r_hist.PLUS_NP_NOTTAXED) and
            (salary_sheets_r.TOTAL_BEFORE_TAXES = salary_sheets_r_hist.TOTAL_BEFORE_TAXES) and
            (salary_sheets_r.ADJUSTED_AMOUNT = salary_sheets_r_hist.ADJUSTED_AMOUNT) and
            (salary_sheets_r.AMOUNT_BEFORE_SN = salary_sheets_r_hist.AMOUNT_BEFORE_SN) and
            (salary_sheets_r.AMOUNT_BEFORE_SN_REVERSE = salary_sheets_r_hist.AMOUNT_BEFORE_SN_REVERSE) and
            (salary_sheets_r.RATE_DNSN = salary_sheets_r_hist.RATE_DNSN) and
            (salary_sheets_r.RATE_DDSN = salary_sheets_r_hist.RATE_DDSN) and
            (salary_sheets_r.DNSN_AMOUNT = salary_sheets_r_hist.DNSN_AMOUNT) and
            (salary_sheets_r.DDSN_AMOUNT = salary_sheets_r_hist.DDSN_AMOUNT) and
            (salary_sheets_r.SN_AMOUNT = salary_sheets_r_hist.SN_AMOUNT) and
            (salary_sheets_r.DNSN_AMOUNT_REVERSE = salary_sheets_r_hist.DNSN_AMOUNT_REVERSE) and
            (salary_sheets_r.DDSN_AMOUNT_REVERSE = salary_sheets_r_hist.DDSN_AMOUNT_REVERSE) and
            (salary_sheets_r.SN_MAX_AMOUNT = salary_sheets_r_hist.SN_MAX_AMOUNT) and
            (salary_sheets_r.IIN_EXEMPT_UNTAXED_MINIMUM0 = salary_sheets_r_hist.IIN_EXEMPT_UNTAXED_MINIMUM0) and
            (salary_sheets_r.IIN_EXEMPT_DEPENDANTS0 = salary_sheets_r_hist.IIN_EXEMPT_DEPENDANTS0) and
            (salary_sheets_r.IIN_EXEMPT_RETALIATION0 = salary_sheets_r_hist.IIN_EXEMPT_RETALIATION0) and
            (salary_sheets_r.IIN_EXEMPT_INVALIDITY0 = salary_sheets_r_hist.IIN_EXEMPT_INVALIDITY0) and
            (salary_sheets_r.IIN_EXEMPT_NATIONAL_MOVEMENT0 = salary_sheets_r_hist.IIN_EXEMPT_NATIONAL_MOVEMENT0) and
            (salary_sheets_r.IIN_EXEMPT_UNTAXED_MINIMUM = salary_sheets_r_hist.IIN_EXEMPT_UNTAXED_MINIMUM) and
            (salary_sheets_r.IIN_EXEMPT_DEPENDANTS = salary_sheets_r_hist.IIN_EXEMPT_DEPENDANTS) and
            (salary_sheets_r.IIN_EXEMPT_RETALIATION = salary_sheets_r_hist.IIN_EXEMPT_RETALIATION) and
            (salary_sheets_r.IIN_EXEMPT_INVALIDITY = salary_sheets_r_hist.IIN_EXEMPT_INVALIDITY) and
            (salary_sheets_r.IIN_EXEMPT_NATIONAL_MOVEMENT = salary_sheets_r_hist.IIN_EXEMPT_NATIONAL_MOVEMENT) and
            (salary_sheets_r.IIN_EXEMPT_EXPENSES = salary_sheets_r_hist.IIN_EXEMPT_EXPENSES) and
            (salary_sheets_r.IIN_EXEMPT_2TP = salary_sheets_r_hist.IIN_EXEMPT_2TP) and
            (salary_sheets_r.IIN_EXEMPT_20 = salary_sheets_r_hist.IIN_EXEMPT_20) and
            (salary_sheets_r.IIN_EXEMPT_2 = salary_sheets_r_hist.IIN_EXEMPT_2) and
            (salary_sheets_r.AMOUNT_BEFORE_IIN = salary_sheets_r_hist.AMOUNT_BEFORE_IIN) and
            (salary_sheets_r.AMOUNT_BEFORE_IIN_REVERSE = salary_sheets_r_hist.AMOUNT_BEFORE_IIN_REVERSE) and
            (salary_sheets_r.RATE_IIN = salary_sheets_r_hist.RATE_IIN) and
            (salary_sheets_r.RATE_IIN2 = salary_sheets_r_hist.RATE_IIN2) and
            (salary_sheets_r.IIN_AMOUNT = salary_sheets_r_hist.IIN_AMOUNT) and
            (salary_sheets_r.IIN_AMOUNT_REVERSE = salary_sheets_r_hist.IIN_AMOUNT_REVERSE) and
            (salary_sheets_r.URVN_AMAOUNT = salary_sheets_r_hist.URVN_AMAOUNT) and
            (salary_sheets_r.PLUS_NOT_PAID = salary_sheets_r_hist.PLUS_NOT_PAID) and
            (salary_sheets_r.VACATION_ADVANCE_CURRENT = salary_sheets_r_hist.VACATION_ADVANCE_CURRENT) and
            (salary_sheets_r.VACATION_ADVANCE_NEXT = salary_sheets_r_hist.VACATION_ADVANCE_NEXT) and
            (salary_sheets_r.VACATION_ADVANCE_PREV = salary_sheets_r_hist.VACATION_ADVANCE_PREV) and
            (salary_sheets_r.ADVANCE = salary_sheets_r_hist.ADVANCE) and
            (salary_sheets_r.PAY0 = salary_sheets_r_hist.PAY0) and
            (salary_sheets_r.PAY = salary_sheets_r_hist.PAY) and
            (salary_sheets_r.PAYT = salary_sheets_r_hist.PAYT) and
            (salary_sheets_r.PAY_DATE is null and salary_sheets_r_hist.PAY_DATE is null or salary_sheets_r.PAY_DATE = salary_sheets_r_hist.PAY_DATE) and
            (salary_sheets_r.COMMENTS is null and salary_sheets_r_hist.COMMENTS is null or salary_sheets_r.COMMENTS = salary_sheets_r_hist.COMMENTS) and
            (salary_sheets_r.WITHHOLD_FROM_PAY = salary_sheets_r_hist.WITHHOLD_FROM_PAY) and
            (salary_sheets_r.FORAVPAYCALC_BRUTO = salary_sheets_r_hist.FORAVPAYCALC_BRUTO) and
            (salary_sheets_r.FORAVPAYCALC_PAYOUT = salary_sheets_r_hist.FORAVPAYCALC_PAYOUT) and
            (salary_sheets_r.FORAVPAYCALC_DAYS = salary_sheets_r_hist.FORAVPAYCALC_DAYS) and
            (salary_sheets_r.FORAVPAYCALC_HOURS = salary_sheets_r_hist.FORAVPAYCALC_HOURS) and
            (salary_sheets_r.AVPAYCALC_CALDAY = salary_sheets_r_hist.AVPAYCALC_CALDAY) and
            (salary_sheets_r.AVPAYCALC_DAY = salary_sheets_r_hist.AVPAYCALC_DAY) and
            (salary_sheets_r.AVPAYCALC_HOUR = salary_sheets_r_hist.AVPAYCALC_HOUR) and
            (salary_sheets_r.CALC_VER = salary_sheets_r_hist.CALC_VER)
        then  1
        else  0
        end as is_eq
        from salary_sheets_r, salary_sheets_r_hist
        where salary_sheets_r.id = :PID and
            salary_sheets_r_hist.idh = :V_IDH
        into :v_eq;

        if(v_eq = 1) then exit;

    end


    insert into salary_sheets_r_hist
    (
        IDH,
        ID,
        IDS,
        IDSX,
        IDST,
        IS_TEMP,
        TYPE_TAG,
        IDP,
        IDAM,
        SNR,
        FNAME,
        LNAME,
        POSITION_TITLE,
        TERRITORIAL_CODE,
        CALENDAR_DAYS,
        CALENDAR_DAYS_USE,
        MONTH_WORKDAYS,
        MONTH_WORKHOURS,
        PLAN_DAYS,
        PLAN_HOURS,
        PLAN_HOURS_NIGHT,
        PLAN_HOURS_OVERTIME,
        FACT_DAYS,
        FACT_HOURS,
        FACT_HOURS_NIGHT,
        FACT_HOURS_OVERTIME,
        PLAN_WORK_DAYS,
        PLAN_WORK_HOURS,
        PLAN_WORK_HOURS_NIGHT,
        PLAN_WORK_HOURS_OVERTIME,
        FACT_WORK_DAYS,
        FACT_WORK_HOURS,
        FACT_WORK_HOURS_NIGHT,
        FACT_WORK_HOURS_OVERTIME,
        PLAN_HOLIDAYS_DAYS,
        PLAN_HOLIDAYS_HOURS,
        PLAN_HOLIDAYS_HOURS_NIGHT,
        PLAN_HOLIDAYS_HOURS_OVERTIME,
        FACT_HOLIDAYS_DAYS,
        FACT_HOLIDAYS_HOURS,
        FACT_HOLIDAYS_HOURS_NIGHT,
        FACT_HOLIDAYS_HOURS_OVERTIME,
        SALARY,
        SALARY_DAY,
        SALARY_NIGHT,
        SALARY_OVERTIME,
        SALARY_HOLIDAYS_DAY,
        SALARY_HOLIDAYS_NIGHT,
        SALARY_HOLIDAYS_OVERTIME,
        SALARY_PAID_HOLIDAYS_DAY,
        SALARY_PAID_HOLIDAYS_NIGHT,
        SALARY_PIECEWORK,
        SICKDAYS,
        SICKDAYS_PAY,
        ACCIDENT_DAYS,
        ACCIDENT_PAY,
        AVERAGE_INCOME_DAYS,
        AVERAGE_INCOME_PAY,
        FACT_AVPAY_FREE_DAYS,
        FACT_AVPAY_FREE_HOURS,
        FACT_AVPAY_WORK_DAYS,
        FACT_AVPAY_WORKINHOLIDAYS,
        FACT_AVPAY_HOURS,
        FACT_AVPAY_HOURS_OVERTIME,
        FACT_AVPAY_HOLIDAYS_HOURS,
        FACT_AVPAY_HOLIDAYS_HOURS_OVERT,
        SALARY_AVPAY_FREE_DAYS,
        SALARY_AVPAY_WORK_DAYS,
        SALARY_AVPAY_WORK_DAYS_OVERTIME,
        SALARY_AVPAY_HOLIDAYS,
        SALARY_AVPAY_HOLIDAYS_OVERTIME,
        BUSINESS_TRIP_DAYS,
        BUSINESS_TRIP_PAY,
        PAID_HOLIDAYS,
        PAID_HOLIDAYS_PAY,
        VACATION_DAYS_CURRENT,
        VACATION_DAYS_NEXT,
        VACATION_HOURS_CURRENT,
        VACATION_HOURS_NEXT,
        VACATION_PAY_CURRENT,
        VACATION_PAY_NEXT,
        VACATION_DNS_NEXT,
        VACATION_DDS_NEXT,
        VACATION_IIN_NEXT,
        VACATION_IIN_REDUCE_NEXT,
        VACATION_CASH_NEXT,
        VACATION_PAY_PREV,
        VACATION_DNS_PREV,
        VACATION_DDS_PREV,
        VACATION_IIN_PREV,
        VACATION_DAYS_COMP,
        VACATION_PAY_COMP,
        PLUS_TAXED,
        PLUS_NOTTAXED,
        PLUS_NOSAI,
        PLUS_AUTHORS_FEES,
        MINUS_BEFORE_IIN,
        MINUS_AFTER_IIN,
        PLUS_PF_NOTTAXED,
        PLUS_PF_TAXED,
        PLUS_LI_NOTTAXED,
        PLUS_LI_TAXED,
        PLUS_HI_NOTTAXED,
        PLUS_HI_TAXED,
        PLUS_NP_TAXED,
        PLUS_NP_NOSAI,
        PLUS_NP_NOTTAXED,
        TOTAL_BEFORE_TAXES,
        ADJUSTED_AMOUNT,
        AMOUNT_BEFORE_SN,
        AMOUNT_BEFORE_SN_REVERSE,
        RATE_DNSN,
        RATE_DDSN,
        DNSN_AMOUNT,
        DDSN_AMOUNT,
        SN_AMOUNT,
        DNSN_AMOUNT_REVERSE,
        DDSN_AMOUNT_REVERSE,
        SN_MAX_AMOUNT,
        IIN_EXEMPT_UNTAXED_MINIMUM0,
        IIN_EXEMPT_DEPENDANTS0,
        IIN_EXEMPT_RETALIATION0,
        IIN_EXEMPT_INVALIDITY0,
        IIN_EXEMPT_NATIONAL_MOVEMENT0,
        IIN_EXEMPT_UNTAXED_MINIMUM,
        IIN_EXEMPT_DEPENDANTS,
        IIN_EXEMPT_RETALIATION,
        IIN_EXEMPT_INVALIDITY,
        IIN_EXEMPT_NATIONAL_MOVEMENT,
        IIN_EXEMPT_EXPENSES,
        IIN_EXEMPT_2TP,
        IIN_EXEMPT_20,
        IIN_EXEMPT_2,
        AMOUNT_BEFORE_IIN,
        AMOUNT_BEFORE_IIN_REVERSE,
        RATE_IIN,
        RATE_IIN2,
        IIN_AMOUNT,
        IIN_AMOUNT_REVERSE,
        URVN_AMAOUNT,
        PLUS_NOT_PAID,
        VACATION_ADVANCE_CURRENT,
        VACATION_ADVANCE_NEXT,
        VACATION_ADVANCE_PREV,
        ADVANCE,
        PAY0,
        PAY,
        PAYT,
        PAY_DATE,
        COMMENTS,
        WITHHOLD_FROM_PAY,
        FORAVPAYCALC_BRUTO,
        FORAVPAYCALC_PAYOUT,
        FORAVPAYCALC_DAYS,
        FORAVPAYCALC_HOURS,
        AVPAYCALC_CALDAY,
        AVPAYCALC_DAY,
        AVPAYCALC_HOUR,
        DT_EDITED,
        CALC_VER
    )
    select
        null, 
        ID,
        IDS,
        IDSX,
        IDST,
        IS_TEMP,
        TYPE_TAG,
        IDP,
        IDAM,
        SNR,
        FNAME,
        LNAME,
        POSITION_TITLE,
        TERRITORIAL_CODE,
        CALENDAR_DAYS,
        CALENDAR_DAYS_USE,
        MONTH_WORKDAYS,
        MONTH_WORKHOURS,
        PLAN_DAYS,
        PLAN_HOURS,
        PLAN_HOURS_NIGHT,
        PLAN_HOURS_OVERTIME,
        FACT_DAYS,
        FACT_HOURS,
        FACT_HOURS_NIGHT,
        FACT_HOURS_OVERTIME,
        PLAN_WORK_DAYS,
        PLAN_WORK_HOURS,
        PLAN_WORK_HOURS_NIGHT,
        PLAN_WORK_HOURS_OVERTIME,
        FACT_WORK_DAYS,
        FACT_WORK_HOURS,
        FACT_WORK_HOURS_NIGHT,
        FACT_WORK_HOURS_OVERTIME,
        PLAN_HOLIDAYS_DAYS,
        PLAN_HOLIDAYS_HOURS,
        PLAN_HOLIDAYS_HOURS_NIGHT,
        PLAN_HOLIDAYS_HOURS_OVERTIME,
        FACT_HOLIDAYS_DAYS,
        FACT_HOLIDAYS_HOURS,
        FACT_HOLIDAYS_HOURS_NIGHT,
        FACT_HOLIDAYS_HOURS_OVERTIME,
        SALARY,
        SALARY_DAY,
        SALARY_NIGHT,
        SALARY_OVERTIME,
        SALARY_HOLIDAYS_DAY,
        SALARY_HOLIDAYS_NIGHT,
        SALARY_HOLIDAYS_OVERTIME,
        SALARY_PAID_HOLIDAYS_DAY,
        SALARY_PAID_HOLIDAYS_NIGHT,
        SALARY_PIECEWORK,
        SICKDAYS,
        SICKDAYS_PAY,
        ACCIDENT_DAYS,
        ACCIDENT_PAY,
        AVERAGE_INCOME_DAYS,
        AVERAGE_INCOME_PAY,
        FACT_AVPAY_FREE_DAYS,
        FACT_AVPAY_FREE_HOURS,
        FACT_AVPAY_WORK_DAYS,
        FACT_AVPAY_WORKINHOLIDAYS,
        FACT_AVPAY_HOURS,
        FACT_AVPAY_HOURS_OVERTIME,
        FACT_AVPAY_HOLIDAYS_HOURS,
        FACT_AVPAY_HOLIDAYS_HOURS_OVERT,
        SALARY_AVPAY_FREE_DAYS,
        SALARY_AVPAY_WORK_DAYS,
        SALARY_AVPAY_WORK_DAYS_OVERTIME,
        SALARY_AVPAY_HOLIDAYS,
        SALARY_AVPAY_HOLIDAYS_OVERTIME,
        BUSINESS_TRIP_DAYS,
        BUSINESS_TRIP_PAY,
        PAID_HOLIDAYS,
        PAID_HOLIDAYS_PAY,
        VACATION_DAYS_CURRENT,
        VACATION_DAYS_NEXT,
        VACATION_HOURS_CURRENT,
        VACATION_HOURS_NEXT,
        VACATION_PAY_CURRENT,
        VACATION_PAY_NEXT,
        VACATION_DNS_NEXT,
        VACATION_DDS_NEXT,
        VACATION_IIN_NEXT,
        VACATION_IIN_REDUCE_NEXT,
        VACATION_CASH_NEXT,
        VACATION_PAY_PREV,
        VACATION_DNS_PREV,
        VACATION_DDS_PREV,
        VACATION_IIN_PREV,
        VACATION_DAYS_COMP,
        VACATION_PAY_COMP,
        PLUS_TAXED,
        PLUS_NOTTAXED,
        PLUS_NOSAI,
        PLUS_AUTHORS_FEES,
        MINUS_BEFORE_IIN,
        MINUS_AFTER_IIN,
        PLUS_PF_NOTTAXED,
        PLUS_PF_TAXED,
        PLUS_LI_NOTTAXED,
        PLUS_LI_TAXED,
        PLUS_HI_NOTTAXED,
        PLUS_HI_TAXED,
        PLUS_NP_TAXED,
        PLUS_NP_NOSAI,
        PLUS_NP_NOTTAXED,
        TOTAL_BEFORE_TAXES,
        ADJUSTED_AMOUNT,
        AMOUNT_BEFORE_SN,
        AMOUNT_BEFORE_SN_REVERSE,
        RATE_DNSN,
        RATE_DDSN,
        DNSN_AMOUNT,
        DDSN_AMOUNT,
        SN_AMOUNT,
        DNSN_AMOUNT_REVERSE,
        DDSN_AMOUNT_REVERSE,
        SN_MAX_AMOUNT,
        IIN_EXEMPT_UNTAXED_MINIMUM0,
        IIN_EXEMPT_DEPENDANTS0,
        IIN_EXEMPT_RETALIATION0,
        IIN_EXEMPT_INVALIDITY0,
        IIN_EXEMPT_NATIONAL_MOVEMENT0,
        IIN_EXEMPT_UNTAXED_MINIMUM,
        IIN_EXEMPT_DEPENDANTS,
        IIN_EXEMPT_RETALIATION,
        IIN_EXEMPT_INVALIDITY,
        IIN_EXEMPT_NATIONAL_MOVEMENT,
        IIN_EXEMPT_EXPENSES,
        IIN_EXEMPT_2TP,
        IIN_EXEMPT_20,
        IIN_EXEMPT_2,
        AMOUNT_BEFORE_IIN,
        AMOUNT_BEFORE_IIN_REVERSE,
        RATE_IIN,
        RATE_IIN2,
        IIN_AMOUNT,
        IIN_AMOUNT_REVERSE,
        URVN_AMAOUNT,
        PLUS_NOT_PAID,
        VACATION_ADVANCE_CURRENT,
        VACATION_ADVANCE_NEXT,
        VACATION_ADVANCE_PREV,
        ADVANCE,
        PAY0,
        PAY,
        PAYT,
        PAY_DATE,
        COMMENTS,
        WITHHOLD_FROM_PAY,
        FORAVPAYCALC_BRUTO,
        FORAVPAYCALC_PAYOUT,
        FORAVPAYCALC_DAYS,
        FORAVPAYCALC_HOURS,
        AVPAYCALC_CALDAY,
        AVPAYCALC_DAY,
        AVPAYCALC_HOUR,
        DT_EDITED,
        CALC_VER
    from salary_sheets_r
    where salary_sheets_r.id = :PID;


  suspend;
end
^

ALTER PROCEDURE SP_MAKE_SALARY_SHEET_R_HIST_2(
  PIDSX INTEGER,
  PDTCUR TIMESTAMP,
  PSKIP_INTERVAL FLOAT)
AS
declare variable V_LAST_DT TIMESTAMP;
    declare variable V_DIFF_DT FLOAT;
    declare variable V_ID INTEGER;
    declare variable V_IDH INTEGER;
    declare variable V_EQ INTEGER;
    declare variable V_CT INTEGER;
begin
    select count(salary_sheets_r.idsx)
    from salary_sheets_r
    where salary_sheets_r.idsx = :PIDSX
    into :V_CT;
    
    if(V_CT = 0) then exit;

    select max(salary_sheets_r_hist.dt_edited)
    from salary_sheets_r_hist
    where salary_sheets_r_hist.idsx = :PIDSX
    into :V_LAST_DT;

    if(V_LAST_DT is not null) then
    begin
        if(pdtcur < V_LAST_DT) then exit;
        V_DIFF_DT = pdtcur - V_LAST_DT;
        if(V_DIFF_DT < PSKIP_INTERVAL) then exit;
    end

    insert into salary_sheets_r_hist
    (
        IDH,
        ID,
        IDS,
        IDSX,
        IDST,
        IS_TEMP,
        TYPE_TAG,
        IDP,
        IDAM,
        SNR,
        FNAME,
        LNAME,
        POSITION_TITLE,
        TERRITORIAL_CODE,
        CALENDAR_DAYS,
        CALENDAR_DAYS_USE,
        MONTH_WORKDAYS,
        MONTH_WORKHOURS,
        PLAN_DAYS,
        PLAN_HOURS,
        PLAN_HOURS_NIGHT,
        PLAN_HOURS_OVERTIME,
        FACT_DAYS,
        FACT_HOURS,
        FACT_HOURS_NIGHT,
        FACT_HOURS_OVERTIME,
        PLAN_WORK_DAYS,
        PLAN_WORK_HOURS,
        PLAN_WORK_HOURS_NIGHT,
        PLAN_WORK_HOURS_OVERTIME,
        FACT_WORK_DAYS,
        FACT_WORK_HOURS,
        FACT_WORK_HOURS_NIGHT,
        FACT_WORK_HOURS_OVERTIME,
        PLAN_HOLIDAYS_DAYS,
        PLAN_HOLIDAYS_HOURS,
        PLAN_HOLIDAYS_HOURS_NIGHT,
        PLAN_HOLIDAYS_HOURS_OVERTIME,
        FACT_HOLIDAYS_DAYS,
        FACT_HOLIDAYS_HOURS,
        FACT_HOLIDAYS_HOURS_NIGHT,
        FACT_HOLIDAYS_HOURS_OVERTIME,
        SALARY,
        SALARY_DAY,
        SALARY_NIGHT,
        SALARY_OVERTIME,
        SALARY_HOLIDAYS_DAY,
        SALARY_HOLIDAYS_NIGHT,
        SALARY_HOLIDAYS_OVERTIME,
        SALARY_PAID_HOLIDAYS_DAY,
        SALARY_PAID_HOLIDAYS_NIGHT,
        SALARY_PIECEWORK,
        SICKDAYS,
        SICKDAYS_PAY,
        ACCIDENT_DAYS,
        ACCIDENT_PAY,
        AVERAGE_INCOME_DAYS,
        AVERAGE_INCOME_PAY,
        FACT_AVPAY_FREE_DAYS,
        FACT_AVPAY_FREE_HOURS,
        FACT_AVPAY_WORK_DAYS,
        FACT_AVPAY_WORKINHOLIDAYS,
        FACT_AVPAY_HOURS,
        FACT_AVPAY_HOURS_OVERTIME,
        FACT_AVPAY_HOLIDAYS_HOURS,
        FACT_AVPAY_HOLIDAYS_HOURS_OVERT,
        SALARY_AVPAY_FREE_DAYS,
        SALARY_AVPAY_WORK_DAYS,
        SALARY_AVPAY_WORK_DAYS_OVERTIME,
        SALARY_AVPAY_HOLIDAYS,
        SALARY_AVPAY_HOLIDAYS_OVERTIME,
        BUSINESS_TRIP_DAYS,
        BUSINESS_TRIP_PAY,
        PAID_HOLIDAYS,
        PAID_HOLIDAYS_PAY,
        VACATION_DAYS_CURRENT,
        VACATION_DAYS_NEXT,
        VACATION_HOURS_CURRENT,
        VACATION_HOURS_NEXT,
        VACATION_PAY_CURRENT,
        VACATION_PAY_NEXT,
        VACATION_DNS_NEXT,
        VACATION_DDS_NEXT,
        VACATION_IIN_NEXT,
        VACATION_IIN_REDUCE_NEXT,
        VACATION_CASH_NEXT,
        VACATION_PAY_PREV,
        VACATION_DNS_PREV,
        VACATION_DDS_PREV,
        VACATION_IIN_PREV,
        VACATION_DAYS_COMP,
        VACATION_PAY_COMP,
        PLUS_TAXED,
        PLUS_NOTTAXED,
        PLUS_NOSAI,
        PLUS_AUTHORS_FEES,
        MINUS_BEFORE_IIN,
        MINUS_AFTER_IIN,
        PLUS_PF_NOTTAXED,
        PLUS_PF_TAXED,
        PLUS_LI_NOTTAXED,
        PLUS_LI_TAXED,
        PLUS_HI_NOTTAXED,
        PLUS_HI_TAXED,
        PLUS_NP_TAXED,
        PLUS_NP_NOSAI,
        PLUS_NP_NOTTAXED,
        TOTAL_BEFORE_TAXES,
        ADJUSTED_AMOUNT,
        AMOUNT_BEFORE_SN,
        AMOUNT_BEFORE_SN_REVERSE,
        RATE_DNSN,
        RATE_DDSN,
        DNSN_AMOUNT,
        DDSN_AMOUNT,
        SN_AMOUNT,
        DNSN_AMOUNT_REVERSE,
        DDSN_AMOUNT_REVERSE,
        SN_MAX_AMOUNT,
        IIN_EXEMPT_UNTAXED_MINIMUM0,
        IIN_EXEMPT_DEPENDANTS0,
        IIN_EXEMPT_RETALIATION0,
        IIN_EXEMPT_INVALIDITY0,
        IIN_EXEMPT_NATIONAL_MOVEMENT0,
        IIN_EXEMPT_UNTAXED_MINIMUM,
        IIN_EXEMPT_DEPENDANTS,
        IIN_EXEMPT_RETALIATION,
        IIN_EXEMPT_INVALIDITY,
        IIN_EXEMPT_NATIONAL_MOVEMENT,
        IIN_EXEMPT_EXPENSES,
        IIN_EXEMPT_2TP,
        IIN_EXEMPT_20,
        IIN_EXEMPT_2,
        AMOUNT_BEFORE_IIN,
        AMOUNT_BEFORE_IIN_REVERSE,
        RATE_IIN,
        RATE_IIN2,
        IIN_AMOUNT,
        IIN_AMOUNT_REVERSE,
        URVN_AMAOUNT,
        PLUS_NOT_PAID,
        VACATION_ADVANCE_CURRENT,
        VACATION_ADVANCE_NEXT,
        VACATION_ADVANCE_PREV,
        ADVANCE,
        PAY0,
        PAY,
        PAYT,
        PAY_DATE,
        COMMENTS,
        WITHHOLD_FROM_PAY,
        FORAVPAYCALC_BRUTO,
        FORAVPAYCALC_PAYOUT,
        FORAVPAYCALC_DAYS,
        FORAVPAYCALC_HOURS,
        AVPAYCALC_CALDAY,
        AVPAYCALC_DAY,
        AVPAYCALC_HOUR,
        DT_EDITED,
        CALC_VER
    )
    select
        null, 
        ID,
        IDS,
        IDSX,
        IDST,
        IS_TEMP,
        TYPE_TAG,
        IDP,
        IDAM,
        SNR,
        FNAME,
        LNAME,
        POSITION_TITLE,
        TERRITORIAL_CODE,
        CALENDAR_DAYS,
        CALENDAR_DAYS_USE,
        MONTH_WORKDAYS,
        MONTH_WORKHOURS,
        PLAN_DAYS,
        PLAN_HOURS,
        PLAN_HOURS_NIGHT,
        PLAN_HOURS_OVERTIME,
        FACT_DAYS,
        FACT_HOURS,
        FACT_HOURS_NIGHT,
        FACT_HOURS_OVERTIME,
        PLAN_WORK_DAYS,
        PLAN_WORK_HOURS,
        PLAN_WORK_HOURS_NIGHT,
        PLAN_WORK_HOURS_OVERTIME,
        FACT_WORK_DAYS,
        FACT_WORK_HOURS,
        FACT_WORK_HOURS_NIGHT,
        FACT_WORK_HOURS_OVERTIME,
        PLAN_HOLIDAYS_DAYS,
        PLAN_HOLIDAYS_HOURS,
        PLAN_HOLIDAYS_HOURS_NIGHT,
        PLAN_HOLIDAYS_HOURS_OVERTIME,
        FACT_HOLIDAYS_DAYS,
        FACT_HOLIDAYS_HOURS,
        FACT_HOLIDAYS_HOURS_NIGHT,
        FACT_HOLIDAYS_HOURS_OVERTIME,
        SALARY,
        SALARY_DAY,
        SALARY_NIGHT,
        SALARY_OVERTIME,
        SALARY_HOLIDAYS_DAY,
        SALARY_HOLIDAYS_NIGHT,
        SALARY_HOLIDAYS_OVERTIME,
        SALARY_PAID_HOLIDAYS_DAY,
        SALARY_PAID_HOLIDAYS_NIGHT,
        SALARY_PIECEWORK,
        SICKDAYS,
        SICKDAYS_PAY,
        ACCIDENT_DAYS,
        ACCIDENT_PAY,
        AVERAGE_INCOME_DAYS,
        AVERAGE_INCOME_PAY,
        FACT_AVPAY_FREE_DAYS,
        FACT_AVPAY_FREE_HOURS,
        FACT_AVPAY_WORK_DAYS,
        FACT_AVPAY_WORKINHOLIDAYS,
        FACT_AVPAY_HOURS,
        FACT_AVPAY_HOURS_OVERTIME,
        FACT_AVPAY_HOLIDAYS_HOURS,
        FACT_AVPAY_HOLIDAYS_HOURS_OVERT,
        SALARY_AVPAY_FREE_DAYS,
        SALARY_AVPAY_WORK_DAYS,
        SALARY_AVPAY_WORK_DAYS_OVERTIME,
        SALARY_AVPAY_HOLIDAYS,
        SALARY_AVPAY_HOLIDAYS_OVERTIME,
        BUSINESS_TRIP_DAYS,
        BUSINESS_TRIP_PAY,
        PAID_HOLIDAYS,
        PAID_HOLIDAYS_PAY,
        VACATION_DAYS_CURRENT,
        VACATION_DAYS_NEXT,
        VACATION_HOURS_CURRENT,
        VACATION_HOURS_NEXT,
        VACATION_PAY_CURRENT,
        VACATION_PAY_NEXT,
        VACATION_DNS_NEXT,
        VACATION_DDS_NEXT,
        VACATION_IIN_NEXT,
        VACATION_IIN_REDUCE_NEXT,
        VACATION_CASH_NEXT,
        VACATION_PAY_PREV,
        VACATION_DNS_PREV,
        VACATION_DDS_PREV,
        VACATION_IIN_PREV,
        VACATION_DAYS_COMP,
        VACATION_PAY_COMP,
        PLUS_TAXED,
        PLUS_NOTTAXED,
        PLUS_NOSAI,
        PLUS_AUTHORS_FEES,
        MINUS_BEFORE_IIN,
        MINUS_AFTER_IIN,
        PLUS_PF_NOTTAXED,
        PLUS_PF_TAXED,
        PLUS_LI_NOTTAXED,
        PLUS_LI_TAXED,
        PLUS_HI_NOTTAXED,
        PLUS_HI_TAXED,
        PLUS_NP_TAXED,
        PLUS_NP_NOSAI,
        PLUS_NP_NOTTAXED,
        TOTAL_BEFORE_TAXES,
        ADJUSTED_AMOUNT,
        AMOUNT_BEFORE_SN,
        AMOUNT_BEFORE_SN_REVERSE,
        RATE_DNSN,
        RATE_DDSN,
        DNSN_AMOUNT,
        DDSN_AMOUNT,
        SN_AMOUNT,
        DNSN_AMOUNT_REVERSE,
        DDSN_AMOUNT_REVERSE,
        SN_MAX_AMOUNT,
        IIN_EXEMPT_UNTAXED_MINIMUM0,
        IIN_EXEMPT_DEPENDANTS0,
        IIN_EXEMPT_RETALIATION0,
        IIN_EXEMPT_INVALIDITY0,
        IIN_EXEMPT_NATIONAL_MOVEMENT0,
        IIN_EXEMPT_UNTAXED_MINIMUM,
        IIN_EXEMPT_DEPENDANTS,
        IIN_EXEMPT_RETALIATION,
        IIN_EXEMPT_INVALIDITY,
        IIN_EXEMPT_NATIONAL_MOVEMENT,
        IIN_EXEMPT_EXPENSES,
        IIN_EXEMPT_2TP,
        IIN_EXEMPT_20,
        IIN_EXEMPT_2,
        AMOUNT_BEFORE_IIN,
        AMOUNT_BEFORE_IIN_REVERSE,
        RATE_IIN,
        RATE_IIN2,
        IIN_AMOUNT,
        IIN_AMOUNT_REVERSE,
        URVN_AMAOUNT,
        PLUS_NOT_PAID,
        VACATION_ADVANCE_CURRENT,
        VACATION_ADVANCE_NEXT,
        VACATION_ADVANCE_PREV,
        ADVANCE,
        PAY0,
        PAY,
        PAYT,
        PAY_DATE,
        COMMENTS,
        WITHHOLD_FROM_PAY,
        FORAVPAYCALC_BRUTO,
        FORAVPAYCALC_PAYOUT,
        FORAVPAYCALC_DAYS,
        FORAVPAYCALC_HOURS,
        AVPAYCALC_CALDAY,
        AVPAYCALC_DAY,
        AVPAYCALC_HOUR,
        DT_EDITED,
        CALC_VER
    from salary_sheets_r
    where salary_sheets_r.idsx = :PIDSX;


  suspend;
end
^

ALTER PROCEDURE SP_REP_AGGREGATE_01(
  PDT1 DATE,
  PDT2 DATE,
  PIDP INTEGER,
  PIDAM INTEGER,
  PRETYRMT INTEGER,
  PRETIDP INTEGER,
  PRETIDAM INTEGER)
RETURNS (
  IDP TYPE OF COLUMN SALARY_SHEETS_R.IDP,
  IDAM TYPE OF COLUMN SALARY_SHEETS_R.IDAM,
  IDDEP TYPE OF COLUMN DEPARTMENTS.ID /* COLLATE UTF8 - default */,
  YR TYPE OF COLUMN SALARY_SHEETS.YR,
  MT TYPE OF COLUMN SALARY_SHEETS.MT,
  WORKHOURS TYPE OF COLUMN SALARY_SHEETS_R.FACT_HOURS,
  WORKDAYS TYPE OF COLUMN SALARY_SHEETS_R.FACT_DAYS,
  FREEAVPAYDAYS TYPE OF COLUMN SALARY_SHEETS_R.FACT_DAYS,
  VACATIONDAYS TYPE OF COLUMN SALARY_SHEETS_R.VACATION_DAYS_CURRENT,
  VACATIONDAYSCOMP TYPE OF COLUMN SALARY_SHEETS_R.VACATION_DAYS_COMP,
  SICKDAYS TYPE OF COLUMN SALARY_SHEETS_R.FACT_DAYS,
  WORKPAY TYPE OF COLUMN SALARY_SHEETS_R.SALARY,
  SICKPAY TYPE OF COLUMN SALARY_SHEETS_R.SALARY,
  VACATIONPAY TYPE OF COLUMN SALARY_SHEETS_R.SALARY,
  VACATIONPAYCOMP TYPE OF COLUMN SALARY_SHEETS_R.VACATION_PAY_COMP,
  FREEAVPAY TYPE OF COLUMN SALARY_SHEETS_R.SALARY,
  WORKAVPAY TYPE OF COLUMN SALARY_SHEETS_R.SALARY,
  PLUS_TAXED TYPE OF COLUMN SALARY_SHEETS_R.PLUS_TAXED,
  PLUS_NOTTAXED TYPE OF COLUMN SALARY_SHEETS_R.PLUS_NOTTAXED,
  PLUS_AUTHORS_FEES TYPE OF COLUMN SALARY_SHEETS_R.PLUS_AUTHORS_FEES,
  PLUS_NOSAI TYPE OF COLUMN SALARY_SHEETS_R.PLUS_NOSAI,
  TOTALPAY TYPE OF COLUMN SALARY_SHEETS_R.SALARY,
  FORSAI TYPE OF COLUMN SALARY_SHEETS_R.AMOUNT_BEFORE_SN,
  DNSN_AMOUNT TYPE OF COLUMN SALARY_SHEETS_R.DNSN_AMOUNT,
  DDSN_AMOUNT TYPE OF COLUMN SALARY_SHEETS_R.DDSN_AMOUNT,
  UNTAXED_MINIMUM TYPE OF COLUMN SALARY_SHEETS_R.IIN_EXEMPT_UNTAXED_MINIMUM,
  IIN_EXEMPT_DEPENDANTS TYPE OF COLUMN SALARY_SHEETS_R.IIN_EXEMPT_DEPENDANTS,
  IIN_EXEMPT_INVALIDITY TYPE OF COLUMN SALARY_SHEETS_R.IIN_EXEMPT_INVALIDITY,
  IIN_EXEMPT_NATIONAL_MOVEMENT TYPE OF COLUMN SALARY_SHEETS_R.IIN_EXEMPT_NATIONAL_MOVEMENT,
  IIN_EXEMPT_RETALIATION TYPE OF COLUMN SALARY_SHEETS_R.IIN_EXEMPT_RETALIATION,
  IIN_EXEMPT_EXPENSES TYPE OF COLUMN SALARY_SHEETS_R.IIN_EXEMPT_EXPENSES,
  PLUS_PF_NOTTAXED TYPE OF COLUMN SALARY_SHEETS_R.PLUS_PF_NOTTAXED,
  PLUS_LI_NOTTAXED TYPE OF COLUMN SALARY_SHEETS_R.PLUS_LI_NOTTAXED,
  PLUS_HI_NOTTAXED TYPE OF COLUMN SALARY_SHEETS_R.PLUS_HI_NOTTAXED,
  IIN_AMOUNT TYPE OF COLUMN SALARY_SHEETS_R.IIN_AMOUNT,
  MINUS_BEFORE_IIN TYPE OF COLUMN SALARY_SHEETS_R.MINUS_BEFORE_IIN,
  MINUS_AFTER_IIN TYPE OF COLUMN SALARY_SHEETS_R.MINUS_AFTER_IIN,
  PAY TYPE OF COLUMN SALARY_SHEETS_R.PAY,
  ADVANCE TYPE OF COLUMN SALARY_SHEETS_R.ADVANCE,
  PAYT TYPE OF COLUMN SALARY_SHEETS_R.PAYT,
  PAID TYPE OF COLUMN PAYLISTS_R.TPAY)
AS
begin
    for select
        ridp,
        ridam,
        null as iddep,

        ryr,
        rmt,

        sum(rworkhours) as tworkhours,
        sum(rworkdays) as tworkdays,

        sum(rfreeavpaydays) as tfreeavpaydays,
        sum(rvacationdays) as tvacationdays,
        sum(rvacationdayscomp) as tvacationdayscomp,
        sum(rsickdays) as tsickdays,

        sum(rworkpay) as tworkpay,
        sum(rsickpay) as tsickpay,
        sum(rvacationpay) as tvacationpay,
        sum(rvacationpaycomp) as tvacationpaycomp,
        sum(rfreeavpay) as tfreeavpay,
        sum(rworkavpay) as tworkavpay,

        sum(rplus_taxed) as tplus_taxed,
        sum(rplus_nottaxed) as tplus_nottaxed,
        sum(rplus_authors_fees) as tplus_authors_fees,
        sum(rplus_nosai) as tplus_nosai,

        sum(rtotalpay) as ttotalpay,

        sum(rforsai) as tforsai,

        sum(rdnsn_amount) as tdnsn_amount,
        sum(rddsn_amount) as tddsn_amount,

        sum(runtaxed_minimum) as tuntaxed_minimum,
        sum(riin_exempt_dependants) as tiin_exempt_dependants,
        sum(riin_exempt_invalidity) as tiin_exempt_invalidity,
        sum(riin_exempt_national_movement) as tiin_exempt_national_movement,
        sum(riin_exempt_retaliation) as tiin_exempt_retaliation,
        sum(riin_exempt_expenses) as tiin_exempt_expenses,

        sum(rplus_pf_nottaxed) as tplus_pf_nottaxed,
        sum(rplus_li_nottaxed) as tplus_li_nottaxed,
        sum(rplus_hi_nottaxed) as tplus_hi_nottaxed,

        sum(riin_amount) as tiin_amount,

        sum(rminus_before_iin) as tminus_before_iin,
        sum(rminus_after_iin) as tminus_after_iin,

        sum(rpay) as tpay,
        sum(radvance) as tadvance,
        sum(rpayt) as tpayt,
        sum(rpaid) as tpaid
    from
    (

        select
            iif(:pretidp = 0, null, salary_sheets_R.idp) as ridp,
            iif(:pretidam = 0, null, salary_sheets_R.idam) as ridam,

            iif(:pretyrmt = 0, null, salary_sheets.yr) as ryr,
            iif(:pretyrmt = 0, null, salary_sheets.mt) as rmt,

            salary_sheets_R.fact_hours as rworkhours,
            salary_sheets_R.fact_days as rworkdays,

            salary_sheets_R.fact_avpay_free_days as rfreeavpaydays,
            salary_sheets_R.vacation_days_current as rvacationdays,
            salary_sheets_R.vacation_days_comp as rvacationdayscomp,
            salary_sheets_R.sickdays as rsickdays,

            salary_sheets_R.salary as rworkpay,
            salary_sheets_R.sickdays_pay as rsickpay,
            salary_sheets_R.vacation_pay_current as rvacationpay,
            salary_sheets_R.vacation_pay_comp as rvacationpaycomp,
            salary_sheets_R.salary_avpay_free_days as rfreeavpay,

            salary_sheets_R.salary_avpay_work_days +
                salary_sheets_R.salary_avpay_work_days_overtime +
                salary_sheets_R.salary_avpay_holidays +
                salary_sheets_R.salary_avpay_holidays_overtime as rworkavpay,

            salary_sheets_r.plus_taxed +
                salary_sheets_r.plus_pf_taxed +
                salary_sheets_r.plus_li_taxed +
                salary_sheets_r.plus_hi_taxed as rplus_taxed,

            salary_sheets_r.plus_nottaxed +
                salary_sheets_r.plus_pf_nottaxed +
                salary_sheets_r.plus_li_nottaxed +
                salary_sheets_r.plus_hi_nottaxed as rplus_nottaxed,

            salary_sheets_r.plus_authors_fees as rplus_authors_fees,
            salary_sheets_r.plus_nosai as rplus_nosai,

            salary_sheets_R.total_before_taxes as rtotalpay,

            salary_sheets_R.amount_before_sn as rforsai,

            salary_sheets_r.dnsn_amount as rdnsn_amount,
            salary_sheets_r.ddsn_amount as rddsn_amount,

            salary_sheets_r.iin_exempt_untaxed_minimum as runtaxed_minimum,
            salary_sheets_r.iin_exempt_dependants as riin_exempt_dependants,
            salary_sheets_r.iin_exempt_invalidity as riin_exempt_invalidity,
            salary_sheets_r.iin_exempt_national_movement as riin_exempt_national_movement,
            salary_sheets_r.iin_exempt_retaliation as riin_exempt_retaliation,
            salary_sheets_r.iin_exempt_expenses as riin_exempt_expenses,

            salary_sheets_r.plus_pf_nottaxed as rplus_pf_nottaxed,
            salary_sheets_r.plus_li_nottaxed as rplus_li_nottaxed,
            salary_sheets_r.plus_hi_nottaxed as rplus_hi_nottaxed,

            salary_sheets_r.iin_amount as riin_amount,

            salary_sheets_r.minus_before_iin as rminus_before_iin,
            salary_sheets_r.minus_after_iin as rminus_after_iin,

            salary_sheets_r.pay as rpay,
            salary_sheets_r.advance as radvance,
            salary_sheets_r.payt as rpayt,
            0.0 as rpaid
    
        from salary_sheets
        inner join salary_sheets_r on salary_sheets.id = salary_sheets_r.ids

        where
            (salary_sheets.dt2 between :pdt1 and :pdt2) AND
            ((:pidp is null) OR (salary_sheets_r.idp = :pidp)) AND
            ((:pidam is null) OR (salary_sheets_r.idam = :pidam)) AND
            (salary_sheets.is_temp = 0) AND
            (salary_sheets.kind = 0)

        union all

        select
            iif(:pretidp = 0, null, paylists_R.idp) as ridp,
            iif(:pretidam = 0, null, paylists_R.idam) as ridam,

            iif(:pretyrmt = 0, null, paylists.yr) as ryr,
            iif(:pretyrmt = 0, null, paylists.mt) as rmt,

            0 as rworkhours,
            0 as rworkdays,

            0 as rfreeavpaydays,
            0 as rvacationdays,
            0 as rvacationdayscomp,
            0 as sickdays,

            0.0 as rworkpay,
            0.0 as rsickpay,
            0.0 as rvacationpay,
            0.0 as rvacationpaycomp,
            0.0 as rfreeavpay,
            0.0 as rworkavpay,

            0.0 as rplus_taxed,

            0.0 as rplus_nottaxed,

            0.0 as rplus_authors_fees,
            0.0 as rplus_nosai,

            0.0 as rtotalpay,

            0.0 as rforsai,

            0.0 as rdnsn_amount,
            0.0 as rddsn_amount,

            0.0 as runtaxed_minimum,
            0.0 as riin_exempt_dependants,
            0.0 as riin_exempt_invalidity,
            0.0 as riin_exempt_national_movement,
            0.0 as riin_exempt_retaliation,
            0.0 as riin_exempt_expenses,

            0.0 as rplus_pf_nottaxed,
            0.0 as rplus_li_nottaxed,
            0.0 as rplus_hi_nottaxed,

            0.0 as riin_amount,

            0.0 as rminus_before_iin,
            0.0 as rminus_after_iin,

            0.0 as rpay,
            0.0 as radvance,
            0.0 as rpayt,
            paylists_r.tpay as rpaid
    
        from paylists
        inner join paylists_r on paylists.id = paylists_r.ids

        where
            (paylists.dt between :pdt1 and :pdt2) AND
            ((:pidp is null) OR (paylists_r.idp = :pidp)) AND
            ((:pidam is null) OR (paylists_r.idam = :pidam))

    )
    group by ridp, ridam, ryr, rmt
    order by ryr, rmt

    into
        :idp,
        :idam,
        :iddep,

        :yr,
        :mt, 

        :workhours,
        :workdays,

        :freeavpaydays,
        :vacationdays,
        :vacationdayscomp,
        :sickdays,

        :workpay,
        :sickpay, 
        :vacationpay, 
        :vacationpaycomp,
        :freeavpay,
        :workavpay,

        :plus_taxed,
        :plus_nottaxed,
        :plus_authors_fees,
        :plus_nosai,

        :totalpay,

        :forsai,

        :dnsn_amount,
        :ddsn_amount,

        :untaxed_minimum,
        :iin_exempt_dependants,
        :iin_exempt_invalidity,
        :iin_exempt_national_movement,
        :iin_exempt_retaliation,
        :iin_exempt_expenses,

        :plus_pf_nottaxed,
        :plus_li_nottaxed,
        :plus_hi_nottaxed,

        :iin_amount,

        :minus_before_iin,
        :minus_after_iin,

        :pay,
        :advance,
        :payt,

        :paid
  do
  begin
    suspend;
  end
end
^

ALTER PROCEDURE SP_REP_AGGREGATE_02(
  PDT1 DATE,
  PDT2 DATE,
  PIDDEP TYPE OF COLUMN DEPARTMENTS.ID /* COLLATE UTF8 - default */,
  PRETYRMT INTEGER,
  PRETIDP INTEGER,
  PRETIDAM INTEGER,
  PRETIDDEP INTEGER)
RETURNS (
  IDP TYPE OF COLUMN SALARY_SHEETS_R.IDP,
  IDAM TYPE OF COLUMN SALARY_SHEETS_R.IDAM,
  IDDEP TYPE OF COLUMN DEPARTMENTS.ID /* COLLATE UTF8 - default */,
  YR TYPE OF COLUMN SALARY_SHEETS.YR,
  MT TYPE OF COLUMN SALARY_SHEETS.MT,
  WORKHOURS TYPE OF COLUMN SALARY_SHEETS_R.FACT_HOURS,
  WORKDAYS TYPE OF COLUMN SALARY_SHEETS_R.FACT_DAYS,
  FREEAVPAYDAYS TYPE OF COLUMN SALARY_SHEETS_R.FACT_DAYS,
  VACATIONDAYS TYPE OF COLUMN SALARY_SHEETS_R.VACATION_DAYS_CURRENT,
  VACATIONDAYSCOMP TYPE OF COLUMN SALARY_SHEETS_R.VACATION_DAYS_COMP,
  SICKDAYS TYPE OF COLUMN SALARY_SHEETS_R.FACT_DAYS,
  WORKPAY TYPE OF COLUMN SALARY_SHEETS_R.SALARY,
  SICKPAY TYPE OF COLUMN SALARY_SHEETS_R.SALARY,
  VACATIONPAY TYPE OF COLUMN SALARY_SHEETS_R.SALARY,
  VACATIONPAYCOMP TYPE OF COLUMN SALARY_SHEETS_R.VACATION_PAY_COMP,
  FREEAVPAY TYPE OF COLUMN SALARY_SHEETS_R.SALARY,
  WORKAVPAY TYPE OF COLUMN SALARY_SHEETS_R.SALARY,
  PLUS_TAXED TYPE OF COLUMN SALARY_SHEETS_R.PLUS_TAXED,
  PLUS_NOTTAXED TYPE OF COLUMN SALARY_SHEETS_R.PLUS_NOTTAXED,
  PLUS_AUTHORS_FEES TYPE OF COLUMN SALARY_SHEETS_R.PLUS_AUTHORS_FEES,
  PLUS_NOSAI TYPE OF COLUMN SALARY_SHEETS_R.PLUS_NOSAI,
  TOTALPAY TYPE OF COLUMN SALARY_SHEETS_R.SALARY,
  FORSAI TYPE OF COLUMN SALARY_SHEETS_R.AMOUNT_BEFORE_SN,
  DNSN_AMOUNT TYPE OF COLUMN SALARY_SHEETS_R.DNSN_AMOUNT,
  DDSN_AMOUNT TYPE OF COLUMN SALARY_SHEETS_R.DDSN_AMOUNT,
  UNTAXED_MINIMUM TYPE OF COLUMN SALARY_SHEETS_R.IIN_EXEMPT_UNTAXED_MINIMUM,
  IIN_EXEMPT_DEPENDANTS TYPE OF COLUMN SALARY_SHEETS_R.IIN_EXEMPT_DEPENDANTS,
  IIN_EXEMPT_INVALIDITY TYPE OF COLUMN SALARY_SHEETS_R.IIN_EXEMPT_INVALIDITY,
  IIN_EXEMPT_NATIONAL_MOVEMENT TYPE OF COLUMN SALARY_SHEETS_R.IIN_EXEMPT_NATIONAL_MOVEMENT,
  IIN_EXEMPT_RETALIATION TYPE OF COLUMN SALARY_SHEETS_R.IIN_EXEMPT_RETALIATION,
  IIN_EXEMPT_EXPENSES TYPE OF COLUMN SALARY_SHEETS_R.IIN_EXEMPT_EXPENSES,
  PLUS_PF_NOTTAXED TYPE OF COLUMN SALARY_SHEETS_R.PLUS_PF_NOTTAXED,
  PLUS_LI_NOTTAXED TYPE OF COLUMN SALARY_SHEETS_R.PLUS_LI_NOTTAXED,
  PLUS_HI_NOTTAXED TYPE OF COLUMN SALARY_SHEETS_R.PLUS_HI_NOTTAXED,
  IIN_AMOUNT TYPE OF COLUMN SALARY_SHEETS_R.IIN_AMOUNT,
  MINUS_BEFORE_IIN TYPE OF COLUMN SALARY_SHEETS_R.MINUS_BEFORE_IIN,
  MINUS_AFTER_IIN TYPE OF COLUMN SALARY_SHEETS_R.MINUS_AFTER_IIN,
  PAY TYPE OF COLUMN SALARY_SHEETS_R.PAY,
  ADVANCE TYPE OF COLUMN SALARY_SHEETS_R.ADVANCE,
  PAYT TYPE OF COLUMN SALARY_SHEETS_R.PAYT,
  PAID TYPE OF COLUMN PAYLISTS_R.TPAY)
AS
begin
    for select
        ridp,
        ridam,
        riddep,

        ryr,
        rmt,

        sum(rworkhours) as tworkhours,
        sum(rworkdays) as tworkdays,

        sum(rfreeavpaydays) as tfreeavpaydays,
        sum(rvacationdays) as tvacationdays,
        sum(rvacationdayscomp) as tvacationdayscomp,
        sum(rsickdays) as tsickdays,

        sum(rworkpay) as tworkpay,
        sum(rsickpay) as tsickpay,
        sum(rvacationpay) as tvacationpay,
        sum(rvacationpaycomp) as tvacationpaycomp,
        sum(rfreeavpay) as tfreeavpay,
        sum(rworkavpay) as tworkavpay,

        sum(rplus_taxed) as tplus_taxed,
        sum(rplus_nottaxed) as tplus_nottaxed,
        sum(rplus_authors_fees) as tplus_authors_fees,
        sum(rplus_nosai) as tplus_nosai,

        sum(rtotalpay) as ttotalpay,

        sum(rforsai) as tforsai,

        sum(rdnsn_amount) as tdnsn_amount,
        sum(rddsn_amount) as tddsn_amount,

        sum(runtaxed_minimum) as tuntaxed_minimum,
        sum(riin_exempt_dependants) as tiin_exempt_dependants,
        sum(riin_exempt_invalidity) as tiin_exempt_invalidity,
        sum(riin_exempt_national_movement) as tiin_exempt_national_movement,
        sum(riin_exempt_retaliation) as tiin_exempt_retaliation,
        sum(riin_exempt_expenses) as tiin_exempt_expenses,

        sum(rplus_pf_nottaxed) as tplus_pf_nottaxed,
        sum(rplus_li_nottaxed) as tplus_li_nottaxed,
        sum(rplus_hi_nottaxed) as tplus_hi_nottaxed,

        sum(riin_amount) as tiin_amount,

        sum(rminus_before_iin) as tminus_before_iin,
        sum(rminus_after_iin) as tminus_after_iin,

        sum(rpay) as tpay,
        sum(radvance) as tadvance,
        sum(rpayt) as tpayt,

        sum(rpaid) as tpaid
    from
    (

        select
            iif(:pretidp = 0, null, salary_sheets_R.idp) as ridp,
            iif(:pretidam = 0, null, salary_sheets_R.idam) as ridam,
            iif(:pretiddep = 0, null, TPOS2.iddep) as riddep,

            iif(:pretyrmt = 0, null, salary_sheets.yr) as ryr,
            iif(:pretyrmt = 0, null, salary_sheets.mt) as rmt,

            salary_sheets_R.fact_hours as rworkhours,
            salary_sheets_R.fact_days as rworkdays,

            salary_sheets_R.fact_avpay_free_days as rfreeavpaydays,
            salary_sheets_R.vacation_days_current as rvacationdays,
            salary_sheets_R.vacation_days_comp as rvacationdayscomp,
            salary_sheets_R.sickdays as rsickdays,

            salary_sheets_R.salary as rworkpay,
            salary_sheets_R.sickdays_pay as rsickpay,
            salary_sheets_R.vacation_pay_current as rvacationpay,
            salary_sheets_R.vacation_pay_comp as rvacationpaycomp,
            salary_sheets_R.salary_avpay_free_days as rfreeavpay,

            salary_sheets_R.salary_avpay_work_days +
                salary_sheets_R.salary_avpay_work_days_overtime +
                salary_sheets_R.salary_avpay_holidays +
                salary_sheets_R.salary_avpay_holidays_overtime as rworkavpay,

            salary_sheets_r.plus_taxed +
                salary_sheets_r.plus_pf_taxed +
                salary_sheets_r.plus_li_taxed +
                salary_sheets_r.plus_hi_taxed as rplus_taxed,

            salary_sheets_r.plus_nottaxed +
                salary_sheets_r.plus_pf_nottaxed +
                salary_sheets_r.plus_li_nottaxed +
                salary_sheets_r.plus_hi_nottaxed as rplus_nottaxed,

            salary_sheets_r.plus_authors_fees as rplus_authors_fees,
            salary_sheets_r.plus_nosai as rplus_nosai,

            salary_sheets_R.total_before_taxes as rtotalpay,

            salary_sheets_R.amount_before_sn as rforsai,

            salary_sheets_r.dnsn_amount as rdnsn_amount,
            salary_sheets_r.ddsn_amount as rddsn_amount,

            salary_sheets_r.iin_exempt_untaxed_minimum as runtaxed_minimum,
            salary_sheets_r.iin_exempt_dependants as riin_exempt_dependants,
            salary_sheets_r.iin_exempt_invalidity as riin_exempt_invalidity,
            salary_sheets_r.iin_exempt_national_movement as riin_exempt_national_movement,
            salary_sheets_r.iin_exempt_retaliation as riin_exempt_retaliation,
            salary_sheets_r.iin_exempt_expenses as riin_exempt_expenses,

            salary_sheets_r.plus_pf_nottaxed as rplus_pf_nottaxed,
            salary_sheets_r.plus_li_nottaxed as rplus_li_nottaxed,
            salary_sheets_r.plus_hi_nottaxed as rplus_hi_nottaxed,

            salary_sheets_r.iin_amount as riin_amount,

            salary_sheets_r.minus_before_iin as rminus_before_iin,
            salary_sheets_r.minus_after_iin as rminus_after_iin,

            salary_sheets_r.pay as rpay,
            salary_sheets_r.advance as radvance,
            salary_sheets_r.payt as rpayt,
            0.0 as rpaid
    
        from salary_sheets
        inner join salary_sheets_r on salary_sheets.id = salary_sheets_r.ids

        inner join
        (
            select TPOS1.id, TPOS1.idam, positions_r.iddep
            from positions_r
            inner join 
            (
                select salary_sheets_r.id, salary_sheets_r.idam, max(positions_r.edit_date) as posdt
                from salary_sheets
                inner join salary_sheets_r
                    on salary_sheets.id = salary_sheets_r.ids AND
                        (salary_sheets.dt2 between :pdt1 and :pdt2)
                inner join positions_r
                    on salary_sheets_r.idam = positions_r.ida AND
                        positions_r.edit_date <= salary_sheets.dt2
                group by salary_sheets_r.id, salary_sheets_r.idam
            ) as TPOS1
            on positions_r.ida = TPOS1.idam
        ) as TPOS2
        on salary_sheets_r.id = TPOS2.id

        where
            (salary_sheets.dt2 between :pdt1 and :pdt2) AND
            ((:piddep is null) or (TPOS2.iddep = :piddep)) AND
            (salary_sheets.is_temp = 0) AND
            (salary_sheets.kind = 0)


        union all


        select
            iif(:pretidp = 0, null, paylists_R.idp) as ridp,
            iif(:pretidam = 0, null, paylists_R.idam) as ridam,
            iif(:pretiddep = 0, null, TPOS2.iddep) as riddep,

            iif(:pretyrmt = 0, null, paylists.yr) as ryr,
            iif(:pretyrmt = 0, null, paylists.mt) as rmt,

            0 as rworkhours,
            0 as rworkdays,

            0 as rfreeavpaydays,
            0 as rvacationdays,
            0 as rvacationdayscomp,
            0 as sickdays,

            0.0 as rworkpay,
            0.0 as rsickpay,
            0.0 as rvacationpay,
            0.0 as rvacationpaycomp,
            0.0 as rfreeavpay,
            0.0 as rworkavpay,

            0.0 as rplus_taxed,

            0.0 as rplus_nottaxed,

            0.0 as rplus_authors_fees,
            0.0 as rplus_nosai,

            0.0 as rtotalpay,

            0.0 as rforsai,

            0.0 as rdnsn_amount,
            0.0 as rddsn_amount,

            0.0 as runtaxed_minimum,
            0.0 as riin_exempt_dependants,
            0.0 as riin_exempt_invalidity,
            0.0 as riin_exempt_national_movement,
            0.0 as riin_exempt_retaliation,
            0.0 as riin_exempt_expenses,

            0.0 as rplus_pf_nottaxed,
            0.0 as rplus_li_nottaxed,
            0.0 as rplus_hi_nottaxed,

            0.0 as riin_amount,

            0.0 as rminus_before_iin,
            0.0 as rminus_after_iin,

            0.0 as rpay,
            0.0 as radvance,
            0.0 as rpayt,
            paylists_r.tpay as rpaid
    
        from paylists
        inner join paylists_r on paylists.id = paylists_r.ids

        inner join
        (
            select TPOS1.id, TPOS1.idam, positions_r.iddep
            from positions_r
            inner join 
            (
                select paylists_r.id, paylists_r.idam, max(positions_r.edit_date) as posdt
                from paylists
                inner join paylists_r
                    on paylists.id = paylists_r.ids AND
                        (paylists.dt between :pdt1 and :pdt2)
                inner join positions_r
                    on paylists_r.idam = positions_r.ida AND
                        positions_r.edit_date <= paylists.dt
                group by paylists_r.id, paylists_r.idam
            ) as TPOS1
            on positions_r.ida = TPOS1.idam
        ) as TPOS2
        on paylists_r.id = TPOS2.id

        where
            (paylists.dt between :pdt1 and :pdt2) AND
            ((:piddep is null) or (TPOS2.iddep = :piddep))


    )
    group by ridp, ridam, riddep, ryr, rmt
    order by ryr, rmt

    into
        :idp,
        :idam,
        :iddep,
        :yr,
        :mt, 

        :workhours,
        :workdays,

        :freeavpaydays,
        :vacationdays,
        :vacationdayscomp,
        :sickdays,

        :workpay,
        :sickpay, 
        :vacationpay, 
        :vacationpaycomp,
        :freeavpay,
        :workavpay,

        :plus_taxed,
        :plus_nottaxed,
        :plus_authors_fees,
        :plus_nosai,

        :totalpay,

        :forsai,

        :dnsn_amount,
        :ddsn_amount,

        :untaxed_minimum,
        :iin_exempt_dependants,
        :iin_exempt_invalidity,
        :iin_exempt_national_movement,
        :iin_exempt_retaliation,
        :iin_exempt_expenses,

        :plus_pf_nottaxed,
        :plus_li_nottaxed,
        :plus_hi_nottaxed,

        :iin_amount,

        :minus_before_iin,
        :minus_after_iin,

        :pay,
        :advance,
        :payt,

        :paid
  do
  begin
    suspend;
  end
end
^

ALTER PROCEDURE SP_SALARY_SHEETS_R_HIST_01(
  PID INTEGER)
RETURNS (
  IDH TYPE OF COLUMN SALARY_SHEETS_R_HIST.ID,
  ID TYPE OF COLUMN SALARY_SHEETS_R_HIST.ID,
  IDS TYPE OF COLUMN SALARY_SHEETS_R_HIST.IDS,
  IDSX TYPE OF COLUMN SALARY_SHEETS_R_HIST.IDSX,
  IDST TYPE OF COLUMN SALARY_SHEETS_R_HIST.IDST,
  IS_TEMP TYPE OF COLUMN SALARY_SHEETS_R_HIST.IS_TEMP,
  TYPE_TAG TYPE OF COLUMN SALARY_SHEETS_R_HIST.TYPE_TAG,
  IDP TYPE OF COLUMN SALARY_SHEETS_R_HIST.IDP,
  IDAM TYPE OF COLUMN SALARY_SHEETS_R_HIST.IDAM,
  SNR TYPE OF COLUMN SALARY_SHEETS_R_HIST.SNR,
  FNAME TYPE OF COLUMN SALARY_SHEETS_R_HIST.FNAME /* COLLATE UTF8 - default */,
  LNAME TYPE OF COLUMN SALARY_SHEETS_R_HIST.LNAME /* COLLATE UTF8 - default */,
  POSITION_TITLE TYPE OF COLUMN SALARY_SHEETS_R_HIST.POSITION_TITLE /* COLLATE UTF8 - default */,
  TERRITORIAL_CODE TYPE OF COLUMN SALARY_SHEETS_R_HIST.TERRITORIAL_CODE /* COLLATE UTF8 - default */,
  CALENDAR_DAYS TYPE OF COLUMN SALARY_SHEETS_R_HIST.CALENDAR_DAYS,
  CALENDAR_DAYS_USE TYPE OF COLUMN SALARY_SHEETS_R_HIST.CALENDAR_DAYS_USE,
  MONTH_WORKDAYS TYPE OF COLUMN SALARY_SHEETS_R_HIST.MONTH_WORKDAYS,
  MONTH_WORKHOURS TYPE OF COLUMN SALARY_SHEETS_R_HIST.MONTH_WORKHOURS,
  PLAN_DAYS TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLAN_DAYS,
  PLAN_HOURS TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLAN_HOURS,
  PLAN_HOURS_NIGHT TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLAN_HOURS_NIGHT,
  PLAN_HOURS_OVERTIME TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLAN_HOURS_OVERTIME,
  FACT_DAYS TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_DAYS,
  FACT_HOURS TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_HOURS,
  FACT_HOURS_NIGHT TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_HOURS_NIGHT,
  FACT_HOURS_OVERTIME TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_HOURS_OVERTIME,
  PLAN_WORK_DAYS TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLAN_WORK_DAYS,
  PLAN_WORK_HOURS TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLAN_WORK_HOURS,
  PLAN_WORK_HOURS_NIGHT TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLAN_WORK_HOURS_NIGHT,
  PLAN_WORK_HOURS_OVERTIME TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLAN_WORK_HOURS_OVERTIME,
  FACT_WORK_DAYS TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_WORK_DAYS,
  FACT_WORK_HOURS TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_WORK_HOURS,
  FACT_WORK_HOURS_NIGHT TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_WORK_HOURS_NIGHT,
  FACT_WORK_HOURS_OVERTIME TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_WORK_HOURS_OVERTIME,
  PLAN_HOLIDAYS_DAYS TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLAN_HOLIDAYS_DAYS,
  PLAN_HOLIDAYS_HOURS TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLAN_HOLIDAYS_HOURS,
  PLAN_HOLIDAYS_HOURS_NIGHT TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLAN_HOLIDAYS_HOURS_NIGHT,
  PLAN_HOLIDAYS_HOURS_OVERTIME TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLAN_HOLIDAYS_HOURS_OVERTIME,
  FACT_HOLIDAYS_DAYS TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_HOLIDAYS_DAYS,
  FACT_HOLIDAYS_HOURS TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_HOLIDAYS_HOURS,
  FACT_HOLIDAYS_HOURS_NIGHT TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_HOLIDAYS_HOURS_NIGHT,
  FACT_HOLIDAYS_HOURS_OVERTIME TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_HOLIDAYS_HOURS_OVERTIME,
  SALARY TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY,
  SALARY_DAY TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY_DAY,
  SALARY_NIGHT TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY_NIGHT,
  SALARY_OVERTIME TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY_OVERTIME,
  SALARY_HOLIDAYS_DAY TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY_HOLIDAYS_DAY,
  SALARY_HOLIDAYS_NIGHT TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY_HOLIDAYS_NIGHT,
  SALARY_HOLIDAYS_OVERTIME TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY_HOLIDAYS_OVERTIME,
  SALARY_PAID_HOLIDAYS_DAY TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY_PAID_HOLIDAYS_DAY,
  SALARY_PAID_HOLIDAYS_NIGHT TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY_PAID_HOLIDAYS_NIGHT,
  SALARY_PIECEWORK TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY_PIECEWORK,
  SICKDAYS TYPE OF COLUMN SALARY_SHEETS_R_HIST.SICKDAYS,
  SICKDAYS_PAY TYPE OF COLUMN SALARY_SHEETS_R_HIST.SICKDAYS_PAY,
  ACCIDENT_DAYS TYPE OF COLUMN SALARY_SHEETS_R_HIST.ACCIDENT_DAYS,
  ACCIDENT_PAY TYPE OF COLUMN SALARY_SHEETS_R_HIST.ACCIDENT_PAY,
  AVERAGE_INCOME_DAYS TYPE OF COLUMN SALARY_SHEETS_R_HIST.AVERAGE_INCOME_DAYS,
  AVERAGE_INCOME_PAY TYPE OF COLUMN SALARY_SHEETS_R_HIST.AVERAGE_INCOME_PAY,
  FACT_AVPAY_FREE_DAYS TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_AVPAY_FREE_DAYS,
  FACT_AVPAY_FREE_HOURS TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_AVPAY_FREE_HOURS,
  FACT_AVPAY_WORK_DAYS TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_AVPAY_WORK_DAYS,
  FACT_AVPAY_WORKINHOLIDAYS TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_AVPAY_WORKINHOLIDAYS,
  FACT_AVPAY_HOURS TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_AVPAY_HOURS,
  FACT_AVPAY_HOURS_OVERTIME TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_AVPAY_HOURS_OVERTIME,
  FACT_AVPAY_HOLIDAYS_HOURS TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_AVPAY_HOLIDAYS_HOURS,
  FACT_AVPAY_HOLIDAYS_HOURS_OVERT TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_AVPAY_HOLIDAYS_HOURS_OVERT,
  SALARY_AVPAY_FREE_DAYS TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY_AVPAY_FREE_DAYS,
  SALARY_AVPAY_WORK_DAYS TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY_AVPAY_WORK_DAYS,
  SALARY_AVPAY_WORK_DAYS_OVERTIME TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY_AVPAY_WORK_DAYS_OVERTIME,
  SALARY_AVPAY_HOLIDAYS TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY_AVPAY_HOLIDAYS,
  SALARY_AVPAY_HOLIDAYS_OVERTIME TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY_AVPAY_HOLIDAYS_OVERTIME,
  BUSINESS_TRIP_DAYS TYPE OF COLUMN SALARY_SHEETS_R_HIST.BUSINESS_TRIP_DAYS,
  BUSINESS_TRIP_PAY TYPE OF COLUMN SALARY_SHEETS_R_HIST.BUSINESS_TRIP_PAY,
  PAID_HOLIDAYS TYPE OF COLUMN SALARY_SHEETS_R_HIST.PAID_HOLIDAYS,
  PAID_HOLIDAYS_PAY TYPE OF COLUMN SALARY_SHEETS_R_HIST.PAID_HOLIDAYS_PAY,
  VACATION_DAYS_CURRENT TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_DAYS_CURRENT,
  VACATION_DAYS_NEXT TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_DAYS_NEXT,
  VACATION_HOURS_CURRENT TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_HOURS_CURRENT,
  VACATION_HOURS_NEXT TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_HOURS_NEXT,
  VACATION_PAY_CURRENT TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_PAY_CURRENT,
  VACATION_PAY_NEXT TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_PAY_NEXT,
  VACATION_DNS_NEXT TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_DNS_NEXT,
  VACATION_DDS_NEXT TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_DDS_NEXT,
  VACATION_IIN_NEXT TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_IIN_NEXT,
  VACATION_IIN_REDUCE_NEXT TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_IIN_REDUCE_NEXT,
  VACATION_CASH_NEXT TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_CASH_NEXT,
  VACATION_PAY_PREV TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_PAY_PREV,
  VACATION_DNS_PREV TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_DNS_PREV,
  VACATION_DDS_PREV TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_DDS_PREV,
  VACATION_IIN_PREV TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_IIN_PREV,
  VACATION_DAYS_COMP TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_DAYS_COMP,
  VACATION_PAY_COMP TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_PAY_COMP,
  PLUS_TAXED TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLUS_TAXED,
  PLUS_NOTTAXED TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLUS_NOTTAXED,
  PLUS_NOSAI TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLUS_NOSAI,
  PLUS_AUTHORS_FEES TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLUS_AUTHORS_FEES,
  MINUS_BEFORE_IIN TYPE OF COLUMN SALARY_SHEETS_R_HIST.MINUS_BEFORE_IIN,
  MINUS_AFTER_IIN TYPE OF COLUMN SALARY_SHEETS_R_HIST.MINUS_AFTER_IIN,
  PLUS_PF_NOTTAXED TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLUS_PF_NOTTAXED,
  PLUS_PF_TAXED TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLUS_PF_TAXED,
  PLUS_LI_NOTTAXED TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLUS_LI_NOTTAXED,
  PLUS_LI_TAXED TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLUS_LI_TAXED,
  PLUS_HI_NOTTAXED TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLUS_HI_NOTTAXED,
  PLUS_HI_TAXED TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLUS_HI_TAXED,
  PLUS_NP_TAXED TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLUS_NP_TAXED,
  PLUS_NP_NOTTAXED TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLUS_NP_NOTTAXED,
  PLUS_NP_NOSAI TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLUS_NP_NOSAI,
  TOTAL_BEFORE_TAXES TYPE OF COLUMN SALARY_SHEETS_R_HIST.TOTAL_BEFORE_TAXES,
  ADJUSTED_AMOUNT TYPE OF COLUMN SALARY_SHEETS_R_HIST.ADJUSTED_AMOUNT,
  AMOUNT_BEFORE_SN TYPE OF COLUMN SALARY_SHEETS_R_HIST.AMOUNT_BEFORE_SN,
  AMOUNT_BEFORE_SN_REVERSE TYPE OF COLUMN SALARY_SHEETS_R_HIST.AMOUNT_BEFORE_SN_REVERSE,
  RATE_DNSN TYPE OF COLUMN SALARY_SHEETS_R_HIST.RATE_DNSN,
  RATE_DDSN TYPE OF COLUMN SALARY_SHEETS_R_HIST.RATE_DDSN,
  DNSN_AMOUNT TYPE OF COLUMN SALARY_SHEETS_R_HIST.DNSN_AMOUNT,
  DDSN_AMOUNT TYPE OF COLUMN SALARY_SHEETS_R_HIST.DDSN_AMOUNT,
  SN_AMOUNT TYPE OF COLUMN SALARY_SHEETS_R_HIST.SN_AMOUNT,
  DNSN_AMOUNT_REVERSE TYPE OF COLUMN SALARY_SHEETS_R_HIST.DNSN_AMOUNT_REVERSE,
  DDSN_AMOUNT_REVERSE TYPE OF COLUMN SALARY_SHEETS_R_HIST.DDSN_AMOUNT_REVERSE,
  SN_MAX_AMOUNT TYPE OF COLUMN SALARY_SHEETS_R_HIST.SN_MAX_AMOUNT,
  IIN_EXEMPT_UNTAXED_MINIMUM0 TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_EXEMPT_UNTAXED_MINIMUM0,
  IIN_EXEMPT_DEPENDANTS0 TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_EXEMPT_DEPENDANTS0,
  IIN_EXEMPT_RETALIATION0 TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_EXEMPT_RETALIATION0,
  IIN_EXEMPT_INVALIDITY0 TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_EXEMPT_INVALIDITY0,
  IIN_EXEMPT_NATIONAL_MOVEMENT0 TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_EXEMPT_NATIONAL_MOVEMENT0,
  IIN_EXEMPT_UNTAXED_MINIMUM TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_EXEMPT_UNTAXED_MINIMUM,
  IIN_EXEMPT_DEPENDANTS TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_EXEMPT_DEPENDANTS,
  IIN_EXEMPT_RETALIATION TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_EXEMPT_RETALIATION,
  IIN_EXEMPT_INVALIDITY TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_EXEMPT_INVALIDITY,
  IIN_EXEMPT_NATIONAL_MOVEMENT TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_EXEMPT_NATIONAL_MOVEMENT,
  IIN_EXEMPT_EXPENSES TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_EXEMPT_EXPENSES,
  IIN_EXEMPT_2TP TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_EXEMPT_2TP,
  IIN_EXEMPT_20 TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_EXEMPT_20,
  IIN_EXEMPT_2 TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_EXEMPT_2,
  AMOUNT_BEFORE_IIN TYPE OF COLUMN SALARY_SHEETS_R_HIST.AMOUNT_BEFORE_IIN,
  AMOUNT_BEFORE_IIN_REVERSE TYPE OF COLUMN SALARY_SHEETS_R_HIST.AMOUNT_BEFORE_IIN_REVERSE,
  RATE_IIN TYPE OF COLUMN SALARY_SHEETS_R_HIST.RATE_IIN,
  RATE_IIN2 TYPE OF COLUMN SALARY_SHEETS_R_HIST.RATE_IIN2,
  IIN_AMOUNT TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_AMOUNT,
  IIN_AMOUNT_REVERSE TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_AMOUNT_REVERSE,
  URVN_AMAOUNT TYPE OF COLUMN SALARY_SHEETS_R_HIST.URVN_AMAOUNT,
  PLUS_NOT_PAID TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLUS_NOT_PAID,
  VACATION_ADVANCE_CURRENT TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_ADVANCE_CURRENT,
  VACATION_ADVANCE_NEXT TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_ADVANCE_NEXT,
  VACATION_ADVANCE_PREV TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_ADVANCE_PREV,
  ADVANCE TYPE OF COLUMN SALARY_SHEETS_R_HIST.ADVANCE,
  PAY0 TYPE OF COLUMN SALARY_SHEETS_R_HIST.PAY0,
  PAY TYPE OF COLUMN SALARY_SHEETS_R_HIST.PAY,
  PAYT TYPE OF COLUMN SALARY_SHEETS_R_HIST.PAYT,
  PAY_DATE TYPE OF COLUMN SALARY_SHEETS_R_HIST.PAY_DATE,
  COMMENTS TYPE OF COLUMN SALARY_SHEETS_R_HIST.COMMENTS /* COLLATE UTF8 - default */,
  WITHHOLD_FROM_PAY TYPE OF COLUMN SALARY_SHEETS_R_HIST.WITHHOLD_FROM_PAY,
  FORAVPAYCALC_BRUTO TYPE OF COLUMN SALARY_SHEETS_R_HIST.FORAVPAYCALC_BRUTO,
  FORAVPAYCALC_PAYOUT TYPE OF COLUMN SALARY_SHEETS_R_HIST.FORAVPAYCALC_PAYOUT,
  FORAVPAYCALC_DAYS TYPE OF COLUMN SALARY_SHEETS_R_HIST.FORAVPAYCALC_DAYS,
  FORAVPAYCALC_HOURS TYPE OF COLUMN SALARY_SHEETS_R_HIST.FORAVPAYCALC_HOURS,
  AVPAYCALC_CALDAY TYPE OF COLUMN SALARY_SHEETS_R_HIST.AVPAYCALC_CALDAY,
  AVPAYCALC_DAY TYPE OF COLUMN SALARY_SHEETS_R_HIST.AVPAYCALC_DAY,
  AVPAYCALC_HOUR TYPE OF COLUMN SALARY_SHEETS_R_HIST.AVPAYCALC_HOUR,
  DT_EDITED TYPE OF COLUMN SALARY_SHEETS_R_HIST.DT_EDITED,
  CALC_VER TYPE OF COLUMN SALARY_SHEETS_R_HIST.CALC_VER)
AS
begin

    for select
             SALARY_SHEETS_R_HIST.idH,
             SALARY_SHEETS_R_HIST.id,
             SALARY_SHEETS_R_HIST.ids,
             SALARY_SHEETS_R_HIST.idsx,
             SALARY_SHEETS_R_HIST.idst,
             SALARY_SHEETS_R_HIST.is_temp,
             SALARY_SHEETS_R_HIST.type_tag,
             SALARY_SHEETS_R_HIST.idp,
             SALARY_SHEETS_R_HIST.idam,
             SALARY_SHEETS_R_HIST.snr,
             SALARY_SHEETS_R_HIST.fname,
             SALARY_SHEETS_R_HIST.lname,
             SALARY_SHEETS_R_HIST.position_title,
             SALARY_SHEETS_R_HIST.territorial_code,
             SALARY_SHEETS_R_HIST.calendar_days,
             SALARY_SHEETS_R_HIST.calendar_days_use,
             SALARY_SHEETS_R_HIST.month_workdays,
             SALARY_SHEETS_R_HIST.month_workhours,
             SALARY_SHEETS_R_HIST.plan_days,
             SALARY_SHEETS_R_HIST.plan_hours,
             SALARY_SHEETS_R_HIST.plan_hours_night,
             SALARY_SHEETS_R_HIST.plan_hours_overtime,
             SALARY_SHEETS_R_HIST.fact_days,
             SALARY_SHEETS_R_HIST.fact_hours,
             SALARY_SHEETS_R_HIST.fact_hours_night,
             SALARY_SHEETS_R_HIST.fact_hours_overtime,
             SALARY_SHEETS_R_HIST.plan_work_days,
             SALARY_SHEETS_R_HIST.plan_work_hours,
             SALARY_SHEETS_R_HIST.plan_work_hours_night,
             SALARY_SHEETS_R_HIST.plan_work_hours_overtime,
             SALARY_SHEETS_R_HIST.fact_work_days,
             SALARY_SHEETS_R_HIST.fact_work_hours,
             SALARY_SHEETS_R_HIST.fact_work_hours_night,
             SALARY_SHEETS_R_HIST.fact_work_hours_overtime,
             SALARY_SHEETS_R_HIST.plan_holidays_days,
             SALARY_SHEETS_R_HIST.plan_holidays_hours,
             SALARY_SHEETS_R_HIST.plan_holidays_hours_night,
             SALARY_SHEETS_R_HIST.plan_holidays_hours_overtime,
             SALARY_SHEETS_R_HIST.fact_holidays_days,
             SALARY_SHEETS_R_HIST.fact_holidays_hours,
             SALARY_SHEETS_R_HIST.fact_holidays_hours_night,
             SALARY_SHEETS_R_HIST.fact_holidays_hours_overtime,
             SALARY_SHEETS_R_HIST.salary,
             SALARY_SHEETS_R_HIST.salary_day,
             SALARY_SHEETS_R_HIST.salary_night,
             SALARY_SHEETS_R_HIST.salary_overtime,
             SALARY_SHEETS_R_HIST.salary_holidays_day,
             SALARY_SHEETS_R_HIST.salary_holidays_night,
             SALARY_SHEETS_R_HIST.salary_holidays_overtime,
             SALARY_SHEETS_R_HIST.salary_paid_holidays_day,
             SALARY_SHEETS_R_HIST.salary_paid_holidays_night,
             SALARY_SHEETS_R_HIST.salary_piecework,
             SALARY_SHEETS_R_HIST.sickdays,
             SALARY_SHEETS_R_HIST.sickdays_pay,
             SALARY_SHEETS_R_HIST.accident_days,
             SALARY_SHEETS_R_HIST.accident_pay,
             SALARY_SHEETS_R_HIST.average_income_days,
             SALARY_SHEETS_R_HIST.average_income_pay,

             SALARY_SHEETS_R_HIST.fact_avpay_free_days,
             SALARY_SHEETS_R_HIST.fact_avpay_free_hours,
             SALARY_SHEETS_R_HIST.fact_avpay_work_days,
             SALARY_SHEETS_R_HIST.fact_avpay_workinholidays,
             SALARY_SHEETS_R_HIST.fact_avpay_hours,
             SALARY_SHEETS_R_HIST.fact_avpay_hours_overtime,
             SALARY_SHEETS_R_HIST.fact_avpay_holidays_hours,
             SALARY_SHEETS_R_HIST.fact_avpay_holidays_hours_overt,
             SALARY_SHEETS_R_HIST.salary_avpay_free_days,
             SALARY_SHEETS_R_HIST.salary_avpay_work_days,
             SALARY_SHEETS_R_HIST.salary_avpay_work_days_overtime,
             SALARY_SHEETS_R_HIST.salary_avpay_holidays,
             SALARY_SHEETS_R_HIST.salary_avpay_holidays_overtime,

             SALARY_SHEETS_R_HIST.business_trip_days,
             SALARY_SHEETS_R_HIST.business_trip_pay,
             SALARY_SHEETS_R_HIST.paid_holidays,
             SALARY_SHEETS_R_HIST.paid_holidays_pay,
             SALARY_SHEETS_R_HIST.vacation_days_current,
             SALARY_SHEETS_R_HIST.vacation_days_next,
             SALARY_SHEETS_R_HIST.vacation_hours_current,
             SALARY_SHEETS_R_HIST.vacation_hours_next,
             SALARY_SHEETS_R_HIST.vacation_pay_current,
             SALARY_SHEETS_R_HIST.vacation_pay_next,
             SALARY_SHEETS_R_HIST.vacation_dns_next,
             SALARY_SHEETS_R_HIST.vacation_dds_next,
             SALARY_SHEETS_R_HIST.vacation_iin_next,
             SALARY_SHEETS_R_HIST.vacation_iin_reduce_next,
             SALARY_SHEETS_R_HIST.vacation_cash_next,
             SALARY_SHEETS_R_HIST.vacation_pay_prev,
             SALARY_SHEETS_R_HIST.vacation_dns_prev,
             SALARY_SHEETS_R_HIST.vacation_dds_prev,
             SALARY_SHEETS_R_HIST.vacation_iin_prev,
             SALARY_SHEETS_R_HIST.vacation_days_comp,
             SALARY_SHEETS_R_HIST.vacation_pay_comp,

             SALARY_SHEETS_R_HIST.plus_taxed,
             SALARY_SHEETS_R_HIST.plus_nottaxed,
             SALARY_SHEETS_R_HIST.plus_nosai,
             SALARY_SHEETS_R_HIST.plus_authors_fees,
             SALARY_SHEETS_R_HIST.minus_before_iin,
             SALARY_SHEETS_R_HIST.minus_after_iin,
             SALARY_SHEETS_R_HIST.plus_pf_nottaxed,
             SALARY_SHEETS_R_HIST.plus_pf_taxed,
             SALARY_SHEETS_R_HIST.plus_li_nottaxed,
             SALARY_SHEETS_R_HIST.plus_li_taxed,
             SALARY_SHEETS_R_HIST.plus_hi_nottaxed,
             SALARY_SHEETS_R_HIST.plus_hi_taxed,
             SALARY_SHEETS_R_HIST.plus_np_taxed,
             SALARY_SHEETS_R_HIST.plus_np_nottaxed,
             SALARY_SHEETS_R_HIST.plus_np_nosai,

             SALARY_SHEETS_R_HIST.total_before_taxes,
             SALARY_SHEETS_R_HIST.adjusted_amount,
             SALARY_SHEETS_R_HIST.amount_before_sn,
             SALARY_SHEETS_R_HIST.amount_before_sn_reverse,
             SALARY_SHEETS_R_HIST.rate_dnsn,
             SALARY_SHEETS_R_HIST.rate_ddsn,
             SALARY_SHEETS_R_HIST.dnsn_amount,
             SALARY_SHEETS_R_HIST.ddsn_amount,
             SALARY_SHEETS_R_HIST.sn_amount,
             SALARY_SHEETS_R_HIST.dnsn_amount_reverse,
             SALARY_SHEETS_R_HIST.ddsn_amount_reverse,
             SALARY_SHEETS_R_HIST.sn_max_amount,

             SALARY_SHEETS_R_HIST.iin_exempt_untaxed_minimum0,
             SALARY_SHEETS_R_HIST.iin_exempt_dependants0,
             SALARY_SHEETS_R_HIST.iin_exempt_retaliation0,
             SALARY_SHEETS_R_HIST.iin_exempt_invalidity0,
             SALARY_SHEETS_R_HIST.iin_exempt_national_movement0,
             SALARY_SHEETS_R_HIST.iin_exempt_untaxed_minimum,
             SALARY_SHEETS_R_HIST.iin_exempt_dependants,
             SALARY_SHEETS_R_HIST.iin_exempt_retaliation,
             SALARY_SHEETS_R_HIST.iin_exempt_invalidity,
             SALARY_SHEETS_R_HIST.iin_exempt_national_movement,
             SALARY_SHEETS_R_HIST.iin_exempt_expenses,
             SALARY_SHEETS_R_HIST.iin_exempt_2tp,
             SALARY_SHEETS_R_HIST.iin_exempt_20,
             SALARY_SHEETS_R_HIST.iin_exempt_2,
             SALARY_SHEETS_R_HIST.amount_before_iin,
             SALARY_SHEETS_R_HIST.amount_before_iin_reverse,
             SALARY_SHEETS_R_HIST.rate_iin,
             SALARY_SHEETS_R_HIST.rate_iin2,
             SALARY_SHEETS_R_HIST.iin_amount,
             SALARY_SHEETS_R_HIST.iin_amount_reverse,
             SALARY_SHEETS_R_HIST.urvn_amaount,

             SALARY_SHEETS_R_HIST.plus_not_paid,
             SALARY_SHEETS_R_HIST.vacation_advance_current,
             SALARY_SHEETS_R_HIST.vacation_advance_next,
             SALARY_SHEETS_R_HIST.vacation_advance_prev,
             SALARY_SHEETS_R_HIST.advance,
             SALARY_SHEETS_R_HIST.pay0,
             SALARY_SHEETS_R_HIST.pay,
             SALARY_SHEETS_R_HIST.payt,
             SALARY_SHEETS_R_HIST.pay_date,
             SALARY_SHEETS_R_HIST.comments,
             SALARY_SHEETS_R_HIST.withhold_from_pay,

             SALARY_SHEETS_R_HIST.foravpaycalc_bruto,
             SALARY_SHEETS_R_HIST.foravpaycalc_payout,
             SALARY_SHEETS_R_HIST.foravpaycalc_days,
             SALARY_SHEETS_R_HIST.foravpaycalc_hours,
             SALARY_SHEETS_R_HIST.avpaycalc_calday,
             SALARY_SHEETS_R_HIST.avpaycalc_day,
             SALARY_SHEETS_R_HIST.avpaycalc_hour,

             SALARY_SHEETS_R_HIST.dt_edited,
             SALARY_SHEETS_R_HIST.calc_ver

    from SALARY_SHEETS_R_HIST
    where SALARY_SHEETS_R_HIST.id = :PID
    order by SALARY_SHEETS_R_HIST.dt_edited

    into
        :idH,
        :id,
        :ids,
        :idsx,
        :idst,
        :is_temp,
        :type_tag,
        :idp,
        :idam,
        :snr,
        :fname,
        :lname,
        :position_title,
        :territorial_code,
        :calendar_days,
        :calendar_days_use,
        :month_workdays,
        :month_workhours,
        :plan_days,
        :plan_hours,
        :plan_hours_night,
        :plan_hours_overtime,
        :fact_days,
        :fact_hours,
        :fact_hours_night,
        :fact_hours_overtime,
        :plan_work_days,
        :plan_work_hours,
        :plan_work_hours_night,
        :plan_work_hours_overtime,
        :fact_work_days,
        :fact_work_hours,
        :fact_work_hours_night,
        :fact_work_hours_overtime,
        :plan_holidays_days,
        :plan_holidays_hours,
        :plan_holidays_hours_night,
        :plan_holidays_hours_overtime,
        :fact_holidays_days,
        :fact_holidays_hours,
        :fact_holidays_hours_night,
        :fact_holidays_hours_overtime,
        :salary,
        :salary_day,
        :salary_night,
        :salary_overtime,
        :salary_holidays_day,
        :salary_holidays_night,
        :salary_holidays_overtime,
        :salary_paid_holidays_day,
        :salary_paid_holidays_night,
        :salary_piecework,
        :sickdays,
        :sickdays_pay,
        :accident_days,
        :accident_pay,
        :average_income_days,
        :average_income_pay,
        
        :fact_avpay_free_days,
        :fact_avpay_free_hours,
        :fact_avpay_work_days,
        :fact_avpay_workinholidays,
        :fact_avpay_hours,
        :fact_avpay_hours_overtime,
        :fact_avpay_holidays_hours,
        :fact_avpay_holidays_hours_overt,
        :salary_avpay_free_days,
        :salary_avpay_work_days,
        :salary_avpay_work_days_overtime,
        :salary_avpay_holidays,
        :salary_avpay_holidays_overtime,
        
        :business_trip_days,
        :business_trip_pay,
        :paid_holidays,
        :paid_holidays_pay,
        :vacation_days_current,
        :vacation_days_next,
        :vacation_hours_current,
        :vacation_hours_next,
        :vacation_pay_current,
        :vacation_pay_next,
        :vacation_dns_next,
        :vacation_dds_next,
        :vacation_iin_next,
        :vacation_iin_reduce_next,
        :vacation_cash_next,
        :vacation_pay_prev,
        :vacation_dns_prev,
        :vacation_dds_prev,
        :vacation_iin_prev,
        :vacation_days_comp,
        :vacation_pay_comp,

        :plus_taxed,
        :plus_nottaxed,
        :plus_nosai,
        :plus_authors_fees,
        :minus_before_iin,
        :minus_after_iin,
        :plus_pf_nottaxed,
        :plus_pf_taxed,
        :plus_li_nottaxed,
        :plus_li_taxed,
        :plus_hi_nottaxed,
        :plus_hi_taxed,
        :plus_np_taxed,
        :plus_np_nottaxed,
        :plus_np_nosai,

        :total_before_taxes,
        :adjusted_amount,
        :amount_before_sn,
        :amount_before_sn_reverse,
        :rate_dnsn,
        :rate_ddsn,
        :dnsn_amount,
        :ddsn_amount,
        :sn_amount,
        :dnsn_amount_reverse,
        :ddsn_amount_reverse,
        :sn_max_amount,

        :iin_exempt_untaxed_minimum0,
        :iin_exempt_dependants0,
        :iin_exempt_retaliation0,
        :iin_exempt_invalidity0,
        :iin_exempt_national_movement0,
        :iin_exempt_untaxed_minimum,
        :iin_exempt_dependants,
        :iin_exempt_retaliation,
        :iin_exempt_invalidity,
        :iin_exempt_national_movement,
        :iin_exempt_expenses,
        :iin_exempt_2tp,
        :iin_exempt_20,
        :iin_exempt_2,
        :amount_before_iin,
        :amount_before_iin_reverse,
        :rate_iin,
        :rate_iin2,
        :iin_amount,
        :iin_amount_reverse,
        :urvn_amaount,

        :plus_not_paid,
        :vacation_advance_current,
        :vacation_advance_next,
        :vacation_advance_prev,
        :advance,
        :pay0,
        :pay,
        :payt,
        :pay_date,
        :comments,
        :withhold_from_pay,

        :foravpaycalc_bruto,
        :foravpaycalc_payout,
        :foravpaycalc_days,
        :foravpaycalc_hours,
        :avpaycalc_calday,
        :avpaycalc_day,
        :avpaycalc_hour,

        :dt_edited,
        :calc_ver
  do
  begin
    suspend;
  end
end
^

ALTER PROCEDURE SP_SALARY_SHEETS_R_HIST_02(
  PIDSX INTEGER,
  PTIME1 TIMESTAMP,
  PTIME2 TIMESTAMP)
RETURNS (
  IDH TYPE OF COLUMN SALARY_SHEETS_R_HIST.ID,
  ID TYPE OF COLUMN SALARY_SHEETS_R_HIST.ID,
  IDS TYPE OF COLUMN SALARY_SHEETS_R_HIST.IDS,
  IDSX TYPE OF COLUMN SALARY_SHEETS_R_HIST.IDSX,
  IDST TYPE OF COLUMN SALARY_SHEETS_R_HIST.IDST,
  IS_TEMP TYPE OF COLUMN SALARY_SHEETS_R_HIST.IS_TEMP,
  TYPE_TAG TYPE OF COLUMN SALARY_SHEETS_R_HIST.TYPE_TAG,
  IDP TYPE OF COLUMN SALARY_SHEETS_R_HIST.IDP,
  IDAM TYPE OF COLUMN SALARY_SHEETS_R_HIST.IDAM,
  SNR TYPE OF COLUMN SALARY_SHEETS_R_HIST.SNR,
  FNAME TYPE OF COLUMN SALARY_SHEETS_R_HIST.FNAME /* COLLATE UTF8 - default */,
  LNAME TYPE OF COLUMN SALARY_SHEETS_R_HIST.LNAME /* COLLATE UTF8 - default */,
  POSITION_TITLE TYPE OF COLUMN SALARY_SHEETS_R_HIST.POSITION_TITLE /* COLLATE UTF8 - default */,
  TERRITORIAL_CODE TYPE OF COLUMN SALARY_SHEETS_R_HIST.TERRITORIAL_CODE /* COLLATE UTF8 - default */,
  CALENDAR_DAYS TYPE OF COLUMN SALARY_SHEETS_R_HIST.CALENDAR_DAYS,
  CALENDAR_DAYS_USE TYPE OF COLUMN SALARY_SHEETS_R_HIST.CALENDAR_DAYS_USE,
  MONTH_WORKDAYS TYPE OF COLUMN SALARY_SHEETS_R_HIST.MONTH_WORKDAYS,
  MONTH_WORKHOURS TYPE OF COLUMN SALARY_SHEETS_R_HIST.MONTH_WORKHOURS,
  PLAN_DAYS TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLAN_DAYS,
  PLAN_HOURS TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLAN_HOURS,
  PLAN_HOURS_NIGHT TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLAN_HOURS_NIGHT,
  PLAN_HOURS_OVERTIME TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLAN_HOURS_OVERTIME,
  FACT_DAYS TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_DAYS,
  FACT_HOURS TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_HOURS,
  FACT_HOURS_NIGHT TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_HOURS_NIGHT,
  FACT_HOURS_OVERTIME TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_HOURS_OVERTIME,
  PLAN_WORK_DAYS TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLAN_WORK_DAYS,
  PLAN_WORK_HOURS TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLAN_WORK_HOURS,
  PLAN_WORK_HOURS_NIGHT TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLAN_WORK_HOURS_NIGHT,
  PLAN_WORK_HOURS_OVERTIME TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLAN_WORK_HOURS_OVERTIME,
  FACT_WORK_DAYS TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_WORK_DAYS,
  FACT_WORK_HOURS TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_WORK_HOURS,
  FACT_WORK_HOURS_NIGHT TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_WORK_HOURS_NIGHT,
  FACT_WORK_HOURS_OVERTIME TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_WORK_HOURS_OVERTIME,
  PLAN_HOLIDAYS_DAYS TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLAN_HOLIDAYS_DAYS,
  PLAN_HOLIDAYS_HOURS TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLAN_HOLIDAYS_HOURS,
  PLAN_HOLIDAYS_HOURS_NIGHT TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLAN_HOLIDAYS_HOURS_NIGHT,
  PLAN_HOLIDAYS_HOURS_OVERTIME TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLAN_HOLIDAYS_HOURS_OVERTIME,
  FACT_HOLIDAYS_DAYS TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_HOLIDAYS_DAYS,
  FACT_HOLIDAYS_HOURS TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_HOLIDAYS_HOURS,
  FACT_HOLIDAYS_HOURS_NIGHT TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_HOLIDAYS_HOURS_NIGHT,
  FACT_HOLIDAYS_HOURS_OVERTIME TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_HOLIDAYS_HOURS_OVERTIME,
  SALARY TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY,
  SALARY_DAY TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY_DAY,
  SALARY_NIGHT TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY_NIGHT,
  SALARY_OVERTIME TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY_OVERTIME,
  SALARY_HOLIDAYS_DAY TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY_HOLIDAYS_DAY,
  SALARY_HOLIDAYS_NIGHT TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY_HOLIDAYS_NIGHT,
  SALARY_HOLIDAYS_OVERTIME TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY_HOLIDAYS_OVERTIME,
  SALARY_PAID_HOLIDAYS_DAY TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY_PAID_HOLIDAYS_DAY,
  SALARY_PAID_HOLIDAYS_NIGHT TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY_PAID_HOLIDAYS_NIGHT,
  SALARY_PIECEWORK TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY_PIECEWORK,
  SICKDAYS TYPE OF COLUMN SALARY_SHEETS_R_HIST.SICKDAYS,
  SICKDAYS_PAY TYPE OF COLUMN SALARY_SHEETS_R_HIST.SICKDAYS_PAY,
  ACCIDENT_DAYS TYPE OF COLUMN SALARY_SHEETS_R_HIST.ACCIDENT_DAYS,
  ACCIDENT_PAY TYPE OF COLUMN SALARY_SHEETS_R_HIST.ACCIDENT_PAY,
  AVERAGE_INCOME_DAYS TYPE OF COLUMN SALARY_SHEETS_R_HIST.AVERAGE_INCOME_DAYS,
  AVERAGE_INCOME_PAY TYPE OF COLUMN SALARY_SHEETS_R_HIST.AVERAGE_INCOME_PAY,
  FACT_AVPAY_FREE_DAYS TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_AVPAY_FREE_DAYS,
  FACT_AVPAY_FREE_HOURS TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_AVPAY_FREE_HOURS,
  FACT_AVPAY_WORK_DAYS TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_AVPAY_WORK_DAYS,
  FACT_AVPAY_WORKINHOLIDAYS TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_AVPAY_WORKINHOLIDAYS,
  FACT_AVPAY_HOURS TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_AVPAY_HOURS,
  FACT_AVPAY_HOURS_OVERTIME TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_AVPAY_HOURS_OVERTIME,
  FACT_AVPAY_HOLIDAYS_HOURS TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_AVPAY_HOLIDAYS_HOURS,
  FACT_AVPAY_HOLIDAYS_HOURS_OVERT TYPE OF COLUMN SALARY_SHEETS_R_HIST.FACT_AVPAY_HOLIDAYS_HOURS_OVERT,
  SALARY_AVPAY_FREE_DAYS TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY_AVPAY_FREE_DAYS,
  SALARY_AVPAY_WORK_DAYS TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY_AVPAY_WORK_DAYS,
  SALARY_AVPAY_WORK_DAYS_OVERTIME TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY_AVPAY_WORK_DAYS_OVERTIME,
  SALARY_AVPAY_HOLIDAYS TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY_AVPAY_HOLIDAYS,
  SALARY_AVPAY_HOLIDAYS_OVERTIME TYPE OF COLUMN SALARY_SHEETS_R_HIST.SALARY_AVPAY_HOLIDAYS_OVERTIME,
  BUSINESS_TRIP_DAYS TYPE OF COLUMN SALARY_SHEETS_R_HIST.BUSINESS_TRIP_DAYS,
  BUSINESS_TRIP_PAY TYPE OF COLUMN SALARY_SHEETS_R_HIST.BUSINESS_TRIP_PAY,
  PAID_HOLIDAYS TYPE OF COLUMN SALARY_SHEETS_R_HIST.PAID_HOLIDAYS,
  PAID_HOLIDAYS_PAY TYPE OF COLUMN SALARY_SHEETS_R_HIST.PAID_HOLIDAYS_PAY,
  VACATION_DAYS_CURRENT TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_DAYS_CURRENT,
  VACATION_DAYS_NEXT TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_DAYS_NEXT,
  VACATION_HOURS_CURRENT TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_HOURS_CURRENT,
  VACATION_HOURS_NEXT TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_HOURS_NEXT,
  VACATION_PAY_CURRENT TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_PAY_CURRENT,
  VACATION_PAY_NEXT TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_PAY_NEXT,
  VACATION_DNS_NEXT TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_DNS_NEXT,
  VACATION_DDS_NEXT TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_DDS_NEXT,
  VACATION_IIN_NEXT TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_IIN_NEXT,
  VACATION_IIN_REDUCE_NEXT TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_IIN_REDUCE_NEXT,
  VACATION_CASH_NEXT TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_CASH_NEXT,
  VACATION_PAY_PREV TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_PAY_PREV,
  VACATION_DNS_PREV TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_DNS_PREV,
  VACATION_DDS_PREV TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_DDS_PREV,
  VACATION_IIN_PREV TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_IIN_PREV,
  VACATION_DAYS_COMP TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_DAYS_COMP,
  VACATION_PAY_COMP TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_PAY_COMP,
  PLUS_TAXED TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLUS_TAXED,
  PLUS_NOTTAXED TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLUS_NOTTAXED,
  PLUS_NOSAI TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLUS_NOSAI,
  PLUS_AUTHORS_FEES TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLUS_AUTHORS_FEES,
  MINUS_BEFORE_IIN TYPE OF COLUMN SALARY_SHEETS_R_HIST.MINUS_BEFORE_IIN,
  MINUS_AFTER_IIN TYPE OF COLUMN SALARY_SHEETS_R_HIST.MINUS_AFTER_IIN,
  PLUS_PF_NOTTAXED TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLUS_PF_NOTTAXED,
  PLUS_PF_TAXED TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLUS_PF_TAXED,
  PLUS_LI_NOTTAXED TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLUS_LI_NOTTAXED,
  PLUS_LI_TAXED TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLUS_LI_TAXED,
  PLUS_HI_NOTTAXED TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLUS_HI_NOTTAXED,
  PLUS_HI_TAXED TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLUS_HI_TAXED,
  PLUS_NP_TAXED TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLUS_NP_TAXED,
  PLUS_NP_NOTTAXED TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLUS_NP_NOTTAXED,
  PLUS_NP_NOSAI TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLUS_NP_NOSAI,
  TOTAL_BEFORE_TAXES TYPE OF COLUMN SALARY_SHEETS_R_HIST.TOTAL_BEFORE_TAXES,
  ADJUSTED_AMOUNT TYPE OF COLUMN SALARY_SHEETS_R_HIST.ADJUSTED_AMOUNT,
  AMOUNT_BEFORE_SN TYPE OF COLUMN SALARY_SHEETS_R_HIST.AMOUNT_BEFORE_SN,
  AMOUNT_BEFORE_SN_REVERSE TYPE OF COLUMN SALARY_SHEETS_R_HIST.AMOUNT_BEFORE_SN_REVERSE,
  RATE_DNSN TYPE OF COLUMN SALARY_SHEETS_R_HIST.RATE_DNSN,
  RATE_DDSN TYPE OF COLUMN SALARY_SHEETS_R_HIST.RATE_DDSN,
  DNSN_AMOUNT TYPE OF COLUMN SALARY_SHEETS_R_HIST.DNSN_AMOUNT,
  DDSN_AMOUNT TYPE OF COLUMN SALARY_SHEETS_R_HIST.DDSN_AMOUNT,
  SN_AMOUNT TYPE OF COLUMN SALARY_SHEETS_R_HIST.SN_AMOUNT,
  DNSN_AMOUNT_REVERSE TYPE OF COLUMN SALARY_SHEETS_R_HIST.DNSN_AMOUNT_REVERSE,
  DDSN_AMOUNT_REVERSE TYPE OF COLUMN SALARY_SHEETS_R_HIST.DDSN_AMOUNT_REVERSE,
  SN_MAX_AMOUNT TYPE OF COLUMN SALARY_SHEETS_R_HIST.SN_MAX_AMOUNT,
  IIN_EXEMPT_UNTAXED_MINIMUM0 TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_EXEMPT_UNTAXED_MINIMUM0,
  IIN_EXEMPT_DEPENDANTS0 TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_EXEMPT_DEPENDANTS0,
  IIN_EXEMPT_RETALIATION0 TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_EXEMPT_RETALIATION0,
  IIN_EXEMPT_INVALIDITY0 TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_EXEMPT_INVALIDITY0,
  IIN_EXEMPT_NATIONAL_MOVEMENT0 TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_EXEMPT_NATIONAL_MOVEMENT0,
  IIN_EXEMPT_UNTAXED_MINIMUM TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_EXEMPT_UNTAXED_MINIMUM,
  IIN_EXEMPT_DEPENDANTS TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_EXEMPT_DEPENDANTS,
  IIN_EXEMPT_RETALIATION TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_EXEMPT_RETALIATION,
  IIN_EXEMPT_INVALIDITY TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_EXEMPT_INVALIDITY,
  IIN_EXEMPT_NATIONAL_MOVEMENT TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_EXEMPT_NATIONAL_MOVEMENT,
  IIN_EXEMPT_EXPENSES TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_EXEMPT_EXPENSES,
  IIN_EXEMPT_2TP TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_EXEMPT_2TP,
  IIN_EXEMPT_20 TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_EXEMPT_20,
  IIN_EXEMPT_2 TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_EXEMPT_2,
  AMOUNT_BEFORE_IIN TYPE OF COLUMN SALARY_SHEETS_R_HIST.AMOUNT_BEFORE_IIN,
  AMOUNT_BEFORE_IIN_REVERSE TYPE OF COLUMN SALARY_SHEETS_R_HIST.AMOUNT_BEFORE_IIN_REVERSE,
  RATE_IIN TYPE OF COLUMN SALARY_SHEETS_R_HIST.RATE_IIN,
  RATE_IIN2 TYPE OF COLUMN SALARY_SHEETS_R_HIST.RATE_IIN2,
  IIN_AMOUNT TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_AMOUNT,
  IIN_AMOUNT_REVERSE TYPE OF COLUMN SALARY_SHEETS_R_HIST.IIN_AMOUNT_REVERSE,
  URVN_AMAOUNT TYPE OF COLUMN SALARY_SHEETS_R_HIST.URVN_AMAOUNT,
  PLUS_NOT_PAID TYPE OF COLUMN SALARY_SHEETS_R_HIST.PLUS_NOT_PAID,
  VACATION_ADVANCE_CURRENT TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_ADVANCE_CURRENT,
  VACATION_ADVANCE_NEXT TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_ADVANCE_NEXT,
  VACATION_ADVANCE_PREV TYPE OF COLUMN SALARY_SHEETS_R_HIST.VACATION_ADVANCE_PREV,
  ADVANCE TYPE OF COLUMN SALARY_SHEETS_R_HIST.ADVANCE,
  PAY0 TYPE OF COLUMN SALARY_SHEETS_R_HIST.PAY0,
  PAY TYPE OF COLUMN SALARY_SHEETS_R_HIST.PAY,
  PAYT TYPE OF COLUMN SALARY_SHEETS_R_HIST.PAYT,
  PAY_DATE TYPE OF COLUMN SALARY_SHEETS_R_HIST.PAY_DATE,
  COMMENTS TYPE OF COLUMN SALARY_SHEETS_R_HIST.COMMENTS /* COLLATE UTF8 - default */,
  WITHHOLD_FROM_PAY TYPE OF COLUMN SALARY_SHEETS_R_HIST.WITHHOLD_FROM_PAY,
  FORAVPAYCALC_BRUTO TYPE OF COLUMN SALARY_SHEETS_R_HIST.FORAVPAYCALC_BRUTO,
  FORAVPAYCALC_PAYOUT TYPE OF COLUMN SALARY_SHEETS_R_HIST.FORAVPAYCALC_PAYOUT,
  FORAVPAYCALC_DAYS TYPE OF COLUMN SALARY_SHEETS_R_HIST.FORAVPAYCALC_DAYS,
  FORAVPAYCALC_HOURS TYPE OF COLUMN SALARY_SHEETS_R_HIST.FORAVPAYCALC_HOURS,
  AVPAYCALC_CALDAY TYPE OF COLUMN SALARY_SHEETS_R_HIST.AVPAYCALC_CALDAY,
  AVPAYCALC_DAY TYPE OF COLUMN SALARY_SHEETS_R_HIST.AVPAYCALC_DAY,
  AVPAYCALC_HOUR TYPE OF COLUMN SALARY_SHEETS_R_HIST.AVPAYCALC_HOUR,
  DT_EDITED TYPE OF COLUMN SALARY_SHEETS_R_HIST.DT_EDITED,
  CALC_VER TYPE OF COLUMN SALARY_SHEETS_R_HIST.CALC_VER)
AS
begin

    for select
             SALARY_SHEETS_R_HIST.idH,
             SALARY_SHEETS_R_HIST.id,
             SALARY_SHEETS_R_HIST.ids,
             SALARY_SHEETS_R_HIST.idsx,
             SALARY_SHEETS_R_HIST.idst,
             SALARY_SHEETS_R_HIST.is_temp,
             SALARY_SHEETS_R_HIST.type_tag,
             SALARY_SHEETS_R_HIST.idp,
             SALARY_SHEETS_R_HIST.idam,
             SALARY_SHEETS_R_HIST.snr,
             SALARY_SHEETS_R_HIST.fname,
             SALARY_SHEETS_R_HIST.lname,
             SALARY_SHEETS_R_HIST.position_title,
             SALARY_SHEETS_R_HIST.territorial_code,
             SALARY_SHEETS_R_HIST.calendar_days,
             SALARY_SHEETS_R_HIST.calendar_days_use,
             SALARY_SHEETS_R_HIST.month_workdays,
             SALARY_SHEETS_R_HIST.month_workhours,
             SALARY_SHEETS_R_HIST.plan_days,
             SALARY_SHEETS_R_HIST.plan_hours,
             SALARY_SHEETS_R_HIST.plan_hours_night,
             SALARY_SHEETS_R_HIST.plan_hours_overtime,
             SALARY_SHEETS_R_HIST.fact_days,
             SALARY_SHEETS_R_HIST.fact_hours,
             SALARY_SHEETS_R_HIST.fact_hours_night,
             SALARY_SHEETS_R_HIST.fact_hours_overtime,
             SALARY_SHEETS_R_HIST.plan_work_days,
             SALARY_SHEETS_R_HIST.plan_work_hours,
             SALARY_SHEETS_R_HIST.plan_work_hours_night,
             SALARY_SHEETS_R_HIST.plan_work_hours_overtime,
             SALARY_SHEETS_R_HIST.fact_work_days,
             SALARY_SHEETS_R_HIST.fact_work_hours,
             SALARY_SHEETS_R_HIST.fact_work_hours_night,
             SALARY_SHEETS_R_HIST.fact_work_hours_overtime,
             SALARY_SHEETS_R_HIST.plan_holidays_days,
             SALARY_SHEETS_R_HIST.plan_holidays_hours,
             SALARY_SHEETS_R_HIST.plan_holidays_hours_night,
             SALARY_SHEETS_R_HIST.plan_holidays_hours_overtime,
             SALARY_SHEETS_R_HIST.fact_holidays_days,
             SALARY_SHEETS_R_HIST.fact_holidays_hours,
             SALARY_SHEETS_R_HIST.fact_holidays_hours_night,
             SALARY_SHEETS_R_HIST.fact_holidays_hours_overtime,
             SALARY_SHEETS_R_HIST.salary,
             SALARY_SHEETS_R_HIST.salary_day,
             SALARY_SHEETS_R_HIST.salary_night,
             SALARY_SHEETS_R_HIST.salary_overtime,
             SALARY_SHEETS_R_HIST.salary_holidays_day,
             SALARY_SHEETS_R_HIST.salary_holidays_night,
             SALARY_SHEETS_R_HIST.salary_holidays_overtime,
             SALARY_SHEETS_R_HIST.salary_paid_holidays_day,
             SALARY_SHEETS_R_HIST.salary_paid_holidays_night,
             SALARY_SHEETS_R_HIST.salary_piecework,
             SALARY_SHEETS_R_HIST.sickdays,
             SALARY_SHEETS_R_HIST.sickdays_pay,
             SALARY_SHEETS_R_HIST.accident_days,
             SALARY_SHEETS_R_HIST.accident_pay,
             SALARY_SHEETS_R_HIST.average_income_days,
             SALARY_SHEETS_R_HIST.average_income_pay,

             SALARY_SHEETS_R_HIST.fact_avpay_free_days,
             SALARY_SHEETS_R_HIST.fact_avpay_free_hours,
             SALARY_SHEETS_R_HIST.fact_avpay_work_days,
             SALARY_SHEETS_R_HIST.fact_avpay_workinholidays,
             SALARY_SHEETS_R_HIST.fact_avpay_hours,
             SALARY_SHEETS_R_HIST.fact_avpay_hours_overtime,
             SALARY_SHEETS_R_HIST.fact_avpay_holidays_hours,
             SALARY_SHEETS_R_HIST.fact_avpay_holidays_hours_overt,
             SALARY_SHEETS_R_HIST.salary_avpay_free_days,
             SALARY_SHEETS_R_HIST.salary_avpay_work_days,
             SALARY_SHEETS_R_HIST.salary_avpay_work_days_overtime,
             SALARY_SHEETS_R_HIST.salary_avpay_holidays,
             SALARY_SHEETS_R_HIST.salary_avpay_holidays_overtime,

             SALARY_SHEETS_R_HIST.business_trip_days,
             SALARY_SHEETS_R_HIST.business_trip_pay,
             SALARY_SHEETS_R_HIST.paid_holidays,
             SALARY_SHEETS_R_HIST.paid_holidays_pay,
             SALARY_SHEETS_R_HIST.vacation_days_current,
             SALARY_SHEETS_R_HIST.vacation_days_next,
             SALARY_SHEETS_R_HIST.vacation_hours_current,
             SALARY_SHEETS_R_HIST.vacation_hours_next,
             SALARY_SHEETS_R_HIST.vacation_pay_current,
             SALARY_SHEETS_R_HIST.vacation_pay_next,
             SALARY_SHEETS_R_HIST.vacation_dns_next,
             SALARY_SHEETS_R_HIST.vacation_dds_next,
             SALARY_SHEETS_R_HIST.vacation_iin_next,
             SALARY_SHEETS_R_HIST.vacation_iin_reduce_next,
             SALARY_SHEETS_R_HIST.vacation_cash_next,
             SALARY_SHEETS_R_HIST.vacation_pay_prev,
             SALARY_SHEETS_R_HIST.vacation_dns_prev,
             SALARY_SHEETS_R_HIST.vacation_dds_prev,
             SALARY_SHEETS_R_HIST.vacation_iin_prev,
             SALARY_SHEETS_R_HIST.vacation_days_comp,
             SALARY_SHEETS_R_HIST.vacation_pay_comp,

             SALARY_SHEETS_R_HIST.plus_taxed,
             SALARY_SHEETS_R_HIST.plus_nottaxed,
             SALARY_SHEETS_R_HIST.plus_nosai,
             SALARY_SHEETS_R_HIST.plus_authors_fees,
             SALARY_SHEETS_R_HIST.minus_before_iin,
             SALARY_SHEETS_R_HIST.minus_after_iin,
             SALARY_SHEETS_R_HIST.plus_pf_nottaxed,
             SALARY_SHEETS_R_HIST.plus_pf_taxed,
             SALARY_SHEETS_R_HIST.plus_li_nottaxed,
             SALARY_SHEETS_R_HIST.plus_li_taxed,
             SALARY_SHEETS_R_HIST.plus_hi_nottaxed,
             SALARY_SHEETS_R_HIST.plus_hi_taxed,
             SALARY_SHEETS_R_HIST.plus_np_taxed,
             SALARY_SHEETS_R_HIST.plus_np_nottaxed,
             SALARY_SHEETS_R_HIST.plus_np_nosai,

             SALARY_SHEETS_R_HIST.total_before_taxes,
             SALARY_SHEETS_R_HIST.adjusted_amount,
             SALARY_SHEETS_R_HIST.amount_before_sn,
             SALARY_SHEETS_R_HIST.amount_before_sn_reverse,
             SALARY_SHEETS_R_HIST.rate_dnsn,
             SALARY_SHEETS_R_HIST.rate_ddsn,
             SALARY_SHEETS_R_HIST.dnsn_amount,
             SALARY_SHEETS_R_HIST.ddsn_amount,
             SALARY_SHEETS_R_HIST.sn_amount,
             SALARY_SHEETS_R_HIST.dnsn_amount_reverse,
             SALARY_SHEETS_R_HIST.ddsn_amount_reverse,
             SALARY_SHEETS_R_HIST.sn_max_amount,

             SALARY_SHEETS_R_HIST.iin_exempt_untaxed_minimum0,
             SALARY_SHEETS_R_HIST.iin_exempt_dependants0,
             SALARY_SHEETS_R_HIST.iin_exempt_retaliation0,
             SALARY_SHEETS_R_HIST.iin_exempt_invalidity0,
             SALARY_SHEETS_R_HIST.iin_exempt_national_movement0,
             SALARY_SHEETS_R_HIST.iin_exempt_untaxed_minimum,
             SALARY_SHEETS_R_HIST.iin_exempt_dependants,
             SALARY_SHEETS_R_HIST.iin_exempt_retaliation,
             SALARY_SHEETS_R_HIST.iin_exempt_invalidity,
             SALARY_SHEETS_R_HIST.iin_exempt_national_movement,
             SALARY_SHEETS_R_HIST.iin_exempt_expenses,
             SALARY_SHEETS_R_HIST.iin_exempt_2tp,
             SALARY_SHEETS_R_HIST.iin_exempt_20,
             SALARY_SHEETS_R_HIST.iin_exempt_2,
             SALARY_SHEETS_R_HIST.amount_before_iin,
             SALARY_SHEETS_R_HIST.amount_before_iin_reverse,
             SALARY_SHEETS_R_HIST.rate_iin,
             SALARY_SHEETS_R_HIST.rate_iin2,
             SALARY_SHEETS_R_HIST.iin_amount,
             SALARY_SHEETS_R_HIST.iin_amount_reverse,
             SALARY_SHEETS_R_HIST.urvn_amaount,

             SALARY_SHEETS_R_HIST.plus_not_paid,
             SALARY_SHEETS_R_HIST.vacation_advance_current,
             SALARY_SHEETS_R_HIST.vacation_advance_next,
             SALARY_SHEETS_R_HIST.vacation_advance_prev,
             SALARY_SHEETS_R_HIST.advance,
             SALARY_SHEETS_R_HIST.pay0,
             SALARY_SHEETS_R_HIST.pay,
             SALARY_SHEETS_R_HIST.payt,
             SALARY_SHEETS_R_HIST.pay_date,
             SALARY_SHEETS_R_HIST.comments,
             SALARY_SHEETS_R_HIST.withhold_from_pay,

             SALARY_SHEETS_R_HIST.foravpaycalc_bruto,
             SALARY_SHEETS_R_HIST.foravpaycalc_payout,
             SALARY_SHEETS_R_HIST.foravpaycalc_days,
             SALARY_SHEETS_R_HIST.foravpaycalc_hours,
             SALARY_SHEETS_R_HIST.avpaycalc_calday,
             SALARY_SHEETS_R_HIST.avpaycalc_day,
             SALARY_SHEETS_R_HIST.avpaycalc_hour,

             SALARY_SHEETS_R_HIST.dt_edited,
             SALARY_SHEETS_R_HIST.calc_ver

    from SALARY_SHEETS_R_HIST
    where SALARY_SHEETS_R_HIST.idsx = :pidsx and
        SALARY_SHEETS_R_HIST.dt_edited between :ptime1 and :ptime2
    order by SALARY_SHEETS_R_HIST.dt_edited

    into
        :idH,
        :id,
        :ids,
        :idsx,
        :idst,
        :is_temp,
        :type_tag,
        :idp,
        :idam,
        :snr,
        :fname,
        :lname,
        :position_title,
        :territorial_code,
        :calendar_days,
        :calendar_days_use,
        :month_workdays,
        :month_workhours,
        :plan_days,
        :plan_hours,
        :plan_hours_night,
        :plan_hours_overtime,
        :fact_days,
        :fact_hours,
        :fact_hours_night,
        :fact_hours_overtime,
        :plan_work_days,
        :plan_work_hours,
        :plan_work_hours_night,
        :plan_work_hours_overtime,
        :fact_work_days,
        :fact_work_hours,
        :fact_work_hours_night,
        :fact_work_hours_overtime,
        :plan_holidays_days,
        :plan_holidays_hours,
        :plan_holidays_hours_night,
        :plan_holidays_hours_overtime,
        :fact_holidays_days,
        :fact_holidays_hours,
        :fact_holidays_hours_night,
        :fact_holidays_hours_overtime,
        :salary,
        :salary_day,
        :salary_night,
        :salary_overtime,
        :salary_holidays_day,
        :salary_holidays_night,
        :salary_holidays_overtime,
        :salary_paid_holidays_day,
        :salary_paid_holidays_night,
        :salary_piecework,
        :sickdays,
        :sickdays_pay,
        :accident_days,
        :accident_pay,
        :average_income_days,
        :average_income_pay,
        
        :fact_avpay_free_days,
        :fact_avpay_free_hours,
        :fact_avpay_work_days,
        :fact_avpay_workinholidays,
        :fact_avpay_hours,
        :fact_avpay_hours_overtime,
        :fact_avpay_holidays_hours,
        :fact_avpay_holidays_hours_overt,
        :salary_avpay_free_days,
        :salary_avpay_work_days,
        :salary_avpay_work_days_overtime,
        :salary_avpay_holidays,
        :salary_avpay_holidays_overtime,
        
        :business_trip_days,
        :business_trip_pay,
        :paid_holidays,
        :paid_holidays_pay,
        :vacation_days_current,
        :vacation_days_next,
        :vacation_hours_current,
        :vacation_hours_next,
        :vacation_pay_current,
        :vacation_pay_next,
        :vacation_dns_next,
        :vacation_dds_next,
        :vacation_iin_next,
        :vacation_iin_reduce_next,
        :vacation_cash_next,
        :vacation_pay_prev,
        :vacation_dns_prev,
        :vacation_dds_prev,
        :vacation_iin_prev,
        :vacation_days_comp,
        :vacation_pay_comp,

        :plus_taxed,
        :plus_nottaxed,
        :plus_nosai,
        :plus_authors_fees,
        :minus_before_iin,
        :minus_after_iin,
        :plus_pf_nottaxed,
        :plus_pf_taxed,
        :plus_li_nottaxed,
        :plus_li_taxed,
        :plus_hi_nottaxed,
        :plus_hi_taxed,
        :plus_np_taxed,
        :plus_np_nottaxed,
        :plus_np_nosai,

        :total_before_taxes,
        :adjusted_amount,
        :amount_before_sn,
        :amount_before_sn_reverse,
        :rate_dnsn,
        :rate_ddsn,
        :dnsn_amount,
        :ddsn_amount,
        :sn_amount,
        :dnsn_amount_reverse,
        :ddsn_amount_reverse,
        :sn_max_amount,

        :iin_exempt_untaxed_minimum0,
        :iin_exempt_dependants0,
        :iin_exempt_retaliation0,
        :iin_exempt_invalidity0,
        :iin_exempt_national_movement0,
        :iin_exempt_untaxed_minimum,
        :iin_exempt_dependants,
        :iin_exempt_retaliation,
        :iin_exempt_invalidity,
        :iin_exempt_national_movement,
        :iin_exempt_expenses,
        :iin_exempt_2tp,
        :iin_exempt_20,
        :iin_exempt_2,
        :amount_before_iin,
        :amount_before_iin_reverse,
        :rate_iin,
        :rate_iin2,
        :iin_amount,
        :iin_amount_reverse,
        :urvn_amaount,

        :plus_not_paid,
        :vacation_advance_current,
        :vacation_advance_next,
        :vacation_advance_prev,
        :advance,
        :pay0,
        :pay,
        :payt,
        :pay_date,
        :comments,
        :withhold_from_pay,

        :foravpaycalc_bruto,
        :foravpaycalc_payout,
        :foravpaycalc_days,
        :foravpaycalc_hours,
        :avpaycalc_calday,
        :avpaycalc_day,
        :avpaycalc_hour,

        :dt_edited,
        :calc_ver
  do
  begin
    suspend;
  end
end
^

ALTER PROCEDURE SP_SALARY_SHEETS_R_PER_01(
  PYR1 INTEGER,
  PMT1 INTEGER,
  PYR2 INTEGER,
  PMT2 INTEGER)
RETURNS (
  ID TYPE OF COLUMN SALARY_SHEETS_R.ID,
  IDS TYPE OF COLUMN SALARY_SHEETS_R.IDS,
  IDSX TYPE OF COLUMN SALARY_SHEETS_R.IDSX,
  IDST TYPE OF COLUMN SALARY_SHEETS_R.IDST,
  IS_TEMP TYPE OF COLUMN SALARY_SHEETS_R.IS_TEMP,
  TYPE_TAG TYPE OF COLUMN SALARY_SHEETS_R.TYPE_TAG,
  IDP TYPE OF COLUMN SALARY_SHEETS_R.IDP,
  IDAM TYPE OF COLUMN SALARY_SHEETS_R.IDAM,
  SNR TYPE OF COLUMN SALARY_SHEETS_R.SNR,
  FNAME TYPE OF COLUMN SALARY_SHEETS_R.FNAME /* COLLATE UTF8 - default */,
  LNAME TYPE OF COLUMN SALARY_SHEETS_R.LNAME /* COLLATE UTF8 - default */,
  POSITION_TITLE TYPE OF COLUMN SALARY_SHEETS_R.POSITION_TITLE /* COLLATE UTF8 - default */,
  TERRITORIAL_CODE TYPE OF COLUMN SALARY_SHEETS_R.TERRITORIAL_CODE /* COLLATE UTF8 - default */,
  CALENDAR_DAYS TYPE OF COLUMN SALARY_SHEETS_R.CALENDAR_DAYS,
  CALENDAR_DAYS_USE TYPE OF COLUMN SALARY_SHEETS_R.CALENDAR_DAYS_USE,
  MONTH_WORKDAYS TYPE OF COLUMN SALARY_SHEETS_R.MONTH_WORKDAYS,
  MONTH_WORKHOURS TYPE OF COLUMN SALARY_SHEETS_R.MONTH_WORKHOURS,
  PLAN_DAYS TYPE OF COLUMN SALARY_SHEETS_R.PLAN_DAYS,
  PLAN_HOURS TYPE OF COLUMN SALARY_SHEETS_R.PLAN_HOURS,
  PLAN_HOURS_NIGHT TYPE OF COLUMN SALARY_SHEETS_R.PLAN_HOURS_NIGHT,
  PLAN_HOURS_OVERTIME TYPE OF COLUMN SALARY_SHEETS_R.PLAN_HOURS_OVERTIME,
  FACT_DAYS TYPE OF COLUMN SALARY_SHEETS_R.FACT_DAYS,
  FACT_HOURS TYPE OF COLUMN SALARY_SHEETS_R.FACT_HOURS,
  FACT_HOURS_NIGHT TYPE OF COLUMN SALARY_SHEETS_R.FACT_HOURS_NIGHT,
  FACT_HOURS_OVERTIME TYPE OF COLUMN SALARY_SHEETS_R.FACT_HOURS_OVERTIME,
  PLAN_WORK_DAYS TYPE OF COLUMN SALARY_SHEETS_R.PLAN_WORK_DAYS,
  PLAN_WORK_HOURS TYPE OF COLUMN SALARY_SHEETS_R.PLAN_WORK_HOURS,
  PLAN_WORK_HOURS_NIGHT TYPE OF COLUMN SALARY_SHEETS_R.PLAN_WORK_HOURS_NIGHT,
  PLAN_WORK_HOURS_OVERTIME TYPE OF COLUMN SALARY_SHEETS_R.PLAN_WORK_HOURS_OVERTIME,
  FACT_WORK_DAYS TYPE OF COLUMN SALARY_SHEETS_R.FACT_WORK_DAYS,
  FACT_WORK_HOURS TYPE OF COLUMN SALARY_SHEETS_R.FACT_WORK_HOURS,
  FACT_WORK_HOURS_NIGHT TYPE OF COLUMN SALARY_SHEETS_R.FACT_WORK_HOURS_NIGHT,
  FACT_WORK_HOURS_OVERTIME TYPE OF COLUMN SALARY_SHEETS_R.FACT_WORK_HOURS_OVERTIME,
  PLAN_HOLIDAYS_DAYS TYPE OF COLUMN SALARY_SHEETS_R.PLAN_HOLIDAYS_DAYS,
  PLAN_HOLIDAYS_HOURS TYPE OF COLUMN SALARY_SHEETS_R.PLAN_HOLIDAYS_HOURS,
  PLAN_HOLIDAYS_HOURS_NIGHT TYPE OF COLUMN SALARY_SHEETS_R.PLAN_HOLIDAYS_HOURS_NIGHT,
  PLAN_HOLIDAYS_HOURS_OVERTIME TYPE OF COLUMN SALARY_SHEETS_R.PLAN_HOLIDAYS_HOURS_OVERTIME,
  FACT_HOLIDAYS_DAYS TYPE OF COLUMN SALARY_SHEETS_R.FACT_HOLIDAYS_DAYS,
  FACT_HOLIDAYS_HOURS TYPE OF COLUMN SALARY_SHEETS_R.FACT_HOLIDAYS_HOURS,
  FACT_HOLIDAYS_HOURS_NIGHT TYPE OF COLUMN SALARY_SHEETS_R.FACT_HOLIDAYS_HOURS_NIGHT,
  FACT_HOLIDAYS_HOURS_OVERTIME TYPE OF COLUMN SALARY_SHEETS_R.FACT_HOLIDAYS_HOURS_OVERTIME,
  SALARY TYPE OF COLUMN SALARY_SHEETS_R.SALARY,
  SALARY_DAY TYPE OF COLUMN SALARY_SHEETS_R.SALARY_DAY,
  SALARY_NIGHT TYPE OF COLUMN SALARY_SHEETS_R.SALARY_NIGHT,
  SALARY_OVERTIME TYPE OF COLUMN SALARY_SHEETS_R.SALARY_OVERTIME,
  SALARY_HOLIDAYS_DAY TYPE OF COLUMN SALARY_SHEETS_R.SALARY_HOLIDAYS_DAY,
  SALARY_HOLIDAYS_NIGHT TYPE OF COLUMN SALARY_SHEETS_R.SALARY_HOLIDAYS_NIGHT,
  SALARY_HOLIDAYS_OVERTIME TYPE OF COLUMN SALARY_SHEETS_R.SALARY_HOLIDAYS_OVERTIME,
  SALARY_PAID_HOLIDAYS_DAY TYPE OF COLUMN SALARY_SHEETS_R.SALARY_PAID_HOLIDAYS_DAY,
  SALARY_PAID_HOLIDAYS_NIGHT TYPE OF COLUMN SALARY_SHEETS_R.SALARY_PAID_HOLIDAYS_NIGHT,
  SALARY_PIECEWORK TYPE OF COLUMN SALARY_SHEETS_R.SALARY_PIECEWORK,
  SICKDAYS TYPE OF COLUMN SALARY_SHEETS_R.SICKDAYS,
  SICKDAYS_PAY TYPE OF COLUMN SALARY_SHEETS_R.SICKDAYS_PAY,
  ACCIDENT_DAYS TYPE OF COLUMN SALARY_SHEETS_R.ACCIDENT_DAYS,
  ACCIDENT_PAY TYPE OF COLUMN SALARY_SHEETS_R.ACCIDENT_PAY,
  AVERAGE_INCOME_DAYS TYPE OF COLUMN SALARY_SHEETS_R.AVERAGE_INCOME_DAYS,
  AVERAGE_INCOME_PAY TYPE OF COLUMN SALARY_SHEETS_R.AVERAGE_INCOME_PAY,
  FACT_AVPAY_FREE_DAYS TYPE OF COLUMN SALARY_SHEETS_R.FACT_AVPAY_FREE_DAYS,
  FACT_AVPAY_FREE_HOURS TYPE OF COLUMN SALARY_SHEETS_R.FACT_AVPAY_FREE_HOURS,
  FACT_AVPAY_WORK_DAYS TYPE OF COLUMN SALARY_SHEETS_R.FACT_AVPAY_WORK_DAYS,
  FACT_AVPAY_WORKINHOLIDAYS TYPE OF COLUMN SALARY_SHEETS_R.FACT_AVPAY_WORKINHOLIDAYS,
  FACT_AVPAY_HOURS TYPE OF COLUMN SALARY_SHEETS_R.FACT_AVPAY_HOURS,
  FACT_AVPAY_HOURS_OVERTIME TYPE OF COLUMN SALARY_SHEETS_R.FACT_AVPAY_HOURS_OVERTIME,
  FACT_AVPAY_HOLIDAYS_HOURS TYPE OF COLUMN SALARY_SHEETS_R.FACT_AVPAY_HOLIDAYS_HOURS,
  FACT_AVPAY_HOLIDAYS_HOURS_OVERT TYPE OF COLUMN SALARY_SHEETS_R.FACT_AVPAY_HOLIDAYS_HOURS_OVERT,
  SALARY_AVPAY_FREE_DAYS TYPE OF COLUMN SALARY_SHEETS_R.SALARY_AVPAY_FREE_DAYS,
  SALARY_AVPAY_WORK_DAYS TYPE OF COLUMN SALARY_SHEETS_R.SALARY_AVPAY_WORK_DAYS,
  SALARY_AVPAY_WORK_DAYS_OVERTIME TYPE OF COLUMN SALARY_SHEETS_R.SALARY_AVPAY_WORK_DAYS_OVERTIME,
  SALARY_AVPAY_HOLIDAYS TYPE OF COLUMN SALARY_SHEETS_R.SALARY_AVPAY_HOLIDAYS,
  SALARY_AVPAY_HOLIDAYS_OVERTIME TYPE OF COLUMN SALARY_SHEETS_R.SALARY_AVPAY_HOLIDAYS_OVERTIME,
  BUSINESS_TRIP_DAYS TYPE OF COLUMN SALARY_SHEETS_R.BUSINESS_TRIP_DAYS,
  BUSINESS_TRIP_PAY TYPE OF COLUMN SALARY_SHEETS_R.BUSINESS_TRIP_PAY,
  PAID_HOLIDAYS TYPE OF COLUMN SALARY_SHEETS_R.PAID_HOLIDAYS,
  PAID_HOLIDAYS_PAY TYPE OF COLUMN SALARY_SHEETS_R.PAID_HOLIDAYS_PAY,
  VACATION_DAYS_CURRENT TYPE OF COLUMN SALARY_SHEETS_R.VACATION_DAYS_CURRENT,
  VACATION_DAYS_NEXT TYPE OF COLUMN SALARY_SHEETS_R.VACATION_DAYS_NEXT,
  VACATION_HOURS_CURRENT TYPE OF COLUMN SALARY_SHEETS_R.VACATION_HOURS_CURRENT,
  VACATION_HOURS_NEXT TYPE OF COLUMN SALARY_SHEETS_R.VACATION_HOURS_NEXT,
  VACATION_PAY_CURRENT TYPE OF COLUMN SALARY_SHEETS_R.VACATION_PAY_CURRENT,
  VACATION_PAY_NEXT TYPE OF COLUMN SALARY_SHEETS_R.VACATION_PAY_NEXT,
  VACATION_DNS_NEXT TYPE OF COLUMN SALARY_SHEETS_R.VACATION_DNS_NEXT,
  VACATION_DDS_NEXT TYPE OF COLUMN SALARY_SHEETS_R.VACATION_DDS_NEXT,
  VACATION_IIN_NEXT TYPE OF COLUMN SALARY_SHEETS_R.VACATION_IIN_NEXT,
  VACATION_IIN_REDUCE_NEXT TYPE OF COLUMN SALARY_SHEETS_R.VACATION_IIN_REDUCE_NEXT,
  VACATION_CASH_NEXT TYPE OF COLUMN SALARY_SHEETS_R.VACATION_CASH_NEXT,
  VACATION_PAY_PREV TYPE OF COLUMN SALARY_SHEETS_R.VACATION_PAY_PREV,
  VACATION_DNS_PREV TYPE OF COLUMN SALARY_SHEETS_R.VACATION_DNS_PREV,
  VACATION_DDS_PREV TYPE OF COLUMN SALARY_SHEETS_R.VACATION_DDS_PREV,
  VACATION_IIN_PREV TYPE OF COLUMN SALARY_SHEETS_R.VACATION_IIN_PREV,
  VACATION_DAYS_COMP TYPE OF COLUMN SALARY_SHEETS_R.VACATION_DAYS_COMP,
  VACATION_PAY_COMP TYPE OF COLUMN SALARY_SHEETS_R.VACATION_PAY_COMP,
  PLUS_TAXED TYPE OF COLUMN SALARY_SHEETS_R.PLUS_TAXED,
  PLUS_NOTTAXED TYPE OF COLUMN SALARY_SHEETS_R.PLUS_NOTTAXED,
  PLUS_NOSAI TYPE OF COLUMN SALARY_SHEETS_R.PLUS_NOSAI,
  PLUS_AUTHORS_FEES TYPE OF COLUMN SALARY_SHEETS_R.PLUS_AUTHORS_FEES,
  MINUS_BEFORE_IIN TYPE OF COLUMN SALARY_SHEETS_R.MINUS_BEFORE_IIN,
  MINUS_AFTER_IIN TYPE OF COLUMN SALARY_SHEETS_R.MINUS_AFTER_IIN,
  PLUS_PF_NOTTAXED TYPE OF COLUMN SALARY_SHEETS_R.PLUS_PF_NOTTAXED,
  PLUS_PF_TAXED TYPE OF COLUMN SALARY_SHEETS_R.PLUS_PF_TAXED,
  PLUS_LI_NOTTAXED TYPE OF COLUMN SALARY_SHEETS_R.PLUS_LI_NOTTAXED,
  PLUS_LI_TAXED TYPE OF COLUMN SALARY_SHEETS_R.PLUS_LI_TAXED,
  PLUS_HI_NOTTAXED TYPE OF COLUMN SALARY_SHEETS_R.PLUS_HI_NOTTAXED,
  PLUS_HI_TAXED TYPE OF COLUMN SALARY_SHEETS_R.PLUS_HI_TAXED,
  PLUS_NP_TAXED TYPE OF COLUMN SALARY_SHEETS_R.PLUS_NP_TAXED,
  PLUS_NP_NOTTAXED TYPE OF COLUMN SALARY_SHEETS_R.PLUS_NP_NOTTAXED,
  PLUS_NP_NOSAI TYPE OF COLUMN SALARY_SHEETS_R.PLUS_NP_NOSAI,
  TOTAL_BEFORE_TAXES TYPE OF COLUMN SALARY_SHEETS_R.TOTAL_BEFORE_TAXES,
  ADJUSTED_AMOUNT TYPE OF COLUMN SALARY_SHEETS_R.ADJUSTED_AMOUNT,
  AMOUNT_BEFORE_SN TYPE OF COLUMN SALARY_SHEETS_R.AMOUNT_BEFORE_SN,
  AMOUNT_BEFORE_SN_REVERSE TYPE OF COLUMN SALARY_SHEETS_R.AMOUNT_BEFORE_SN_REVERSE,
  RATE_DNSN TYPE OF COLUMN SALARY_SHEETS_R.RATE_DNSN,
  RATE_DDSN TYPE OF COLUMN SALARY_SHEETS_R.RATE_DDSN,
  DNSN_AMOUNT TYPE OF COLUMN SALARY_SHEETS_R.DNSN_AMOUNT,
  DDSN_AMOUNT TYPE OF COLUMN SALARY_SHEETS_R.DDSN_AMOUNT,
  SN_AMOUNT TYPE OF COLUMN SALARY_SHEETS_R.SN_AMOUNT,
  DNSN_AMOUNT_REVERSE TYPE OF COLUMN SALARY_SHEETS_R.DNSN_AMOUNT_REVERSE,
  DDSN_AMOUNT_REVERSE TYPE OF COLUMN SALARY_SHEETS_R.DDSN_AMOUNT_REVERSE,
  SN_MAX_AMOUNT TYPE OF COLUMN SALARY_SHEETS_R.SN_MAX_AMOUNT,
  IIN_EXEMPT_UNTAXED_MINIMUM0 TYPE OF COLUMN SALARY_SHEETS_R.IIN_EXEMPT_UNTAXED_MINIMUM0,
  IIN_EXEMPT_DEPENDANTS0 TYPE OF COLUMN SALARY_SHEETS_R.IIN_EXEMPT_DEPENDANTS0,
  IIN_EXEMPT_RETALIATION0 TYPE OF COLUMN SALARY_SHEETS_R.IIN_EXEMPT_RETALIATION0,
  IIN_EXEMPT_INVALIDITY0 TYPE OF COLUMN SALARY_SHEETS_R.IIN_EXEMPT_INVALIDITY0,
  IIN_EXEMPT_NATIONAL_MOVEMENT0 TYPE OF COLUMN SALARY_SHEETS_R.IIN_EXEMPT_NATIONAL_MOVEMENT0,
  IIN_EXEMPT_UNTAXED_MINIMUM TYPE OF COLUMN SALARY_SHEETS_R.IIN_EXEMPT_UNTAXED_MINIMUM,
  IIN_EXEMPT_DEPENDANTS TYPE OF COLUMN SALARY_SHEETS_R.IIN_EXEMPT_DEPENDANTS,
  IIN_EXEMPT_RETALIATION TYPE OF COLUMN SALARY_SHEETS_R.IIN_EXEMPT_RETALIATION,
  IIN_EXEMPT_INVALIDITY TYPE OF COLUMN SALARY_SHEETS_R.IIN_EXEMPT_INVALIDITY,
  IIN_EXEMPT_NATIONAL_MOVEMENT TYPE OF COLUMN SALARY_SHEETS_R.IIN_EXEMPT_NATIONAL_MOVEMENT,
  IIN_EXEMPT_EXPENSES TYPE OF COLUMN SALARY_SHEETS_R.IIN_EXEMPT_EXPENSES,
  IIN_EXEMPT_2TP TYPE OF COLUMN SALARY_SHEETS_R.IIN_EXEMPT_2TP,
  IIN_EXEMPT_20 TYPE OF COLUMN SALARY_SHEETS_R.IIN_EXEMPT_20,
  IIN_EXEMPT_2 TYPE OF COLUMN SALARY_SHEETS_R.IIN_EXEMPT_2,
  AMOUNT_BEFORE_IIN TYPE OF COLUMN SALARY_SHEETS_R.AMOUNT_BEFORE_IIN,
  AMOUNT_BEFORE_IIN_REVERSE TYPE OF COLUMN SALARY_SHEETS_R.AMOUNT_BEFORE_IIN_REVERSE,
  RATE_IIN TYPE OF COLUMN SALARY_SHEETS_R.RATE_IIN,
  RATE_IIN2 TYPE OF COLUMN SALARY_SHEETS_R.RATE_IIN2,
  IIN_AMOUNT TYPE OF COLUMN SALARY_SHEETS_R.IIN_AMOUNT,
  IIN_AMOUNT_REVERSE TYPE OF COLUMN SALARY_SHEETS_R.IIN_AMOUNT_REVERSE,
  URVN_AMAOUNT TYPE OF COLUMN SALARY_SHEETS_R.URVN_AMAOUNT,
  PLUS_NOT_PAID TYPE OF COLUMN SALARY_SHEETS_R.PLUS_NOT_PAID,
  VACATION_ADVANCE_CURRENT TYPE OF COLUMN SALARY_SHEETS_R.VACATION_ADVANCE_CURRENT,
  VACATION_ADVANCE_NEXT TYPE OF COLUMN SALARY_SHEETS_R.VACATION_ADVANCE_NEXT,
  VACATION_ADVANCE_PREV TYPE OF COLUMN SALARY_SHEETS_R.VACATION_ADVANCE_PREV,
  ADVANCE TYPE OF COLUMN SALARY_SHEETS_R.ADVANCE,
  PAY0 TYPE OF COLUMN SALARY_SHEETS_R.PAY0,
  PAY TYPE OF COLUMN SALARY_SHEETS_R.PAY,
  PAYT TYPE OF COLUMN SALARY_SHEETS_R.PAYT,
  PAY_DATE TYPE OF COLUMN SALARY_SHEETS_R.PAY_DATE,
  COMMENTS TYPE OF COLUMN SALARY_SHEETS_R.COMMENTS /* COLLATE UTF8 - default */,
  WITHHOLD_FROM_PAY TYPE OF COLUMN SALARY_SHEETS_R.WITHHOLD_FROM_PAY,
  FORAVPAYCALC_BRUTO TYPE OF COLUMN SALARY_SHEETS_R.FORAVPAYCALC_BRUTO,
  FORAVPAYCALC_PAYOUT TYPE OF COLUMN SALARY_SHEETS_R.FORAVPAYCALC_PAYOUT,
  FORAVPAYCALC_DAYS TYPE OF COLUMN SALARY_SHEETS_R.FORAVPAYCALC_DAYS,
  FORAVPAYCALC_HOURS TYPE OF COLUMN SALARY_SHEETS_R.FORAVPAYCALC_HOURS,
  AVPAYCALC_CALDAY TYPE OF COLUMN SALARY_SHEETS_R.AVPAYCALC_CALDAY,
  AVPAYCALC_DAY TYPE OF COLUMN SALARY_SHEETS_R.AVPAYCALC_DAY,
  AVPAYCALC_HOUR TYPE OF COLUMN SALARY_SHEETS_R.AVPAYCALC_HOUR,
  DT_EDITED TYPE OF COLUMN SALARY_SHEETS_R.DT_EDITED,
  CALC_VER TYPE OF COLUMN SALARY_SHEETS_R.CALC_VER)
AS
declare km1 integer;
    declare km2 integer;
begin
    km1 = (:pyr1 - 1900) * 13 + :pmt1;
    km2 = (:pyr2 - 1900) * 13 + :pmt2;

    for select salary_sheets_r.id,
             salary_sheets_r.ids,
             salary_sheets_r.idsx,
             salary_sheets_r.idst,
             salary_sheets_r.is_temp,
             salary_sheets_r.type_tag,
             salary_sheets_r.idp,
             salary_sheets_r.idam,
             salary_sheets_r.snr,
             salary_sheets_r.fname,
             salary_sheets_r.lname,
             salary_sheets_r.position_title,
             salary_sheets_r.territorial_code,
             salary_sheets_r.calendar_days,
             salary_sheets_r.calendar_days_use,
             salary_sheets_r.month_workdays,
             salary_sheets_r.month_workhours,
             salary_sheets_r.plan_days,
             salary_sheets_r.plan_hours,
             salary_sheets_r.plan_hours_night,
             salary_sheets_r.plan_hours_overtime,
             salary_sheets_r.fact_days,
             salary_sheets_r.fact_hours,
             salary_sheets_r.fact_hours_night,
             salary_sheets_r.fact_hours_overtime,
             salary_sheets_r.plan_work_days,
             salary_sheets_r.plan_work_hours,
             salary_sheets_r.plan_work_hours_night,
             salary_sheets_r.plan_work_hours_overtime,
             salary_sheets_r.fact_work_days,
             salary_sheets_r.fact_work_hours,
             salary_sheets_r.fact_work_hours_night,
             salary_sheets_r.fact_work_hours_overtime,
             salary_sheets_r.plan_holidays_days,
             salary_sheets_r.plan_holidays_hours,
             salary_sheets_r.plan_holidays_hours_night,
             salary_sheets_r.plan_holidays_hours_overtime,
             salary_sheets_r.fact_holidays_days,
             salary_sheets_r.fact_holidays_hours,
             salary_sheets_r.fact_holidays_hours_night,
             salary_sheets_r.fact_holidays_hours_overtime,
             salary_sheets_r.salary,
             salary_sheets_r.salary_day,
             salary_sheets_r.salary_night,
             salary_sheets_r.salary_overtime,
             salary_sheets_r.salary_holidays_day,
             salary_sheets_r.salary_holidays_night,
             salary_sheets_r.salary_holidays_overtime,
             salary_sheets_r.salary_paid_holidays_day,
             salary_sheets_r.salary_paid_holidays_night,
             salary_sheets_r.salary_piecework,
             salary_sheets_r.sickdays,
             salary_sheets_r.sickdays_pay,
             salary_sheets_r.accident_days,
             salary_sheets_r.accident_pay,
             salary_sheets_r.average_income_days,
             salary_sheets_r.average_income_pay,

             salary_sheets_r.fact_avpay_free_days,
             salary_sheets_r.fact_avpay_free_hours,
             salary_sheets_r.fact_avpay_work_days,
             salary_sheets_r.fact_avpay_workinholidays,
             salary_sheets_r.fact_avpay_hours,
             salary_sheets_r.fact_avpay_hours_overtime,
             salary_sheets_r.fact_avpay_holidays_hours,
             salary_sheets_r.fact_avpay_holidays_hours_overt,
             salary_sheets_r.salary_avpay_free_days,
             salary_sheets_r.salary_avpay_work_days,
             salary_sheets_r.salary_avpay_work_days_overtime,
             salary_sheets_r.salary_avpay_holidays,
             salary_sheets_r.salary_avpay_holidays_overtime,

             salary_sheets_r.business_trip_days,
             salary_sheets_r.business_trip_pay,
             salary_sheets_r.paid_holidays,
             salary_sheets_r.paid_holidays_pay,
             salary_sheets_r.vacation_days_current,
             salary_sheets_r.vacation_days_next,
             salary_sheets_r.vacation_hours_current,
             salary_sheets_r.vacation_hours_next,
             salary_sheets_r.vacation_pay_current,
             salary_sheets_r.vacation_pay_next,
             salary_sheets_r.vacation_dns_next,
             salary_sheets_r.vacation_dds_next,
             salary_sheets_r.vacation_iin_next,
             salary_sheets_r.vacation_iin_reduce_next,
             salary_sheets_r.vacation_cash_next,
             salary_sheets_r.vacation_pay_prev,
             salary_sheets_r.vacation_dns_prev,
             salary_sheets_r.vacation_dds_prev,
             salary_sheets_r.vacation_iin_prev,
             salary_sheets_r.vacation_days_comp,
             salary_sheets_r.vacation_pay_comp,

             salary_sheets_r.plus_taxed,
             salary_sheets_r.plus_nottaxed,
             salary_sheets_r.plus_nosai,
             salary_sheets_r.plus_authors_fees,
             salary_sheets_r.minus_before_iin,
             salary_sheets_r.minus_after_iin,
             salary_sheets_r.plus_pf_nottaxed,
             salary_sheets_r.plus_pf_taxed,
             salary_sheets_r.plus_li_nottaxed,
             salary_sheets_r.plus_li_taxed,
             salary_sheets_r.plus_hi_nottaxed,
             salary_sheets_r.plus_hi_taxed,
             salary_sheets_r.plus_np_taxed,
             salary_sheets_r.plus_np_nottaxed,
             salary_sheets_r.plus_np_nosai,

             salary_sheets_r.total_before_taxes,
             salary_sheets_r.adjusted_amount,
             salary_sheets_r.amount_before_sn,
             salary_sheets_r.amount_before_sn_reverse,
             salary_sheets_r.rate_dnsn,
             salary_sheets_r.rate_ddsn,
             salary_sheets_r.dnsn_amount,
             salary_sheets_r.ddsn_amount,
             salary_sheets_r.sn_amount,
             salary_sheets_r.dnsn_amount_reverse,
             salary_sheets_r.ddsn_amount_reverse,
             salary_sheets_r.sn_max_amount,

             salary_sheets_r.iin_exempt_untaxed_minimum0,
             salary_sheets_r.iin_exempt_dependants0,
             salary_sheets_r.iin_exempt_retaliation0,
             salary_sheets_r.iin_exempt_invalidity0,
             salary_sheets_r.iin_exempt_national_movement0,
             salary_sheets_r.iin_exempt_untaxed_minimum,
             salary_sheets_r.iin_exempt_dependants,
             salary_sheets_r.iin_exempt_retaliation,
             salary_sheets_r.iin_exempt_invalidity,
             salary_sheets_r.iin_exempt_national_movement,
             salary_sheets_r.iin_exempt_expenses,
             salary_sheets_r.iin_exempt_2tp,
             salary_sheets_r.iin_exempt_20,
             salary_sheets_r.iin_exempt_2,
             salary_sheets_r.amount_before_iin,
             salary_sheets_r.amount_before_iin_reverse,
             salary_sheets_r.rate_iin,
             salary_sheets_r.rate_iin2,
             salary_sheets_r.iin_amount,
             salary_sheets_r.iin_amount_reverse,
             salary_sheets_r.urvn_amaount,

             salary_sheets_r.plus_not_paid,
             salary_sheets_r.vacation_advance_current,
             salary_sheets_r.vacation_advance_next,
             salary_sheets_r.vacation_advance_prev,
             salary_sheets_r.advance,
             salary_sheets_r.pay0,
             salary_sheets_r.pay,
             salary_sheets_r.payt,
             salary_sheets_r.pay_date,
             salary_sheets_r.comments,
             salary_sheets_r.withhold_from_pay,

             salary_sheets_r.foravpaycalc_bruto,
             salary_sheets_r.foravpaycalc_payout,
             salary_sheets_r.foravpaycalc_days,
             salary_sheets_r.foravpaycalc_hours,
             salary_sheets_r.avpaycalc_calday,
             salary_sheets_r.avpaycalc_day,
             salary_sheets_r.avpaycalc_hour,

             salary_sheets_r.dt_edited,
             salary_sheets_r.calc_ver


    from salary_sheets
    inner join salary_sheets_r on salary_sheets.id = salary_sheets_r.ids

    where ((salary_sheets.yr - 1900)*13 + salary_sheets.mt) between :km1 and :km2

    order by salary_sheets.yr, salary_sheets.mt, salary_sheets.snr, salary_sheets_r.snr

    into :id,
        :ids,
        :idsx,
        :idst,
        :is_temp,
        :type_tag,
        :idp,
        :idam,
        :snr,
        :fname,
        :lname,
        :position_title,
        :territorial_code,
        :calendar_days,
        :calendar_days_use,
        :month_workdays,
        :month_workhours,
        :plan_days,
        :plan_hours,
        :plan_hours_night,
        :plan_hours_overtime,
        :fact_days,
        :fact_hours,
        :fact_hours_night,
        :fact_hours_overtime,
        :plan_work_days,
        :plan_work_hours,
        :plan_work_hours_night,
        :plan_work_hours_overtime,
        :fact_work_days,
        :fact_work_hours,
        :fact_work_hours_night,
        :fact_work_hours_overtime,
        :plan_holidays_days,
        :plan_holidays_hours,
        :plan_holidays_hours_night,
        :plan_holidays_hours_overtime,
        :fact_holidays_days,
        :fact_holidays_hours,
        :fact_holidays_hours_night,
        :fact_holidays_hours_overtime,
        :salary,
        :salary_day,
        :salary_night,
        :salary_overtime,
        :salary_holidays_day,
        :salary_holidays_night,
        :salary_holidays_overtime,
        :salary_paid_holidays_day,
        :salary_paid_holidays_night,
        :salary_piecework,
        :sickdays,
        :sickdays_pay,
        :accident_days,
        :accident_pay,
        :average_income_days,
        :average_income_pay,
        
        :fact_avpay_free_days,
        :fact_avpay_free_hours,
        :fact_avpay_work_days,
        :fact_avpay_workinholidays,
        :fact_avpay_hours,
        :fact_avpay_hours_overtime,
        :fact_avpay_holidays_hours,
        :fact_avpay_holidays_hours_overt,
        :salary_avpay_free_days,
        :salary_avpay_work_days,
        :salary_avpay_work_days_overtime,
        :salary_avpay_holidays,
        :salary_avpay_holidays_overtime,
        
        :business_trip_days,
        :business_trip_pay,
        :paid_holidays,
        :paid_holidays_pay,
        :vacation_days_current,
        :vacation_days_next,
        :vacation_hours_current,
        :vacation_hours_next,
        :vacation_pay_current,
        :vacation_pay_next,
        :vacation_dns_next,
        :vacation_dds_next,
        :vacation_iin_next,
        :vacation_iin_reduce_next,
        :vacation_cash_next,
        :vacation_pay_prev,
        :vacation_dns_prev,
        :vacation_dds_prev,
        :vacation_iin_prev,
        :vacation_days_comp,
        :vacation_pay_comp,

        :plus_taxed,
        :plus_nottaxed,
        :plus_nosai,
        :plus_authors_fees,
        :minus_before_iin,
        :minus_after_iin,
        :plus_pf_nottaxed,
        :plus_pf_taxed,
        :plus_li_nottaxed,
        :plus_li_taxed,
        :plus_hi_nottaxed,
        :plus_hi_taxed,
        :plus_np_taxed,
        :plus_np_nottaxed,
        :plus_np_nosai,

        :total_before_taxes,
        :adjusted_amount,
        :amount_before_sn,
        :amount_before_sn_reverse,
        :rate_dnsn,
        :rate_ddsn,
        :dnsn_amount,
        :ddsn_amount,
        :sn_amount,
        :dnsn_amount_reverse,
        :ddsn_amount_reverse,
        :sn_max_amount,

        :iin_exempt_untaxed_minimum0,
        :iin_exempt_dependants0,
        :iin_exempt_retaliation0,
        :iin_exempt_invalidity0,
        :iin_exempt_national_movement0,
        :iin_exempt_untaxed_minimum,
        :iin_exempt_dependants,
        :iin_exempt_retaliation,
        :iin_exempt_invalidity,
        :iin_exempt_national_movement,
        :iin_exempt_expenses,
        :iin_exempt_2tp,
        :iin_exempt_20,
        :iin_exempt_2,
        :amount_before_iin,
        :amount_before_iin_reverse,
        :rate_iin,
        :rate_iin2,
        :iin_amount,
        :iin_amount_reverse,
        :urvn_amaount,

        :plus_not_paid,
        :vacation_advance_current,
        :vacation_advance_next,
        :vacation_advance_prev,
        :advance,
        :pay0,
        :pay,
        :payt,
        :pay_date,
        :comments,
        :withhold_from_pay,

        :foravpaycalc_bruto,
        :foravpaycalc_payout,
        :foravpaycalc_days,
        :foravpaycalc_hours,
        :avpaycalc_calday,
        :avpaycalc_day,
        :avpaycalc_hour,

        :dt_edited,
        :calc_ver
  do
  begin
    suspend;
  end
end
^


SET TERM ; ^
  
  
UPDATE Params
SET PVALUE = '058'
WHERE PNAME = 'version';
